var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},MJLobby;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.needFullWidth=!0,egret.MainContext.instance.stage.addEventListener(egret.Event.RESIZE,e.resize,e),e.addEventListener(egret.Event.REMOVED_FROM_STAGE,e.onRemove,e),e.resize(),e}return __extends(e,t),e.prototype.resize=function(){this.needFullWidth&&(this.width=uniLib.Global.screenWidth)},e.prototype.onRemove=function(){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemove,this),egret.MainContext.instance.stage.removeEventListener(egret.Event.RESIZE,this.resize,this)},e}(eui.Component);t.BaseComponent=e,__reflect(e.prototype,"MJLobby.BaseComponent")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(){function e(){}return Object.defineProperty(e,"shareScale",{get:function(){return uniLib.Utils.isIOS()?this.iosShareScale:this._shareScale},enumerable:!0,configurable:!0}),e.getLobbyConfig=function(e){var i=this,n="http://h5.publish.66yy99.cn/Mahjong.jx/shareimg/lobbyconfig.json"+(e?"?v="+Date.now():"");RES.getResByUrl(n,function(e){if(e)for(var n in e){var o=e[n];o.id==t.MJLobbyData.getInstance().lobbyId&&(i.lobbyConfig=o)}},this,RES.ResourceItem.TYPE_JSON)},Object.defineProperty(e,"shopLink",{get:function(){return this._shopUrl&&""!=this._shopUrl?this._shopUrl:(this.lobbyConfig||this.getLobbyConfig(),this.lobbyConfig?this.lobbyConfig.shopUrl:null)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"wxShareUrl",{get:function(){if(""!=this._wxShareUrl)return this._wxShareUrl;var e="";t.MJLobbyData.getInstance().getLobbyConfig();return this.lobbyConfig||this.getLobbyConfig(),this.lobbyConfig&&(e=this.lobbyConfig.newLink),this.setLocalShareUrl(e),this._wxShareUrl},set:function(t){this.setLocalShareUrl(t),this._wxShareUrl=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"noticeUrl",{get:function(){if(""!=this._noticeUrl)return this._noticeUrl;t.MJLobbyData.getInstance().getLobbyConfig();return this.lobbyConfig||this.getLobbyConfig(),this.lobbyConfig&&(this._noticeUrl=this.lobbyConfig.noticeUrl),this._noticeUrl},enumerable:!0,configurable:!0}),e.setLocalShareUrl=function(e){var i=t.MJLobbyData.getInstance().getLobbyConfig();i&&i.hasOwnProperty("newLink")&&""!=i.newLink&&(i.newLink=e),this._wxShareUrl=e},e.DoShare=function(t,e,i,n,o,a){void 0===o&&(o=null),void 0===a&&(a=!1);var s=new uniLib.WXShareVo;a||(s.shareWay=e),1==t?this.shareLink(s,i,n,a):this.shareImg(s,i,n,o)},e.shareLink=function(i,n,o,a){void 0===a&&(a=!1);var s=uniLib.SHARE_PLAT.WX;if(a&&(s=uniLib.SHARE_PLAT.WJ),""==uniLib.ZQGameSdk.defaultWXShareVo.webpageUrl&&t.LobbyDataCache.bundleInfo&&t.LobbyDataCache.bundleInfo.weixin.wbappid){var r=t.MJLobbyData.getInstance().myBaseInfo.nickName;r.length>8&&(r=r.slice(0,8)),i.webpageUrl="https://open.weixin.qq.com/connect/oauth2/authorize?appid="+t.LobbyDataCache.bundleInfo.weixin.wbappid+"&redirect_uri=http://"+e.wxShareUrl+"/addons/zqgame/gameshare.php?appid="+t.LobbyDataCache.bundleInfo.weixin.wbappid+"&response_type=code&scope=snsapi_base&state="+uniLib.CompressUtil.base64encode(t.MJLobbyData.getInstance().myBaseInfo.uid+"|0|"+r)+"&connect_redirect=1#wechat_redirect"}else i.webpageUrl=uniLib.ZQGameSdk.defaultWXShareVo.webpageUrl+"?uid="+t.MJLobbyData.getInstance().myBaseInfo.uid+"&nickName="+t.MJLobbyData.getInstance().myBaseInfo.nickName;a&&(i.webpageUrl=this.getXianLiaoLink()),uniLib.ZQGameSdk.share(i,n,o,s)},e.getXianLiaoLink=function(){var e=t.MJLobbyData.getInstance().myBaseInfo.nickName;e.length>8&&(e=e.slice(0,8));var i=t.MJLobbyData.getInstance().lobbyConfig,n=uniLib.Global.gameConfig&&uniLib.Global.gameConfig.gameid?uniLib.Global.gameConfig.gameid:9501;return i?"http://open.xianliao.updrips.com/connect/oauth2/authorize?appid="+t.MJLobbyData.getInstance().lobbyConfig.xianliaoAppid+"&redirect_uri= http://"+t.MJLobbyData.getInstance().lobbyConfig.xianliaoUrl+"/"+n+"/311/login_request&state="+uniLib.CompressUtil.base64encode(t.MJLobbyData.getInstance().myBaseInfo.uid+"|0|"+e)+"&response_type=code#xianliao_redirect":""},e.shareImg=function(i,n,o,a){if(a){var s=new egret.DisplayObjectContainer,r=new egret.Bitmap;s.addChild(r),RES.getResByUrl(a,function(a){if(a){r.bitmapData=a;var h=new egret.Bitmap(uniLib.DisplayUtils.catchScreenToTex(s,new egret.Rectangle(0,0,s.width,s.height),e.shareScale));i.shareImageData=uniLib.DisplayUtils.catchScreen(h,new egret.Rectangle(0,0,h.width,h.height)),uniLib.ZQGameSdk.share(i,n,o)}else t.LobbyPopupManager.showMildWarnShow("分享图片资源获取失败,请稍后重试!")},this)}else{var h=new egret.DisplayObjectContainer,c=new egret.Bitmap(RES.getRes("s_share_png"));h.addChild(c);var l=new egret.Bitmap(uniLib.DisplayUtils.catchScreenToTex(h,new egret.Rectangle(0,0,h.width,h.height),e.shareScale));i.shareImageData=uniLib.DisplayUtils.catchScreen(l,new egret.Rectangle(0,0,l.width,l.height)),uniLib.ZQGameSdk.share(i,n,o)}},e.sharePromote=function(e,i,n,o){var a=new egret.DisplayObjectContainer;a.y=-600;var s=uniLib.DisplayUtils.createBitmapByName("lobby_promote_jpg");a.addChild(s);var r=uniLib.DisplayUtils.createTextLabel(3184046,egret.HorizontalAlign.CENTER,"",56,420,100);r.text=e?e.slice(0,6):"",a.addChild(r),r.x=(a.width-r.width)/2,r.y=275,r.multiline=!1,r.verticalAlign=egret.VerticalAlign.MIDDLE;var h=uniLib.DisplayUtils.createTextLabel(3184046,egret.HorizontalAlign.CENTER,"",30,420,60);h.text=(i?i.slice(0,5):"")+"("+(n?n:666666)+")",a.addChild(h),h.x=(a.width-h.width)/2,h.y=677,h.verticalAlign=egret.VerticalAlign.MIDDLE;var c=this.getCodeImg(n,280,280);c.x=220,c.y=770,a.addChild(c);var l=t.MJLobbyData.getInstance().myBaseInfo.headUrl;if(l){var d=new t.LobbyHeadMc(78,78);d.headUrl=l,a.addChild(d),d.x=c.x+140-d.width/2,d.y=c.y+140-d.height/2}var u=uniLib.DisplayUtils.createTextLabel(3184046,egret.HorizontalAlign.CENTER,"",36,600,60);u.x=(a.width-u.width)/2,u.y=a.height-u.height-20,u.text="客服微信:"+(o&&""!=o?o:t.DataManage.customerWeChat),a.addChild(u);var b=new uniLib.WXShareVo;b.shareWay=1;var p=new egret.Bitmap(uniLib.DisplayUtils.catchScreenToTex(a,new egret.Rectangle(0,0,720,1280),.75));b.shareImageData=uniLib.DisplayUtils.catchScreen(p,new egret.Rectangle(0,0,p.width,p.height)),uniLib.ZQGameSdk.share(b,null,this),uniLib.Global.isH5&&(a.y=-500,t.LobbyPopupManager.addPopUp(a))},e.getCodeImg=function(i,n,o){var a,s="";return s=""==uniLib.ZQGameSdk.defaultWXShareVo.webpageUrl&&t.LobbyDataCache.bundleInfo&&t.LobbyDataCache.bundleInfo.weixin.wbappid?"https://open.weixin.qq.com/connect/oauth2/authorize?appid="+t.LobbyDataCache.bundleInfo.weixin.wbappid+"&redirect_uri=http://"+e.wxShareUrl+"/addons/zqgame/gameshare.php?appid="+t.LobbyDataCache.bundleInfo.weixin.wbappid+"&response_type=code&scope=snsapi_base&state="+uniLib.CompressUtil.base64encode(t.MJLobbyData.getInstance().myBaseInfo.uid+"|"+i)+"&connect_redirect=1#wechat_redirect":uniLib.ZQGameSdk.defaultWXShareVo.webpageUrl+"?uid="+t.MJLobbyData.getInstance().myBaseInfo.uid,""!=s&&(console.log("二维码url:"+s),a=qr.QRCode.create(s,n,o,qr.QRErrorCorrectLevel.M,this.codeVersion)),a},e.showOfficialNumPanel=function(){var e="代理咨询、钻石购买\n请关注官方微信公众号："+t.MJLobbyData.getInstance().getLobbyConfig().officialNum;t.LobbyPopupManager.showConfirmPanel(e,["确定"],[],"",this)},e.delayShareBack=function(t){0==t?console.error("分享成功!"):1==t?console.error("分享已取消"):2==t&&console.error("分享被拒绝")},e.getDateRang=function(e,i,n){void 0===n&&(n=86400);var o,a,s=[],r=i,h=e,c=new Date(h).getDate(),l=new Date(h).getMonth(),d=new Date(h).getFullYear(),u=new Date(r).getDate(),b=new Date(r).getMonth(),p=new Date(r).getFullYear();if(c!=u||l!=b||d!=p){o=new Date(d,l,c,0,0,0,0).valueOf()/1e3,a=new Date(p,b,u+1,23,59,59).valueOf()/1e3;for(var m=o;a>=m;m+=n)s.push({key:t.DataManage.FormatDate(m,!0),value:m})}return s},e.getDayRang=function(e,i){void 0===i&&(i=3600);for(var n=[],o=e,a=new Date(1e3*o),s=a.getDate(),r=a.getMonth(),h=a.getFullYear(),c=new Date(h,r,s,0,0,0,0).valueOf()/1e3,l=new Date(h,r,s+1,0,0,0,0).valueOf()/1e3,d=c;l>=d;d+=i)n.push({key:t.DataManage.FormatDate(d,!0),value:d});return n},e.addIFrame=function(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0);var o=document.createElement("iframe"),a=document.querySelectorAll(".egret-player"),s=a[0];o.style.position="absolute",o.style.border="0",s.appendChild(o);var r=(egret.MainContext.instance.stage,document.body.clientHeight/egret.MainContext.instance.stage.stageHeight),h=document.body.clientWidth/egret.MainContext.instance.stage.stageWidth;return o.style.left=t*h+"px",o.style.top=e*r+"px",o.style.height=n*r+"px",o.style.width=i*h+"px",o},e.removeIFrame=function(t){t&&t.parentNode.removeChild(t)},Object.defineProperty(e,"agentUrl",{get:function(){if(""==this._agentUrl){var t=this.lobbyConfig;t&&t.hasOwnProperty("agentUrl")&&""!=t.agentUrl?this._agentUrl=t.agentUrl:this._agentUrl="http://custom.66yy99.cn/chessAgents/dalianledaMahjong/index.html"}return this._agentUrl},set:function(t){this._agentUrl=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"kefuUrl",{get:function(){if(""==this._kefuUrl){var t=this.lobbyConfig;t&&t.hasOwnProperty("kefuUrl")&&""!=t.kefuUrl&&(this._kefuUrl=t.kefuUrl)}return this._kefuUrl},set:function(t){this._kefuUrl=t},enumerable:!0,configurable:!0}),e}();e._noticeUrl="",e._wxShareUrl="",e._shopUrl=null,e.iosShareScale=.8,e._shareScale=1,e.codeVersion=13,e._agentUrl="",e._kefuUrl="",t.PublicMethed=e,__reflect(e.prototype,"MJLobby.PublicMethed")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function a(){var t=e.call(this)||this;return t.hasGold2MatchPoint=!1,t.isToday=!0,t.teahouseList=[],t.byCost=0,t.matchIdList=[],t.waitList=new Array,t.isAsce=!1,t.isAsce2=!1,t.codeVersion=13,t.skinName=new MatchManageSkin,t}return __extends(a,e),Object.defineProperty(a,"Instanc",{get:function(){return this.instance||(this.instance=new a),this.instance},enumerable:!0,configurable:!0}),a.clearInstance=function(){this.instance=null},a.timeToString=function(t){if(!t)return"00:00:00";var e=Math.floor(t/3600);t-=3600*e;var i=e.toString().length<2?"0"+e:e,n=Math.floor(t/60);t-=60*n;var o=n.toString().length<2?"0"+n:n,a=t,s=a.toString().length<2?"0"+a:a;return i+":"+o+":"+s},a.prototype.initUI=function(){this.addListener(),this.updataMatchList(),this.updataMessageList(),this.updataMemeberList(),this.uidEditableText.restrict="0-9",this.uidEditableText.inputType=egret.TextFieldInputType.TEL,this.whiteBtn.groupName=this.blackBtn.groupName="whiteAndBlack",this.whiteBtn.selected=!0,this.groupViewStack.selectedIndex=0,this.removeRedPoint(),1!=t.MJLobbyData.getInstance().fundType&&(this.tax.visible=this.donateHisButton.visible=this.withdrawalButton.visible=!1,this.gongxianIcon.visible=this.pointBtn.visible=!1),this.updateUI(),t.MJLobbyData.getInstance().isAgent||this.notAgent()},a.prototype.destory=function(){this.onRemove(),a.clearInstance()},a.prototype.addListener=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.matchList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onMatchListTap,this),this.matchTableList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onTableListTap,this),this.uidEditableText.addEventListener(eui.UIEvent.CHANGE,this.onSearch,this),this.uidEditableText.addEventListener(eui.UIEvent.FOCUS_OUT,this.onSearch,this),this.shareButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShare,this)},a.prototype.updateUI=function(){},a.prototype.onRemove=function(){this.memberCollection&&this.memberCollection.replaceAll(null),this.memberCollection=null,this.playerCollection&&this.playerCollection.replaceAll(null),this.playerCollection=null,this.tableCollect&&this.tableCollect.replaceAll(null),this.tableCollect=null,this.matchIdArrCollect&&this.matchIdArrCollect.replaceAll(null),this.matchIdArrCollect=null,this.removeListener()},a.prototype.removeListener=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.matchList.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onMatchListTap,this),this.matchTableList.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onTableListTap,this),this.uidEditableText.removeEventListener(eui.UIEvent.CHANGE,this.onSearch,this),this.uidEditableText.removeEventListener(eui.UIEvent.FOCUS_OUT,this.onSearch,this),this.shareButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShare,this),this.stopTimer(),this.removeRedPoint()},a.prototype.updataMatchList=function(){this.matchList.itemRenderer=i,this.matchIdArrCollect||(this.matchIdArrCollect=new eui.ArrayCollection),this.matchIdArrCollect.replaceAll(this.matchIdList),this.matchList.dataProvider=this.matchIdArrCollect},a.prototype.updataMessageList=function(){this.messageList.itemRenderer=o,this.messageList.dataProvider=new eui.ArrayCollection(this.joinMember)},a.prototype.updataFightingList=function(){this.historyCollect||(this.historyCollect=new eui.ArrayCollection,this.fightingList.itemRenderer=h,this.fightingList.dataProvider=this.historyCollect),this.historyCollect.source=this.roomList},a.prototype.updataMemeberList=function(t){if(this.memberCollection||(this.memberCollection=new eui.ArrayCollection,this.memeberList.itemRenderer=r,this.memeberList.dataProvider=this.memberCollection),t){var e=this.member.clone(),i=e.filter(function(e){return t.test(e.uid.toString())});return void(this.memberCollection.source=i)}this.member&&this.memberCollection.replaceAll(this.member)},a.prototype.updateMemberItemInfo=function(t){var e=t.member.uid>0?t.member.uid:0,i=t.member;if(e&&i){this.member&&this.member instanceof Array||(this.member=[]);var n=this.member.find(function(t){return t.uid==e});if(-1==n){if(0==i.type)return;this.member.push(i),this.memberCollection.addItem(i)}else{if(0==i.type)return this.member.removeAt(n),void this.memberCollection.removeItemAt(n);this.member[n]=i,this.memberCollection.replaceItemAt(i,n)}}},a.prototype.updataplayerList=function(){this.playerList.itemRenderer=s,this.playerList.dataProvider=new eui.ArrayCollection(this.member)},a.prototype.updateYelloList=function(){this.yelloList.itemRenderer=c,this.yelloList.dataProvider=new eui.ArrayCollection(this.yelloIndoList)},a.prototype.updataTableList=function(){this.tableCollect||(this.tableCollect=new eui.ArrayCollection,this.matchTableList.itemRenderer=n,this.matchTableList.dataProvider=this.tableCollect),this.tableCollect.replaceAll(this.roomList)},a.prototype.setMatchFightData=function(t){if(t.matchId==this.selectMatchId){var e=t.roomList instanceof Array?t.roomList:[];this.roomList=e,this.setHistorySearchData(),this.updataFightingList()}},a.prototype.resetSearch=function(){this.updataFightingList(),this.startTime&&this.endTime.data&&(this.startTime.index=0),this.endTime&&this.endTime.data&&(this.endTime.index=this.endTime.data.length-1)},a.prototype.searchHisByDate=function(){if(!this.roomList||this.roomList.length<=0)return void t.LobbyPopupManager.showMildSingleWarnShow("当前没有可查询战绩!");var e=this.endTime.seleceData,i=this.startTime.seleceData;if(e&&i){if(e.value-i.value<=0)return void t.LobbyPopupManager.showMildSingleWarnShow("截止时间必须大于起始时间!");var n=this.roomList.filter(function(t){return i.value<t.beginTime&&t.beginTime<e.value});0==n.length&&t.LobbyPopupManager.showMildSingleWarnShow("未查询到在此时间段内的战绩!"),this.historyCollect&&(this.historyCollect.source=n)}},a.prototype.setHistorySearchData=function(){if(this.startTime&&this.endTime&&(this.startTime.reset(),this.endTime.reset(),this.roomList&&this.roomList instanceof Array&&!(this.roomList.length<=0))){var e=[],i=1e3*this.roomList[0].beginTime,n=1e3*this.roomList[this.roomList.length-1].beginTime;e=t.PublicMethed.getDateRang(n,i),e.length>1&&(this.startTime.data=e.slice(0,e.length-1),this.endTime.data=e.slice(1,e.length),this.endTime.index=this.endTime.data.length-1)}},a.prototype.onSearch=function(t){if(1==this.groupViewStack.selectedIndex){var e;null!=this.uidEditableText.text&&""!=this.uidEditableText.text&&(e=new RegExp(this.uidEditableText.text)),this.updataMemeberList(e)}},a.prototype.addRedPoint=function(){var t=this.messageButton.skin.redPoint;t.visible=!0,egret.Tween.get(t,{loop:!0}).to({alpha:1},500).to({alpha:0},500)},a.prototype.removeRedPoint=function(){var t=this.messageButton.skin.redPoint;t.visible=!1,egret.Tween.removeTweens(t)},a.prototype.updataDetails=function(t){if(t){var e=t&&1==t.state?1:0;this.terminationButton.currentState=1==e?"down":"up",this.ownerLabel.text=""+(t?t.ownername:""),this.gameMemberLabel.text="游戏人数:"+(t?t.gameingUserNum:""),this.matchIdLabel.text=""+(t?t.matchId:""),t.matchName?(this.matchName.visible=!0,this.matchName.text="包厢名:"+t.matchName,this.matchNameStr=t.matchName):this.matchName.visible=!1,this.waitMemberLabel.text="等待人数:"+(t?t.waitUserNum:""),this.stepLabel.text=t&&t.step?"第"+t.step+"轮":"",this.time=t?Math.floor(t.lifeTimeSec):0,this.delTimeLabel.text="包厢号剩余时间:"+a.timeToString(this.time),t&&t.lifeTimeSec<0&&(this.delTimeLabel.text="包厢号已过期"),t&&0==t.lifeTimeSec&&(this.delTimeLabel.text="不限时"),this.curTax=t.curTax?t.curTax:0,this.allTax=t.allTax?t.allTax:0,this.tax.visible=!1,this.roomList=t&&t.roomList instanceof Array?t.roomList:[],this.maxNbr=t&&t.userNbr?t.userNbr:0,this.hasGold2MatchPoint=t.gold2MatchPoint?!0:!1,this.updataTableList(),this.updataFightingList(),this.stopTimer(),0==e&&(this.timer=egret.setInterval(this.updataTimer,this,1e3));var i=t?t.matchId:null;if(i!=a.Instanc.selectMatchId)for(var n=function(t){if(o.matchIdList[t]==i){if(o.matchList.selectedIndex=t,egret.Tween.removeTweens(o.matchList),t>3){o.matchList.touchEnabled=!1;var e=o,n=100*(t-2);t>o.matchIdList.length-3&&(n=100*(o.matchIdList.length-5)),egret.Tween.get(o.matchList).wait(100).to({scrollV:n},100).call(function(){e.matchList.touchEnabled=!0})}return"break"}},o=this,s=0;s<this.matchIdList.length;s++){var r=n(s);if("break"===r)break}this.shareInfo=t?t.shareInfo:null;var h=t.shareInfo.content.lastIndexOf(",");this.playTypeInfo.text=this.shareInfo.title.substring(this.shareInfo.title.indexOf("<")+1,this.shareInfo.title.indexOf(">"))+","+t.shareInfo.content.slice(0,h)}},a.prototype.updataTimer=function(){return null==this.time||this.time<1?void this.stopTimer():(this.time--,void(this.delTimeLabel.text="包厢号剩余时间:"+a.timeToString(this.time)))},a.prototype.stopTimer=function(){egret.clearInterval(this.timer)},a.prototype.isTeahouseID=function(e){if(t.MJLobbyData.getInstance().isTeahouseModle){var i=this.teahouseList.indexOf(e);return i>-1?!0:!1}return!1},a.prototype.initReturnMatchGroup=function(e){if(!e.curMath)return void this.initUI();var i=e&&e.matchIdList&&e.matchIdList instanceof Array?e.matchIdList:[];if(this.teahouseList=e&&e.clubType3List&&e.clubType3List instanceof Array?e.clubType3List:[],i&&i instanceof Array&&i.length>0&&null==e.curMath){var n=new Cmd.RequestMatchGroupCmd_C;return n.matchId=i[0],void t.NetMgr.tcpSend(n)}this.matchIdList=i.distinct(),this.waitList=null!=e&&null!=e.curMath&&null!=e.curMath.waitUserList&&e.curMath.waitUserList instanceof Array&&e.curMath.waitUserList.length>0?e.curMath.waitUserList:[],this.updataMatchList(),this.updataDetails(e?e.curMath:null);var o=e.diamondM?e.diamondM:0,a=e.diamondMNeed?e.diamondMNeed:0,s="; 本月消耗:"+o,r="";if(a>0&&(r=";(超过"+a+"钻,免费开房)"),a&&o>a){s="";var h=this.getCost(e.curMath.gameId,e.curMath.userNbr,e.curMath.gameNbr),c=o-(h-a%h)-a;r="; 包月中,免费开房,已累计优惠"+c+"钻"}if(this.diamondLabel.text="钻石数量:"+(null==e.diamond?0:e.diamond)+"; 昨日消耗:"+(e.diamondY?e.diamondY:0)+"; 今日消耗:"+(e.diamondT?e.diamondT:0)+s+r,e&&e.matchIdList&&e.matchIdList.length>0&&(this.detailsButton.selected=!0,this.switchWindow()),e.leftMin>0){this.lastMin.visible=!0,this.renewBtn.visible=!0;var l=Math.floor(e.leftMin/60/24),d=Math.floor((e.leftMin-60*l*24)/60),u=e.leftMin-60*l*24-60*d;this.lastMin.text="包月剩余:"+l+"天"+d+"小时"+u+"分钟"}else this.lastMin.visible=!1,this.renewBtn.visible=!1;this.updataButtonEnabled(),e.curMath.userNbr&&e.curMath.gameNbr&&(this.byCost=t.CreateGamePanel.instance.getByCost(e.curMath.userNbr,e.curMath.gameNbr))},a.prototype.notAgent=function(){this.renewBtn.visible=!1,this.lastMin.visible=!1},a.prototype.getCost=function(e,i,n){for(var o=t.CreateGamePanel.instance.costObj,a=0;a<o.length;a++)if(o[a].usernbr==i&&o[a].gamenbr==n)return 5200==e?o[a].diamondcost/2:o[a].diamondcost;return 0},a.prototype.updataButtonEnabled=function(){var t=this.matchIdList&&this.matchIdList.length>0?!0:!1;this.detailsButton.enabled=t,this.memberButton.enabled=t,this.messageButton.enabled=t,this.fightingButton.enabled=t,this.joinMatchButton.enabled=t,this.yelloListButton.enabled=t,this.playerListButton.enabled=t,this.setting.enabled=this.recomendButton.touchEnabled=t,this.donateHisButton.touchEnabled=this.addWhiteButton.touchEnabled=this.uidEditableText.touchEnabled=t,0==t&&(this.detailsGroup.visible=t,this.messageGroup.visible=t,this.memberGroup.visible=t,this.fightingGroup.visible=t,this.playerListButton.enabled=t,this.yelloListGroup.visible=t,this.playerListGroup.visible=t)},a.prototype.initMemberList=function(t){t.whitelist=t.whitelist&&t.whitelist instanceof Array?t.whitelist:[];var e=t.whitelist.filter(function(t){return 4==t.type});e=null!=e&&e instanceof Array?e:[],t.whitelist=t.whitelist.filter(function(t){return 4!=t.type}),t.blacklist=t.blacklist&&t.blacklist instanceof Array?t.blacklist:[];for(var i=0,n=t.whitelist;i<n.length;i++){var o=n[i];o.type||(o.type=1)}for(var a=0,s=t.blacklist;a<s.length;a++){var o=s[a];o.type||(o.type=2)}this.member=t.whitelist.concat(t.blacklist),e&&e instanceof Array&&(this.member=e.concat(this.member)),this.member.sort(function(t,e){return t.uid-e.uid>=0?1:t.uid-e.uid<0?-1:void 0}),this.updataMemeberList(),this.tax.text="成员总数:"+this.member.length,this.tax.visible=!0},a.prototype.initPlayerList=function(t){this.yestedayButton.selected=!1,this.simpleTitle.visible=!0,this.isToday=!0;for(var e=0,i=t.list;e<i.length;e++){var n=i[e];n.type=0}this.member=t.list,this.updataplayerList()},a.prototype.initYelloList=function(t){t.list=t.list&&t.list instanceof Array?t.list:[],this.yelloIndoList=t.list,this.updateYelloList()},a.prototype.initHistory=function(t){!t||t.matchId!=this.selectMatchId},a.prototype.JoinMemberListMatch=function(t){this.joinMember=[],t&&t.list&&t.list instanceof Array&&(this.joinMember=t.list),this.updataMessageList(),this.joinMember&&this.joinMember.length>0?this.addRedPoint():this.removeRedPoint()},a.prototype.switchWindow=function(){this.resetPlayerList.visible=!1,this.setting.visible=!0,this.detailsButton.selected?this.groupViewStack.selectedIndex=0:this.memberButton.selected?this.groupViewStack.selectedIndex=1:this.messageButton.selected?this.groupViewStack.selectedIndex=2:this.fightingButton.selected?this.groupViewStack.selectedIndex=3:this.playerListButton.selected?(this.resetPlayerList.visible=!0,this.groupViewStack.selectedIndex=4,this.setting.visible=!1):this.yelloListButton.selected&&(this.groupViewStack.selectedIndex=5),this.yestedayButton.visible=this.resetPlayerList.visible},a.prototype.onClickTap=function(e){if(e.target instanceof eui.Button&&uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),e.target==this.detailsButton||e.target==this.memberButton||e.target==this.messageButton||e.target==this.fightingButton||e.target==this.playerListButton||e.target==this.yelloListButton){if(!this.matchIdList||this.matchIdList.length<=0)return;if(e.target.selected=!0,e.target==this.memberButton){if(1!=this.groupViewStack.selectedIndex){var i=new Cmd.RequestMemberInfoMatchGroupCmd_C;i.matchId=this.selectMatchId,t.LobbyServerMJProxy.getInstance().sendData(i)}}else if(e.target==this.fightingButton){if(4!=this.groupViewStack.selectedIndex){var i=new Cmd.HistoryMatchGroupCmd_C;i.matchId=this.selectMatchId,t.LobbyServerMJProxy.getInstance().sendData(i)}}else if(e.target==this.playerListButton){var n=new Cmd.PlayedListMatchGroupCmd_C;n.matchId=this.selectMatchId,t.LobbyServerMJProxy.getInstance().sendData(n)}else if(e.target==this.yelloListButton){var o=new Cmd.RequestYellowMemberInfoMatchGroupCmd_C;o.matchId=this.selectMatchId,t.LobbyServerMJProxy.getInstance().sendData(o)}this.switchWindow()}else if(e.target==this.descBtn){var s=this.member.filter(function(t){return!t.desc}),r=this.member.filter(function(t){return t.desc});r.sort(function(t,e){var i=t.desc.length,n=e.desc.length;return i-n>0?1:i-n==0?0:-1}),this.member=r.concat(s),this.updataMemeberList()}else if(e.target==this.playerId)this.member.sort(function(t,e){return t.uid-e.uid>0?1:t.uid-e.uid==0?0:-1}),this.updataMemeberList();else if(e.target==this.lastTimeBtn){var h=this.member.filter(function(t){return!t.lastMin&&0!=t.lastMin}),c=this.member.filter(function(t){return t.lastMin>=0});c.sort(function(t,e){var i=t.lastMin-e.lastMin;return i>0?1:0==i?0:-1}),this.member=c.concat(h),this.updataMemeberList()}else if(e.target==this.pointBtn)this.member.sort(function(t,e){return t.matchPoint-e.matchPoint>0?-1:t.matchPoint-e.matchPoint==0?0:1}),this.updataMemeberList();else if(e.target==this.closeButton)this.dispatchEventWith(t.LobbyUIEventConsts.CLOSE);else{if(e.target==this.terminationButton){var l,d=this,u=function(e){var i=new Cmd.OperateMatchGroupCmd_C;"up"==d.terminationButton.currentState?i.state=1:i.state=0,i.matchId=d.selectMatchId,(1==e||2==e)&&(i.clearType=e),t.LobbyServerMJProxy.getInstance().sendData(i)},b=function(t){d.showExportMatchPanel(t)};return"up"==this.terminationButton.currentState?(l=new t.MatchMsgExport,l.setData([u,b])):(l=new t.MatchMsgBox,l.setData("温馨提示","恢复匹配会清除之前战绩,重新开始匹配统计,继续吗？",["确定","取消"],[u])),void t.LobbyPopupManager.addPopUp(l,!0,!0)}if(e.target==this.continueCreateButton)t.MJLobbyVc.m_instance.dispatchEventWith(t.LobbyUIEventConsts.SHOW_CREATE_PANEL);else if(e.target==this.dissolutionButton){var p=new t.MatchMsgBox,m=this,u=function(){var e=new Cmd.RequestDeleteMatchGroupCmd_C;e.matchId=m.selectMatchId,t.LobbyServerMJProxy.getInstance().sendData(e)};p.setData("温馨提示","您确定要解散该包厢吗？",["确定","取消"],[u]),t.LobbyPopupManager.addPopUp(p,!0,!0)}else if(e.target==this.renewBtn){var y=new t.MatchMsgBox,g=this,v=function(){var e=new Cmd.RenewPayTimeMatchGroupCmd_C;e.matchId=g.selectMatchId,t.LobbyServerMJProxy.getInstance().sendData(e)},L="您确定消耗"+this.byCost+"钻";y.setData("包月续费",L+"用于"+this.matchIdLabel.text+"包厢增加30天剩余包月时长？",["确定","取消"],[v]),t.LobbyPopupManager.addPopUp(y,!0,!0)}else if(e.target==this.waitListBtn)this.showWaitPlayerList();else if(e.target==this.prizeMatchButton)this.showPrizeMatchPanel();else if(e.target==this.addWhiteButton||e.target==this.addBlackButton){var _=this.uidEditableText.text,f=Number(_);if(0/0==f||!f)return void t.LobbyPopupManager.showMildWarnShow("请输入正确的玩家ID");var i=new Cmd.OperateMemberListMatchGroupCmd_C;Number(e.target.name);i.reply=e.target==this.addWhiteButton?2:3,i.uid=f,i.matchId=a.Instanc.selectMatchId,t.LobbyServerMJProxy.getInstance().sendData(i)}else if(e.target==this.joinMatchButton){this.dispatchEventWith(t.LobbyUIEventConsts.JOIN_ROOM,!1,this.matchIdList[this.matchList.selectedIndex]);var C=new Cmd.EnterRoomCmd_C;C.roomId=this.matchIdList[this.matchList.selectedIndex],t.LobbyServerMJProxy.getInstance().sendData(C),t.NetMgr.setMsgTimeout(5,"EnterRoomCmd_C")}else if(e.target==this.resetPlayerList){var T=this,u=function(){var e=new Cmd.ClearPlayedListMatchGroupCmd_C;e.matchId=T.selectMatchId,t.LobbyServerMJProxy.getInstance().sendData(e)},M=function(){t.LobbyPopupManager.removePopUp(E,!0,!0),E.destory(),E=null},E=new t.MatchMsgBox;E.setData("温馨提示","您确定要清空个人排行？",["确定","取消"],[u,M]),t.LobbyPopupManager.addPopUp(E,!0,!0)}else if(e.target==this.setting){var i=new Cmd.RequestMatchConfigMatchGroupCmd_C;i.matchId=this.selectMatchId,t.LobbyServerMJProxy.getInstance().sendData(i)}else if(e.target==this.yestedayButton)this.showPlayerListInfo(this.yestedayButton.selected);else if(e.target==this.nameText1)this.isToday?this.sortListByScore():this.sortListByLastScore();else if(e.target==this.withdrawalButton){if(!this.curTax)return void t.LobbyPopupManager.showMildWarnShow("当前无可提现金额!");var I=function(){var e=new Cmd.GetTaxMatchGroupCmd_C;e.matchId=a.Instanc.selectMatchId,t.LobbyServerMJProxy.getInstance().sendData(e)},P=new t.MatchMsgBox;P.setData("温馨提示","是否提现所有贡献？",["确定","取消"],[I]),t.LobbyPopupManager.addPopUp(P,!0,!0)}else if(e.target==this.donateHisButton){if(!a.Instanc.selectMatchId)return void t.LobbyPopupManager.showMildWarnShow("当前无包厢可以查询!");var x=new Cmd.DonateHistoryMatchRoomCmd_C;x.matchId=a.Instanc.selectMatchId,t.LobbyServerMJProxy.getInstance().sendData(x)}else if(e.target==this.whiteBtn||e.target==this.blackBtn)this.updataMemeberList();else if(e.target==this.recomendButton){var S=function(){var e=new Cmd.RequestAddPublicMatchIdMatchGroupCmd_C;e.matchId=a.Instanc.selectMatchId,e.typ=2,e.wechat="huanglaoshi",t.LobbyServerMJProxy.getInstance().sendData(e)};t.LobbyPopupManager.showConfirmPanel("是否推荐ID为:"+a.Instanc.selectMatchId+"的包厢号？",["确定","取消"],[S],"温馨提示",this)}else if(e.target==this.importMatchButton)this.showImportMatchPanel();else if(e.target==this.searchHisBtn)this.searchHisByDate();else if(e.target==this.resetSearchBtn)this.resetSearch();else if(e.target==this.cloundBtn){var k=new Cmd.RequestBookingUrlMatchGroupCmd_CS;k.lobbyId=t.MJLobbyData.getInstance().lobbyId,k.matchId=this.selectMatchId,t.LobbyServerMJProxy.getInstance().sendData(k)}}},a.prototype.onShare=function(t){t.target==this.shareButton&&this.onShareTap()},a.prototype.showRoomPlayerList=function(e){if(e){var i=new t.MatchPlayerListPanel;t.LobbyPopupManager.addPopUp(i,!0,!0,!0),i.addEventListener(t.LobbyUIEventConsts.CLOSE,this.closeRoomPlayerList,this),i.initPlayerList(e)}},a.prototype.closeRoomPlayerList=function(e){var i=e.target;i.removeEventListener(t.LobbyUIEventConsts.CLOSE,this.closeRoomPlayerList,this),t.LobbyPopupManager.removePopUp(i),i.destory()},a.prototype.showWaitPlayerList=function(){var e=new Cmd.WaitUserListMatchGroupCmd_C;e.matchId=this.selectMatchId,t.LobbyServerMJProxy.getInstance().sendData(e)},a.prototype.showPrizeMatchPanel=function(){var e=this,i=new t.MatchPrizePanel(function(i){var n=new Cmd.ChangeOwnerMatchGroupCmd_C;n.uid=i,n.matchId=e.selectMatchId,t.LobbyServerMJProxy.getInstance().sendData(n)});t.LobbyPopupManager.addPopUp(i,!0,!0)},a.prototype.showImportMatchPanel=function(){var e=this,i=new t.MatchPrizePanel(function(i){var n=new Cmd.ImportWhiteListMatchGroupCmd_C;n.fromMatchId=i,n.toMatchId=e.selectMatchId,t.LobbyServerMJProxy.getInstance().sendData(n)},"导入","请输入需要导入的包厢ID","请输入正确的包厢ID");t.LobbyPopupManager.addPopUp(i,!0,!0)},a.prototype.showExportMatchPanel=function(e){var i=this,n=new t.MatchPrizePanel(function(n){var o=new Cmd.ExportHistoryMatchGroupCmd_C;o.fromMatchId=i.selectMatchId,o.toMatchId=n,(1==e||2==e)&&(o.clearType=e),t.LobbyServerMJProxy.getInstance().sendData(o)},"导出","请输入需要导出的包厢ID","请输入正确的包厢ID",!0);t.LobbyPopupManager.addPopUp(n,!0,!0)},a.prototype.setWaitList=function(e){e&&e.matchId==this.selectMatchId&&(this.waitList=e.waitUserList),this.listPanel||(this.listPanel=new t.ActiveRoomInformationPanel,t.LobbyPopupManager.addPopUp(this.listPanel,!0,!0,!0),this.listPanel.addEventListener(t.LobbyUIEventConsts.CLOSE,this.closelistPanel,this),this.listPanel.initUI()),this.listPanel.showWaitList(this.waitList)},a.prototype.closelistPanel=function(e){this.listPanel&&(this.listPanel.removeEventListener(t.LobbyUIEventConsts.CLOSE,this.closelistPanel,this),t.LobbyPopupManager.removePopUp(this.listPanel),this.listPanel.destory(),this.listPanel=null)},a.prototype.showPlayerListInfo=function(t){this.playerCollection||(this.playerCollection=new eui.ArrayCollection,this.playerList.dataProvider=this.playerCollection),this.isToday=!t,this.updataplayerList()},a.prototype.sortListByScore=function(){this.isAsce=!this.isAsce;var t=this.member.deepcopy();t=this.isAsce?t.sort(function(t,e){return t.score-e.score}):t.sort(function(t,e){return e.score-t.score
}),this.playerList.dataProvider=new eui.ArrayCollection(t)},a.prototype.sortListByLastScore=function(){this.isAsce2=!this.isAsce2;var t=this.member.deepcopy();t=this.isAsce2?t.sort(function(t,e){return t.lastScore-e.lastScore}):t.sort(function(t,e){return e.lastScore-t.lastScore}),this.playerList.dataProvider=new eui.ArrayCollection(t)},a.prototype.showMatchSetPanel=function(e){this.matchSetPanel||(this.matchSetPanel=new t.MatchSetPanel,this.matchSetPanel.addEventListener(t.LobbyUIEventConsts.CLOSE,this.removeMatchSetPanel,this),t.LobbyPopupManager.addPopUp(this.matchSetPanel,!0,!0)),this.matchSetPanel.setData(e)},a.prototype.removeMatchSetPanel=function(){this.matchSetPanel.removeEventListener(t.LobbyUIEventConsts.CLOSE,this.removeMatchSetPanel,this),this.matchSetPanel=null},a.prototype.showMatchSettingPanel=function(){function e(){i&&(i.removeEventListener(t.LobbyUIEventConsts.CLOSE,e,this),t.LobbyPopupManager.removePopUp(i,!1),i.destory(),i=null)}var i=new t.CreatMatchSetPanel;i.showSettIngBtn(this.matchIdList[this.matchList.selectedIndex]),t.LobbyPopupManager.addPopUp(i,!0,!0,!1),i.y-=30,i.addEventListener(t.LobbyUIEventConsts.CLOSE,e,this),i.initData()},Object.defineProperty(a.prototype,"_shareInfo",{get:function(){return this.shareInfo},enumerable:!0,configurable:!0}),a.prototype.onShareTap=function(){uniLib.ZQGameSdk.openApp("com.tencent.mm","com.tencent.mm.ui.LauncherUI","weixin://")},a.prototype.shareCode=function(){var e=this,i=new egret.Bitmap,n="http://h5.publish.66yy99.cn/Mahjong.jx/shareimg/club_share_"+t.MJLobbyData.getInstance().lobbyId+".jpg";RES.getResByUrl(n,function(n){if(n){var o=new egret.DisplayObjectContainer;uniLib.Global.isH5&&t.LobbyPopupManager.addPopUp(o),i.texture=n,o.addChild(i);var a=new eui.Label;a.text=e.ownerLabel.text,o.addChild(a),a.x=270,a.y=310,a.scaleX=1.5,a.scaleY=1.5,a.textColor=3184046;var s=new eui.Label;s.text=e.matchIdLabel.text,o.addChild(s),s.x=350,s.y=610,s.scaleX=1.3,s.scaleY=1.3,s.textColor=3184046;var r=new eui.Label;if(r.text=e.playTypeInfo.text,o.addChild(r),r.width=400,r.x=(i.width-r.width)/2-50,r.y=1100,r.scaleX=1.5,r.scaleY=1.5,r.textColor=16777215,r.fontFamily="Microsoft YaHei",""==uniLib.ZQGameSdk.defaultWXShareVo.webpageUrl&&t.LobbyDataCache.bundleInfo&&t.LobbyDataCache.bundleInfo.weixin.wbappid){var h=t.TableHouseListPanel.Instanc.selectMatchId,c=t.MJLobbyData.getInstance().myBaseInfo.nickName;c.length>8&&(c=c.slice(0,8));var l="https://open.weixin.qq.com/connect/oauth2/authorize?appid="+t.LobbyDataCache.bundleInfo.weixin.wbappid+"&redirect_uri=http://"+t.PublicMethed.wxShareUrl+"/addons/zqgame/gameshare.php?appid="+t.LobbyDataCache.bundleInfo.weixin.wbappid+"&response_type=code&scope=snsapi_base&state="+uniLib.CompressUtil.base64encode(t.MJLobbyData.getInstance().myBaseInfo.uid+"|"+h+"|"+c)+"&connect_redirect=1#wechat_redirect";if(l){var d=qr.QRCode.create(l,280,280,qr.QRErrorCorrectLevel.M,e.codeVersion);o.addChild(d),d.x=222,d.y=698;var u=new uniLib.WXShareVo,b=new egret.Bitmap(uniLib.DisplayUtils.catchScreenToTex(o,new egret.Rectangle(0,0,720,1280),.75));u.shareImageData=uniLib.DisplayUtils.catchScreen(b,new egret.Rectangle(0,0,b.width,b.height)),uniLib.Global.dispatchEvent(uniLib.ZqEvent.SHARE,u,!1)}}}else t.LobbyPopupManager.showMildWarnShow("分享图片资源获取失败,请稍后重试!")},this,RES.ResourceItem.TYPE_IMAGE)},Object.defineProperty(a.prototype,"selectMatchId",{get:function(){return this.matchIdList[this.matchList.selectedIndex]},enumerable:!0,configurable:!0}),a.prototype.onMatchListTap=function(e){var i=new Cmd.RequestMatchGroupCmd_C;i.matchId=this.selectMatchId,t.LobbyServerMJProxy.getInstance().sendData(i)},a.prototype.onTableListTap=function(t){},a.prototype.onRecordListTap=function(e){var i=e.item;i&&i.roomId&&(t.MJLobbyData.getInstance().globalRoomId=i.roomId,this.dispatchEventWith(t.LobbyUIEventConsts.GET_HISTORY_DETAIL_DATA,!1,i.roomId))},a}(eui.Component);t.MatchManagePanel=e,__reflect(e.prototype,"MJLobby.MatchManagePanel");var i=function(t){function i(){var e=t.call(this)||this;return e.skinName=new MatchRadioButtonSkin,e.identifierIcon.visible=!1,e}return __extends(i,t),i.prototype.dataChanged=function(){var t=this.data;this.labelDisplay.text=t+"";var i=e.Instanc.isTeahouseID(t);this.isTeahouse=i},Object.defineProperty(i.prototype,"isTeahouse",{set:function(t){this.identifierIcon.visible=t},enumerable:!0,configurable:!0}),i}(eui.ItemRenderer);t.MatchRadioButton=i,__reflect(i.prototype,"MJLobby.MatchRadioButton");var n=function(i){function n(){var t=i.call(this)||this;return t.skinName=new MatchTableItemSkin,t.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onHandle,t),t}return __extends(n,i),n.prototype.dataChanged=function(){var t=this.data;this.roomId=t.roomId;var i=t.list&&t.list instanceof Array?t.list.length:0,n="桌"+t.roomId+"\n"+(null==t.endTime?t.curGameNbr>0?"（第"+t.curGameNbr+"局）\n":"（未开局）\n":"(牌局结束)\n")+"人数:"+i+"/"+e.Instanc.maxNbr;this.contentLabel.text=n},n.prototype.onHandle=function(){if(2==this.data.state||this.data.endTime)t.LobbyPopupManager.showMildWarnShow("房间已结束");else if(this.roomId){var e=new Cmd.GetMatchGroupRoomInfoCmd_C;e.roomId=this.roomId,t.LobbyServerMJProxy.getInstance().sendData(e)}},n}(eui.ItemRenderer);t.MatchTableItem=n,__reflect(n.prototype,"MJLobby.MatchTableItem");var o=function(i){function n(){var t=i.call(this)||this;return t.skinName=new MatchMessageItemSkin,t.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onClickTap,t),t}return __extends(n,i),n.prototype.dataChanged=function(){var t=this.data;t.nickname?t.nickname.slice(0,4):"";this.contenLabel.text="玩家"+t.nickname+"(ID:"+t.uid+")请求加入匹配场？"},n.prototype.onClickTap=function(i){var n=this.data;if(i.target==this.disAgreeButton){var o=new Cmd.ReplyJoinMemberListMatchGroupCmd_C;o.matchId=e.Instanc.selectMatchId,o.reply=0,o.uid=n.uid,t.LobbyServerMJProxy.getInstance().sendData(o)}else if(i.target==this.agreeButton){var o=new Cmd.ReplyJoinMemberListMatchGroupCmd_C;o.matchId=e.Instanc.selectMatchId,o.reply=1,o.uid=n.uid,t.LobbyServerMJProxy.getInstance().sendData(o)}else if(i.target==this.blackButton){var o=new Cmd.ReplyJoinMemberListMatchGroupCmd_C;o.matchId=e.Instanc.selectMatchId,o.reply=3,o.uid=n.uid,t.LobbyServerMJProxy.getInstance().sendData(o)}else if(i.target==this.whiteButton){var o=new Cmd.ReplyJoinMemberListMatchGroupCmd_C;o.matchId=e.Instanc.selectMatchId,o.reply=2,o.uid=n.uid,t.LobbyServerMJProxy.getInstance().sendData(o)}},n}(eui.ItemRenderer);t.MatchMessageItem=o,__reflect(o.prototype,"MJLobby.MatchMessageItem");var a=function(i){function n(){var t=i.call(this)||this;return t.skinName=new MatchPlayerListSkin,t}return __extends(n,i),n.prototype.dataChanged=function(){var t=this.data;this.rankingLabel.text=this.itemIndex+1+"",this.nameLabel=t.nickname?t.nickname.slice(0,5):"",this.nameLabelText.TextImageData=Emoji.toCodePoint(this.nameLabel),this.nameLabelText.textColor=5489379,this.nameLabelText.size=30,this.nameLabelText.width=150,this.nameLabelText.height=30,this.integralLabel.text=(null==t.score?0:t.score)+"",this._bigWinnerNum.text=null!=t.bigWinNum?t.bigWinNum+"":"0",this._playNum.text=null!=t.playNum?t.playNum+"":"0",this.stateLabel.text=null!=t.lastScore?t.lastScore+"":"0"},n.prototype.onLabelTap=function(i){var n=this.data,o=new Cmd.OperateMemberListMatchGroupCmd_C,a=Number(i.target.name);o.reply=1==a||2==a?1:0,o.uid=n.uid,o.matchId=e.Instanc.selectMatchId,t.LobbyServerMJProxy.getInstance().sendData(o)},n}(eui.ItemRenderer);t.MatchPLayerList=a,__reflect(a.prototype,"MJLobby.MatchPLayerList");var s=function(i){function n(){var t=i.call(this)||this;return t.skinName=new MatchPlayerSimpleSkin,t}return __extends(n,i),n.prototype.dataChanged=function(){var t=this.data;this.rankingLabel.text=this.itemIndex+1+"",this.nameLabel=t&&t.nickname?t.nickname.slice(0,5):"",this.nameLabelText.TextImageData=Emoji.toCodePoint(this.nameLabel),this.nameLabelText.textColor=5489379,this.nameLabelText.size=30,this.nameLabelText.width=150,this.nameLabelText.height=30,this.uidLabel.text=null!=t.uid?t.uid+"":"",this.desc=t.desc?t.desc:"",this.descText.name=this.itemIndex+"",this.descText.TextImageData=Emoji.toCodePoint(this.desc),this.descText.textColor=5489379,this.descText.size=30;var i="0",n="0",o="0";e.Instanc.isToday?(i=(t.score?t.score:0)+"",n=(t.playNum?t.playNum:0)+"",o=(t.bigWinNum?t.bigWinNum:0)+""):(i=(t.lastScore?t.lastScore:0)+"",n=(t.playNumY?t.playNumY:0)+"",o=(t.bigWinNumY?t.bigWinNumY:0)+""),this.integralLabel.text=i,this.winLabel.text=o,this._playNum.text=n},n.prototype.onLabelTap=function(i){var n=this.data,o=new Cmd.OperateMemberListMatchGroupCmd_C,a=Number(i.target.name);o.reply=1==a||2==a?1:0,o.uid=n.uid,o.matchId=e.Instanc.selectMatchId,t.LobbyServerMJProxy.getInstance().sendData(o)},n}(eui.ItemRenderer);t.MatchPLayerListSimple=s,__reflect(s.prototype,"MJLobby.MatchPLayerListSimple");var r=function(i){function n(){var e=i.call(this)||this;return e.skinName=new MatchMemberItemSkin,e.operateBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onOperate,e),e.addEventListener(egret.Event.REMOVED_FROM_STAGE,e.onRemove,e),e.playerID.addEventListener(egret.TouchEvent.TOUCH_TAP,e.reqUserRecord,e),1!=t.MJLobbyData.getInstance().fundType&&(e.tax.visible=e.matchPoint.visible=!1),e}return __extends(n,i),n.prototype.onRemove=function(){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemove,this),this.playerID.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.reqUserRecord,this),this.operateBtn&&this.operateBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onOperate,this),this.matchPoint&&this.matchPoint.hasEventListener(egret.TouchEvent.TOUCH_TAP)&&this.matchPoint.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.reqDonateHis,this),this.desc&&this.desc.hasEventListener(egret.TouchEvent.TOUCH_TAP)&&this.desc.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.reqTaxReward,this)},n.prototype.onOperate=function(){this.operatePanel||(this.operatePanel=new t.MatchUserOpratePanel(e.Instanc.selectMatchId,this.playerUid,this.nickName,this.curInteger,this.curState,this.descStr,e.Instanc.hasGold2MatchPoint)),this.operatePanel.init(),this.operatePanel.addEventListener(t.LobbyUIEventConsts.CLOSE,this.closeOperate,this),t.LobbyPopupManager.addPopUp(this.operatePanel,!0,!0)},n.prototype.closeOperate=function(){this.operatePanel&&(t.LobbyPopupManager.removePopUp(this.operatePanel,!0,!0),this.operatePanel.removeEventListener(t.LobbyUIEventConsts.CLOSE,this.closeOperate,this),this.operatePanel=null)},n.prototype.dataChanged=function(){var e=this.data;this.nickName=e.nickname?e.nickname.slice(0,5):"",this.nameLabelText.TextImageData=Emoji.toCodePoint(this.nickName),this.nameLabelText.textColor=5489379,this.nameLabelText.size=30,this.curInteger=e.matchPoint?e.matchPoint:0,this.curInteger?(this.matchPoint.textFlow=[{text:this.curInteger+"",style:{underline:!0}}],this.matchPoint.addEventListener(egret.TouchEvent.TOUCH_TAP,this.reqDonateHis,this),this.matchPoint.touchEnabled=!0):this.matchPoint.text="",this.playerUid=e.uid,this.descStr=e.desc?e.desc.slice(0,3):"",this.descText.TextImageData=Emoji.toCodePoint(this.descStr),this.descText.textColor=5489379,this.descText.size=30,e.desc?(this.descText.addEventListener(egret.TouchEvent.TOUCH_TAP,this.reqTaxReward,this),this.descText.touchEnabled=!0):this.descStr="",this.curState=e.type,this.typeLabel.text=t.DataManage.MatchMemberTypeToString(e.type),this.playerID.text=this.playerUid.toString(),1==e.state?this.lastTime.text="在线":e.lastMin?e.lastMin<60?this.lastTime.text=e.lastMin+"分钟":e.lastMin/60<24?this.lastTime.text=Math.floor(e.lastMin/24)+"小时":e.lastMin/1440<30?this.lastTime.text=Math.floor(e.lastMin/1440)+"天":this.lastTime.text=Math.floor(e.lastMin/1440/30)+"月":this.lastTime.text="离线"},n.prototype.reqTaxReward=function(){e.Instanc.dispatchEventWith("show_promote",!1,{matchId:e.Instanc.selectMatchId,matchName:e.Instanc.matchNameStr,wechat:null});var i=new Cmd.TaxRewardMatchRoomCmd_C;i.matchId=e.Instanc.selectMatchId,i.uid=this.playerUid,t.LobbyServerMJProxy.getInstance().sendData(i),t.NetMgr.setMsgTimeout(5,"TaxRewardMatchRoomCmd_C")},n.prototype.reqDonateHis=function(){var i=new Cmd.DonateHistoryMatchRoomCmd_C;i.matchId=e.Instanc.selectMatchId,i.uid=this.playerUid,t.LobbyServerMJProxy.getInstance().sendData(i)},n.prototype.reqUserRecord=function(){t.MatchUserRecordPanel.instace.setUserData(this.playerUid,this.nickName),t.LobbyPopupManager.addPopUp(t.MatchUserRecordPanel.instace,!0,!0);var i=new Cmd.HistoryMatchGroupCmd_C;i.matchId=e.Instanc.selectMatchId,t.LobbyServerMJProxy.getInstance().sendData(i)},n}(eui.ItemRenderer);t.MatchMemberItem=r,__reflect(r.prototype,"MJLobby.MatchMemberItem");var h=function(i){function n(){var t=i.call(this)||this;return t.defaultColor=0,t.skinName=new MatchFightingItemSkin,t.addEventListener(egret.TouchEvent.TOUCH_TAP,t.reqRecordData,t),t}return __extends(n,i),n.prototype.reqRecordData=function(i){if(i.target==this.recordDeleteButton){var n=this,o=function(){var i=new Cmd.RequestDelHistoryMatchGroupCmd_C;i.matchId=e.Instanc.selectMatchId,i.roomId=n.roomId,t.LobbyServerMJProxy.getInstance().sendData(i)},a=function(){t.LobbyPopupManager.removePopUp(s,!0,!0),s.destory(),s=null},s=new t.MatchMsgBox,r="您确定要删除此历史战况？\n桌号:"+n.roomId;return s.setData("温馨提示",r,["确定","取消"],[o,a]),void t.LobbyPopupManager.addPopUp(s,!0,!0)}this.roomId&&(t.MJLobbyData.getInstance().globalRoomId=this.roomId,e.Instanc.dispatchEventWith(t.LobbyUIEventConsts.GET_HISTORY_DETAIL_DATA,!1,this.roomId))},n.prototype.dataChanged=function(){var e=this.data;0==this.defaultColor&&(this.defaultColor=this.tableIdLabel.textColor),this.tableNoLabel.text=this.itemIndex+1+"",this.tableIdLabel.text="桌号"+e.roomId,this.timeLabel.text=t.DataManage.FormatDate(e.beginTime)+"~"+t.DataManage.FormatDate(e.endTime),e.endTime||(this.timeLabel.text=this.timeLabel.text+"正在进行中"),this.nameGroup.removeChildren(),this.idGroup.removeChildren(),this.scoreGroup.removeChildren(),this.roomId=e.roomId;for(var i=0,n=0,o=30,a=0,s=e.list;a<s.length;a++){var r=s[a],h=new t.TextImage;h.width=125,h.size=24,h.y=3,h.TextImageData=Emoji.toCodePoint(r.nickname?r.nickname.slice(0,4):""),h.textColor=1985957,h.x=o+135*n,n++,this.nameGroup.addChild(h);var c=new eui.Label;if(c.width=135,c.size=24,c.y=3,c.text=r.uid+"",c.textColor=1985957,c.textAlign=egret.HorizontalAlign.CENTER,c.multiline=!1,this.idGroup.addChild(c),null!=r.score){r.score>i&&(i=r.score);var l=new eui.Label;l.width=135,l.size=24,l.y=3,l.text=r.score+"",l.textColor=r.score<0?1985957:14382400,l.textAlign=egret.HorizontalAlign.CENTER,this.scoreGroup.addChild(l)}}5>i?(this.tableIdLabel.textColor=16711680,this.timeLabel.textColor=16711680):(this.tableIdLabel.textColor=this.defaultColor,this.timeLabel.textColor=this.defaultColor)},n}(eui.ItemRenderer);t.MatchFightingItem=h,__reflect(h.prototype,"MJLobby.MatchFightingItem");var c=function(i){function n(){var t=i.call(this)||this;return t.skinName=new MatchYelloItemSkin,t.removeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,t.removeHandel,t),t}return __extends(n,i),n.prototype.dataChanged=function(){var t=this.data;t&&(this.nameLabel=t.nickName?t.nickName.toString():"",this.nameLabelText.TextImageData=Emoji.toCodePoint(this.nameLabel),this.nameLabelText.textColor=5489379,this.nameLabelText.size=30,this.playerID.text=t.uid?t.uid.toString():"",this.nameLabel_1=t.nickName2?t.nickName2.toString():"",this.nameLabelText_1.TextImageData=Emoji.toCodePoint(this.nameLabel_1),this.nameLabelText_1.textColor=5489379,this.nameLabelText_1.size=30,this.playerID_1.text=t.uid2?t.uid2.toString():"")},n.prototype.removeHandel=function(i){var n=new Cmd.OperateYellowMemberListMatchGroupCmd_C;n.reply=0,n.uid=Number(this.playerID.text),n.uid2=Number(this.playerID_1.text),n.matchId=e.Instanc.selectMatchId,t.LobbyServerMJProxy.getInstance().sendData(n)},n}(eui.ItemRenderer);t.MatchYelloItem=c,__reflect(c.prototype,"MJLobby.MatchYelloItem")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function i(n){var o=e.call(this,i.NAME,n)||this;return o._main=new t.MJLobbyVc,t.MJLobbyInfo.mainUILayer.addChild(o._main),o._main.addEventListener(t.LobbyUIEventConsts.ROOM_MANAGE,o.uiEventHandle,o),o._main.addEventListener(t.LobbyUIEventConsts.SHOW_SHARE,o.uiEventHandle,o),o._main.addEventListener(t.LobbyUIEventConsts.SHOW_TO_BATTLE,o.uiEventHandle,o),o._main.addEventListener(t.LobbyUIEventConsts.CLICK_RANKBTN,o.uiEventHandle,o),o._main.addEventListener(t.LobbyUIEventConsts.SHOW_CREATE_PANEL,o.uiEventHandle,o),o._main.addEventListener(t.LobbyUIEventConsts.SHOW_JOIN_PANEL,o.uiEventHandle,o),o._main.addEventListener(t.LobbyUIEventConsts.SHOW_USERINFO,o.uiEventHandle,o),o._main.addEventListener(t.LobbyUIEventConsts.BACK_ROOM,o.uiEventHandle,o),o._main.addEventListener(t.LobbyUIEventConsts.SHOW_MARKET,o.uiEventHandle,o),o._main.addEventListener(t.LobbyUIEventConsts.COIN_SELECT_GAMEID,o.uiEventHandle,o),o._main.addEventListener(t.LobbyUIEventConsts.SHOW_HORN,o.uiEventHandle,o),o._main.addEventListener(t.LobbyUIEventConsts.SHOW_DTK,o.uiEventHandle,o),o._main.addEventListener(t.LobbyUIEventConsts.SHOW_CLUB,o.uiEventHandle,o),o._main.addEventListener(t.LobbyUIEventConsts.SHOW_NOTICE,o.uiEventHandle,o),o._main.addEventListener(t.LobbyUIEventConsts.SHOW_VIP,o.uiEventHandle,o),o._main.addEventListener(t.LobbyUIEventConsts.LOBBY_SHOW_LOTTERY,o.uiEventHandle,o),o._main.addEventListener(t.LobbyUIEventConsts.CERTIFICATION_CLICK,o.uiEventHandle,o),o.initGame(),uniLib.Global.hasEventListener(uniLib.ZqEvent.SHARE)||uniLib.Global.addEventListener(uniLib.ZqEvent.SHARE,function(e){var i;e&&e.param&&(i=e.param);var n=uniLib.SHARE_PLAT.WX;if(""==uniLib.ZQGameSdk.defaultWXShareVo.webpageUrl&&t.LobbyDataCache.bundleInfo&&t.LobbyDataCache.bundleInfo.weixin.wbappid){var a=t.MJLobbyData.getInstance().myBaseInfo.nickName;a.length>8&&(a=a.slice(0,8)),i.webpageUrl="https://open.weixin.qq.com/connect/oauth2/authorize?appid="+t.LobbyDataCache.bundleInfo.weixin.wbappid+"&redirect_uri=http://"+t.MJLobbyData.getInstance().lobbyConfig.newLink+"/addons/zqgame/gameshare.php?appid="+t.LobbyDataCache.bundleInfo.weixin.wbappid+"&response_type=code&scope=snsapi_base&state="+uniLib.CompressUtil.base64encode(t.MJLobbyData.getInstance().myBaseInfo.uid+"|0|"+a)+"&connect_redirect=1#wechat_redirect"}else i.webpageUrl=uniLib.ZQGameSdk.defaultWXShareVo.webpageUrl+"?uid="+t.MJLobbyData.getInstance().myBaseInfo.uid+"&nickName="+t.MJLobbyData.getInstance().myBaseInfo.nickName;i.shareWay=0,uniLib.ZQGameSdk.share(i,null,o,n)},o),t.EventInGameCommonPanel.instance.init(),o}return __extends(i,e),i.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.removeCreatePanel(),this.removeTableListPanel(),this.removePromoteRewardPanel(),t.MahJongLobbyFacade.getLobbyInstance().removeMediator(t.MJLobbyMenuDownMediator.NAME),this._main&&(this._main.removeEventListener(t.LobbyUIEventConsts.ROOM_MANAGE,this.uiEventHandle,this),this._main.removeEventListener(t.LobbyUIEventConsts.SHOW_SHARE,this.uiEventHandle,this),this._main.removeEventListener(t.LobbyUIEventConsts.SHOW_TO_BATTLE,this.uiEventHandle,this),this._main.removeEventListener(t.LobbyUIEventConsts.CLICK_RANKBTN,this.uiEventHandle,this),this._main.removeEventListener(t.LobbyUIEventConsts.SHOW_CREATE_PANEL,this.uiEventHandle,this),this._main.removeEventListener(t.LobbyUIEventConsts.SHOW_JOIN_PANEL,this.uiEventHandle,this),this._main.removeEventListener(t.LobbyUIEventConsts.SHOW_USERINFO,this.uiEventHandle,this),this._main.removeEventListener(t.LobbyUIEventConsts.BACK_ROOM,this.uiEventHandle,this),this._main.removeEventListener(t.LobbyUIEventConsts.SHOW_MARKET,this.uiEventHandle,this),this._main.removeEventListener(t.LobbyUIEventConsts.COIN_SELECT_GAMEID,this.uiEventHandle,this),this._main.removeEventListener(t.LobbyUIEventConsts.SHOW_HORN,this.uiEventHandle,this),this._main.removeEventListener(t.LobbyUIEventConsts.SHOW_CLUB,this.uiEventHandle,this),this._main.removeEventListener(t.LobbyUIEventConsts.SHOW_DTK,this.uiEventHandle,this),this._main.removeEventListener(t.LobbyUIEventConsts.SHOW_NOTICE,this.uiEventHandle,this),this._main.removeEventListener(t.LobbyUIEventConsts.SHOW_VIP,this.uiEventHandle,this),this._main.removeEventListener(t.LobbyUIEventConsts.LOBBY_SHOW_LOTTERY,this.uiEventHandle,this),this._main.removeEventListener(t.LobbyUIEventConsts.CERTIFICATION_CLICK,this.uiEventHandle,this),this._main.destory(),this._main=null)},i.prototype.listNotificationInterests=function(){return[t.MahJongLobbyFacadeConsts.ENTER_LOBBY,t.MahJongLobbyFacadeConsts.GAME_LIST_DATA,t.MahJongLobbyFacadeConsts.INVITE_DATA,t.MahJongLobbyFacadeConsts.INVITE_AWARDS_DATA,t.MahJongLobbyFacadeConsts.CONTINUE,t.MahJongLobbyFacadeConsts.LOBBY_RECONNECTION,t.MahJongLobbyFacadeConsts.ReturnMatchGroup,t.MahJongLobbyFacadeConsts.ENTER_MATCHGROUP,t.MahJongLobbyFacadeConsts.REFRESH_MATCHGROUP,t.MahJongLobbyFacadeConsts.LEAVE_MATCHGROUP,t.MahJongLobbyFacadeConsts.HistoryMatchIdList,t.MahJongLobbyFacadeConsts.ChangeMatchGroupEvent,t.MahJongLobbyFacadeConsts.PersonalInfo,t.MahJongLobbyFacadeConsts.PublicMatchList,t.MahJongLobbyFacadeConsts.UODATE_MATCHGROUP,t.MahJongLobbyFacadeConsts.LEAVE_MATCHGROUP_OTHER,t.MahJongLobbyFacadeConsts.ReturnRoomMatchGroup,t.MahJongLobbyFacadeConsts.UpdataMatchRoomStatus,t.MahJongLobbyFacadeConsts.DONATE_HISTORY,t.MahJongLobbyFacadeConsts.OpenWindowHandle,t.MahJongLobbyFacadeConsts.Mail_Changed,t.MahJongLobbyFacadeConsts.GetItemMail,t.MahJongLobbyFacadeConsts.GET_RANK_LIST,t.MahJongLobbyFacadeConsts.EntryInfoEvent,t.MahJongLobbyFacadeConsts.RefreshCueMatchGroupGameNbr,t.MahJongLobbyFacadeConsts.ReturnDailyTask,t.MahJongLobbyFacadeConsts.ReturnLuckShopPointItem,t.MahJongLobbyFacadeConsts.Bind_WeChatNum,t.MahJongLobbyFacadeConsts.ReturnShopPointList,t.MahJongLobbyFacadeConsts.OrderListMatchGroup,t.MahJongLobbyFacadeConsts.Return_PopUpNews,t.MahJongLobbyFacadeConsts.RETURN_PROMOTE_REWARD,t.MahJongLobbyFacadeConsts.ReturnUserHeadList,t.MahJongLobbyFacadeConsts.DeleteAccount,t.MahJongLobbyFacadeConsts.ReturnVisList,t.MahJongLobbyFacadeConsts.OPEN_REDPACKETPANEL,t.MahJongLobbyFacadeConsts.GET_REDPACKET_RECORD,t.MahJongLobbyFacadeConsts.GET_REDPACKET_SUCCESS,t.MahJongLobbyFacadeConsts.CHECKOPENREDPACK_OK,t.MahJongLobbyFacadeConsts.ReturnMyPlayedData,t.MahJongLobbyFacadeConsts.Update_UserInfo]},i.prototype.handleNotification=function(e){switch(e.getName()){case t.MahJongLobbyFacadeConsts.Update_UserInfo:this._main.updateUserInfo(e.getBody());break;case t.MahJongLobbyFacadeConsts.ReturnMyPlayedData:new t.ClubMyDataPanel(e.getBody());break;case t.MahJongLobbyFacadeConsts.DeleteAccount:this.onLoginOutBack();break;case t.MahJongLobbyFacadeConsts.ReturnVisList:var i=e.getBody();t.AudienceListPanel.instace&&t.AudienceListPanel.instace.parent&&t.AudienceListPanel.instace.open(),t.AudienceListPanel.instace.setData(i);break;case t.MahJongLobbyFacadeConsts.ReturnUserHeadList:t.HeadMcManager.instanc.onHeadurlBack(e.getBody().headList);break;case t.MahJongLobbyFacadeConsts.RETURN_PROMOTE_REWARD:var n=e.getBody();this.setProtmteData(n);break;case t.MahJongLobbyFacadeConsts.Return_PopUpNews:t.MJLobbyData.getInstance().popActiveData;this.removeActive(),this.showActivePanel();break;case t.MahJongLobbyFacadeConsts.OrderListMatchGroup:this._tableGamePanel&&this._tableGamePanel.parent&&this._tableGamePanel.showRank(e.getBody());break;case t.MahJongLobbyFacadeConsts.Mail_Changed:this._main&&this._main.showUnReadNum(e.getBody()),t.LobbyMailPanel.Instance.updataInfor(e.getBody());break;case t.MahJongLobbyFacadeConsts.GetItemMail:this._main.showUnReadNum(t.Mail.Instance.mailList),t.LobbyMailPanel.Instance.getMoney(e.getBody());break;case t.MahJongLobbyFacadeConsts.OpenWindowHandle:var o=e.getBody();1==o?this.showMarket():2==o?this.showShare():3==o&&this.showMailPanel();break;case t.MahJongLobbyFacadeConsts.RefreshCueMatchGroupGameNbr:var a=e.getBody();t.TableHouseListPanel.Instanc&&t.TableHouseListPanel.Instanc.parent&&t.TableHouseListPanel.Instanc.updateRoomCurNbr(a),this.multiplayerMatchPanel&&this.multiplayerMatchPanel.refreshCurMatchRound(a.nbr);break;case t.MahJongLobbyFacadeConsts.EntryInfoEvent:var s=e.getBody();this.onEventData(s);break;case t.MahJongLobbyFacadeConsts.DONATE_HISTORY:var r=e.getBody();t.LobbyPopupManager.addPopUp(t.DonateHistoryPanel.Instance,!0,!0),t.DonateHistoryPanel.Instance.addListener(),t.DonateHistoryPanel.Instance.setData(r.list);break;case t.MahJongLobbyFacadeConsts.ReturnShopPointList:var h=e.getBody();t.LuckPoorPanel.Instance&&t.LuckPoorPanel.Instance.updateJackpotData(h);break;case t.MahJongLobbyFacadeConsts.PublicMatchList:var c=e.getBody();t.GoldenPanel.Instance.setData(c.list);break;case t.MahJongLobbyFacadeConsts.PersonalInfo:var l=e.getBody();null!=l&&(t.MJLobbyData.getInstance().myBaseInfo=l,this.userPanel&&this.userPanel.showGrowthData(l.growth),l.growth&&t.LuckPoorPanel.Instance&&t.LuckPoorPanel.Instance.parent&&t.LuckPoorPanel.Instance.updateUserIntegral(l.growth.shopPoint));break;case t.MahJongLobbyFacadeConsts.HistoryMatchIdList:var d=e.getBody();this.joinPanel&&this.joinPanel.setData(d),this._clubPanel&&this._clubPanel.setJoinedList(d);break;case t.MahJongLobbyFacadeConsts.ENTER_LOBBY:this._main.initLobby();break;case t.MahJongLobbyFacadeConsts.GAME_LIST_DATA:this._createPanel&&this._createPanel.initData(e.getBody());break;case t.MahJongLobbyFacadeConsts.INVITE_DATA:this._invitePanel&&this._invitePanel.setInviteData(e.getBody());break;case t.MahJongLobbyFacadeConsts.INVITE_AWARDS_DATA:this._invitePanel&&this._invitePanel.updateInviteData(e.getBody());break;case t.MahJongLobbyFacadeConsts.CONTINUE:this.continueGame();break;case t.MahJongLobbyFacadeConsts.LOBBY_RECONNECTION:uniLib.UIMgr.instance.commonLoadUI=PublicLoadingView,this._main.updateAgentMenu();break;case t.MahJongLobbyFacadeConsts.ReturnMatchGroup:this.removeCreatePanel(),this.closeSettingMatch();break;case t.MahJongLobbyFacadeConsts.UODATE_MATCHGROUP:var u=e.getBody();this._tableGamePanel&&this._tableGamePanel.updateMatch(u);break;case t.MahJongLobbyFacadeConsts.ENTER_MATCHGROUP:var b=e.getBody();this._tableGamePanel?this._tableGamePanel.enterMatchGroup():(this.showMultiplayer(),this.multiplayerMatchPanel.enterMatchGroup(b)),Cmd.EnterMatchGroup=null,Cmd.EnterMatchGroupTime=null,this.closeBind(),this.closeJoinPanel();break;case t.MahJongLobbyFacadeConsts.REFRESH_MATCHGROUP:var p=e.getBody();this._tableGamePanel||(this.showMultiplayer(),this.multiplayerMatchPanel.refre(p)),Cmd.RefreshMatchGroup=null;break;case t.MahJongLobbyFacadeConsts.LEAVE_MATCHGROUP:this._tableGamePanel?this._tableGamePanel.leaveMatchGroup():this.closeMultiplayer();break;case t.MahJongLobbyFacadeConsts.LEAVE_MATCHGROUP_OTHER:var m=e.getBody();this._tableGamePanel&&m.uid&&this._tableGamePanel.leaveMatchGroup(m.uid);break;case t.MahJongLobbyFacadeConsts.ReturnRoomMatchGroup:var y=e.getBody();y.matchId&&(this.showTableListPanel(),this._tableGamePanel.initOtherTeaData(e.getBody())),this.closeBind(),this.closeJoinPanel();break;case t.MahJongLobbyFacadeConsts.UpdataMatchRoomStatus:this._tableGamePanel&&this._tableGamePanel.updateRoom(e.getBody());break;case t.MahJongLobbyFacadeConsts.ChangeMatchGroupEvent:var g=e.getBody();this.showSettingMatch(g.createRoom),this._newMatchPanel&&(this._newMatchPanel.showSettIngBtn(g.matchId),this._newMatchPanel.showMatchData(g));break;case t.MahJongLobbyFacadeConsts.GET_RANK_LIST:t.DataManage.RankData=e.getBody(),t.GoldenRankPanel.Instance.showPanel(t.DataManage.RankData);break;case t.MahJongLobbyFacadeConsts.ReturnDailyTask:var v=e.getBody();this.onReturnDailyTask(v);break;case t.MahJongLobbyFacadeConsts.ReturnLuckShopPointItem:e.getBody();t.LuckPoorPanel.Instance&&t.LuckPoorPanel.Instance.parent&&t.LuckPoorPanel.Instance.setJackpotResult(e.getBody());break;case t.MahJongLobbyFacadeConsts.Bind_WeChatNum:this.showBindPanel();break;case t.MahJongLobbyFacadeConsts.OPEN_REDPACKETPANEL:this.showRedPacketPanel();break;case t.MahJongLobbyFacadeConsts.GET_REDPACKET_RECORD:this._redPacketPanel;break;case t.MahJongLobbyFacadeConsts.GET_REDPACKET_SUCCESS:var L=e.getBody();this._redPacketPanel&&this._redPacketPanel.updateRedSurplus(L.distance),L.codeUrl&&(t.RedPacketRewardPanel.instance.setData(L.codeUrl,5),t.LobbyPopupManager.addPopUp(t.RedPacketRewardPanel.instance));break;case t.MahJongLobbyFacadeConsts.CHECKOPENREDPACK_OK:var _=e.getBody();t.RedPacketRewardPanel.instance.setData(_.codeUrl,5),t.LobbyPopupManager.addPopUp(t.RedPacketRewardPanel.instance)}},i.prototype.onReturnDailyTask=function(e){1==t.MJLobbyData.getInstance().dailyTask&&(t.LuckPoorPanel.Instance.isShow||t.LuckPoorPanel.Instance.setLuckPanelVisible(!0),t.LuckPoorPanel.Instance.updateDailyTaskData(e.daily,e.leftNum),t.LuckPoorPanel.Instance.hasEventListener(t.LobbyUIEventConsts.SHOW_SHARE)||t.LuckPoorPanel.Instance.hasEventListener(t.LobbyUIEventConsts.SHOW_CREATE_PANEL)||(t.LuckPoorPanel.Instance.addEventListener(t.LobbyUIEventConsts.SHOW_SHARE,this.uiEventHandle,this),t.LuckPoorPanel.Instance.addEventListener(t.LobbyUIEventConsts.SHOW_CREATE_PANEL,this.uiEventHandle,this)),t.LuckPoorPanel.Instance.hasEventListener(t.LobbyUIEventConsts.SHOW_VIP)||t.LuckPoorPanel.Instance.addEventListener(t.LobbyUIEventConsts.SHOW_VIP,this.uiEventHandle,this),t.LuckPoorPanel.Instance.hasEventListener(t.LobbyUIEventConsts.CERTIFICATION_CLICK)||t.LuckPoorPanel.Instance.addEventListener(t.LobbyUIEventConsts.CERTIFICATION_CLICK,this.uiEventHandle,this),t.LuckPoorPanel.Instance.hasEventListener(t.LobbyUIEventConsts.SHOW_JOIN_PANEL)||t.LuckPoorPanel.Instance.addEventListener(t.LobbyUIEventConsts.SHOW_JOIN_PANEL,this.uiEventHandle,this))},i.prototype.onLoginOutBack=function(){this.closeUserInfo(),0==uniLib.Global.isH5&&(this.sendNotification(t.MahJongLobbyFacadeConsts.SEND_DATA,null,t.LobbyDataRequestCommand.LOGIN_OUT),uniLib.SceneMgr.instance.changeScene(t.LobbyLoginPanel))},i.prototype.showPromoteRewardPanel=function(e){if(e.data){var i=e.data;this.promotePanel||(this.promotePanel=new t.PromoteRewardPanel,this.promotePanel.addEventListener(t.LobbyUIEventConsts.CLOSE,this.removePromoteRewardPanel,this)),this.promotePanel.setShareInfo(i.matchId,i.matchName,i.wechat,i.extenStr,i.shareInfo)}},i.prototype.setProtmteData=function(e){!e||!e.list||e.list.length<=0||this.promotePanel&&(this.promotePanel.setData(e.list),t.LobbyPopupManager.addPopUp(this.promotePanel,!0,!0))},i.prototype.removePromoteRewardPanel=function(){this.promotePanel&&(this.promotePanel.removeEventListener(t.LobbyUIEventConsts.CLOSE,this.removePromoteRewardPanel,this),this.promotePanel.destory(),this.promotePanel.parent&&t.LobbyPopupManager.removePopUp(this.promotePanel,!0)),this.promotePanel=null},i.prototype.showMailPanel=function(){t.LobbyMailPanel.Instance.addListener(),t.LobbyMailPanel.Instance.updataInfor(t.Mail.Instance.mailList),t.LobbyPopupManager.addPopUp(t.LobbyMailPanel.Instance,!0,!0,!1)},i.prototype.showClub=function(){this._clubPanel||(this._clubPanel=t.ClubPanel.instance),this._clubPanel.init(),this._clubPanel.addEventListener(t.LobbyUIEventConsts.CLOSE,this.closeClubPanel,this),t.LobbyPopupManager.addPopUp(this._clubPanel,!0,!0)},i.prototype.closeClubPanel=function(){this._clubPanel&&(this._clubPanel.removeEventListener(t.LobbyUIEventConsts.CLOSE,this.closeClubPanel,this),t.LobbyPopupManager.removePopUp(this._clubPanel,!1,!0),this._clubPanel.destory(),this._clubPanel=null)},i.prototype.showTableListPanel=function(){this._tableGamePanel||(this._tableGamePanel=new t.TableHouseListPanel,this._tableGamePanel.addEventListener(t.LobbyUIEventConsts.CLOSE,this.removeTableListPanel,this),this._tableGamePanel.addEventListener("show_promote",this.showPromoteRewardPanel,this),t.LobbyPopupManager.addPopUp(this._tableGamePanel,!0,!0,!0))},i.prototype.removeTableListPanel=function(){this._tableGamePanel&&(this._tableGamePanel.removeEventListener(t.LobbyUIEventConsts.CLOSE,this.removeTableListPanel,this),this._tableGamePanel.removeEventListener("show_promote",this.showPromoteRewardPanel,this),t.LobbyPopupManager.removePopUp(this._tableGamePanel),this._tableGamePanel.destory(),this._tableGamePanel=null)
},i.prototype.showBindPanel=function(){this.bindPanel||(this.bindPanel=new t.VerifyPanel,this.bindPanel.addEventListener(t.LobbyUIEventConsts.CLOSE,this.closeBind,this)),t.LobbyPopupManager.addPopUp(this.bindPanel,!0,!0)},i.prototype.closeBind=function(){this.bindPanel&&(this.bindPanel.removeEventListener(t.LobbyUIEventConsts.CLOSE,this.closeBind,this),t.LobbyPopupManager.removePopUp(this.bindPanel),this.bindPanel.destroy(),this.bindPanel=null)},i.prototype.showCertificationPanel=function(){this.certificationPanel||(this.certificationPanel=new t.CertificationPanel,this.certificationPanel.addEventListener(t.LobbyUIEventConsts.CLOSE,this.closeCertificationPanel,this)),t.LobbyPopupManager.addPopUp(this.certificationPanel,!0,!0)},i.prototype.closeCertificationPanel=function(){this.certificationPanel&&(this.certificationPanel.removeEventListener(t.LobbyUIEventConsts.CLOSE,this.closeCertificationPanel,this),t.LobbyPopupManager.removePopUp(this.certificationPanel),this.certificationPanel.destroy(),this.certificationPanel=null)},i.prototype.showMultiplayer=function(){var e=this;null==this.multiplayerMatchPanel&&(this.multiplayerMatchPanel=new t.MultiplayerMatchPanel,this.multiplayerMatchPanel.addEventListener(t.LobbyUIEventConsts.CLOSE,this.closeMultiplayer,this),this.multiplayerMatchPanel.addEventListener("show_promote",this.showPromoteRewardPanel,this),this.multiplayerMatchPanel.leaveMatch=function(){return e.closeMultiplayer()}),null==this.multiplayerMatchPanel.parent&&t.LobbyPopupManager.addPopUp(this.multiplayerMatchPanel,!0,!0,!1)},i.prototype.closeMultiplayer=function(){if(null!=this.multiplayerMatchPanel){this.multiplayerMatchPanel.leaveMatch=null,t.LobbyPopupManager.removePopUp(this.multiplayerMatchPanel,!0),this.multiplayerMatchPanel.removeEventListener(t.LobbyUIEventConsts.CLOSE,this.closeMultiplayer,this),this.multiplayerMatchPanel.removeEventListener("show_promote",this.showPromoteRewardPanel,this);var e=new Cmd.LeaveMatchGroupCmd_C;t.LobbyServerMJProxy.getInstance().sendData(e),this.multiplayerMatchPanel=null,this._createPanel&&t.LobbyPopupManager.addPopUp(this._createPanel,!0,!0,!1,0,0)}},i.prototype.onContinue=function(){var e=new Cmd.EnterRoomCmd_C;t.MJLobbyData.getInstance().continueObj&&t.MJLobbyData.getInstance().continueObj&&(e.roomId=t.MJLobbyData.getInstance().continueObj.roomId,t.MJLobbyData.getInstance().continueObj=null,this.sendNotification(t.MahJongLobbyFacadeConsts.SEND_DATA,e,t.LobbyDataRequestCommand.GAME_DATA))},i.prototype.initGame=function(){if(t.MJLobbyData.getInstance().hasShowGame){var e=new Cmd.UserInfoGetLobbyCmd_C;e.uid=t.MJLobbyInfo.userId,e.getIsCreate=!0,e.lobbyId=t.MJLobbyData.getInstance().lobbyId,this.sendNotification(t.MahJongLobbyFacadeConsts.SEND_DATA,e,t.LobbyDataRequestCommand.GAME_DATA)}else t.MJLobbyData.getInstance().hasShowGame=!0;t.MJLobbyData.getInstance().continueObj&&egret.setTimeout(this.continueGame,this,50);var i=new t.MJLobbyMenuDownVc;t.MJLobbyInfo.mainUILayer.addChild(i),i.x=(uniLib.Global.screenWidth-i.width)/2,i.y=uniLib.Global.screenHeight-i.height,t.MahJongLobbyFacade.getLobbyInstance().registerMediator(new t.MJLobbyMenuDownMediator(i)),this.startMusic(),0==uniLib.Global.is_sandbox?(1==t.MJLobbyData.getInstance().dailyTask&&t.LuckPoorPanel.Instance&&!t.LuckPoorPanel.Instance.parent&&(t.MJLobbyInfo.topLayer.addChild(t.LuckPoorPanel.Instance),t.LuckPoorPanel.Instance.setLuckPanelVisible(!1)),1==t.MJLobbyData.getInstance().disclaimer&&uniLib.Global.debugLevel<1&&(this.showDeclare(),t.MJLobbyData.getInstance().disclaimer=0),this.isMatch(),t.DataManage.firstInLobby&&(this.showActivePanel(1),t.DataManage.getLocation()),t.MJLobbyData.getInstance().popActiveData||this.reqActive()):this.showCoinGamePanel(),t.DataManage.firstInLobby=!1,t.PublicMethed.getLobbyConfig(!0)},i.prototype.startMusic=function(){1==Number(uniLib.Utils.getLocalStorage("sound_toggle"))||null==uniLib.Utils.getLocalStorage("sound_toggle")?(uniLib.SoundMgr.instance.soundVolume=.7,uniLib.SoundMgr.instance.soundOpen=!0):(uniLib.SoundMgr.instance.soundVolume=0,uniLib.SoundMgr.instance.soundOpen=!1),1==Number(uniLib.Utils.getLocalStorage("music_toggle"))||null==uniLib.Utils.getLocalStorage("music_toggle")?(uniLib.SoundMgr.instance.musicVolume=.7,uniLib.SoundMgr.instance.musicOpen=!0):(uniLib.SoundMgr.instance.musicVolume=0,uniLib.SoundMgr.instance.musicOpen=!1),uniLib.Utils.setLocalStorage("musicVolume",uniLib.SoundMgr.instance.musicVolume),uniLib.Utils.setLocalStorage("soundVolume",uniLib.SoundMgr.instance.soundVolume),uniLib.SoundMgr.instance.playBgMusic(["bg_mp3"]),uniLib.ZQGameSdk.speakerActive()},i.prototype.isMatch=function(){if(null!=Cmd.EnterMatchGroup){var e=Date.now(),i=Math.floor((e-Cmd.EnterMatchGroupTime)/1e3);console.error("差值秒数"+i);var n=Cmd.EnterMatchGroup,o=new Cmd.EnterMatchGroupCmd_S;o.list=n.list,o.ownerid=n.ownerid,o.ownername=n.ownername,o.matchId=n.matchId,o.shareInfo=n.shareInfo,this.showMultiplayer(),this.multiplayerMatchPanel.enterMatchGroup(o),Cmd.EnterMatchGroup=null,Cmd.RefreshMatchGroup&&(this.showMultiplayer(),Cmd.RefreshMatchGroup.leftTime&&(Cmd.RefreshMatchGroup.leftTime-=i),this.multiplayerMatchPanel.refre(Cmd.RefreshMatchGroup),this.multiplayerMatchPanel.promotionLabelVisible(!0),t.LobbyPopupManager.showMildWarnShow("恭喜您已晋级，等待下一轮"))}},i.prototype.continueGame=function(){var e=t.MJLobbyData.getInstance().continueObj;t.LobbyPopupManager.showConfirmPanel(e.owner+"邀请您再来一局，是否确认参与？",["确定","取消"],[this.onContinue],"",this)},i.prototype.showDeclare=function(){this._declarePanel||(this._declarePanel=new t.DeclarePanel)},i.prototype.removeDeclare=function(){if(this._declarePanel){var e=new Cmd.ReadDisclaimerLobbyCmd_C;this.sendNotification(t.MahJongLobbyFacadeConsts.SEND_DATA,e,t.LobbyDataRequestCommand.GAME_DATA),this._declarePanel.removeEventListener(t.LobbyUIEventConsts.CLOSE,this.removeDeclare,this),this._declarePanel.destory(),this._declarePanel=null}},i.prototype.reqRankData=function(){if(t.DataManage.RankData)t.GoldenRankPanel.Instance.showPanel(t.DataManage.RankData);else{var e=new Cmd.GetListRankCmd_C;e.rType=2,t.MJLobbyData,e.index=1,this.sendNotification(t.MahJongLobbyFacadeConsts.SEND_DATA,e,t.LobbyDataRequestCommand.GAME_DATA)}},i.prototype.uiEventHandle=function(e){var i=e.type;switch(i){case t.LobbyUIEventConsts.ROOM_MANAGE:var n=new Cmd.RequestMatchGroupCmd_C;this.sendNotification(t.MahJongLobbyFacadeConsts.SEND_DATA,n,t.LobbyDataRequestCommand.GAME_DATA);break;case t.LobbyUIEventConsts.SHOW_SHARE:this.showShare();break;case t.LobbyUIEventConsts.SHOW_TO_BATTLE:this.showEventPanel();break;case t.LobbyUIEventConsts.SHOW_VIP:this.showVerifyPanel();break;case t.LobbyUIEventConsts.LOBBY_SHOW_LOTTERY:this.showCertificationPanel();break;case t.LobbyUIEventConsts.SHOW_NOTICE:this.showActivePanel(1);break;case t.LobbyUIEventConsts.CLICK_RANKBTN:this.reqRankData();break;case t.LobbyUIEventConsts.SHOW_CLUB:var o=new Cmd.HistoryMatchIdListMatchGroupCmd_C;this.sendNotification(t.MahJongLobbyFacadeConsts.SEND_DATA,o,t.LobbyDataRequestCommand.GAME_DATA),this.showClub();break;case t.LobbyUIEventConsts.SHOW_CREATE_PANEL:var a=e.data,s=new Cmd.GetNormalGameListRoomCmd_C;s.lobbyId=t.MJLobbyData.getInstance().lobbyId,this.sendNotification(t.MahJongLobbyFacadeConsts.SEND_DATA,s,t.LobbyDataRequestCommand.GAME_DATA),this.showCreatePanel(a);break;case t.LobbyUIEventConsts.SHOW_JOIN_PANEL:var r=new Cmd.HistoryMatchIdListMatchGroupCmd_C;this.sendNotification(t.MahJongLobbyFacadeConsts.SEND_DATA,r,t.LobbyDataRequestCommand.GAME_DATA),this.showJoinPanel();break;case t.LobbyUIEventConsts.SHOW_USERINFO:this.showUserInfo();break;case t.LobbyUIEventConsts.BACK_ROOM:var h=new Cmd.ReturnRoomCmd_C;h.lobbyId=t.MJLobbyData.getInstance().lobbyId,this.sendNotification(t.MahJongLobbyFacadeConsts.SEND_DATA,h,t.LobbyDataRequestCommand.GAME_DATA),t.NetMgr.setMsgTimeout(5,"Cmd.ReturnRoomCmd_C");break;case t.LobbyUIEventConsts.SHOW_MARKET:this.showMarket(e.data);break;case t.LobbyUIEventConsts.COIN_SELECT_GAMEID:this.showCoinGamePanel();break;case t.LobbyUIEventConsts.CERTIFICATION_CLICK:this.showBindPanel()}},i.prototype.showShare=function(){var e=new t.LobbySharePanel;e.addEventListener(t.LobbyUIEventConsts.CLOSE,this.shareHandle,this),e.addEventListener(t.LobbyUIEventConsts.SHARE_SUCCESS,this.shareHandle,this),t.LobbyPopupManager.addPopUp(e,!0,!0,!1)},i.prototype.shareHandle=function(e){var i=e.currentTarget;if(e.type==t.LobbyUIEventConsts.SHARE_SUCCESS){var n=new Cmd.ShareLobbyCmd_C;n.lobbyId=t.MJLobbyData.getInstance().lobbyId,this.sendNotification(t.MahJongLobbyFacadeConsts.SEND_DATA,n,t.LobbyDataRequestCommand.GAME_DATA)}else e.type==t.LobbyUIEventConsts.CLOSE&&(i.removeEventListener(t.LobbyUIEventConsts.CLOSE,this.shareHandle,this),i.removeEventListener(t.LobbyUIEventConsts.SHARE_SUCCESS,this.shareHandle,this),t.LobbyPopupManager.removePopUp(i,!1,!0),i.destory())},i.prototype.showEventPanel=function(){this.eventPanel||(this.eventPanel=new t.LobbyEventPanel,this.eventPanel.addEventListener(egret.Event.CLOSE,this.removeEventPanel,this),t.LobbyPopupManager.addPopUp(this.eventPanel,!0,!0,!1))},i.prototype.onEventData=function(e){if(this.eventPanel)this.eventPanel.showEventInfo();else if(!t.EventInfoPanel.instance.parent){var i={},n=t.MJLobbyData.getInstance().getTableEventConfig(),o=t.MJLobbyData.getInstance().getGameOfficalEventConfigByMatchId(e.matchId);n&&(i=n.first(function(t){return t.id==o.eventId}),t.EventInfoPanel.instance.initUI(i),t.LobbyPopupManager.addPopUp(t.EventInfoPanel.instance,!0,!0))}t.EventInfoPanel.instance.parent&&t.EventInfoPanel.instance.EntryEventResult(e)},i.prototype.removeEventPanel=function(){this.eventPanel&&(this.eventPanel.removeEventListener(egret.Event.CLOSE,this.removeEventPanel,this),t.LobbyPopupManager.removePopUp(this.eventPanel,!1,!0),this.eventPanel=null)},i.prototype.showVerifyPanel=function(){this._phoneBind||(this._phoneBind=new t.PhoneBindPanel(1),this._phoneBind.addEventListener(t.LobbyUIEventConsts.CLOSE,this.closeBindPanel,this),t.LobbyPopupManager.addPopUp(this._phoneBind,!0,!0))},i.prototype.closeBindPanel=function(){this._phoneBind&&(t.LobbyPopupManager.removePopUp(this._phoneBind),this._phoneBind.removeEventListener(t.LobbyUIEventConsts.CLOSE,this.closeBindPanel,this),this._phoneBind.destroy(),this._phoneBind=null)},i.prototype.closeVerifyPanel=function(){this.bindPanel&&(t.LobbyPopupManager.removePopUp(this.bindPanel),this.bindPanel.removeEventListener(t.LobbyUIEventConsts.CLOSE,this.closeVerifyPanel,this),this.bindPanel.destroy(),this.bindPanel=null)},i.prototype.showCoinGamePanel=function(){var e=new Cmd.PublicMatchIdListMatchGroupCmd_C;e.typ=2,this.sendNotification(t.MahJongLobbyFacadeConsts.SEND_DATA,e,t.LobbyDataRequestCommand.GAME_DATA),t.LobbyPopupManager.addPopUp(t.GoldenPanel.Instance)},i.prototype.showTGY=function(){var e=new Cmd.GetInviteListCmd_CS;this.sendNotification(t.MahJongLobbyFacadeConsts.SEND_DATA,e,t.LobbyDataRequestCommand.GAME_DATA),this._invitePanel||(this._invitePanel=new t.InvitePanel,this._invitePanel.addEventListener(t.LobbyUIEventConsts.CLOSE,this.closeTGY,this),this._invitePanel.addEventListener(t.LobbyUIEventConsts.SET_TGY,this.closeTGY,this),this._invitePanel.addEventListener(t.LobbyUIEventConsts.GET_CHECKIN_AWARDS,this.closeTGY,this),this._invitePanel.addEventListener(t.LobbyUIEventConsts.GET_INVITE_AWARDS,this.closeTGY,this),this._invitePanel.addEventListener(t.LobbyUIEventConsts.GET_RANK_DATA,this.closeTGY,this),t.LobbyPopupManager.addPopUp(this._invitePanel,!0,!0,!0))},i.prototype.closeTGY=function(e){if(this._invitePanel){if(e.type==t.LobbyUIEventConsts.GET_CHECKIN_AWARDS){var i=new Cmd.GetRegisterRewardCmd_C;return i.lobbyId=t.MJLobbyData.getInstance().lobbyId,void this.sendNotification(t.MahJongLobbyFacadeConsts.SEND_DATA,i,t.LobbyDataRequestCommand.GAME_DATA)}if(e.type==t.LobbyUIEventConsts.GET_INVITE_AWARDS){var n=new Cmd.GetInviteRewardCmd_C;return void this.sendNotification(t.MahJongLobbyFacadeConsts.SEND_DATA,n,t.LobbyDataRequestCommand.GAME_DATA)}this._invitePanel.removeEventListener(t.LobbyUIEventConsts.CLOSE,this.closeTGY,this),this._invitePanel.removeEventListener(t.LobbyUIEventConsts.SET_TGY,this.closeTGY,this),this._invitePanel.removeEventListener(t.LobbyUIEventConsts.GET_CHECKIN_AWARDS,this.closeTGY,this),this._invitePanel.removeEventListener(t.LobbyUIEventConsts.GET_INVITE_AWARDS,this.closeTGY,this),this._invitePanel.removeEventListener(t.LobbyUIEventConsts.GET_RANK_DATA,this.closeTGY,this),e.type==t.LobbyUIEventConsts.SET_TGY&&(t.MJLobbyData.getInstance().tgyId=Number(e.data),t.LobbyPopupManager.showConfirmPanel("确定将推广员ID改成"+e.data+"吗？",["确定","取消"],[this.submitTGY],null,this,0,!1)),t.LobbyPopupManager.removePopUp(this._invitePanel),this._invitePanel.destory(),this._invitePanel=null}},i.prototype.submitTGY=function(){var e=new Cmd.ChangeParentCmd_C;e.parent=Number(t.MJLobbyData.getInstance().tgyId),this.sendNotification(t.MahJongLobbyFacadeConsts.SEND_DATA,e,t.LobbyDataRequestCommand.GAME_DATA)},i.prototype.showMarket=function(e){void 0===e&&(e=!0);var i=new t.LobbyMarketPanel(e);i.addEventListener(t.LobbyUIEventConsts.CLOSE,this.closeMarket,this),t.LobbyPopupManager.addPopUp(i,!0,!0,!0)},i.prototype.closeMarket=function(e){var i=e.currentTarget;i.removeEventListener(t.LobbyUIEventConsts.CLOSE,this.closeMarket,this),t.LobbyPopupManager.removePopUp(i)},i.prototype.showUserInfo=function(){this.userPanel=new t.LobbyUserInfoPanel,this.userPanel.addEventListener(t.LobbyUIEventConsts.CLOSE,this.closeUserInfo,this),this.userPanel.setData(t.MJLobbyData.getInstance().myBaseInfo),t.LobbyPopupManager.addPopUp(this.userPanel,!0,!0,!0)},i.prototype.closeUserInfo=function(){this.userPanel&&(this.userPanel.removeEventListener(t.LobbyUIEventConsts.CLOSE,this.closeUserInfo,this),t.LobbyPopupManager.removePopUp(this.userPanel),this.userPanel.destory())},i.prototype.showJoinPanel=function(){this.joinPanel=new t.JoinRoomPanel,t.LobbyPopupManager.addPopUp(this.joinPanel,!0,!0,!0),this.joinPanel.addEventListener(t.LobbyUIEventConsts.JOIN_ROOM,this.joinRoonReq,this)},i.prototype.closeJoinPanel=function(){this.joinPanel&&(this.joinPanel.onRemove(),this.joinPanel.removeEventListener(t.LobbyUIEventConsts.JOIN_ROOM,this.joinRoonReq,this),this.joinPanel=null)},i.prototype.joinRoonReq=function(e){var i=new Cmd.EnterRoomCmd_C;i.roomId=Number(e.data),this.sendNotification(t.MahJongLobbyFacadeConsts.SEND_DATA,i,t.LobbyDataRequestCommand.GAME_DATA),t.NetMgr.setMsgTimeout(5,"CreateRoomCmd_C")},i.prototype.showCreatePanel=function(e){this._createPanel||(this._createPanel=t.CreateGamePanel.instance,this._createPanel.addEventListener(t.LobbyUIEventConsts.CREATE_ROOM,this.createUIEvent,this),this._createPanel.addEventListener(t.LobbyUIEventConsts.CLOSE,this.createUIEvent,this),this._createPanel.addEventListener(t.LobbyUIEventConsts.SettingMatch,this.createUIEvent,this),t.MJLobbyInfo.topLayer.addChild(this._createPanel))},i.prototype.removeCreatePanel=function(){this._createPanel&&(this._createPanel.removeEventListener(t.LobbyUIEventConsts.CREATE_ROOM,this.createUIEvent,this),this._createPanel.removeEventListener(t.LobbyUIEventConsts.CLOSE,this.createUIEvent,this),this._createPanel.removeEventListener(t.LobbyUIEventConsts.SettingMatch,this.createUIEvent,this),t.LobbyPopupManager.removePopUp(this._createPanel),this._createPanel.destory(),this._createPanel=null)},i.prototype.createUIEvent=function(e){switch(e.type){case t.LobbyUIEventConsts.CREATE_ROOM:var i=e.data;this.sendNotification(t.MahJongLobbyFacadeConsts.SEND_DATA,i,t.LobbyDataRequestCommand.GAME_DATA),t.NetMgr.setMsgTimeout(5,"CreateRoomCmd_C"),this.removeCreatePanel();break;case t.LobbyUIEventConsts.SettingMatch:this.showSettingMatch(e.data);break;case t.LobbyUIEventConsts.CLOSE:this.removeCreatePanel()}},i.prototype.showSettingMatch=function(e){this._newMatchPanel||(this._newMatchPanel=new t.CreatMatchSetPanel,this._newMatchPanel.height=2*uniLib.Global.screenHeight/3,t.LobbyPopupManager.addPopUp(this._newMatchPanel,!0,!0,!1),this._newMatchPanel.y-=30,this._newMatchPanel.addEventListener(t.LobbyUIEventConsts.CLOSE,this.closeSettingMatch,this),this._newMatchPanel.setCreatReq(e),this._newMatchPanel.initData())},i.prototype.closeSettingMatch=function(){this._newMatchPanel&&(this._newMatchPanel.removeEventListener(t.LobbyUIEventConsts.CLOSE,this.closeSettingMatch,this),t.LobbyPopupManager.removePopUp(this._newMatchPanel,!1),this._newMatchPanel.destory(),this._newMatchPanel=null)},i.prototype.showActivePanel=function(e){void 0===e&&(e=0),this.activePanel||(this.activePanel=new t.LobbyActivity(e),this.activePanel.addEventListener(egret.Event.CLOSE,this.removeActive,this),this.activePanel.addEventListener(t.LobbyUIEventConsts.JOIN_ROOM,this.joinRoonReq,this),t.LobbyPopupManager.addPopUp(this.activePanel,!0,!0))},i.prototype.removeActive=function(){this.activePanel&&(this.activePanel.parent&&t.LobbyPopupManager.removePopUp(this.activePanel,!0),this.activePanel.removeEventListener(t.LobbyUIEventConsts.JOIN_ROOM,this.joinRoonReq,this),this.activePanel.removeEventListener(egret.Event.CLOSE,this.removeActive,this),this.activePanel=null)},i.prototype.reqActive=function(){var e=new Cmd.PopUpNewsLobbyCmd_C;this.sendNotification(t.MahJongLobbyFacadeConsts.SEND_DATA,e,t.LobbyDataRequestCommand.GAME_DATA),uniLib.NetMgr.setMsgTimeout(5,"PopUpNewsLobbyCmd_C")},i.prototype.showRedPacketPanel=function(){this._redPacketPanel||(this._redPacketPanel=t.RedPacketPanel.instance,this._redPacketPanel.setData(t.MJLobbyData.getInstance().redpacket_info),this._redPacketPanel.addEventListener(t.LobbyUIEventConsts.CLOSE,this.removeRedpacketPanel,this),this._redPacketPanel.addEventListener(t.LobbyUIEventConsts.CHAI_REDPACKET,this.redEvent,this),this._redPacketPanel.addEventListener(t.LobbyUIEventConsts.GET_REDPACKET_RECORD,this.redEvent,this),t.LobbyPopupManager.addPopUp(this._redPacketPanel,!0,!1))},i.prototype.redEvent=function(e){switch(e.type){case t.LobbyUIEventConsts.CHAI_REDPACKET:var i=new Cmd.ExchangeChipsReceive_CS,n=e.data;i.exchangeKey=n,this.sendNotification(t.MahJongLobbyFacadeConsts.SEND_DATA,i,t.LobbyDataRequestCommand.GAME_DATA);break;case t.LobbyUIEventConsts.GET_REDPACKET_RECORD:var o=new Cmd.ExchangeRecordGet_CS;this.sendNotification(t.MahJongLobbyFacadeConsts.SEND_DATA,o,t.LobbyDataRequestCommand.GAME_DATA)}},i.prototype.removeRedpacketPanel=function(e){this._redPacketPanel&&(this._redPacketPanel.removeEventListener(t.LobbyUIEventConsts.CLOSE,this.removeRedpacketPanel,this),t.LobbyPopupManager.removePopUp(this._redPacketPanel),this._redPacketPanel=null)},i}(t.Mediator);e.NAME="MahJongLobbyMediator",t.MahJongLobbyMediator=e,__reflect(e.prototype,"MJLobby.MahJongLobbyMediator")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.isSetting=!1,t.userNumbers=[],t.touchEnabled=!0,t}return __extends(i,e),i.prototype.destory=function(){e.prototype.destory.call(this),this._creatBtn&&(this._creatBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.createHandle,this),this._creatBtn=null),this._settingBtn&&(this._settingBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.settingHandel,this),this._settingBtn=null),this._advSettingBtn&&(this._advSettingBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onAdvancedSet,this),this._advSettingBtn=null),this._changeBtn&&(this._changeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeHandel,this),this._changeBtn=null),this._minGameNList&&(this._minGameNList.destory(),this._minGameNList=null),this.teaCheck&&this.teaCheck.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTeaModeChange,this),this.teaCheck=null,this.teaGroupCheck&&this.teaGroupCheck.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTeaModeChange,this),this.teaGroupCheck=null,this._menuScroll&&(this._menuScroll.removeChildren(),this._menuScroll=null),this._menuMc&&(this._menuMc=null),uniLib.DisplayUtils.removeAllChildren(this)},i.prototype.initUI=function(){var e=t.LobbyResUtil.createBitmapByName("mjl_common_bj_3");e.scale9Grid=new egret.Rectangle(47,51,184,491),e.width=960,e.height=400,1==t.MJLobbyData.getInstance().fundType&&(e.height=580),this.addChild(e),this._back=new t.LobbyGameButton(["close","close"]),this._back.x=this.width-this._back.width/2-20,this._back.y=-(this._back.width/3),this.addChild(this._back),this._back.touchEnabled=!0,this._back.addEventListener(egret.TouchEvent.TOUCH_TAP,this.backToCreat,this),this._creatBtn=new t.LobbyGameButton(["mjl_btn_create_match_1","mjl_btn_create_match_2"]),this._creatBtn.x=(this.width-this._creatBtn.width)/2,this._creatBtn.y=this.height-140,this.addChild(this._creatBtn),this._creatBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.createMatchReq,this),this._settingBtn=new t.LobbyGameButton(["mjl_commonBtn_sure_1","mjl_commonBtn_sure_2"]),this._settingBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.settingHandel,this),this._settingBtn.x=(this.width-this._settingBtn.width)/2+300,this._settingBtn.y=this.height-140,this.addChild(this._settingBtn),this._settingBtn.visible=!1,this._changeBtn=new t.LobbyGameButton(["mjl_commonBtn_change_1","mjl_commonBtn_change_2"]),this._changeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeHandel,this),this._changeBtn.x=(this.width-this._changeBtn.width)/2,this._changeBtn.y=this.height-140,this.addChild(this._changeBtn),this._changeBtn.visible=!1,this._advSettingBtn=new t.LobbyGameButton(["match_taxSet_btn_1","match_taxSet_btn_2"]),this._advSettingBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onAdvancedSet,this),this._advSettingBtn.x=(this.width-this._advSettingBtn.width)/2-300,this._advSettingBtn.y=this.height-140,this.addChild(this._advSettingBtn),this._advSettingBtn.visible=!1,this._menuMc=new egret.Sprite,this.addChild(this._menuMc),this._menuScroll=t.LobbyResUtil.createScroll(this._menuMc,880,430,50,50),this._menuScroll.horizontalScrollPolicy="off",this._menuScroll.verticalScrollPolicy="off",this.addChild(this._menuScroll),this._menuMc.touchEnabled=this._menuScroll.touchEnabled=!0},i.prototype.initData=function(){this.removeCheckBox();var e=60;1==t.MJLobbyData.getInstance().fundType&&(e=20,this.minIntegarl=this.addInputItem("最小携带","基金",0,e+160,6),this.gold2MatchPoint=this.addInputItem("金豆转基金","请输入",480,e+160,9),this.addTaxInput()),this.editableText=this.addInputItem("包厢号","输入6位数字",0,e,6),this.matchName=this.addInputItem("包厢名称","输入包厢名称",480,e),this.refreshSetting()},i.prototype.addTaxInput=function(){this.taxCheckBox||(this.taxCheckBox=new eui.ItemRenderer,this.taxCheckBox.skinName=new TaxSKin,this.taxCheckBox.y=260,this._menuMc.addChild(this.taxCheckBox),this.taxCheckBox.touchEnabled=!1,this.taxCheckBox.touchChildren=!0,this.taxPromote=this.taxCheckBox.taxPromote,this.taxMin=this.taxCheckBox.taxMin,this.taxNum=this.taxCheckBox.taxNum,this.taxMin.inputType=egret.TextFieldInputType.TEL)},i.prototype.showMatchData=function(t){if(null!=t){this.changeData_c=new Cmd.ChangeMatchGroupCmd_C;for(var e in t)this.changeData_c[e]=t[e];t.createRoom&&(this.thisRoomProps=t.createRoom),this.taxPromote&&(this.taxPromote.text=t.taxReward?t.taxReward+"":""),this.taxMin&&(this.taxMin.text=t.taxMin?t.taxMin+"":""),this.taxNum&&(this.taxNum.text=t.taxNum?t.taxNum+"":""),this.gold2MatchPoint&&(this.gold2MatchPoint.text=t.gold2MatchPoint?t.gold2MatchPoint+"":"",this.gold2MatchPoint.touchEnabled=!1),this.maxRoomNum&&(this.maxRoomNum.text=null!=t.maxRoomNum?t.maxRoomNum+"":""),this.minIntegarl&&(this.minIntegarl.text=null!=t.minMatchPoint?t.minMatchPoint+"":""),this.editableText&&(this.editableText.text=null!=t.matchId?t.matchId+"":"",this.editableText.touchEnabled=!1),this.matchName&&(this.matchName.text=t.matchName?t.matchName:""),this.wechat&&(this.wechat.text=t.wechat?t.wechat:""),this.permissionCheck&&(this.permissionCheck.check=null!=t.needAgree&&1==t.needAgree?!0:!1,this.permissionCheck.labelColor=16251903),this.teaCheck&&this.teaGroupCheck&&(this.teaCheck.check=this.teaGroupCheck.check=!1,t.clubType&&2==t.clubType?this.teaCheck.check=!0:t.clubType&&3==t.clubType?this.teaGroupCheck.check=!0:1)}},i.prototype.removeCheckBox=function(){this._menuMc&&(uniLib.DisplayUtils.removeAllChildren(this._menuMc),this.taxCheckBox=null)},i.prototype.refreshSetting=function(){var e=340;1!=t.MJLobbyData.getInstance().fundType&&(e=140),this._menuMc.graphics.clear(),this.permissionCheck=new t.CreateCheckMc,this.permissionCheck.x=0,this.permissionCheck.y=e,this.permissionCheck.label="房主授权进入",this.permissionCheck.setLabelSize(28),this.permissionCheck.setCheckType(2),this.permissionCheck.labelColor=16251903,this._menuMc.addChild(this.permissionCheck),this.permissionCheck.touchEnabled=!0,this.permissionCheck.check=!0,this.permissionCheck.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEntChange,this),this.teaCheck=new t.CreateCheckMc,this.teaCheck.x=480,this.teaCheck.y=e,this.teaCheck.label="包厢模式",this.teaCheck.setLabelSize(28),this.teaCheck.setCheckType(1),this.teaCheck.labelColor=16251903,this._menuMc.addChild(this.teaCheck),this.teaCheck.touchEnabled=!0,this.teaCheck.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTeaModeChange,this),this.teaGroupCheck=new t.CreateCheckMc,this.teaGroupCheck.x=480-this.teaCheck.width-10,this.teaGroupCheck.y=e,this.teaGroupCheck.label="茶楼模式",this.teaGroupCheck.setLabelSize(28),this.teaGroupCheck.setCheckType(1),this.teaGroupCheck.labelColor=16251903,this._menuMc.addChild(this.teaGroupCheck),this.teaGroupCheck.touchEnabled=!0,this.teaGroupCheck.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTeaModeChange,this),this.teaGroupCheck.visible=t.MJLobbyData.getInstance().isTeahouseModle,this._menuMc.graphics.clear(),this._menuMc.graphics.beginFill(16711680,0),this._menuMc.graphics.drawRect(-this._menuMc.x,0,this._menuMc.width,this._menuMc.height),this._menuMc.graphics.endFill(),this.teaCheck.check=!0},i.prototype.onTeaModeChange=function(t){uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),t.target.check||(this.teaCheck.check=this.teaGroupCheck.check=!1,t.target.check=!0)},i.prototype.onEntChange=function(t){uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),this.permissionCheck.check=!this.permissionCheck.check},i.prototype.onTimeChange=function(t){uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),this._isLimiteTimeIcon.visible=!this._isLimiteTimeIcon.visible},i.prototype.addInputItem=function(t,e,i,n,o){void 0===o&&(o=null);var a=new eui.Label;a.text=t,a.size=28,a.x=i,a.y=n,a.textColor=16251903,a.name=t,this._menuMc.addChild(a);var s=new eui.Image;s.source="mjl_create_match_inputBg",s.x=a.x+155,s.y=a.y-5,s.width=220,this._menuMc.addChild(s),s.name=t;var r=new eui.EditableText;return r.prompt=e,r.promptColor=16251903,r.textColor=16251903,r.size=25,r.width=s.width,o&&(r.maxChars=o,r.restrict="0-9",r.inputType=egret.TextFieldInputType.TEL),r.x=s.x,r.y=s.y+8,r.textAlign=egret.HorizontalAlign.CENTER,this._menuMc.addChild(r),r.name=t,r},i.prototype.createMatchReq=function(){var e=new Cmd.CreateMatchGroupCmd_C;this._req&&(e.createRoom=this._req),e.needAgree=this.permissionCheck.check?1:0,e.clubType=this.teaCheck.check?2:this.teaGroupCheck.check?3:0;var i=null!=this.editableText?this.editableText.text:"";if(i&&6==i.length){var n=Number(i);e.roomId=n}if(this.maxRoomNum){var o=Number(this.maxRoomNum.text);o&&(e.maxRoomNum=o)}if(this.minIntegarl){var a=Number(this.minIntegarl.text);a&&(e.minMatchPoint=a)}if(this.matchName&&(e.matchName=this.matchName.text),this.wechat&&(e.wechat=this.wechat.text),this.gold2MatchPoint){var s=Number(this.gold2MatchPoint.text);s&&(e.gold2MatchPoint=s)}if(this.taxMin){var r=Number(this.taxMin.text);r>=0&&(e.taxMin=r)}if(this.taxPromote){var h=Number(this.taxPromote.text);h>=0&&(e.taxReward=h)}if(this.taxNum){var c=Number(this.taxNum.text);c>=0&&(e.taxNum=c)}this.beforeCreateMatch(e),t.LobbyServerMJProxy.getInstance().sendData(e),this.dispatchEventWith(t.LobbyUIEventConsts.CLOSE)},i.prototype.beforeCreateMatch=function(t){},i.prototype.showSettIngBtn=function(e){this.isSetting=!0,this._changeMatchId=0,e&&(this._changeMatchId=e),this.initData(),this._changeBtn.visible=this._settingBtn.visible=!0,1==t.MJLobbyData.getInstance().fundType?this._advSettingBtn.visible=!0:this._changeBtn.x=100,this._creatBtn.visible=!1},i.prototype.onChangeHandel=function(){this.thisRoomProps&&this.showCreate()},i.prototype.onAdvancedSet=function(){this.changeData_c&&(this.matchTaxSetPanel||(this.matchTaxSetPanel=new t.MatchTaxSetPanel),t.LobbyPopupManager.addPopUp(this.matchTaxSetPanel,!0,!0),this.matchTaxSetPanel.initData(this.changeData_c),this.matchTaxSetPanel.addEventListener(egret.Event.CLOSE,this.removeAdvancedSet,this))},i.prototype.removeAdvancedSet=function(t){t.data&&(this.changeData_c=t.data),this.matchTaxSetPanel.removeEventListener(egret.Event.CLOSE,this.removeAdvancedSet,this),this.matchTaxSetPanel.destory(),this.matchTaxSetPanel=null},i.prototype.showCreate=function(){this.createRoomPanel||(this.createRoomPanel=new t.CreateGamePanel,this.createRoomPanel.addEventListener(t.LobbyUIEventConsts.SettingMatch,this.removeCreate,this),this.createRoomPanel.addEventListener(t.LobbyUIEventConsts.CLOSE,this.removeCreate,this),t.LobbyPopupManager.addPopUp(this.createRoomPanel,!0,!0),this.createRoomPanel.initData(this.thisRoomProps,!0))},i.prototype.removeCreate=function(e){var i=e.data;this.createRoomPanel&&(this.createRoomPanel.removeEventListener(t.LobbyUIEventConsts.SettingMatch,this.removeCreate,this),this.createRoomPanel.removeEventListener(t.LobbyUIEventConsts.CLOSE,this.removeCreate,this),t.LobbyPopupManager.removePopUp(this.createRoomPanel,!1,!0)),i&&i.gameId==this.thisRoomProps.gameId&&(this.thisRoomProps=i),this.createRoomPanel=null},i.prototype.settingHandel=function(e){uniLib.SoundMgr.instance.playSound("buttonClick_mp3");var i=new Cmd.ChangeMatchGroupCmd_C;if(this.changeData_c&&(i=this.changeData_c),i.needAgree=this.permissionCheck.check?1:0,i.matchId=null!=this._changeMatchId?this._changeMatchId:0,i.clubType=this.teaCheck.check?2:this.teaGroupCheck.check?3:0,this.maxRoomNum){var n=Number(this.maxRoomNum.text);n&&(i.maxRoomNum=n)}if(this.minIntegarl){var o=Number(this.minIntegarl.text);o&&(i.minMatchPoint=o)}if(this.matchName&&(i.matchName=this.matchName.text),this.wechat&&(i.wechat=this.wechat.text),this.taxMin){var a=Number(this.taxMin.text);a>=0&&(i.taxMin=a)}if(this.taxPromote){var s=Number(this.taxPromote.text);s>=0&&(i.taxReward=s)}if(this.taxNum){var r=Number(this.taxNum.text);r>=0&&(i.taxNum=r)}this.thisRoomProps&&(i.createRoom=this.thisRoomProps),t.LobbyServerMJProxy.getInstance().sendData(i),this._changeMatchId=0,this.dispatchEventWith(t.LobbyUIEventConsts.CLOSE)},i.prototype.createHandle=function(e){uniLib.SoundMgr.instance.playSound("buttonClick_mp3");var i=this.editableText.text;Number(i);if(i&&6!=i.length){var n=new t.LobbyMsgBox(!1);return n.titleY=35,n.titleColor=0,n.msgColor=0,n.setData("温馨提示","您申请的包厢ID不合法，确定要继续吗？",["确定","取消"],[this.createMatchReq],this),void t.LobbyPopupManager.addPopUp(n,!0,!0)}this.createMatchReq()},i.prototype.setCreatReq=function(t){t&&(this._req=t)},i.prototype.backToCreat=function(e){this.dispatchEventWith(t.LobbyUIEventConsts.CLOSE)},i}(t.LobbyBaseVc);t.CreatMatchSetPanel=e,__reflect(e.prototype,"MJLobby.CreatMatchSetPanel")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function o(){var t=e.call(this)||this;return t.moveTime=500,t.goldGameConfList={},t.gameIdList=[],t.curSelectIndex=0,t.skinName=new GoldenSkin,t}return __extends(o,e),o.cleaInstance=function(){o.Instance.removeListener(),this.m_instance=null},Object.defineProperty(o,"Instance",{get:function(){return null==this.m_instance&&(this.m_instance=new o),this.m_instance},enumerable:!0,configurable:!0}),o.prototype.addListener=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.pokerList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onGameSelectClick,this),this.mahjongList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onGameSelectClick,this),uniLib.Global.addEventListener(uniLib.ZqEvent.USER_INFO,this.changeGold,this)
},o.prototype.removeListener=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.mahjongList.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onGameSelectClick,this),this.pokerList.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onGameSelectClick,this),uniLib.Global.removeEventListener(uniLib.ZqEvent.USER_INFO,this.changeGold,this)},o.prototype.Init=function(){this.addListener(),this.getGameConfData(),this.initGameData(),this.btnList.itemRenderer=i,this.changeGold(),this.curSelectIndex=0,this.mahjongGroup.scrollH=this.mahjongGroup.width,this.pokerGroup.scrollH=this.mahjongGroup.width,this.panelMask.visible=!1,this.updateUi(),0!=uniLib.Global.is_sandbox?(this.sc1.visible=this.sc2.visible=this.topGroup.visible=this.bg_1.visible=this.selectGroup.visible=!1,this.backButton.visible=this.curGameName.visible=!1,this.btnList.left=120):this.sc1.left=this.sc2.left=60*t.ScreenFixedUtils.instance.scaleFactor},o.prototype.updateUi=function(){this.helpButton.visible=!1},o.prototype.changeGold=function(){if(this.coinNum)if(uniLib.UserInfo.goldChips)if(uniLib.UserInfo.goldChips>=1e4){var t=(uniLib.UserInfo.goldChips/1e4).toFixed(2);this.coinNum.text=t+"万"}else this.coinNum.text=Math.floor(uniLib.UserInfo.goldChips).toString();else this.coinNum.text="0"},o.prototype.initGameData=function(){if(this.mahjongList.itemRenderer=n,this.pokerList.itemRenderer=n,this.gameIdList&&this.gameIdList.length>0){for(var t=[],e=[],i=0;i<this.gameIdList.length;i++){var o=this.gameIdList[i];this.checkIsPoker(o)?t.push(o):e.push(o)}this.mahjongList.dataProvider=new eui.ArrayCollection(e),this.pokerList.dataProvider=new eui.ArrayCollection(t),this.setCurGame(this.gameIdList[0]),this.checkIsPoker(this.gameIdList[0])?(this.pokerButton.selected=!0,this.pokerList.selectedIndex=0):(this.mahjongButton.selected=!0,this.mahjongList.selectedIndex=0)}},o.prototype.onGameSelectClick=function(t){uniLib.SoundMgr.instance.playSound("buttonClick_mp3");var e=0;e=t.target==this.mahjongList?this.mahjongList.selectedItem:this.pokerList.selectedItem,this.setCurGame(e)},o.prototype.setCurGame=function(e){if(this.curGameName.text=t.MJLobbyData.getInstance().getGameCreateConfig(e).gameName,this.curGameId=e,this.checkIsPoker(e)?this.mahjongList.selectedItem=0/0:this.pokerList.selectedItem=0/0,this.goldGameConfList[e]&&this.goldGameConfList[e]instanceof Array){for(var i=this.goldGameConfList[e],n=new eui.ArrayCollection,o=function(t){var e=null,o=null,s=null,r=null,h=0,c=i[t];if(a.goldRoomData&&a.goldRoomData instanceof Array){var l=a.goldRoomData.first(function(t){return t.matchId==c.id});l&&(e=l.bottomPoint,o=l.enteringPoint,r=l.curUserNbr,s=l.leavingPoint,h=1)}n.addItem({matchId:c.id,level:c.level,userNum:r,bottomPoint:e,enteringPoint:o,leavingPoint:s,isOpen:h})},a=this,s=0;s<i.length;s++)o(s);this.btnList.dataProvider=n}},o.prototype.getGameConfData=function(){if(this._tableOfficalEventConfig=t.MJLobbyData.prototype.getGameOfficeEventConfigByLobbyId(t.MJLobbyData.getInstance().lobbyId),this._tableOfficalEventConfig)for(var e=0,i=this._tableOfficalEventConfig;e<i.length;e++){var n=i[e];if(n.gameId&&0!=n.isOpen){var o=n.gameId[0];if(o){var a=t.MJLobbyData.getInstance().getGameCreateConfig(o);if(!uniLib.Global.isH5&&2==a.hide)continue;if(!uniLib.Global.isH5&&1==a.hide&&0==t.MJLobbyData.getInstance().isAgent)continue;this.goldGameConfList[o]||(this.goldGameConfList[o]=[]),this.gameIdList||(this.gameIdList=[]),-1==this.gameIdList.indexOf(o)&&this.gameIdList.push(o),this.goldGameConfList[o].push(n)}}}},o.prototype.setData=function(t){t&&t instanceof Array&&(this.goldRoomData=t),this.Init()},o.prototype.checkIsPoker=function(t){if(this.gameListJson||(this.gameListJson=RES.getRes("gameList_json")),!this.gameListJson)return!1;var e=this.gameListJson.first(function(e){return e.gameId==t});return e?e.isPoker:!1},o.prototype.onClick=function(e){e.target instanceof eui.Button&&uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),e.target==this.mahjongButton?1==this.curSelectIndex?this.refreshSelectGamePanel(0):this.refreshSelectGamePanel(1):e.target==this.pokerButton?2==this.curSelectIndex?this.refreshSelectGamePanel(0):this.refreshSelectGamePanel(2):e.target==this.panelMask||e.target==this.closeMj||e.target==this.closePk?this.refreshSelectGamePanel(0):e.target==this.backButton?(o.m_instance.parent&&t.LobbyPopupManager.removePopUp(o.Instance),this.removeListener()):e.target==this.buyCoinButton&&t.PublicMethed.showOfficialNumPanel()},o.prototype.refreshSelectGamePanel=function(t){o.Instance.removeListener(),this.curSelectIndex=t;var e=0,i=0;0==t?(e=this.mahjongGroup.width,i=this.pokerGroup.width,this.panelMask.visible=!1):1==t?(i=this.pokerGroup.width,this.panelMask.visible=!0,this.mahjongGroup.parent&&(this.mahjongGroup.parent.visible=!0)):2==t&&(e=this.mahjongGroup.width,this.panelMask.visible=!0,this.pokerGroup.parent&&(this.pokerGroup.parent.visible=!0)),egret.Tween.get(this.mahjongGroup).to({scrollH:e},this.moveTime),egret.Tween.get(this.pokerGroup).to({scrollH:i},this.moveTime).call(this.afterSelected)},o.prototype.afterSelected=function(){var t=o.Instance;t.addListener(),t.mahjongGroup.parent&&(t.mahjongGroup.parent.visible=1!=t.curSelectIndex?!1:!0),t.pokerGroup.parent&&(t.pokerGroup.parent.visible=2!=t.curSelectIndex?!1:!0)},o}(t.BaseComponent);t.GoldenPanel=e,__reflect(e.prototype,"MJLobby.GoldenPanel");var i=function(e){function i(){var t=e.call(this)||this;return t.skinName=new GoldBtnSkin,t.addEventListener(egret.TouchEvent.TOUCH_TAP,t.joinEvent,t),t}return __extends(i,e),i.prototype.dataChanged=function(){var t=this.data;this.matchId=t.matchId,0==t.level?this._enterbg.source="coin_diban":1==t.level?this._enterbg.source="coin_zhongji":2==t.level&&(this._enterbg.source="coin_gaoji"),1!=t.isOpen&&(this.currentState="disable",this.enabled=!1);var e=null==t.bottomPoint?1e3:t.bottomPoint>1e4?Math.floor(t.bottomPoint/1e4).toFixed(2)+"万":t.bottomPoint;this._bottomPoint.text=""+e;var i=null==t.enteringPoint?1e3:t.enteringPoint>1e4?Math.floor(t.enteringPoint/1e4).toFixed(2)+"万":t.enteringPoint;this._enterPoint.text=i+"以上",this.userNum.text=t.userNum?t.userNum:"0"},i.prototype.joinEvent=function(){uniLib.SoundMgr.instance.playSound("buttonClick_mp3");var e=new Cmd.EnterRoomCmd_C;console.error("GoldenPanel"),e.roomId=this.matchId,t.LobbyServerMJProxy.getInstance().sendData(e)},i}(eui.ItemRenderer);t.GoldenItem=i,__reflect(i.prototype,"MJLobby.GoldenItem");var n=function(e){function i(){var t=e.call(this)||this;return t.skinName=new Mj_CheckBox,t}return __extends(i,e),i.prototype.dataChanged=function(){var e=this.data;e&&(this.gameId=e,this.gameName.text=t.MJLobbyData.getInstance().getGameCreateConfig(e).gameName)},i}(eui.ItemRenderer);t.GameCheckBox=n,__reflect(n.prototype,"MJLobby.GameCheckBox")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i._isPyq=!1,i.codeVersion=13,i.skinName=new LobbySharePanelSkin,i.changeSkin(),i.addListener(),t.MJLobbyData.getInstance().hasXianLiao&&i.setPosition(),t.DataManage.DownloadUrl&&(i.downloadUrl1=i.downloadUrl2=i.downloadUrl3=t.DataManage.DownloadUrl),""!=uniLib.ZQGameSdk.defaultWXShareVo.webpageUrl&&(i.downloadUrl1=i.downloadUrl2=i.downloadUrl3=uniLib.ZQGameSdk.defaultWXShareVo.webpageUrl),i}return __extends(i,e),i.prototype.changeSkin=function(){},i.prototype.setPosition=function(){this._xlIcon.visible=this._xlimg.visible=!0,this._wXinIcon.x=217,this._pyqIcon.x=this._wXinIcon.x+179,this._xlIcon.x=this._pyqIcon.x+179,this._pyqIcon.y=this._wXinIcon.y=this._xlIcon.y=295,this._wximg.y=this._pyqimg.y=this._xlimg.y=515,this._wximg.horizontalCenter=-331,this._pyqimg.horizontalCenter=-150,this._xlimg.horizontalCenter=22.5},i.prototype.destory=function(){this._wXinIcon.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShare,this),this._pyqIcon.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShare,this),this._xlIcon.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onXianShare,this),this.closeButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.closeHandle,this),this.downloadBtn1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.showDownload,this),this.downloadBtn2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.showDownload,this),this.downloadBtn3.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.showDownload,this)},i.prototype.addListener=function(){this._wXinIcon.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShare,this),this._pyqIcon.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShare,this),this._xlIcon.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onXianShare,this),this.closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeHandle,this),this.downloadBtn1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showDownload,this),this.downloadBtn2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showDownload,this),this.downloadBtn3.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showDownload,this)},i.prototype.onXianShare=function(){t.PublicMethed.DoShare(1,1,this.shareBack,this,null,!0)},i.prototype.shareDebug=function(){var e=uniLib.BrowersUtils.getLocationUrl().split("?")[0]+"?debug=true&cacheToken=false&uid=",i=qr.QRCode.create(e,300,300,qr.QRErrorCorrectLevel.M,7),n=function(e){var i=e.target;i.removeEventListener(t.LobbyUIEventConsts.CLOSE,n,i),t.LobbyPopupManager.removePopUp(i,!1,!0)};i.addEventListener(t.LobbyUIEventConsts.CLOSE,n,i),t.LobbyPopupManager.addPopUp(i,!0,!0,!1,300,300,!0)},i.prototype.onShare=function(e){if(uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),uniLib.Global.debugLevel>0)return void this.shareDebug();var i=0;e.currentTarget==this._wXinIcon?(i=0,this._isPyq=!1):(i=1,this._isPyq=!0);var n="http://h5.publish.66yy99.cn/Mahjong.jx/shareimg/"+t.MJLobbyData.getInstance().lobbyId+".jpg";t.PublicMethed.DoShare(2,i,this.shareBack,this,n)},i.prototype.shareCode=function(){var e=this,i=new egret.Bitmap,n="http://h5.publish.66yy99.cn/Mahjong.jx/shareimg/lobby_share_"+t.MJLobbyData.getInstance().lobbyId+".jpg";RES.getResByUrl(n,function(n){if(n){var o=new egret.DisplayObjectContainer;if(uniLib.Global.isH5&&t.LobbyPopupManager.addPopUp(o),i.texture=n,o.addChild(i),""==uniLib.ZQGameSdk.defaultWXShareVo.webpageUrl&&t.LobbyDataCache.bundleInfo&&t.LobbyDataCache.bundleInfo.weixin.wbappid){var a=t.MJLobbyData.getInstance().myBaseInfo.nickName;a.length>8&&(a=a.slice(0,8));var s="https://open.weixin.qq.com/connect/oauth2/authorize?appid="+t.LobbyDataCache.bundleInfo.weixin.wbappid+"&redirect_uri=http://"+t.PublicMethed.wxShareUrl+"/addons/zqgame/gameshare.php?appid="+t.LobbyDataCache.bundleInfo.weixin.wbappid+"&response_type=code&scope=snsapi_base&state="+uniLib.CompressUtil.base64encode(t.MJLobbyData.getInstance().myBaseInfo.uid+"|0|"+a)+"&connect_redirect=1#wechat_redirect";if(s){var r=qr.QRCode.create(s,350,350,qr.QRErrorCorrectLevel.M,e.codeVersion);console.error(r),o.addChild(r),r.x=185,r.y=730;var h=new uniLib.WXShareVo,c=new egret.Bitmap(uniLib.DisplayUtils.catchScreenToTex(o,new egret.Rectangle(0,0,720,1280),.75));h.shareImageData=uniLib.DisplayUtils.catchScreen(c,new egret.Rectangle(0,0,c.width,c.height)),uniLib.Global.dispatchEvent(uniLib.ZqEvent.SHARE,h,!1)}}else{var s=uniLib.ZQGameSdk.defaultWXShareVo.webpageUrl+"?uid="+t.MJLobbyData.getInstance().myBaseInfo.uid+"&nickName="+t.MJLobbyData.getInstance().myBaseInfo.nickName;if(s){var r=qr.QRCode.create(s,350,350,qr.QRErrorCorrectLevel.M,e.codeVersion);console.error(r),o.addChild(r),r.x=185,r.y=730;var h=new uniLib.WXShareVo,c=new egret.Bitmap(uniLib.DisplayUtils.catchScreenToTex(o,new egret.Rectangle(0,0,720,1280),.75));h.shareImageData=uniLib.DisplayUtils.catchScreen(c,new egret.Rectangle(0,0,c.width,c.height)),uniLib.Global.dispatchEvent(uniLib.ZqEvent.SHARE,h,!1)}}}else t.LobbyPopupManager.showMildWarnShow("分享图片资源获取失败,请稍后重试!")},this,RES.ResourceItem.TYPE_IMAGE)},i.prototype.shareBack=function(e){e&&(0==e.code&&this.dispatchEventWith(t.LobbyUIEventConsts.SHARE_SUCCESS),egret.Tween.get(this).wait(100).call(t.PublicMethed.delayShareBack,this,[e.code]))},i.prototype.closeHandle=function(e){uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),this.dispatchEventWith(t.LobbyUIEventConsts.CLOSE)},i.prototype.showDownload=function(e){this.changedownloadUrl(),e.target==this.downloadBtn1?(uniLib.ZQGameSdk.nativeCopyStr(this.downloadUrl1),t.LobbyPopupManager.showMildWarnShow("复制成功")):e.target==this.downloadBtn2?(uniLib.ZQGameSdk.nativeCopyStr(this.downloadUrl2),t.LobbyPopupManager.showMildWarnShow("复制成功")):e.target==this.downloadBtn3&&(uniLib.ZQGameSdk.nativeCopyStr(this.downloadUrl3),t.LobbyPopupManager.showMildWarnShow("复制成功"))},i.prototype.changedownloadUrl=function(){},i}(eui.Component);t.LobbySharePanel=e,__reflect(e.prototype,"MJLobby.LobbySharePanel")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.skinName=new LobbySkin,t.initUI(),t.addListener(),i.m_instance=t,t}return __extends(i,e),i.prototype.addListener=function(){this.bindPhoneButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this),this.certificationButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this),this.shareButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this),this.messageButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this),this.noticeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this),this.buyDiamondButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this),this.buyCoinButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this),this.headBg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this),this.idLabel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this),uniLib.Global.addEventListener(uniLib.ZqEvent.USER_INFO,this.onUserInfoChanged,this),this.createBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this),this.joinBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this),this.coinBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this),this.sijuBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this),this.rankButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this),this.clubBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this),this.redpacketButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this)},i.prototype.removeListener=function(){this.shareButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this),this.messageButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this),this.bindPhoneButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this),this.certificationButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this),this.noticeButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this),this.buyCoinButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this),this.sijuBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this),this.buyDiamondButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this),this.headBg.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this),this.idLabel.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this),uniLib.Global.removeEventListener(uniLib.ZqEvent.USER_INFO,this.onUserInfoChanged,this),this.joinBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this),this.createBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this),this.coinBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this),this.clubBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this),this.rankButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this),this.redpacketButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this)},i.prototype.destory=function(){this.agentMenu&&(this.agentMenu.onRemove(),this.agentMenu=null),this.removeListener()},i.prototype.initUI=function(){var e=this.headBg;e.touchEnabled=!0,this._headMc=new t.LobbyHeadMc(e.width-5,e.height-5),this._headMc.x=e.x+(e.width-this._headMc.width)/2,this._headMc.y=e.y+(e.height-this._headMc.height)/2,e.parent.addChildAt(this._headMc,0),this._headMc.mask=this.headMask,this._headMc.touchEnabled=!1,t.MJLobbyData.getInstance().myBaseInfo&&this.showUserInfo(t.MJLobbyData.getInstance().myBaseInfo),0==uniLib.Global.is_sandbox?(this._sysMsgVc=new t.SysMsgMc,this.sysGroup.addChild(this._sysMsgVc),this._sysMsgVc.touchEnabled=!1,this.agentMenu||(this.agentMenu=new t.LobbyAgentMenuPanel,this.agentMenu.x=-1,this.agentMenu.y=88,this.addChild(this.agentMenu)),t.LobbyMailPanel.Instance.requestMailList()):(this.buyCoinButton.visible=this.buyDiamondButton.visible=!1,this.buttonGroup.visible=!1,this.messageButton.visible=this.shareButton.visible=this.bindPhoneButton.visible=!1,this.idLabel.visible=!1,this.rankButton.visible=this.noticeButton.visible=!1,this.certificationButton.visible=!1),129==uniLib.Global.platId&&(this.bindPhoneButton.visible=!1),this.onUserInfoChanged(),0==uniLib.Global.is_sandbox&&this.updateUI()},i.prototype.updateUI=function(){},i.prototype.updateAgentMenu=function(){this.agentMenu&&this.agentMenu.initUI()},i.prototype.showUnReadNum=function(t){t=null!=t&&t instanceof Array&&t.length>0?t:[];var e=this.messageButton.readPoint,i=t.length;e.visible=!1;for(var n=0;i>n;n++)if(t[n].state==Cmd.MailInfo.State.UnRead&&e)return void(e.visible=!0)},i.prototype.showMailPanel=function(){t.LobbyMailPanel.Instance.addListener(),t.LobbyMailPanel.Instance.updataInfor(t.Mail.Instance.mailList),t.LobbyPopupManager.addPopUp(t.LobbyMailPanel.Instance,!0,!0,!1)},i.prototype.onBtnClick=function(e){switch(uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),e.target){case this.noticeButton:this.onShowNotice();break;case this.createBtn:this.showCreatePanel();break;case this.buyDiamondButton:case this.buyCoinButton:this.onShowMarket(e);break;case this.headBg:this.showUserInfoPanel();break;case this.idLabel:this.onIdClickTap();break;case this.joinBtn:this.showJoinPanel();break;case this.coinBtn:this.onToCoin();break;case this.sijuBtn:this.dispatchEventWith(t.LobbyUIEventConsts.ROOM_MANAGE);break;case this.rankButton:this.onShowRankInfo();break;case this.clubBtn:this.onClubTap();break;case this.bindPhoneButton:this.onShowBindPanel();break;case this.certificationButton:this.showCertificationPanel();break;case this.messageButton:this.showMailPanel();break;case this.shareButton:this.dispatchEventWith(t.LobbyUIEventConsts.SHOW_SHARE);break;case this.redpacketButton:this.showRedpacket()}},i.prototype.showRedpacket=function(e){var i=new Cmd.GetRedPackRewardInfoLobbyCmd_C;i.lobbyId=t.MJLobbyData.getInstance().lobbyId,t.NetMgr.tcpSend(i),uniLib.UIMgr.instance.showLoadingTimeout(LoadSecondPanel,"redpacket")},i.prototype.onShowBindPanel=function(){this.dispatchEventWith(t.LobbyUIEventConsts.SHOW_VIP)},i.prototype.showCertificationPanel=function(){this.dispatchEventWith(t.LobbyUIEventConsts.LOBBY_SHOW_LOTTERY)},i.prototype.onShowNotice=function(){this.dispatchEventWith(t.LobbyUIEventConsts.SHOW_NOTICE)},i.prototype.onShowRankInfo=function(){this.dispatchEventWith(t.LobbyUIEventConsts.CLICK_RANKBTN)},i.prototype.onClubTap=function(){this.dispatchEventWith(t.LobbyUIEventConsts.SHOW_CLUB)},i.prototype.onToCoin=function(){this.dispatchEventWith(t.LobbyUIEventConsts.COIN_SELECT_GAMEID)},i.prototype.onMathchTap=function(){t.LobbyPopupManager.showMildWarnShow("敬请期待！")},i.prototype.onTGY=function(){this.dispatchEventWith(t.LobbyUIEventConsts.SHOW_TGY)},i.prototype.onUserInfoChanged=function(t){this.diamondLabel&&uniLib.UserInfo.chips&&(this.diamondLabel.text=uniLib.UserInfo.chips.toFixed(1).toString()),this.changeCoin()},i.prototype.changeCoin=function(){if(this.coinLabel)if(uniLib.UserInfo.goldChips)if(uniLib.UserInfo.goldChips>=1e4){var t=(uniLib.UserInfo.goldChips/1e4).toFixed(2);this.coinLabel.text=t+"万"}else if(uniLib.UserInfo.goldChips>=1e5){var t=(uniLib.UserInfo.goldChips/1e4).toFixed(1);this.coinLabel.text=t+"万"}else this.coinLabel.text=Math.floor(uniLib.UserInfo.goldChips).toString();else this.coinLabel.text="0"},i.prototype.onShowMarket=function(e){e.target==this.buyCoinButton?t.PublicMethed.showOfficialNumPanel():this.dispatchEventWith(t.LobbyUIEventConsts.SHOW_MARKET,!1,!0)},i.prototype.onIdClickTap=function(){uniLib.ZQGameSdk.nativeCopyStr(this.idLabel.text),1!=uniLib.Global.is_sandbox&&t.LobbyPopupManager.showMildWarnShow("id复制成功"+this.idLabel.text)},i.prototype.showUserInfoPanel=function(){var e=new Cmd.GetPersonalPanel_C;e.uid=uniLib.NetMgr.UID,t.LobbyServerMJProxy.getInstance().sendData(e),this.dispatchEventWith(t.LobbyUIEventConsts.SHOW_USERINFO)},i.prototype.showCreatePanel=function(){this.dispatchEventWith(t.LobbyUIEventConsts.SHOW_CREATE_PANEL,!1,!1)},i.prototype.showJoinPanel=function(){this.dispatchEventWith(t.LobbyUIEventConsts.SHOW_JOIN_PANEL)},i.prototype.initLobby=function(){this.showUserInfo(t.MJLobbyData.getInstance().myBaseInfo)},i.prototype.showUserInfo=function(t){2==uniLib.Global.is_sandbox&&(this.buyDiamondButton.visible=!1),this._headMc.headUrl=t.headUrl,this.nameLabel=t.nickName,this.nameLabelText.TextImageData=Emoji.toCodePoint(this.nameLabel),this.nameLabelText.textColor=16777215,this.nameLabelText.size=25,this.idLabel.text="ID:"+t.uid,uniLib.UserInfo.chips&&(this.diamondLabel.text=uniLib.UserInfo.chips.toFixed(1).toString())},i.prototype.updateUserInfo=function(t){t.uid==uniLib.NetMgr.UID&&(t.headUrl&&(this._headMc.headUrl=t.headUrl),t.nickName&&(this.nameLabel=t.nickName,this.nameLabelText.TextImageData=Emoji.toCodePoint(this.nameLabel),this.nameLabelText.textColor=16777215,this.nameLabelText.size=25))},i.prototype.updateBtnStatus=function(t){this.createBtn.visible=this.joinBtn.visible=t},i}(t.BaseComponent);t.MJLobbyVc=e,__reflect(e.prototype,"MJLobby.MJLobbyVc")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function o(){var t=e.call(this)||this;return t.matchTableCount=3,t.state=0,t.autoStartGame=["拼三张","拼十"],t.matchIdList=[],t.payType=0,t.lastRefreshTime=0,t.teaHouseIdList=[],o.Instanc=t,t.skinName=new HouseTablePanelSkin,t.initUI(),t}return __extends(o,e),Object.defineProperty(o.prototype,"userNbr",{get:function(){return this._userNbr?this._userNbr:0},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"isAutoGame",{get:function(){return-1!=this.autoStartGame.indexOf(this.gameName)},enumerable:!0,configurable:!0}),o.prototype.initUI=function(){this.addListener(),this.setHeadMask(),this.quitBtn.visible=!1,this.updateUI(),1!=t.MJLobbyData.getInstance().fundType&&(this.fundNum.visible=this.fundBg.visible=!1)},o.prototype.updateUI=function(){},o.prototype.destory=function(){this.removeListener(),this.matchTableList.dataProvider=new eui.ArrayCollection(null)},o.prototype.addListener=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.UIHandle,this),uniLib.Global.addEventListener(uniLib.ZqEvent.EVENT_ACTIVE_SOCKET_CACHE_OK,this.reqRefresh,this),this.teaGroupList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onteaHosueListTap,this),egret.MainContext.instance.stage.addEventListener(egret.Event.DEACTIVATE,this.deactivate,this)},o.prototype.removeListener=function(){egret.MainContext.instance.stage.removeEventListener(egret.Event.DEACTIVATE,this.deactivate,this),this.teaGroupList.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onteaHosueListTap,this),uniLib.Global.removeEventListener(uniLib.ZqEvent.EVENT_ACTIVE_SOCKET_CACHE_OK,this.reqRefresh,this),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.UIHandle,this)},o.prototype.deactivate=function(){this.lastRefreshTime=Date.now()},o.prototype.getMasterId=function(){return this.masterId},o.prototype.setHeadMask=function(){var t=new egret.Shape;t.graphics.beginFill(255),t.graphics.drawCircle(this.headGroup.width/2,this.headGroup.height/2,37),t.graphics.endFill(),this.headGroup.addChild(t),this.headGroup.mask=t},o.prototype.getMatchName=function(){return this.matchName},o.prototype.onteaHosueListTap=function(e){this.quitMatchRoom();var i=new Cmd.ClearCurMatchGroupCmd_C;i.matchId=this.curMatchId,t.LobbyServerMJProxy.getInstance().sendData(i);var n=new Cmd.EnterRoomCmd_C;n.roomId=this.teaHouseIdList[this.teaGroupList.selectedIndex],this.teaListButton.label=this.teaHouseIdList[this.teaGroupList.selectedIndex]+"",t.LobbyServerMJProxy.getInstance().sendData(n),t.NetMgr.setMsgTimeout(5,"EnterRoomCmd_C"),this.onMenuClose()},Object.defineProperty(o.prototype,"selectMatchId",{get:function(){return this.curMatchId},enumerable:!0,configurable:!0}),o.prototype.initOtherTeaData=function(t){t&&(this.matchIdList=[],this.teaHouseIdList=t.matchIdList&&t.matchIdList instanceof Array?t.matchIdList:[],this.fundNum.text=t.matchPoint?"当前基金："+t.matchPoint:"",this.fundBg.visible=t.matchPoint?!0:!1,this.teaName.text=t.nickName,this.payType=t.payType,this.teaType=2,","==t.shareInfo.content.substring(t.shareInfo.content.length-1)?this.playRule.text=t.shareInfo.title+":"+t.shareInfo.content.substring(0,t.shareInfo.content.length-1):this.playRule.text=t.shareInfo.title+":"+t.shareInfo.content,this.updataDetails(t?t:null),this.updateState(t.state),this.updataMatchList())},o.prototype.checkUserHeadCallBack=function(t){return!0},o.prototype.updataDetails=function(e){var i=this;this.fundNum.text=e.matchPoint?"当前基金："+e.matchPoint:"",this.fundBg.visible=e.matchPoint?!0:!1,this.takeInfo(e.shareInfo),this.gameId=e.gameId?e.gameId:0,this.gameNbr=e.gameNbr;var n=t.MJLobbyData.getInstance().getGameCreateConfig(this.gameId).gameName;if(this.gameName=n&&""!=n?n:"",this.refreshBtn.visible=this.isAutoGame,this.matchIdLabel.text="ID:"+(e?e.matchId:""),this.teaListButton.label=e?e.matchId+"":"",e&&e.matchId){var o=t.MatchManagePanel.Instanc.isTeahouseID(e.matchId);this.matchIdLabel.visible=!o,this.teaListButton.visible=o}else this.matchIdLabel.visible=!0,this.teaListButton.visible=!1;this.masterId=e.ownerid,this.wechatNum=e.wechat?e.wechat:"",this.matchName=e.nickName?e.nickName:"",t.HeadMcManager.instanc.getUserHeadByUid(e.ownerid,this,function(t){t&&(i.headMc.source=t)});var a=e&&e.roomList instanceof Array?e.roomList:[];a.length?this.roomList=a:this.roomList=[],this.updataTableList(),this.curMatchId=e?e.matchId:null,this._userNbr=e?e.userNbr:0},o.prototype.updateState=function(t){null==t&&(t=0),this.masterId==uniLib.NetMgr.UID&&(t=2),this.state=t,0==t?(this.applyBtn.visible=!0,this.applyWait.visible=!1):1==t?(this.applyBtn.visible=!1,this.applyWait.visible=!0):2==t&&(this.applyBtn.visible=!1,this.applyWait.visible=!1)},o.prototype.updataTableList=function(){this.matchTableList.itemRenderer=n;var e=[];this.isAutoGame?this.matchTableCount=1:this.matchTableCount=3;for(var i=function(t){var i=a.roomList.first(function(e){return e.roomId==t+1});i?a.roomList.remove(i):i={roomId:t+1},i.list&&i.list.length?-1!=i.list.find(function(t){return t.uid==uniLib.NetMgr.UID})&&1!=a.teaType&&(a.isJoin=!0):i.list=[],e.push(i)},a=this,s=0;s<this.matchTableCount;s++)i(s);this.roomList=e.concat(this.roomList),e=[];for(var s=this.roomList.length;20>s;s++)e.push({roomId:s+1});this.roomList=this.roomList.concat(e),this.tableCollect=new eui.ArrayCollection(this.roomList),this.matchTableList.dataProvider=this.tableCollect;var r=this.roomList.filter(function(t){return t.list&&t.list.length});this.tabelCount.text=r.length+"/20";for(var h=[],s=0;s<r.length;s++)if(r[s].list[0])for(var c=r[s].list,l=0;l<c.length;l++)t.LobbyDataCache.getHeadUrlByUid(c[l].uid)||h.push(c[l].uid);h.length>0&&t.HeadMcManager.instanc.requestHeadurl(h),this.playingRoomList=o.Instanc.roomList.filter(function(t){return t.roomId>20&&!t.endTime})},o.prototype.removeItems=function(){this.matchTableList.dataProvider=new eui.ArrayCollection(null)},o.prototype.takeInfo=function(e){if(e){this.shareInfo=e;var i=this.shareInfo.content.split(",");this.playTypes=i[1].split(" "),this.playTypes=this.playTypes.filter(function(t){return"玩法"!=t}),this.shareInfo.content=i.join(),-1!=this.shareInfo.content.indexOf("GPS防作弊")&&t.DataManage.getLocation()}},o.prototype.quitMatchRoom=function(){var e=new Cmd.LeaveMatchGroupCmd_C;t.LobbyServerMJProxy.getInstance().sendData(e)},o.prototype.checkIsMatch=function(t){if(!this.roomList||this.roomList.length<=0)return null;for(var e=0;e<this.roomList.length;e++)if(this.roomList[e]&&this.roomList[e].list instanceof Array&&-1!=this.roomList[e].list.find(function(e){return e.uid==t})&&2!=this.roomList[e].state&&!this.roomList[e].endTime)return this.roomList[e];return null},o.prototype.getMaxUserRoom=function(){if(!this.roomList||this.roomList.length<=0)return null;for(var t=null,e=0;e<this.roomList.length;e++){var i=void 0;i=this.roomList[e],2==i.state||i.endTime||(t?i.list instanceof Array&&i.list.length>0&&(t.list&&t.list instanceof Array&&!(t.list.length<i.list.length)||(t=i)):t=i)}return t},o.prototype.onClose=function(){var e=new Cmd.ClearCurMatchGroupCmd_C;e.matchId=this.curMatchId,t.LobbyServerMJProxy.getInstance().sendData(e),this.dispatchEventWith(t.LobbyUIEventConsts.CLOSE)},o.prototype.UIHandle=function(e){if(e.target instanceof eui.Button&&uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),e.target==this.backBtn)this.onBack();else if(e.target==this.quitBtn)this.quitMatchRoom();else if(e.target==this.applyBtn)this.onApply();else if(e.target==this.shareBtn)this.showSharePanel();else if(e.target==this.refreshBtn)this.refreshTable();else if(e.target==this.rankButton)this.reqRankData();else if(e.target==this.promoteBtn)this.reqPromoteReward();else if(e.target==this.openAudienceListBtn)this.onshowAudienceList();else if(e.target==this.teaListButton)this.showMenu();else if(e.target==this.myDataBtn){var i=new Cmd.MyPlayedDataMatchGroupCmd_C;i.matchId=this.selectMatchId,t.LobbyServerMJProxy.getInstance().sendData(i)}else if(e.target==this.cloudRecordBtn){var i=new Cmd.RequestBookingUrlMatchGroupCmd_CS;i.matchId=this.curMatchId,i.lobbyId=t.MJLobbyData.getInstance().lobbyId,t.LobbyServerMJProxy.getInstance().sendData(i)}else this.onMenuClose()},o.prototype.onshowAudienceList=function(){var e=new Cmd.RecentVisitListMatchGroupCmd_C;e.matchId=this.curMatchId,t.LobbyServerMJProxy.getInstance().sendData(e),t.LobbyPopupManager.addPopUp(t.AudienceListPanel.instace,!0,!0),t.AudienceListPanel.instace.shareInfo=this.shareInfo,t.AudienceListPanel.instace.gameName=this.gameName,t.AudienceListPanel.instace.userNbrStr=this.getUserNbrStr()},o.prototype.refreshTable=function(){var e=new Cmd.EnterMatchGroupCmd_C;e.matchId=o.Instanc.selectMatchId,e.lobbyId=t.MJLobbyData.getInstance().lobbyId,e.roomId=100,t.LobbyServerMJProxy.getInstance().sendData(e),t.NetMgr.setMsgTimeout(5,"EnterMatchGroupCmd_C")},o.prototype.reqPromoteReward=function(){var e=this.getUserNbrStr();this.dispatchEventWith("show_promote",!1,{matchId:o.Instanc.selectMatchId,matchName:o.Instanc.matchName,wechat:this.wechatNum,extenStr:e,shareInfo:o.Instanc.shareInfo});var i=new Cmd.TaxRewardMatchRoomCmd_C;i.matchId=this.curMatchId,t.LobbyServerMJProxy.getInstance().sendData(i),t.NetMgr.setMsgTimeout(5,"TaxRewardMatchRoomCmd_C")},o.prototype.onApply=function(){var e=new t.MvcSender,i=new Cmd.EnterMatchGroupCmd_C;i.matchId=o.Instanc.selectMatchId,i.lobbyId=t.MJLobbyData.getInstance().lobbyId,e.sendNotification(t.MahJongLobbyFacadeConsts.SEND_DATA,i,t.LobbyDataRequestCommand.GAME_DATA),t.NetMgr.setMsgTimeout(5,"EnterMatchGroupCmd_C"),this.updateState(1)},o.prototype.onBack=function(){var e=this,i=function(){e.quitMatchRoom(),e.onClose()};if(this.isJoin){var n=new t.MatchMsgBox;n.setData("","关闭界面您将退出已加入牌桌，确定要退出吗？",["确定","取消"],[i]),t.LobbyPopupManager.addPopUp(n,!0,!0)}else e.onClose()},o.prototype.onShare=function(){var e=o.Instanc.selectMatchId,i=new uniLib.WXShareVo;if(i.shareWay=0,""==uniLib.ZQGameSdk.defaultWXShareVo.webpageUrl&&t.LobbyDataCache.bundleInfo&&t.LobbyDataCache.bundleInfo.weixin.wbappid){var n=t.MJLobbyData.getInstance().myBaseInfo.nickName;n.length>8&&(n=n.slice(0,8)),i.webpageUrl="https://open.weixin.qq.com/connect/oauth2/authorize?appid="+t.LobbyDataCache.bundleInfo.weixin.wbappid+"&redirect_uri=http://"+t.PublicMethed.wxShareUrl+"/addons/zqgame/gameshare.php?appid="+t.LobbyDataCache.bundleInfo.weixin.wbappid+"&response_type=code&scope=snsapi_base&state="+uniLib.CompressUtil.base64encode(t.MJLobbyData.getInstance().myBaseInfo.uid+"|"+e+"|"+n)+"&connect_redirect=1#wechat_redirect"
}else i.webpageUrl=uniLib.ZQGameSdk.defaultWXShareVo.webpageUrl+"?uid="+t.MJLobbyData.getInstance().myBaseInfo.uid+"&nickName="+t.MJLobbyData.getInstance().myBaseInfo.nickName;var a=o.Instanc.shareInfo;i.title=a&&a.title?a.title:"";var s=this.getUserNbrStr();i.description=a&&a.content?a.content+s:"",t.MJLobbyData.getInstance().hasXianLiao?(i.roomId=JSON.stringify({matchId:e}),uniLib.Global.dispatchEvent(uniLib.ZqEvent.SHARE,i,!0)):uniLib.ZQGameSdk.share(i,null,this)},o.prototype.getUserNbrStr=function(){var t="",e=0,i=this.checkIsMatch(uniLib.NetMgr.UID),n=i?i:this.getMaxUserRoom();return e=n.list instanceof Array?n.list.length:0,t=e+"缺"+(o.Instanc.userNbr-e)},o.prototype.reqRankData=function(e){var i=new Cmd.OrderListMatchGroupCmd_C;e&&e.data&&(i.day=Number(e.data)),i.matchId=this.curMatchId,t.LobbyServerMJProxy.getInstance().sendData(i),t.NetMgr.setMsgTimeout(5,"OrderListMatchGroupCmd_C")},o.prototype.showRank=function(e){this.rankPanel||(this.rankPanel=new t.ClubRankPanel,this.rankPanel.addEventListener(egret.Event.CLOSE,this.removeRank,this),this.rankPanel.addEventListener(t.LobbyUIEventConsts.CLICK_RANKBTN,this.reqRankData,this),this.addChild(this.rankPanel),this.rankPanel.showPanel()),this.rankPanel.setDate(e)},o.prototype.removeRank=function(){this.rankPanel&&(this.rankPanel.removeEventListener(t.LobbyUIEventConsts.CLICK_RANKBTN,this.reqRankData,this),this.rankPanel.removeEventListener(egret.Event.CLOSE,this.removeRank,this),uniLib.DisplayUtils.removeAllChildren(this.rankPanel),uniLib.DisplayUtils.removeFromParent(this.rankPanel),this.rankPanel=null)},o.prototype.showSharePanel=function(){this.sharePanel||(this.sharePanel=new t.ClubSharePanel,this.sharePanel.addEventListener(egret.Event.CLOSE,this.removeSharePanel,this),this.addChild(this.sharePanel),this.sharePanel.showPanel())},o.prototype.removeSharePanel=function(){this.sharePanel&&(this.sharePanel.removeEventListener(egret.Event.CLOSE,this.removeSharePanel,this),uniLib.DisplayUtils.removeAllChildren(this.sharePanel),uniLib.DisplayUtils.removeFromParent(this.sharePanel),this.sharePanel=null)},o.prototype.reqRefresh=function(){if(this.curMatchId&&this.parent&&!t.MJLobbyData.getInstance().isGameLoading&&!uniLib.Global.isInGame){var e=Date.now();if(this.lastRefreshTime>0&&e-this.lastRefreshTime>5e3){var i=new Cmd.EnterRoomCmd_C;i.roomId=this.curMatchId,t.LobbyServerMJProxy.getInstance().sendData(i),t.NetMgr.setMsgTimeout(5,"EnterRoomCmd_C"),this.lastRefreshTime=0}}},o.prototype.updataRoomList=function(){var t=this,e=this.roomList.filter(function(e){return e.roomId>0&&e.roomId<=t.matchTableCount}),i=this.roomList.filter(function(t){return t.roomId>20}),n=e.concat(i.sort(function(t,e){return t.roomId-e.roomId>0?-1:1})),o=[];if(n.length<=20)for(var a=n.length;20>a;a++)o.push({roomId:a+1});this.roomList=n.concat(o)},o.prototype.updateRoomCurNbr=function(t){if(t&&t.roomId&&this.tableCollect&&this.roomList&&this.roomList.length>0){var e=this.roomList.first(function(e){return e.roomId==t.roomId});e&&e.roomId&&(e.curGameNbr=t.nbr,t.list&&(e.scoreList=t.list),this.tableCollect.replaceAll(this.roomList))}},o.prototype.updateRoom=function(t){if(t&&t.matchId==this.selectMatchId){var e=this.roomList.find(function(e){return e.roomId==t.roomId});if(3==t.state||2==t.state)-1!=e&&(this.roomList.removeAt(e),this.updataRoomList(),this.tableCollect.replaceAll(this.roomList));else if(1==t.state&&-1==e){var i=this.roomList.first(function(e){return e.roomId==t.deskId});i&&(this.roomList.push({roomId:t.roomId,list:i.list}),i.list=[],this.tableCollect.itemUpdated(i),this.tableCollect.refresh(),this.updataTableList(),this.updataRoomList(),this.tableCollect.replaceAll(this.roomList))}}},Object.defineProperty(o.prototype,"isJoin",{get:function(){return this._isJoin},set:function(t){this._isJoin=t,this.quitBtn.visible=t,this.refreshBtn.visible=!t},enumerable:!0,configurable:!0}),o.prototype.enterMatchGroup=function(){this.isJoin=!0},o.prototype.updateMatch=function(e){if(e&&e.info&&e.info.uid){var i,n=this.roomList.find(function(t){return t.roomId==e.info.roomId&&!t.endTime&&2!=t.state});if(n>=0&&(i=this.roomList[n]),i){i.list=null!=i.list&&i.list instanceof Array?i.list:[];var o=i.list.first(function(t){return t.uid==e.info.uid});o?o=e.info:i.list.push(e.info),this.tableCollect.replaceItemAt(i,n),e.info.uid==uniLib.NetMgr.UID&&(this.isJoin=!0),t.LobbyDataCache.getHeadUrlByUid(e.info.uid)||t.HeadMcManager.instanc.requestHeadurl([e.info.uid])}}},o.prototype.leaveMatchGroup=function(t){void 0===t&&(t=null),t||(t=uniLib.NetMgr.UID,this.isJoin=!1);var e=this.checkIsMatch(t);if(this.isAutoGame&&(e=this.roomList.first(function(e){return e.roomId==t&&!e.endTime&&2!=e.state})),e){var i=this.roomList.indexOf(e);e.list.removeAll(function(e){return e.uid==t}),i>=0&&this.tableCollect.replaceItemAt(e,i)}},o.prototype.showMenu=function(){var t=this;this.teaListButton.selected?(this.menuEffect.visible=!0,this.menuEffect.scrollEnabled=!0,this.menuBtnGroup.y=-375,egret.Tween.removeTweens(this.menuBtnGroup),egret.Tween.removeTweens(this.teaListButton.menuBtnArrow),egret.Tween.get(this.menuBtnGroup).to({y:0},200,egret.Ease.sineOut).call(function(){t.menuEffect.scrollEnabled=!1,t.updataMatchList()}),egret.Tween.get(this.teaListButton.menuBtnArrow).to({rotation:180},200,egret.Ease.sineOut)):this.onMenuClose()},o.prototype.onMenuClose=function(){var t=this;this.teaListButton.selected=!1,this.menuEffect.scrollEnabled=!0,egret.Tween.removeTweens(this.menuBtnGroup),egret.Tween.removeTweens(this.teaListButton.menuBtnArrow),egret.Tween.get(this.menuBtnGroup).to({y:-375},200,egret.Ease.sineOut).call(function(){t.menuEffect.visible=!1}),egret.Tween.get(this.teaListButton.menuBtnArrow).to({rotation:0},200,egret.Ease.sineOut)},o.prototype.updataMatchList=function(){if(t.MJLobbyData.getInstance().isTeahouseModle){var e=this.teaHouseIdList.indexOf(this.curMatchId),n=e>-1?!0:!1;this.matchIdLabel.visible=!n,this.teaListButton.visible=n}else this.matchIdLabel.visible=!0,this.teaListButton.visible=!1;this.teaGroupList.itemRenderer=i,this.teaGroupList.dataProvider=new eui.ArrayCollection(this.teaHouseIdList)},o}(t.BaseComponent);t.TableHouseListPanel=e,__reflect(e.prototype,"MJLobby.TableHouseListPanel");var i=function(t){function e(){var e=t.call(this)||this;return e.skinName=new TeaHouseRadioButtonSkin,e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.labelDisplay.text=t+""},e}(eui.ItemRenderer);t.TeaHouseRadioButton=i,__reflect(i.prototype,"MJLobby.TeaHouseRadioButton");var n=function(i){function n(){var t=i.call(this)||this;return t.uidArr=[],e.Instanc.userNbr>4?t.skinName=new SixTableItemSkin:t.skinName=new RoomTableItem4Skin,t.addListener(),t.hasOutLine=!1,t}return __extends(n,i),n.prototype.addListener=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.joinRoom,this)},n.prototype.removeListener=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.joinRoom,this)},n.prototype.destory=function(){this.removeListener()},n.prototype.RefreshQuickRoom=function(){var t=this;3==this.data.roomId&&(this.uidArr.length>=2?this._quickRoomTimer||(this.countDown=10,this._quickRoomTimer=uniLib.SetUniTimerTimeout(this,function(){t.countDown=t.countDown-1,t.countDown>0?t.infoBtn.labelDisplay.text=t.countDown.toString():t.countDown=10},1e3,!1,this)):(this._quickRoomTimer&&(this._quickRoomTimer.stop(),this._quickRoomTimer=null),this.infoBtn.labelDisplay.text="快速桌"))},n.prototype.joinRoom=function(i){if(!(this.data.roomId>e.Instanc.matchTableCount&&this.data.roomId<=20)){if(this.endIcon.visible)return void t.LobbyPopupManager.showMildWarnShow("当前房间已结束！");if(this.data.curGameNbr>=0&&this.hasOutLine){var n=new Cmd.GetMatchGroupRoomInfoCmd_C;return n.roomId=this.data.roomId,void t.LobbyServerMJProxy.getInstance().sendData(n)}if(this.data.list.length>=e.Instanc.userNbr)return void t.LobbyPopupManager.showMildWarnShow("当前房间已满员！");e.Instanc.isJoin&&e.Instanc.quitMatchRoom();var o=new Cmd.EnterMatchGroupCmd_C;o.matchId=e.Instanc.selectMatchId,o.lobbyId=t.MJLobbyData.getInstance().lobbyId,o.roomId=this.data.roomId,t.LobbyServerMJProxy.getInstance().sendData(o),t.NetMgr.setMsgTimeout(5,"EnterMatchGroupCmd_C")}},n.prototype.setUser=function(e,i){var n=this;if(e)for(var o=function(o){var s=a.skin["nameLabel"+o];if(s&&(s.text=e[o].nickname?e[o].nickname.slice(0,2):"",i))for(var r=0;r<i.length;r++)i[r].uid==e[o].uid&&void 0!=i[r].score&&(s.text=s.text+":"+i[r].score.toString());a.uidArr.push(e[o].uid);var h=a.skin["headMc"+o];h&&t.HeadMcManager.instanc.getUserHeadByUid(e[o].uid,a,function(t){t&&(n.skin["headMc"+o].source=t)});var c=a.skin["player"+o];if(c&&(c.visible=!0,1!=e[o].state&&!a.endIcon.visible)){var l=a.skin["outLine"+o];l&&(l.visible=!0,a.hasOutLine=!0)}var d=a.skin["joinBtn"+o];d&&(d.visible=!1)},a=this,s=0;s<e.length;s++)o(s)},n.prototype.dataChanged=function(){this.reset();var t=this.data;this.roomId.text="桌号:"+t.roomId,e.Instanc.userNbr>=5&&2==t.roomId?this.infoBtn.labelDisplay.text=t.curGameNbr?"第"+t.curGameNbr+"局":"四人桌":e.Instanc.userNbr>=5&&3==t.roomId?this.infoBtn.labelDisplay.text=t.curGameNbr?"第"+t.curGameNbr+"局":"三人桌":3==t.roomId?this.infoBtn.labelDisplay.text=t.curGameNbr?"第"+t.curGameNbr+"局":"二人桌":t.roomId<=20?4==e.Instanc.userNbr&&2==t.roomId?this.infoBtn.labelDisplay.text=t.curGameNbr?"第"+t.curGameNbr+"局":"三人桌":this.infoBtn.labelDisplay.text=t.curGameNbr?"第"+t.curGameNbr+"局":"人满开":(this.infoBtn.labelDisplay.text=t.curGameNbr?"第"+t.curGameNbr+"局":"待开局",this.roomId.text="桌号"+t.roomId),5261==e.Instanc.gameId&&(this.infoBtn.labelDisplay.text=t.curGameNbr?"第"+t.curGameNbr+"局":"待开局",this.roomId.text="桌号"+t.roomId),t.roomId>e.Instanc.matchTableCount&&t.roomId<=20?this.joinGroup.visible=!1:(this.joinGroup.visible=!0,t.roomId>20?(this.joinGroup.visible=!1,t.endTime||2==t.state?this.endIcon.visible=!0:t.list.length==e.Instanc.userNbr||t.curGameNbr?this.skin.playIcon.visible=!0:this.joinGroup.visible=!0):1==t.roomId&&e.Instanc.isAutoGame&&(this.middleJoinBtn.visible=!0,this.infoBtn.visible=!1,this.joinGroup.visible=!1),this.setUser(t.list,t.scoreList?t.scoreList:t.list))},n.prototype.updateCurGameNum=function(t){this.infoBtn.labelDisplay.text=t.nbr?t.nbr+"/"+e.Instanc.gameNbr+"局":"未开局"},n.prototype.reset=function(){var t=e.Instanc.userNbr;this.hasOutLine=!1,e.Instanc.userNbr>=5&&2==this.data.roomId?t=4:e.Instanc.userNbr>=5&&3==this.data.roomId||4==e.Instanc.userNbr&&2==this.data.roomId?t=3:3==this.data.roomId&&(t=2),5261==e.Instanc.gameId&&(t=e.Instanc.userNbr),this.data&&this.data.roomId>20&&this.data.list&&(t=this.data.list.length),4>=t&&(this.removeListener(),this.skinName="RoomTableItem4Skin",this.addListener()),this.middleJoinBtn.visible=!1,this.infoBtn.visible=!0,this.endIcon.visible=!1,this.skin.playIcon.visible=!1;for(var i=0;6>i;i++)this.uidArr=[],this.skin["player"+i]&&(this.skin["player"+i].visible=!1),this.skin["joinBtn"+i]&&(t>i?this.skin["joinBtn"+i].visible=!0:this.skin["joinBtn"+i].visible=!1),this.skin["headMc"+i]&&(this.skin["headMc"+i].source=null),this.skin["nameLabel"+i]&&(this.skin["nameLabel"+i].text=""),this.skin["outLine"+i]&&(this.skin["outLine"+i].visible=!1)},n}(eui.ItemRenderer);t.HouseTableItem=n,__reflect(n.prototype,"MJLobby.HouseTableItem")}(MJLobby||(MJLobby={}));var PublicLoadingView=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this.backgroud_bmp||(1017==MJLobby.MJLobbyData.getInstance().lobbyId?this.backgroud_bmp=MJLobby.LobbyResUtil.createBitmapByName("XJ_login_bg_png"):this.backgroud_bmp=MJLobby.LobbyResUtil.createBitmapByName("HZ_login_bg_png"),this.backgroud_bmp.width=uniLib.Global.screenWidth,this.backgroud_bmp.height=uniLib.Global.screenHeight,this.addChild(this.backgroud_bmp)),!this.bigLogo,this.darkLine_bmp||(this.darkLine_bmp=MJLobby.LobbyResUtil.createBitmapByName("lb_loading_darkLine",(uniLib.Global.screenWidth-418)/2,uniLib.Global.screenHeight-196*uniLib.ScreenUtils.scaleFactor),this.addChild(this.darkLine_bmp)),this.lightLine_bmp||(this.lightLine_bmp=MJLobby.LobbyResUtil.createBitmapByName("lb_loading_lightLine",this.darkLine_bmp.x+8,this.darkLine_bmp.y+5),this.lightLine_bmp.scale9Grid=new egret.Rectangle(9,7,9,6),this.addChild(this.lightLine_bmp)),this.explain_txf||(this.explain_txf=MJLobby.LobbyResUtil.createTextFeild(0,egret.HorizontalAlign.CENTER,"",22,500,uniLib.Global.screenHeight-161*uniLib.ScreenUtils.scaleFactor,276),this.explain_txf.x=(uniLib.Global.screenWidth-this.explain_txf.width)/2,this.addChild(this.explain_txf)),this._progTxt||(this._progTxt=MJLobby.LobbyResUtil.createTextFeild(0,egret.HorizontalAlign.CENTER,"",22,520,uniLib.Global.screenHeight-220*uniLib.ScreenUtils.scaleFactor,276),this._progTxt.x=(uniLib.Global.screenWidth-this._progTxt.width)/2,this.addChild(this._progTxt)),1017==MJLobby.MJLobbyData.getInstance().lobbyId&&(this.darkLine_bmp.y=499,this.lightLine_bmp.y=505,this.explain_txf.y=535,this._progTxt.y=475),this.updateVersion||0!=uniLib.Global.is_sandbox||(this.updateVersion=MJLobby.LobbyResUtil.createBitmapByName("refreshNet"),this.updateVersion.touchEnabled=!0,this.updateVersion.y=0,this.updateVersion.x=uniLib.Global.screenWidth-this.updateVersion.width-10,this.updateVersion.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onUpdateVersion,this),this.addChild(this.updateVersion))},e.prototype.onUpdateVersion=function(){uniLib.ZQGameSdk.getConfig("确定要更新游戏吗?","","确定")},e.prototype.setProgress=function(t,i,n,o,a){if(void 0===a&&(a=!1),this._versionTxt||(this._versionTxt=MJLobby.LobbyResUtil.createTextFeild(10066329,egret.HorizontalAlign.RIGHT,MJLobby.LobbyDataCache.version,22,864),this._versionTxt.x=uniLib.Global.screenWidth-this._versionTxt.width,this._versionTxt.y=uniLib.Global.screenHeight-this._versionTxt.height,this.addChild(this._versionTxt),this._versionTxt.text=MJLobby.LobbyDataCache.version),i&&0!=i){var s=Math.ceil(t/i*100);n&&""!=n?this.explain_txf.text=n:this.explain_txf.text=e.explain,0==a&&s>93&&(s=93);var r=this.darkLine_bmp.width*(s/100);this.lightLine_bmp.width=r,this.lightLine_bmp.width>this.darkLine_bmp.width-20&&(this.lightLine_bmp.width=this.darkLine_bmp.width-20),this._progTxt&&(this._progTxt.text=s+"%")}else this.explain_txf.text=n;this.explain_txf.x=(uniLib.Global.screenWidth-this.explain_txf.width)/2},e}(egret.Sprite);PublicLoadingView.explain="正在加载游戏资源...",__reflect(PublicLoadingView.prototype,"PublicLoadingView");var MJLobby;!function(t){var e=function(e){function i(){return e.call(this)||this}return __extends(i,e),i.prototype.destory=function(){if(e.prototype.destory.call(this),this._checkArr){for(var t=0;t<this._checkArr.length;t++)this._checkArr[t].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCheckHandle,this),this._checkArr[t].destory();this._checkArr=null}this._labelTxt=null,this._value=null},Object.defineProperty(i.prototype,"label",{set:function(e){this._labelTxt?this._labelTxt.text=e:(this._labelTxt=t.LobbyResUtil.createTextFeild(3948081,egret.HorizontalAlign.LEFT,e,32,-170,6,170),this.addChild(this._labelTxt))},enumerable:!0,configurable:!0}),i.prototype.setData=function(e,i,n,o){this._value=e,this._curIndex=n,this._checkArr=[];for(var a,s=0;s<i.length;s++)a=new t.CreateCheckMc,a.label=i[s],a.x=s*o,this.addChild(a),a.name="check"+s,a.touchEnabled=!0,this._checkArr.push(a),a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCheckHandle,this);this.updataCheck()},i.prototype.resetLabel=function(t){for(var e in t)this._checkArr[this._value.indexOf(Number(e))].htmlLabel=t[e]},i.prototype.resetValueN=function(t){for(var e=0;e<this._value.length;e++)t>e?this._checkArr[e].visible=!0:this._checkArr[e].visible=!1;this._curIndex=0,this.updataCheck()},i.prototype.onCheckHandle=function(e){var i=Number(e.currentTarget.name.slice(5));this._curIndex!=i&&(this._curIndex=i,this.updataCheck(),this.dispatchEventWith(t.LobbyUIEventConsts.CHANGE))},i.prototype.updataCheck=function(){for(var t=0;t<this._checkArr.length;t++)this._checkArr[t].check=!1;this._checkArr[this._curIndex].check=!0},Object.defineProperty(i.prototype,"value",{get:function(){return this._value[this._curIndex]},set:function(t){var e=this._value.indexOf(t);-1!=e&&(this._curIndex=e,this.updataCheck())},enumerable:!0,configurable:!0}),i}(t.LobbyBaseVc);t.RadioCheckBox=e,__reflect(e.prototype,"MJLobby.RadioCheckBox")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function i(i,n,o,a){void 0===a&&(a=t.PlayTypeConsts.RADIO);var s=e.call(this)||this;return s._enabled=!0,s._checkArr=i,s._idArr=n,o&&(s._curIndex=n.indexOf(o)),a==t.PlayTypeConsts.RADIO?s._coundNotChoose=!1:s._coundNotChoose=!0,s.init(),s}return __extends(i,e),i.prototype.init=function(){for(var e=0;e<this._checkArr.length;e++)this._checkArr[e].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCheckHandle,this),this._checkArr[e].addEventListener(t.LobbyUIEventConsts.RESET_CHECKBOX,this.onSetByOther,this);this.updataCheck()},i.prototype.onSetByOther=function(e){var i=Number(e.currentTarget.name.slice(5)),n=this._idArr.indexOf(i);this._curIndex!=n&&(this._curIndex=n),this.updataCheck(),this.dispatchEventWith(t.LobbyUIEventConsts.CHANGE)},i.prototype.onCheckHandle=function(e){var i=Number(e.currentTarget.name.slice(5)),n=this._idArr.indexOf(i),o=e.currentTarget;o.check&&this._coundNotChoose?this._curIndex=-1:this._curIndex!=n&&(this._curIndex=n),this.updataCheck(),this.dispatchEventWith(t.LobbyUIEventConsts.CHANGE)},Object.defineProperty(i.prototype,"value",{get:function(){return-1!=this._curIndex&&this._enabled?this._idArr[this._curIndex]:null},set:function(e){var i=this._idArr.indexOf(e);this._curIndex!=i&&(this._curIndex=i,this.updataCheck(),this.dispatchEventWith(t.LobbyUIEventConsts.CHANGE))},enumerable:!0,configurable:!0}),i.prototype.excludeCheckId=function(t){void 0===t&&(t=null);for(var e=0;e<this._checkArr.length;e++)if(t!=this._checkArr[e]){this.value=this._idArr[e];break}},i.prototype.setEnabled=function(t){if(t!=this._enabled)if(this._enabled=t,t){for(var e=0;e<this._checkArr.length;e++)this._checkArr[e].setEnable(t);this._coundNotChoose||this.excludeCheckId()}else{this._curIndex=-1,this.updataCheck();for(var e=0;e<this._checkArr.length;e++)this._checkArr[e].setEnable(t)}},i.prototype.updataCheck=function(){for(var e=0;e<this._checkArr.length;e++)e!=this._curIndex&&0!=this._checkArr[e].check&&(this._checkArr[e].check=!1,this._checkArr[e].dispatchEventWith(t.LobbyUIEventConsts.CHANGE));this._checkArr[this._curIndex]&&1!=this._checkArr[this._curIndex].check&&(this._checkArr[this._curIndex].check=!0,this._checkArr[this._curIndex].dispatchEventWith(t.LobbyUIEventConsts.CHANGE))},i.prototype.destory=function(){if(this._checkArr){for(var e=0;e<this._checkArr.length;e++)this._checkArr[e].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCheckHandle,this),this._checkArr[e].removeEventListener(t.LobbyUIEventConsts.RESET_CHECKBOX,this.onSetByOther,this);this._checkArr=null}this._idArr=null},i}(egret.EventDispatcher);t.RadioRelate=e,__reflect(e.prototype,"MJLobby.RadioRelate")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t._noticeArr=[],t}return __extends(i,e),i.prototype.initUI=function(){this._buffer=25;var e=t.LobbyResUtil.createBitmapByName("paomadengbeijing");e.scale9Grid=new egret.Rectangle(12,5,9,32),e.width=940,e.height=45,e.y=5,e.alpha=.5,this.addChild(e);var i=t.LobbyResUtil.createBitmapByName("lobby_speaker");this.addChild(i),i.y=13,this._msgTxt=t.LobbyResUtil.createTextFeild(16777215,egret.HorizontalAlign.LEFT,"系统公告",32,55,9),this._msgTxt.fontFamily="黑体",this._msgTxt.verticalAlign=egret.VerticalAlign.MIDDLE,this._msgTxt.multiline=!1,uniLib.Global.addEventListener(uniLib.ZqEvent.CHAT_GM,this.onNoticeCome,this),uniLib.Global.addEventListener(uniLib.ZqEvent.CHAT_HORN,this.onNoticeCome,this),uniLib.Global.addEventListener(uniLib.ZqEvent.CHAT_SYSTEM,this.onNoticeCome,this),uniLib.Global.addEventListener(uniLib.ZqEvent.CHAT_IMPORTANT,this.onNoticeCome,this),this._txtMc=new egret.DisplayObjectContainer,this._txtMc.addChild(this._msgTxt),this._txtMc.x=40,this.addChild(this._txtMc),this._txtMc.scrollRect=new egret.Rectangle(0,0,880,e.height),this.visible=!1;var n=this;setTimeout(function(){n.noticeTest()},200)},i.prototype.noticeTest=function(){this._msgTxt&&(this.scrollEnd(),null!=this._noticeArr&&0!=this._noticeArr.length||!t.MJLobbyData.getInstance().defaultSysMsg||(this._noticeArr=[t.MJLobbyData.getInstance().defaultSysMsg]),null==this._noticeArr||0==this._noticeArr.length?0==uniLib.Global.is_sandbox?this._msgTxt.textFlow=[{text:"约上三五好友，随时随地开房组局，可获得丰厚奖品；详情咨询官方客服微信lyhnmj888或QQ群553684818",style:{size:32}}]:this._msgTxt.textFlow=[{text:"【老友麻将】",style:{textColor:16734197,size:32}},{text:"火爆上线，欢迎大家体验，更多精彩内容尽请期待!",style:{size:32}}]:this._msgTxt.text=this._noticeArr.shift(),this.startScroll())},i.prototype.startScroll=function(){this.visible=!0,egret.Tween.removeTweens(this._msgTxt),this._msgTxt.x=700+this._buffer;var t=this._msgTxt.textWidth<850?850:this._msgTxt.textWidth;egret.Tween.get(this._msgTxt).to({x:-(this._msgTxt.textWidth+this._buffer)},10*(t+this._buffer)).call(this.noticeTest,this)},i.prototype.scrollEnd=function(){egret.Tween.removeTweens(this._msgTxt),this.visible=!1},i.prototype.onNoticeCome=function(t){var e=t.param;null==this._noticeArr&&(this._noticeArr=[]),this._noticeArr.push(e.info)},i.prototype.destory=function(){e.prototype.destory.call(this),uniLib.Global.removeEventListener(uniLib.ZqEvent.CHAT_GM,this.onNoticeCome,this),uniLib.Global.removeEventListener(uniLib.ZqEvent.CHAT_HORN,this.onNoticeCome,this),uniLib.Global.removeEventListener(uniLib.ZqEvent.CHAT_SYSTEM,this.onNoticeCome,this),uniLib.Global.removeEventListener(uniLib.ZqEvent.CHAT_IMPORTANT,this.onNoticeCome,this),this.scrollEnd(),this._msgTxt=null,this._noticeArr=null,this._txtMc=null},i}(t.LobbyBaseVc);t.SysMsgMc=e,__reflect(e.prototype,"MJLobby.SysMsgMc")}(MJLobby||(MJLobby={}));var ResGroupConsts=function(){function t(){}return t}();ResGroupConsts.GAMECOMMON="gameCommon",ResGroupConsts.MJL_FONT="mjl_font",ResGroupConsts.MJL_CREATE="mjl_create",ResGroupConsts.MJL_BUY="mjl_buy",ResGroupConsts.MJL_COIN="mjl_coin",ResGroupConsts.MJL_HELP="mjl_rule",ResGroupConsts.MJL_JOINROOM="mjl_joinRoom",ResGroupConsts.MJL_RECORD="mjl_record",ResGroupConsts.MJL_SETTING="mjl_setting",ResGroupConsts.MJL_MARKET="mjl_market",ResGroupConsts.MJL_SHARE="mjl_share",ResGroupConsts.MJL_USERINFO="mjl_userInfo",ResGroupConsts.MJL_CLUB="mjl_club",ResGroupConsts.MJL_NOAGENT="mjl_noAgent",ResGroupConsts.MJL_PROMOTE="mjl_promote",ResGroupConsts.MJL_EVENT="mjl_event",ResGroupConsts.MJL_LOGOUT="mjl_logout",ResGroupConsts.MJL_MATCH="mjl_match",ResGroupConsts.MJL_PUBLIC="mjl_public",ResGroupConsts.MJL_LUCKPOOR="mjl_luckPoor",ResGroupConsts.MJL_MAIL="mjl_mail",__reflect(ResGroupConsts.prototype,"ResGroupConsts");var MJLobby;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.reqList={},t}return __extends(i,e),Object.defineProperty(i,"instanc",{get:function(){return i._instanc||(i._instanc=new i),i._instanc},enumerable:!0,configurable:!0}),i.prototype.getUserHeadByUid=function(e,i,n,o){if(void 0===o&&(o=!1),e==t.MJLobbyData.getInstance().myBaseInfo.uid)return void(n&&n(t.MJLobbyData.getInstance().myBaseInfo.headUrl));var a=t.LobbyDataCache.getHeadUrlByUid(e);a?n&&n(a):(this.reqList[e]||(this.requestHeadurl([e]),this.reqList[e]=[]),this.reqList[e].push({thisObj:i,call:n}))},i.prototype.onHeadurlBack=function(t){if(t instanceof Array&&t.length>0)for(var e=0,i=t;e<i.length;e++){var n=i[e],o=n.uid;if(this.reqList[o]instanceof Array){for(;this.reqList[o].length>0;){var a=this.reqList[o].pop();a.call(n.headUrl,a.thisObj),a=null}delete this.reqList[o]}}},i.prototype.requestHeadurl=function(e){if(e&&e.length>0)for(var i=0,n=e;i<n.length;i++){var o=n[i];this.reqList[o]||(this.reqList[o]=[])}var a=new t.MvcSender,s=new Cmd.GetUserHeadList_C;s.uidList=e,a.sendNotification(t.MahJongLobbyFacadeConsts.SEND_DATA,s,t.LobbyDataRequestCommand.GAME_DATA),t.NetMgr.setMsgTimeout(5,"GetUserHeadList_C")},i}(eui.Component);t.HeadMcManager=e,__reflect(e.prototype,"MJLobby.HeadMcManager")}(MJLobby||(MJLobby={}));var MJ_Panel=function(t){function e(){var e=t.call(this)||this;return e.skinName=new MJ_PanelSkin,e}return __extends(e,t),e}(eui.Component);__reflect(MJ_Panel.prototype,"MJ_Panel");var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,i,n){function o(t){e.call(n,t)}function a(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),i.call(n))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),RES.getResByUrl(t,o,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var MJLobby;!function(t){var e=function(){function e(){}return Object.defineProperty(e,"customerWeChat",{get:function(){if(""==this._customerWeChat){var e=t.MJLobbyData.getInstance().getLobbyConfig();e&&e.customerWeChat&&""!=e.customerWeChat&&(this._customerWeChat=e.customerWeChat)}return this._customerWeChat},enumerable:!0,configurable:!0}),Object.defineProperty(e,"agentUrl",{get:function(){if(""==this._agentUrl){var e=t.MJLobbyData.getInstance().getLobbyConfig();e&&e.hasOwnProperty("agentUrl")&&""!=e.agentUrl&&(this._agentUrl=e.agentUrl)}return this._agentUrl},set:function(t){this._agentUrl=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"kefuUrl",{get:function(){if(""==this._kefuUrl){var e=t.MJLobbyData.getInstance().getLobbyConfig();e&&e.hasOwnProperty("kefuUrl")&&""!=e.kefuUrl&&(this._kefuUrl=e.kefuUrl)}return this._kefuUrl},set:function(t){this._kefuUrl=t},enumerable:!0,configurable:!0}),e.FormatDate=function(t,e){if(void 0===e&&(e=!1),null==t)return"";var i=new Date(1e3*t),n=i.getFullYear(),o=i.getMonth()+1,a=o.toString().padLeft(2,"0"),s=i.getDate(),r=s.toString().padLeft(2,"0"),h=i.getHours(),c=h.toString().padLeft(2,"0"),l=i.getMinutes(),d=l.toString().padLeft(2,"0"),u=i.getSeconds(),b=u.toString().padLeft(2,"0");return e?n+"-"+a+"-"+r+" "+c+":"+d:a+"-"+r+" "+c+":"+d+":"+b},e.StateToString=function(t){return t==Cmd.OnlineState.OnlineState_Online?"在线":t==Cmd.OnlineState.OnlineState_Calling?"电话中":t==Cmd.OnlineState.OnlineState_Slow?"网络差":t==Cmd.OnlineState.OnlineState_Leave?"切后台":t==Cmd.OnlineState.OnlineState_Hosting?"托管":"离线"},e.MatchMemberTypeToString=function(t){return t?1==t?"白":2==t?"黑":3==t?"黄":4==t?"副":void 0:"游"},e.MatchMemberTypeToColor=function(t){return t?1==t?4783872:2==t?16711680:3==t?16235790:4==t?16041845:void 0:8204032},e.checkIsPoker=function(t){var e=RES.getRes("gameList_json");if(!e)return!1;var i=e.first(function(e){return e.gameId==t});return i?i.isPoker:!1},e.getLocation=function(){uniLib.ZQGameSdk.getLocation(function(i){console.info(JSON.stringify(i));var n=new Cmd.GetGPSLocationCmd_C;if(0==i.code){if(Math.abs(e.lat-i.data.latitude)<.001&&Math.abs(e.lng-i.data.longitude)<.001)return void console.info("当前距离上次位置小于100m!");if(e.lat=n.lat=i.data.latitude,e.lng=n.lng=i.data.longitude,i.data.address){var o=i.data.address;if(uniLib.Utils.isIOS()){var a=i.data.address.trim().split("|");o=(a.length>3?a[3]:"")+(a.length>5?a[5]:"")}n.address=o}}else{if(0==e.lng&&0==e.lat)return void console.info("GPS一直没开!,不给服务器发送位置！");e.lat=n.lat=e.lng=n.lng=0,console.info("中途关闭了GPS，需通知服务器！")}console.info("给服务器发送位置信息！"),t.LobbyServerMJProxy.getInstance().sendData(n),e.firstGet&&(e.firstGet=!1)},this,!0)},e}();e.DownloadUrl=null,e.artStyle=0,e.sandboxMarket=!1,e.noticeUrl="",e.inviteStrArr=["看都看了,来玩玩吧","在不在昵,打牌咯!","别墨迹,快来，都在等你呢!","差你一个,就能开弄咧!"],e.hasXianLiao=!1,e.firstInLobby=!0,e.lobbyBGM="bg_mp3",e._customerWeChat="",e._agentUrl="",e._kefuUrl="",e.lat=0,e.lng=0,e.firstGet=!0,t.DataManage=e,__reflect(e.prototype,"MJLobby.DataManage")}(MJLobby||(MJLobby={})),MJLobby.LobbyPopupManager.showConfirmPanel=function(t,e,i,n,o,a,s,r,h){void 0===i&&(i=null),void 0===n&&(n=null),void 0===a&&(a=0),void 0===s&&(s=!1),void 0===h&&(h=egret.HorizontalAlign.CENTER);var c=new MJLobby.MatchMsgBox;n||(n=""),c.setData(n,t,e,i,o),c.x=Math.round((MJLobby.LobbyDataCache.defaultWidth-c.width)/2),c.y=Math.round((MJLobby.LobbyDataCache.defaultHeight-c.height)/2),this.addPopUp(c,!0,!0,!0,0,0,!1)},MJLobby.LobbyMsgBox.prototype.initUI=function(){var t=MJLobby.LobbyResUtil.createBitmapByName("mjl_common_bj_3");if(t.scale9Grid=new egret.Rectangle(50,74,178,451),t.width=635,t.height=391,this.addChild(t),this.title=MJLobby.LobbyResUtil.createTextFeild(4079177,egret.HorizontalAlign.CENTER,"",32,140,18,191),this.info=MJLobby.LobbyResUtil.createTextFeild(4079177,egret.HorizontalAlign.CENTER,"",32,66,39,508),this.info.lineSpacing=2,this.addChild(this.info),this.addChild(this.title),2==MJLobby.MJLobbyData.getInstance().artStyle?(t.texture=RES.getRes("mjl_msgPanel"),t.scale9Grid=new egret.Rectangle(97,215,16,19)):4==MJLobby.MJLobbyData.getInstance().artStyle?(t.texture=RES.getRes("mjl_msgPanel"),t.scale9Grid=new egret.Rectangle(0,0,0,0),this.info.textColor=16777215):5==MJLobby.MJLobbyData.getInstance().artStyle&&(this.info.textColor=16777215),this._needClose){var e=new MJLobby.LobbyGameButton(["mjl_closebtn","mjl_closebtn2"]);e.x=t.width-61,e.y=-10,e.addClickArea(20),e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.addChild(e)}},MJLobby.LobbyMsgBox.prototype.setData=function(t,e,i,n,o,a,s,r){if(void 0===i&&(i=null),void 0===n&&(n=null),void 0===o&&(o=null),void 0===a&&(a=0),void 0===s&&(s=32),void 0===r&&(r=egret.HorizontalAlign.CENTER),this._backFn=n,this._backObj=o,this.info.size=s,this.title.text=t,this.info.text=e,this.info.textAlign=r,this.info.y=20+Math.round((254-this.info.textHeight)/2),1==i.length){if(i[0]&&""!=i[0]||(i[0]="确定"),this.yesBtn=new MJLobby.LobbyGameButton(["mjl_common_sure1","mjl_common_sure2"]),this.yesBtn.x=Math.round((this.width-this.yesBtn.width)/2),this.yesBtn.y=this.height-115,"确定"==i[0]&&4!=MJLobby.MJLobbyData.getInstance().artStyle){var h=MJLobby.LobbyResUtil.createBitmapByName("mjl_txt_sure",65,8);this.yesBtn.addChild(h)}this.addChild(this.yesBtn)}else 2==i.length&&(i[0]&&""!=i[0]||(i[0]="确定"),i[1]&&""!=i[1]||(i[1]="取消"),this.yesBtn=new MJLobby.LobbyGameButton(["mjl_commonBtn_sure_1","mjl_commonBtn_sure_2"]),this.yesBtn.x=317.5-this.yesBtn.width-10,this.yesBtn.y=270,this.addChild(this.yesBtn),this.noBtn=new MJLobby.LobbyGameButton(["mjl_commonBtn_cancle_2","mjl_commonBtn_cancle_1"]),this.noBtn.x=327.5,this.noBtn.y=270,4==MJLobby.MJLobbyData.getInstance().artStyle&&(this.yesBtn.y=this.noBtn.y=this.height-this.yesBtn.height-50),this.addChild(this.noBtn));this._backFn&&this._backFn[0]&&this.yesBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this._backFn[0],this._backObj),this._backFn&&this._backFn[1]&&this.noBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this._backFn[1],this._backObj),this.yesBtn&&this.yesBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.noBtn&&this.noBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.title.x=(635-this.title.width)/2},uniLib.ZQGameSdk.getConfig=function(t,e,i,n){var o=new uniLib.ZQGameObj;o.cmd=uniLib.ZQGameSdk.GET_CONFIG,o.data={},e&&(o.data.configUrl=e),o.data.desc=t,o.data.confirm=i?i:"确定",o.data.cancel=n?n:"",egret.ExternalInterface.call(uniLib.ZQGameSdk.SENDTONATIVE,JSON.stringify(o))},MJLobby.LobbyPopupManager.addPopUp=function(t,e,i,n,o,a,s){void 0===e&&(e=!1),void 0===i&&(i=!1),void 0===n&&(n=!0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===s&&(s=!1);var r=new egret.Sprite;r.graphics.beginFill(0,.6),r.graphics.drawRect(0,0,MJLobby.LobbyDataCache.defaultWidth,MJLobby.LobbyDataCache.defaultHeight*uniLib.ScreenUtils.scaleFactor),r.graphics.endFill(),r.touchEnabled=!0,r.name=t.hashCode+"_mask",e?r.visible=!0:r.visible=!1,this.getContainer().addChild(r),this.getContainer().addChild(t);var h,c;i?(h=o?MJLobby.LobbyDataCache.defaultWidth-o>>1:MJLobby.LobbyDataCache.defaultWidth-t.width>>1,c=a?(MJLobby.LobbyDataCache.defaultHeight*uniLib.ScreenUtils.scaleFactor-a)/2:(MJLobby.LobbyDataCache.defaultHeight*uniLib.ScreenUtils.scaleFactor-t.height)/2,t.x=h,t.y=c):(h=t.x,c=t.y),s&&r.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.dispatchEventWith(MJLobby.LobbyUIEventConsts.CLOSE)
},this)};var MJLobby;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.name="EventInGameCommonPanel",t}return __extends(n,e),Object.defineProperty(n,"instance",{get:function(){return this._instace||(this._instace=new n),this._instace},enumerable:!0,configurable:!0}),n.clearInstance=function(){this._instace=null},n.prototype.init=function(){uniLib.Global.addEventListener(uniLib.ZqEvent.EVENT_L2G,this.onEventDataChange,this),uniLib.Global.addEventListener(uniLib.ZqEvent.EVENT_G2L,this.onGameToLobby,this)},n.prototype.onEventDataChange=function(t){t.param&&"EVENT_INFO"==t.param&&this.showEventInfo()},n.prototype.showEventInfo=function(){if(0!=uniLib.Global.isInGame){var e=t.MJLobbyData.getInstance().eventData;e&&(this.parent&&this.onClose(),uniLib.SceneMgr.instance.currentScene&&uniLib.SceneMgr.instance.currentScene.topLayer&&uniLib.SceneMgr.instance.currentScene.addChild(this),e.curEventState?(e.curEventState==Cmd.EventInfoEventState.EventInfoEventState_Matching?this.showMatchIng():(e.curEventState==Cmd.EventInfoEventState.EventInfoEventState_Out||e.curEventState==Cmd.EventInfoEventState.EventInfoEventState_Result)&&this.showResultPanel(e.curEventState==Cmd.EventInfoEventState.EventInfoEventState_Out?!1:!0,e.myOrder,e.matchId),e.curEventState==Cmd.EventInfoEventState.EventInfoEventState_Ready&&this.showReadyState(e.level)):this.showReadyState(e.level))}},n.prototype.showMatchIng=function(){console.error("showMatchIng");var e=new egret.Sprite;e.name="bg_mask",this.addChild(e);var i=new egret.TextField;this.addChild(i),i.text="本局结束，正在为你匹配，请稍后.",i.x=(uniLib.Global.screenWidth-i.width)/2,i.y=uniLib.Global.screenHeight-180*uniLib.ScreenUtils.scaleFactor,e.graphics.beginFill(4473924,.5),e.graphics.drawRect(0,0,uniLib.Global.screenWidth,uniLib.Global.screenHeight),e.graphics.endFill(),egret.Tween.removeTweens(i),egret.Tween.get(i,{loop:!0}).wait(1e3).to({text:"本局结束，正在为你匹配，请稍后.."}).wait(1e3).to({text:"本局结束，正在为你匹配，请稍后..."}).wait(1e3).to({text:"本局结束，正在为你匹配，请稍后."}),this.giveUpBtn||(this.giveUpBtn=new t.LobbyGameButton(["event_common_giveUp_1","event_common_giveUp_2"]),this.giveUpBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGiveUp,this),this.addChild(this.giveUpBtn),this.giveUpBtn.x=(uniLib.Global.screenWidth-this.giveUpBtn.width)/2,this.giveUpBtn.y=uniLib.Global.screenHeight-100*uniLib.ScreenUtils.scaleFactor)},n.prototype.onGiveUp=function(){if(t.MJLobbyData.getInstance().eventData){var e=new t.MatchMsgBox,i=function(){var e=new Cmd.GiveUpEventMatchGroupCmd_C;e.matchId=t.MJLobbyData.getInstance().eventData.matchId,t.LobbyServerMJProxy.getInstance().sendData(e)};e.setData("","是否确定要弃权吗？",["确定","取消"],[i],this),this.addChild(e)}},n.prototype.showReadyState=function(t){var e=new eui.Panel;e.skinName=new EventRoundInfoSkin;var i=e.info;i.textFlow=[{text:"打立出局",style:{textColor:16768513}},{text:"\n积分低于淘汰分淘汰"}]},n.prototype.showResultPanel=function(t,e,n){var o=new i(t,n,e);this.addChild(o)},n.prototype.onGameToLobby=function(t){var e=t.param;"close_EventInfo"==e?(console.error("close_EventInfo"),this.onClose()):"show_EventInfo"==t.param&&this.showEventInfo()},n.prototype.onClose=function(){console.error("onClose"),uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this),this.giveUpBtn&&(this.giveUpBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onGiveUp,this),this.giveUpBtn=null)},n.prototype.destroy=function(){this.onClose(),uniLib.Global.removeEventListener(uniLib.ZqEvent.EVENT_L2G,this.onEventDataChange,this),uniLib.Global.removeEventListener(uniLib.ZqEvent.EVENT_G2L,this.onGameToLobby,this),n.clearInstance()},n}(egret.DisplayObjectContainer);t.EventInGameCommonPanel=e,__reflect(e.prototype,"MJLobby.EventInGameCommonPanel");var i=function(e){function i(t,i,n){var o=e.call(this)||this;return o.skinName=new EventResultSkin,t||(o.rankLabel.visible=!1,o.rewardNum.visible=!1,o.bgImg.source="event_out_bg_png"),o.addEventListener(egret.Event.REMOVED_FROM_STAGE,o.onRemove,o),o.backBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,o.onBakc,o),o.shareBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,o.onShare,o),o.rankLabel.text="第"+n+"名",o.rewardNum.text="豆"+o.getRewardNum(n,i),o}return __extends(i,e),i.prototype.getRewardNum=function(e,i){var n=t.MJLobbyData.getInstance().getGameOfficalEventConfigByMatchId(i),o=t.MJLobbyData.getInstance().getTableEventConfig();if(n&&o){var a=o.first(function(t){return t.id==n.eventId});if(a){var s=a.reward;if(s&&s instanceof Array)for(var r=0,h=s;r<h.length;r++){var c=h[r];if(c&&c.startOrder<=e&&c.endOrder>=e)return c.num}}}return 0},i.prototype.onShare=function(){uniLib.SoundMgr.instance.playSound("buttonClick_mp3")},i.prototype.onBakc=function(){uniLib.SoundMgr.instance.playSound("buttonClick_mp3");var t=new Cmd.LeaveRoomCmd_CS;t.uid=uniLib.NetMgr.UID,game.PokerFunction.tcpSend(t)},i.prototype.onRemove=function(){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemove,this),this.backBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBakc,this),this.shareBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShare,this)},i}(eui.Component);t.EventCommonResultPanel=i,__reflect(i.prototype,"MJLobby.EventCommonResultPanel")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function o(){var t=e.call(this)||this;return t.skinName=new BattlePanelSkin,t.initUI(),t}return __extends(o,e),o.prototype.initUI=function(){this.addListener(),this.loadEventData(),this.changeCoin()},o.prototype.destroy=function(){this.removeListener(),this.eventConfigList=null,uniLib.DisplayUtils.removeAllChildren(this)},o.prototype.addListener=function(){this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.destroy,this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.eventList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onEventItemTap,this),uniLib.Global.addEventListener(uniLib.ZqEvent.USER_INFO,this.changeCoin,this)},o.prototype.removeListener=function(){this.eventList.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onEventItemTap,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.destroy,this),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),uniLib.Global.removeEventListener(uniLib.ZqEvent.USER_INFO,this.changeCoin,this)},o.prototype.changeCoin=function(){if(this.coinLabel)if(uniLib.UserInfo.goldChips)if(uniLib.UserInfo.goldChips>=1e4){var t=(uniLib.UserInfo.goldChips/1e4).toFixed(2);this.coinLabel.text=t+"万"}else if(uniLib.UserInfo.goldChips>=1e5){var t=(uniLib.UserInfo.goldChips/1e4).toFixed(1);this.coinLabel.text=t+"万"}else this.coinLabel.text=Math.floor(uniLib.UserInfo.goldChips).toString();else this.coinLabel.text="0"},o.prototype.loadEventData=function(){if(!this.eventConfigList){this.eventConfigList=[],this.matchIdList||(this.matchIdList=[]);var e=t.MJLobbyData.getInstance().getGameOfficeEventConfigByLobbyId(t.MJLobbyData.getInstance().lobbyId),n=t.MJLobbyData.getInstance().getTableEventConfig();if(e&&n)for(var o=function(t){if(t.eventId&&1==t.isOpen){var e=n.first(function(e){return e.id==t.eventId});e&&(a.eventConfigList.push(e),a.matchIdList.push(t.id))}},a=this,s=0,r=e;s<r.length;s++){var h=r[s];o(h)}this.eventList.itemRenderer=i,this.eventList.dataProvider=new eui.ArrayCollection(this.eventConfigList)}},o.prototype.onClick=function(e){e.target instanceof eui.Button&&uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),e.target==this.closeButton?this.dispatchEventWith(egret.Event.CLOSE):e.target==this.buyCoinButton&&t.PublicMethed.showOfficialNumPanel()},o.prototype.onEventItemTap=function(e){uniLib.SoundMgr.instance.playSound("buttonClick_mp3");var i=(e.item,new Cmd.EntryInfoEventMatchGroupCmd_C);i.matchId=this.matchIdList[e.itemIndex],t.LobbyServerMJProxy.getInstance().sendData(i),this.curEventConfig=e.item},o.prototype.showEventInfo=function(){this.eventInfoPanel||(this.eventInfoPanel=n.instance,this.eventInfoPanel.initUI(this.curEventConfig),this.eventInfoPanel.addEventListener(egret.Event.CLOSE,this.removeEventInfo,this),t.LobbyPopupManager.addPopUp(this.eventInfoPanel,!0,!0))},o.prototype.removeEventInfo=function(){this.eventInfoPanel&&(this.eventInfoPanel.removeEventListener(egret.Event.CLOSE,this.removeEventInfo,this),t.LobbyPopupManager.removePopUp(this.eventInfoPanel,!1,!0),this.eventInfoPanel=null)},o.prototype.showEventInfoPanel=function(){!this.eventInfoPanel},o}(t.BaseComponent);t.LobbyEventPanel=e,__reflect(e.prototype,"MJLobby.LobbyEventPanel");var i=function(t){function e(){var e=t.call(this)||this;return e.skinName=new BattleItemSkin,e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;if(t){this.eventId=t.id?t.id:0,this.eventName.text=t.name?t.name:"",this.cost.text=(t.entryFee?t.entryFee:0)+"";var e=0;if(t.reward&&t.reward instanceof Array){var i=t.reward;e=i.last().endOrder}this.eventInfo.text="开赛人数"+t.userNum+",前"+e+"名获奖"}},e}(eui.ItemRenderer);t.EventItem=i,__reflect(i.prototype,"MJLobby.EventItem");var n=function(e){function i(){var t=e.call(this)||this;return t.startNum=108,t.skinName=new BattleInfoSkin,t}return __extends(i,e),Object.defineProperty(i,"instance",{get:function(){return this._instance||(this._instance=new i),this._instance},enumerable:!0,configurable:!0}),i.prototype.initUI=function(t){this.addListener(),this.setEventConfig(t)},i.prototype.addListener=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemove,this)},i.prototype.removeListener=function(){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemove,this),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)},i.prototype.setEventReward=function(){if(this.eventConfig){this.rewardList.itemRenderer=o;var t=this.eventConfig.reward&&this.eventConfig.reward instanceof Array?this.eventConfig.reward:[];this.rewardList.dataProvider=new eui.ArrayCollection(t)}},i.prototype.EntryEventResult=function(t){var e=t;this.cueEventId=t.matchId,1==e.myState?(this.joinButton.visible=!1,this.quitButton.visible=!0):(this.joinButton.visible=!0,this.quitButton.visible=!1),this.info.lineSpacing=5,this.info.textFlow=[{text:"当前报名人数:"},{text:(1==t.myState?t.curNum:"-")+"/"+this.startNum,style:{textColor:16768513}},{text:"\n(当前共有"},{text:t.allNum+"",style:{textColor:16768513}},{text:"人参与)"}]},i.prototype.setEventConfig=function(t){this.eventConfig=t,this.freeTime.textFlow=[{text:"每天前 "},{text:t.freeTimes?t.freeTimes:3,style:{textColor:16768513}},{text:" 次报名免费"}],this.title.text=this.eventConfig.name?this.eventConfig.name:"128快速赛",this.cost.text=""+(this.eventConfig.entryFee?this.eventConfig.entryFee:0),this.startNum=this.eventConfig.userNum?this.eventConfig.userNum:0,this.setEventReward()},i.prototype.onClick=function(t){t.target instanceof eui.Button&&uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),t.target==this.closeButton?(this.quitButton.visible&&this.quitClick(!0),this.dispatchEventWith(egret.Event.CLOSE)):t.target==this.joinButton?this.joinClick():t.target==this.quitButton&&this.quitClick()},i.prototype.quitClick=function(e){void 0===e&&(e=!1);var i=new Cmd.LeaveEventMatchGroupCmd_C;i.matchId=this.cueEventId,e&&(i.noSend=1),t.LobbyServerMJProxy.getInstance().sendData(i)},i.prototype.joinClick=function(){var e=new Cmd.EntryEventMatchGroupCmd_C;e.matchId=this.cueEventId,t.LobbyServerMJProxy.getInstance().sendData(e)},i.prototype.onRemove=function(){this.removeListener()},i}(eui.Component);t.EventInfoPanel=n,__reflect(n.prototype,"MJLobby.EventInfoPanel");var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;t&&(t.startOrder==t.endOrder?this.rank.text="第"+t.startOrder+"名:":this.rank.text=t.startOrder+"-"+t.endOrder,this.rewardNum.text=(t.num?t.num:0)+"")},e}(eui.ItemRenderer);t.BattleRewardItem=o,__reflect(o.prototype,"MJLobby.BattleRewardItem")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function i(){return e.call(this)||this}return __extends(i,e),i.prototype.destory=function(){e.prototype.destory.call(this),this._checkIcon=null,this._label=null,this._txtbg=null},i.prototype.initUI=function(){this._checkType=0,this._assetsArr=["mjl_create_checkbg","mjl_create_check","mjl_create_checkdisable"],this._checkBg=t.LobbyResUtil.createBitmapByName("mjl_create_checkbg"),this.addChild(this._checkBg),this._checkIcon=t.LobbyResUtil.createBitmapByName("mjl_create_check",0,0),this.addChild(this._checkIcon),this._checkIcon.x=2,this._checkIcon.y=-1,this.check=!1,this._label=t.LobbyResUtil.createTextFeild(1206199,egret.HorizontalAlign.LEFT,"",32,50,6),this._label.height=40,this.addChild(this._label)},Object.defineProperty(i.prototype,"checkType",{get:function(){return this._checkType},enumerable:!0,configurable:!0}),i.prototype.setCheckType=function(e){if(this._checkType!=e){switch(this._checkType=e,e){case 1:case 4:this._checkIcon.x=2,this._checkIcon.y=-1,this._assetsArr=["mjl_create_checkbg","mjl_create_check","mjl_create_checkdisable"];break;case 2:case 3:this._assetsArr=["mjl_multiple_bg","mjl_multiple_check","mjl_multiple_disable"],this._checkIcon.y=-4,this._checkIcon.x=-0}this._checkBg.texture=t.LobbyResUtil.createTexture(this._assetsArr[0]),this._checkIcon.texture=t.LobbyResUtil.createTexture(this._assetsArr[1])}},i.prototype.setLabelSize=function(t){this._label.size=t},Object.defineProperty(i.prototype,"label",{get:function(){return this._label.text},set:function(t){this._label.text=t,this._txtbg||(this._txtbg=new egret.Sprite,this.addChild(this._txtbg)),this._txtbg.graphics.clear(),this._txtbg.graphics.beginFill(1206199,0),this._txtbg.graphics.drawRect(this._label.x-5,this._label.y-5,this._label.textWidth+10,this._label.textHeight+10),this._txtbg.graphics.endFill()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"htmlLabel",{set:function(t){this._label.textFlow=(new egret.HtmlTextParser).parser(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"check",{get:function(){return this._checkIcon.visible},set:function(t){this._checkIcon.visible=t,this.dispatchEventWith(egret.TouchEvent.CHANGE)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"labelColor",{set:function(t){this._label.textColor=t},enumerable:!0,configurable:!0}),i.prototype.setEnable=function(e){this._checkIcon.visible=!1,this._assetsArr[2]&&(e?(this._label.textColor=1206199,this._checkBg.texture=t.LobbyResUtil.createTexture(this._assetsArr[0])):(this._label.textColor=1206199,this._checkBg.texture=t.LobbyResUtil.createTexture(this._assetsArr[2]))),this.touchEnabled=e,this.touchChildren=e},i.prototype.getEnable=function(){return this.touchEnabled},Object.defineProperty(i.prototype,"checkWidth",{get:function(){return this._label.x+this._label.width+5},enumerable:!0,configurable:!0}),i}(t.LobbyBaseVc);t.CreateCheckMc=e,__reflect(e.prototype,"MJLobby.CreateCheckMc")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.skinName=new MatchMsgBoxSkin,t.confirm.visible=!1,t.cancel.visible=!1,t.prize.visible=!1,t.toEmail.visible=!1,t}return __extends(i,e),i.prototype.setData=function(t,e,i,n,o){var a=this;void 0===i&&(i=null),void 0===n&&(n=null),void 0===o&&(o=null),this.title.text=t,this.info.text=e,this._backFn=n,this._backObject=o,1==i.length?(this.cancel.visible=!1,"领奖"==i[0]?this.prize.visible=!0:"前往邮箱"==i[0]?(this.toEmail.visible=!0,this.cancel.visible=!0):(this.confirm.x=220,this.confirm.visible=!0)):2==i.length&&(this.confirm.x=66,this.confirm.visible=!0,this.cancel.visible=!0),n&&n[0]&&("领奖"==i[0]?this.prize.addEventListener(egret.TouchEvent.TOUCH_TAP,n[0],o):"前往邮箱"==i[0]?this.toEmail.addEventListener(egret.TouchEvent.TOUCH_TAP,n[0],o):this.confirm.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){var t=a;n[0].call(o,t.checkResult)},o)),this._backFn&&this._backFn[1]&&this.cancel.addEventListener(egret.TouchEvent.TOUCH_TAP,n[1],o),"再接再厉!"==e&&(this.info.text="",this.tipimg.visible=!0),this.confirm.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.cancel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.prize.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.toEmail.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this)},i.prototype.addCheck=function(e,i){var n=i.length;this.checkResult||(this.checkResult={}),this.checkArr||(this.checkArr=[]);for(var o=0;n>o;o++){var a=new t.CreateCheckMc,s=new eui.Group;a.setCheckType(e),a.setLabelSize(24),a.touchEnabled=!0,a.touchChildren=!0,a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCheckChange,this),a.label=i[o].str,a.check=Boolean(i[o].check),this.checkArr.push(a),s.height=a.height,s.width=a.width,s.addChild(a),this.checkGroup.addChild(s),this.checkResult[a.label]=a.check}},i.prototype.onCheckChange=function(t){var e=t.target;e&&(e.check=!e.check,this.checkResult[e.label]=Number(e.check))},i.prototype.onClose=function(){if(uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),t.LobbyPopupManager.removePopUp(this),this.checkArr&&this.checkArr.length>0)for(var e=0;e<this.checkArr.length;e++){var i=this.checkArr[e];i.removeEventListener(egret.TouchEvent.CHANGE,this.onCheckChange,this),uniLib.DisplayUtils.removeFromParent(i),i.destory()}this.checkArr=[],uniLib.DisplayUtils.removeAllChildren(this.checkGroup),this.dispatchEventWith(t.LobbyUIEventConsts.CLOSE),this.destory()},i.prototype.destory=function(){this._backFn&&this._backFn[0]&&this.confirm.removeEventListener(egret.TouchEvent.TOUCH_TAP,this._backFn[0],this._backObject),this._backFn&&this._backFn[1]&&this.cancel.removeEventListener(egret.TouchEvent.TOUCH_TAP,this._backFn[1],this._backObject),this.confirm.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.cancel.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this)},i}(eui.Component);t.MatchMsgBox=e,__reflect(e.prototype,"MJLobby.MatchMsgBox");var i=function(e){function i(t,i){var n=e.call(this)||this;return n.skinName=new MatchAddYelloPanelSkin,n.init(),n.matchId=t,n.uid=i,n}return __extends(i,e),i.prototype.init=function(){this.yesBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.cancleBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.uidEditableText.restrict="0-9",this.uidEditableText.inputType=egret.TextFieldInputType.TEL},i.prototype.removeListener=function(){this.yesBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.cancleBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)},i.prototype.onClick=function(e){if(uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),e.target==this.yesBtn){var i=this.uidEditableText.text,n=Number(i);if(0/0==n||!n)return void t.LobbyPopupManager.showMildWarnShow("请输入正确的玩家ID");var o=new Cmd.OperateYellowMemberListMatchGroupCmd_C;o.uid=this.uid,o.uid2=n,o.matchId=this.matchId,o.reply=1,t.LobbyPopupManager.removePopUp(this,!0),t.LobbyServerMJProxy.getInstance().sendData(o),this.destory()}else t.LobbyPopupManager.removePopUp(this,!0),this.destory()},i.prototype.destory=function(){this.removeListener(),this.uidEditableText=null},i}(eui.Component);t.MatchAddYelloPanel=i,__reflect(i.prototype,"MJLobby.MatchAddYelloPanel");var n=function(e){function i(t,i,n,o,a){var s=e.call(this)||this;s.isShowReset=!1,s._errorTip="请输入正确的玩家ID",s.skinName=new MatchPrizePanelSkin,s.init(),s._callback=t,n&&(s.uidEditableText.prompt=n),i&&(s.titleLabel.text=i),o&&(s._errorTip=o);var r=a?!0:!1;return s.isShowReset=r,s}return __extends(i,e),i.prototype.init=function(){this.yesBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.cancleBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.uidEditableText.restrict="0-9",this.uidEditableText.inputType=egret.TextFieldInputType.TEL},i.prototype.onEntChange=function(t){uniLib.SoundMgr.instance.playSound("buttonClick_mp3")},i.prototype.removeListener=function(){this.yesBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.cancleBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)},i.prototype.onClick=function(e){if(uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),e.target==this.cancleBtn&&""!=this.titleLabel.text)return t.LobbyPopupManager.removePopUp(this,!0),void this.destory();var i=this.uidEditableText.text,n=Number(i);return 0/0!=n&&n?(this._callback&&this._callback(n),t.LobbyPopupManager.removePopUp(this,!0),void this.destory()):void t.LobbyPopupManager.showMildWarnShow(this._errorTip)},i.prototype.destory=function(){this.removeListener(),this.uidEditableText=null},i}(eui.Component);t.MatchPrizePanel=n,__reflect(n.prototype,"MJLobby.MatchPrizePanel")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.skinName=new MatchMsgExportSkin,t.init(),t}return __extends(i,e),i.prototype.init=function(){this.clearRecordCheck=new t.CreateCheckMc,this.clearRecordCheck.x=450,this.clearRecordCheck.y=410,this.clearRecordCheck.label="清空原战绩",this.clearRecordCheck.setLabelSize(28),this.clearRecordCheck.setCheckType(2),this.clearRecordCheck.labelColor=16251903,this.addChild(this.clearRecordCheck),this.clearRecordCheck.scaleX=this.clearRecordCheck.scaleY=.8,this.clearRecordCheck.touchEnabled=!0,this.clearRecordCheck.touchChildren=!1,this.clearRecordCheck.check=!1,this.clearRecordCheck.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEntChange,this),this.resetRecordCheck=new t.CreateCheckMc,this.resetRecordCheck.x=750,this.resetRecordCheck.y=410,this.resetRecordCheck.label="重置排行",this.resetRecordCheck.setLabelSize(28),this.resetRecordCheck.setCheckType(2),this.resetRecordCheck.labelColor=16251903,this.addChild(this.resetRecordCheck),this.resetRecordCheck.scaleX=this.resetRecordCheck.scaleY=.8,this.resetRecordCheck.touchEnabled=!0,this.resetRecordCheck.touchChildren=!1,this.resetRecordCheck.check=!1,this.resetRecordCheck.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEntChange,this)},i.prototype.onEntChange=function(t){var e=t.target;e.check=!e.check},i.prototype.setData=function(t,e,i,n,o){void 0===t&&(t=null),void 0===e&&(e=null),this._backFn=t,this._backObject=e,t&&t[0]&&this.sureTButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSuer,this),this._backFn&&this._backFn[1]&&this.exportButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onExport,this),this.sureTButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.exportButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this)},i.prototype.onSuer=function(){this.clearRecordCheck.check?this.resetRecordCheck.check?this._backFn[0].call(this,2):this._backFn[0].call(this,1):this._backFn[0].call(this,0)},i.prototype.onExport=function(){this.clearRecordCheck.check?this.resetRecordCheck.check?this._backFn[1].call(this,2):this._backFn[1].call(this,1):this._backFn[1].call(this,0)},i.prototype.onClose=function(){uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),t.LobbyPopupManager.removePopUp(this),this.dispatchEventWith(t.LobbyUIEventConsts.CLOSE),this.destory()},i.prototype.destory=function(){this._backFn&&this._backFn[0]&&this.sureTButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this._backFn[0],this._backObject),this._backFn&&this._backFn[1]&&this.exportButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this._backFn[1],this._backObject),this.clearRecordCheck&&(this.clearRecordCheck.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEntChange,this),this.clearRecordCheck.destory()),this.clearRecordCheck=null,this.sureTButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.exportButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.closeButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this)},i}(eui.Component);t.MatchMsgExport=e,__reflect(e.prototype,"MJLobby.MatchMsgExport")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function o(){var t=e.call(this)||this;return t.skinName=new MatchPlayingPanelSkin,t.initUI(),o.instance=t,t}return __extends(o,e),o.prototype.addListener=function(){this.dissBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHandle,this),this.closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHandle,this)},o.prototype.removeListener=function(){this.dissBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHandle,this),this.closeButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHandle,this)},o.prototype.destory=function(){this.removeListener()},o.prototype.initUI=function(){this.addListener(),this.playerList.itemRenderer=i},o.prototype.initWaitList=function(e){this.topTableNumber.text="等待列表",this.sendId=t.MatchManagePanel.Instanc.selectMatchId,this.playerGroup.visible=!0,e=null!=e&&e instanceof Array?e:[],this.playerList.itemRenderer=i,this.updatePlayerList(e)},o.prototype.initPlayerList=function(t){this.topTableNumber.text="桌号："+t.roomId,this.sendId=t.roomId;var e=null!=t.list&&t.list instanceof Array?t.list:[];this.nameText.x+=50,this.playCount.x+=80,this.playerList.itemRenderer=n,this.updatePlayerList(e)},o.prototype.updatePlayerList=function(t){t&&!t[0]&&(t=null),this.playerList.dataProvider=new eui.ArrayCollection(t)},o.prototype.onHandle=function(e){var i=this;if(e.target==this.closeButton)this.dispatchEventWith(t.LobbyUIEventConsts.CLOSE);else if(e.target==this.dissBtn){var n=new t.MatchMsgBox;n.setData("","确认解散当前房间？",["确定","取消"],[function(){var e=new Cmd.ActiveDissolveRoomCmd_C;e.roomId=i.sendId,e.matchId=t.MatchManagePanel.Instanc.selectMatchId,t.LobbyServerMJProxy.getInstance().sendNotification(t.MahJongLobbyFacadeConsts.SEND_DATA,e,t.LobbyDataRequestCommand.GAME_DATA),t.NetMgr.setMsgTimeout(5,"ActiveDissolveRoomCmd_C")}],this),t.LobbyPopupManager.addPopUp(n,!0,!0),this.dispatchEventWith(t.LobbyUIEventConsts.CLOSE)}},o}(eui.Component);t.MatchPlayerListPanel=e,__reflect(e.prototype,"MJLobby.MatchPlayerListPanel");var i=function(i){function n(){var t=i.call(this)||this;return t.skinName=new MatchPlayerItemSkin,t.kickBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onKick,t),t}return __extends(n,i),n.prototype.dataChanged=function(){var e=this.data;if(this.uidLabel.text=null!=e.uid?e.uid+"":"",this.nameLabel.text=e.nickname,this.stateLabel.text=t.DataManage.StateToString(e.state),1!=e.state&&e.sec){var i=Date.now()/1e3-e.sec;60>i?this.stateLabel.text="已离线"+Math.floor(i)+"秒":3600>i?this.stateLabel.text="已离线"+Math.floor(i/60)+"分":86400>i?this.stateLabel.text="已离线"+Math.floor(i/3600)+"小时":this.stateLabel.text="已离线"+Math.floor(i/3600*24)+"天"}},n.prototype.onKick=function(){uniLib.SoundMgr.instance.playSound("buttonClick_mp3");var i=new t.MvcSender,n=new Cmd.KickLeaveRoomCmd_C;n.uid=this.data.uid,n.roomId=e.instance.sendId,i.sendNotification(t.MahJongLobbyFacadeConsts.SEND_DATA,n,t.LobbyDataRequestCommand.GAME_DATA),t.NetMgr.setMsgTimeout(5,"KickLeaveRoomCmd_C")},n}(eui.ItemRenderer);t.PlayerListItem=i,__reflect(i.prototype,"MJLobby.PlayerListItem");var n=function(t){function e(){var e=t.call(this)||this;return e.stateLabel.x+=80,e.nameLabel.x+=50,e}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.kickBtn.visible=!1},e}(i);t.RoomPlayerListItem=n,__reflect(n.prototype,"MJLobby.RoomPlayerListItem")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(){function t(){}return t}();t.MatchConfig=e,__reflect(e.prototype,"MJLobby.MatchConfig");var i=function(){function t(){}return t}();t.MatchSetCheck=i,__reflect(i.prototype,"MJLobby.MatchSetCheck");var n=function(e){function i(){var t=e.call(this)||this;return t.skinName=new MatchSetItemSkin,t.setBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onSetBtnCliek,t),t}return __extends(i,e),i.prototype.setData=function(e){var i=this;this.config=e,this.title.text=this.config.title;var n;this.config.info&&""!==this.config.info?(n=this.group2,this.info.text=this.config.info):(n=this.group1,this.info.text="",this.info.parent&&this.info.parent.removeChild(this.info)),2==this.config.btnType&&(this.setBtn.icon.source="mjl_matchSet_set"),this.config.checkList&&this.config.checkList.forEach(function(e){var o;switch(i.config.checkType){case 1:o=new eui.RadioButton,o.skinName=new MatchSetRadioSkin,o.label=e.label,o.value=e.value,o.groupName=i.hashCode,o.value==i.config.value&&(o.selected=!0),o.addEventListener(egret.TouchEvent.TOUCH_TAP,i.onBtnClick,i);break;case 2:o=new eui.CheckBox,o.skinName=new MatchSetCheckSkin,o.label=e.label,o.selected=1==i.config.value,o.addEventListener(eui.UIEvent.CHANGE,i.onBtnClick,i);break;case 3:o=new eui.TextInput,o.skinName=new MatchSetInputSkin,e.inputType&&(o.inputType=e.inputType),e.restrict&&(o.restrict=e.restrict),void 0!=i.config.value&&""!==i.config.value?o.text.prompt=i.config.value:o.text.prompt=e.label,o.addEventListener(eui.UIEvent.CHANGE,i.onInputChange,i);break;case 4:o=new t.List,o.setData(e.list,i.config.value),o.addEventListener(t.LobbyUIEventConsts.CHANGE,i.onListClick,i)}n.addChild(o)})},i.prototype.onBtnClick=function(t){var e=t.target;1==this.config.checkType?this.value=e.value:2==this.config.checkType&&(this.value=e.selected?1:0)},i.prototype.onInputChange=function(t){var e=t.target;e.text&&(0==isNaN(Number(e.text))?this.value=Number(e.text):this.value=e.text)},i.prototype.onListClick=function(t){var e=t.data;e&&0==isNaN(Number(e))&&(this.value=Number(e))},i.prototype.onSetBtnCliek=function(){if(uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),1==this.config.btnType){var e=new Cmd.ChangetMatchConfigMatchGroupCmd_CS;e.matchId=this.config.matchId,e.config=new Cmd.MatchConfig,e.config[this.config.key]=this.value,t.LobbyServerMJProxy.getInstance().sendData(e)}else if(2==this.config.btnType){var e=new Cmd.RequestMatchGameConfigMatchGroupCmd_C;e.matchId=this.config.matchId,t.LobbyServerMJProxy.getInstance().sendData(e)}},i.prototype.destroy=function(){var t;if(t=this.config.info&&""!==this.config.info?this.group2:this.group1)for(;t.numChildren;){var e=t.getChildAt(0);e&&(e.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this),3==this.config.checkType&&e.removeEventListener(eui.UIEvent.CHANGE_END,this.onInputChange,this),t.removeChildAt(0),e=null)}this.group1.removeChildren(),this.group2.removeChildren(),this.config=null},i}(eui.Component);t.MatchSetItem=n,__reflect(n.prototype,"MJLobby.MatchSetItem")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t._config=[],t.isNew=!0,t.skinName=new MatchSetPanelSkin,t._config=RES.getRes("TableMatchSetConfig_json"),t.init(),t}return __extends(i,e),Object.defineProperty(i.prototype,"config",{get:function(){return this._config},set:function(t){this._config=t},enumerable:!0,configurable:!0}),i.prototype.setData=function(t){this.matchId=t.matchId;var e=t.config;this._config&&this._config.forEach(function(i){if(i&&i.length>0)for(var n=i.length,o=0;n>o;o++){var a=i[o];a.matchId=t.matchId,a.key&&""!==a.key&&void 0!=e[a.key]&&(a.value=e[a.key])}}),this.isNew&&this.showSetItem(this.config[this.curId]),this.isNew=!1},i.prototype.init=function(){this.radio1.selected=!0,this.curId=0;for(var t=1;4>=t;t++){var e=this["radio"+t];e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRadioClick,this),e.groupName="MatchSetPanel"}this.clostBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this)},i.prototype.removeListener=function(){for(var t=1;4>=t;t++)this["radio"+t].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRadioClick,this);this.clostBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this)},i.prototype.onRadioClick=function(t){if(uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),this.setGroup){for(this.setGroup.numChildren;this.setGroup.numChildren>0;){var e=this.setGroup.getChildAt(0);e.destroy(),this.setGroup.removeChildAt(0)
}var i=t.target.value;3==i?this.commonTips.visible=!0:this.commonTips.visible=!1,this.curId=i,this.showSetItem(this.config[i])}},i.prototype.showSetItem=function(e){var i=this;e&&e.length>0&&e.forEach(function(e){var n=new t.MatchSetItem;n.setData(e),i.setGroup.addChild(n)})},i.prototype.onClose=function(){this._config=null,this.isNew=!0,uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),t.LobbyPopupManager.removePopUp(this,!0,!0),this.removeListener(),this.dispatchEventWith(t.LobbyUIEventConsts.CLOSE)},i}(t.BaseComponent);t.MatchSetPanel=e,__reflect(e.prototype,"MJLobby.MatchSetPanel")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(eui.RadioButton);t.MatchSetRadion=e,__reflect(e.prototype,"MJLobby.MatchSetRadion")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function i(t){var i=e.call(this)||this;return i.skinName=new MatchShareBoxSkin,i._data=t,i.addListener(),i}return __extends(i,e),i.prototype.addListener=function(){this._wXinIcon.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShareWx,this),this._xlIcon.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShareWx,this),this.closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this)},i.prototype.onShareWx=function(e){var i=uniLib.SHARE_PLAT.WX;if(!this._data)if(this._data=new uniLib.WXShareVo,""==uniLib.ZQGameSdk.defaultWXShareVo.webpageUrl&&t.LobbyDataCache.bundleInfo&&t.LobbyDataCache.bundleInfo.weixin.wbappid){var n=t.MJLobbyData.getInstance().myBaseInfo.nickName;n.length>8&&(n=n.slice(0,8)),this._data.webpageUrl="https://open.weixin.qq.com/connect/oauth2/authorize?appid="+t.LobbyDataCache.bundleInfo.weixin.wbappid+"&redirect_uri=http://"+t.MJLobbyData.getInstance().lobbyConfig.newLink+"/addons/zqgame/gameshare.php?appid="+t.LobbyDataCache.bundleInfo.weixin.wbappid+"&response_type=code&scope=snsapi_base&state="+uniLib.CompressUtil.base64encode(t.MJLobbyData.getInstance().myBaseInfo.uid+"|0|"+n)+"&connect_redirect=1#wechat_redirect"}else this._data.webpageUrl=uniLib.ZQGameSdk.defaultWXShareVo.webpageUrl+"?uid="+t.MJLobbyData.getInstance().myBaseInfo.uid+"&nickName="+t.MJLobbyData.getInstance().myBaseInfo.nickName;e.target==this._xlIcon?(i=uniLib.SHARE_PLAT.WJ,this._data.webpageUrl&&(this._data.webpageUrl=t.PublicMethed.getXianLiaoLink())):e.target==this._wXinIcon&&(this._data.shareWay=0),uniLib.ZQGameSdk.share(this._data,null,this,i),this.onClose()},i.prototype.onClose=function(){uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),uniLib.Global.isInGame?game.PopupManager&&game.PopupManager.removePopUp(this,!1):t.LobbyPopupManager&&t.LobbyPopupManager.removePopUp(this,!1,!0),this.dispatchEventWith(t.LobbyUIEventConsts.CLOSE),this.destory()},i.prototype.destory=function(){this._data=null,this._wXinIcon.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShareWx,this),this._xlIcon.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShareWx,this),this._wXinIcon.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this._xlIcon.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.closeButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this)},i}(eui.Component);t.MatchShareBox=e,__reflect(e.prototype,"MJLobby.MatchShareBox")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.taxUserData=[{key:"所有赢家",value:0},{key:"大赢家",value:1},{key:"一个赢家",value:2},{key:"两个赢家",value:3},{key:"三个赢家",value:4}],t.taxMinData=[{key:"0基金",value:0},{key:"50基金",value:50},{key:"100基金",value:100},{key:"200基金",value:200},{key:"500基金",value:500}],t.taxPerData=[{key:"赠送0%",value:0},{key:"赠送1%",value:1},{key:"赠送2%",value:2},{key:"赠送3%",value:3},{key:"赠送4%",value:4},{key:"赠送5%",value:5},{key:"赠送6%",value:6},{key:"赠送7%",value:7},{key:"赠送8%",value:8},{key:"赠送9%",value:9},{key:"赠送10%",value:10}],t.skinName=new MatchTaxSetSkin,t}return __extends(i,e),i.prototype.childrenCreated=function(){this.initRadioBtn(),this.initInput(),this.inintDrop()},i.prototype.inintDrop=function(){this.taxUserNumDrop&&(this.taxUserNumDrop.title="赠送基金",this.taxUserNumDrop.prompt="赠送方式",this.taxUserNumDrop.data=this.taxUserData),this.taxMinDrop&&(this.taxMinDrop.title="",this.taxMinDrop.prompt="起送基金",this.taxMinDrop.data=this.taxMinData),this.taxPerDrop&&(this.taxPerDrop.title="",this.taxPerDrop.prompt="赠送百分百",this.taxPerDrop.data=this.taxPerData)},i.prototype.initInput=function(){this.minEnterTax.title.text="最小携带基金",this.minEnterTaxEdit=this.minEnterTax.textDisplay,this.minEnterTaxEdit.prompt="输入最小携带基金",this.minEnterTaxEdit.width=this.minEnterTax.title.width,this.minRobTax.title.text="最小抢庄基金",this.minRobTaxEdit=this.minRobTax.textDisplay,this.minRobTaxEdit.prompt="输入最小抢庄基金",this.minRobTaxEdit.width=this.minRobTax.title.width,this.rebate1.title.text="一级返利比例",this.rebateEdit1=this.rebate1.textDisplay,this.rebateEdit1.prompt="输入返利百分比",this.rebateEdit1.width=this.minRobTax.title.width,this.rebate2.title.text="二级返利比例",this.rebateEdit1=this.rebate2.textDisplay,this.rebateEdit1.prompt="输入返利百分比",this.rebateEdit1.width=this.minRobTax.title.width},i.prototype.initRadioBtn=function(){this.canNegative||(this.canNegative=new eui.RadioButtonGroup),this.radioBox0.value=0,this.radioBox0.value=1,this.radioBox0.group=this.radioBox1.group=this.canNegative,this.radioBox0.selected=!0},i.prototype.onClose=function(){this.dispatchEventWith(egret.Event.CLOSE,!1,this._matchData),t.LobbyPopupManager.removePopUp(this,!1,!0)},i.prototype.onSave=function(){this._matchData||(this.minEnterTaxEdit&&this.minEnterTaxEdit.text&&""!=this.minEnterTaxEdit.text&&(this._matchData.minMatchPoint=Number(this.minEnterTaxEdit.text)),this.minRobTaxEdit&&this.minRobTaxEdit.text&&""!=this.minRobTaxEdit.text&&(this._matchData.minBankerPoint=Number(this.minRobTaxEdit.text)),this.rebate1&&this.rebate1.text&&""!=this.rebate1.text&&(this._matchData.tax1=Number(this.rebate1.text)),this.rebate2&&this.rebate2.text&&""!=this.rebate2.text&&(this._matchData.tax2=Number(this.rebate2.text)),this.canNegative&&this.canNegative.selectedValue!=this._matchData.canNegative&&(this._matchData.canNegative=this.canNegative.selectedValue),this.taxUserNumDrop&&this.taxUserNumDrop.value!=this._matchData.taxUserNum&&(this._matchData.taxUserNum=this.taxUserNumDrop.value),this.taxPerDrop&&this.taxPerDrop.value!=this._matchData.tax&&(this._matchData.tax=this.taxPerDrop.value),this.taxMinDrop&&this.taxMinDrop.value!=this._matchData.taxMin&&(this._matchData.taxMin=this.taxMinDrop.value))},i.prototype.addUIListener=function(){this.closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.saveBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSave,this)},i.prototype.removeUIListener=function(){this.saveBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSave,this),this.closeButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this)},i.prototype.initData=function(t){t&&t.matchId&&(this._matchData=t,t.minMatchPoint>=0&&(this.minEnterTaxEdit.prompt=t.minMatchPoint+""),t.minBankerPoint&&(this.minRobTaxEdit.prompt=t.minBankerPoint+""),t.tax1&&(this.minRobTaxEdit.prompt=t.tax1+""),t.tax2&&(this.minRobTaxEdit.prompt=t.tax2+""),1==t.canNegative?this.radioBox1.selected=!0:this.radioBox0.selected=!0,void 0!==t.taxUserNum&&this.taxUserNumDrop&&(this.taxUserNumDrop.value=t.taxUserNum),t.tax&&this.taxPerDrop&&(this.taxPerDrop.value=t.taxUserNum),t.taxMin&&this.taxMinDrop&&(this.taxMinDrop.value=t.taxMin))},i.prototype.destory=function(){this.taxMinData=null,this.taxPerData=null,this.taxUserData=null,this.minEnterTaxEdit=this.minRobTaxEdit=null,this.canNegative=null},i}(game.EuiPanel);t.MatchTaxSetPanel=e,__reflect(e.prototype,"MJLobby.MatchTaxSetPanel")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function i(t,i,n,o,a,s,r){var h=e.call(this)||this;return h.skinName=new MatchUserOprateSkin,h.idText=i,h.idLabel.text="ID:"+i,h.playerUid=i,h.nickNameLabel.text="昵称:"+(n?n.slice(0,8):""),h.integerLabel.text="当前积分:"+o,h.originInteger=o,h.curState=a,h.originState=a,4!=a?h["radioBox"+a].selected=!0:h.radioBox3.selected=!0,h.matchId=t,h.originDesc=s,h.setDesc.text=s,h.upPoint.selected=!0,h.upOrDown=!0,h.donateGroup.visible=!r,h}return __extends(i,e),i.prototype.init=function(){this.setIntegerText.inputType=egret.TextFieldInputType.TEL,this.setIntegerText.restrict="0-9 .",this.setYello.inputType=egret.TextFieldInputType.TEL,this.setYello.restrict="0-9",this.setYello.text="输入ID添加黄名单",this.addListener(),1!=t.MJLobbyData.getInstance().fundType&&(this.donateGroup.visible=!1)},i.prototype.addListener=function(){for(var t=0;4>t;t++)this["radioBox"+t].addEventListener(egret.TouchEvent.TOUCH_TAP,this.updataBtnState,this);this.sureBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this),this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this),this.upPoint.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this),this.reducePoint.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this),this.weChatBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.syncWeChat,this)},i.prototype.removeListener=function(){for(var t=0;4>t;t++)this["radioBox"+t].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.updataBtnState,this);this.sureBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this),this.closeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this),this.upPoint.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this),this.reducePoint.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this),this.weChatBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.syncWeChat,this)},i.prototype.syncWeChat=function(){var e=function(){var e=new Cmd.SyncUserWeChatInfoCmd_CS;e.uid=this.idText,e.leagueId=t.MatchManagePanel.Instanc.selectMatchId,t.LobbyServerMJProxy.getInstance().sendData(e)};t.LobbyPopupManager.showConfirmPanel("提示:点击确认可将微信头像、昵称立即同步到游戏！",["确认同步","取消"],[e],"同步微信",this,0/0,!0)},i.prototype.updataBtnState=function(t){uniLib.SoundMgr.instance.playSound("buttonClick_mp3");var e=t.target;e.selected=!0,this.curState=Number(e.value)},i.prototype.onBtnClick=function(e){if(uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),e.target==this.sureBtn){if(console.error(this.curState),console.error(this.originState),this.curState!=this.originState){var i=new Cmd.OperateMemberListMatchGroupCmd_C;i.matchId=this.matchId,i.uid=this.playerUid;var n=0;n=4==this.originState?1==this.curState?2:2==this.curState?3:0:1==this.curState||2==this.curState?1:3==this.curState?4:0,i.reply=n,t.LobbyServerMJProxy.getInstance().sendData(i)}var o=this.setIntegerText.text;if("请输入分数"!=o&&""!=o){var a=new Cmd.DonateChipsToUserMatchRoomCmd_C,s=1==this.upOrDown?1:-1;a.add=Number(o)*s,a.matchId=this.matchId,a.uid=this.playerUid,t.LobbyServerMJProxy.getInstance().sendData(a)}var r=this.setDesc.text;if(""!=r&&"输入备注"!=r&&r!=this.originDesc){" "==r&&(r="");var h=new Cmd.ChangeMatchDescMatchGroupCmd_CS;h.matchId=this.matchId,h.uid=this.playerUid,h.desc=r,t.LobbyServerMJProxy.getInstance().sendData(h)}var c=this.setYello.text;if("输入ID添加黄名单"!=c&&""!=c){if(c.length!=uniLib.NetMgr.UID.toString().length)return void t.LobbyPopupManager.showMildWarnShow("请输入正确ID");var l=new Cmd.OperateYellowMemberListMatchGroupCmd_C;l.matchId=this.matchId,l.reply=1,l.uid=this.playerUid,l.uid2=Number(c),t.LobbyServerMJProxy.getInstance().sendData(l)}}else if(e.target==this.upPoint||e.target==this.reducePoint)return void this.updateUpOrDown();this.removeListener(),this.dispatchEventWith(t.LobbyUIEventConsts.CLOSE)},i.prototype.updateUpOrDown=function(){this.upOrDown=this.upPoint.selected?!0:!1},i}(eui.Component);t.MatchUserOpratePanel=e,__reflect(e.prototype,"MJLobby.MatchUserOpratePanel")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.timeInterval=[],t.skinName=new MatchRecordSkin,t.initUI(),t}return __extends(n,e),Object.defineProperty(n.prototype,"curUid",{get:function(){return this._curUid},enumerable:!0,configurable:!0}),Object.defineProperty(n,"instace",{get:function(){return this._instace||(this._instace=new n),this._instace},enumerable:!0,configurable:!0}),n.clearInstance=function(){this._instace=null},n.prototype.addUIListener=function(){this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.destory,this),this.recordList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onRecordItemTap,this),this.daySelectList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onDaySelectHandle,this),this.searchBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSearchHandle,this)},n.prototype.removeUIListener=function(){this.closeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.destory,this),this.recordList.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onRecordItemTap,this),this.daySelectList.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onDaySelectHandle,this),this.searchBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSearchHandle,this)},n.prototype.onSearchHandle=function(){if(!this.recordData||this.recordData.length<=0)return void t.LobbyPopupManager.showMildSingleWarnShow("当前没有可查询战绩!");var e=this.endTime.seleceData.value,i=this.startTime.seleceData.value;e&&i&&this.onSearchByRange(i,e)},n.prototype.onSearchByRange=function(e,i){if(this.recordData&&this.recordData instanceof Array){if(0>=i-e)return void t.LobbyPopupManager.showMildSingleWarnShow("截止时间必须大于起始时间!");var n=this.recordData.filter(function(t){return e<t.endTime&&t.endTime<i});0==n.length&&(t.LobbyPopupManager.showMildSingleWarnShow("未查询到在此时间段内的战绩!"),n=this.recordData),this.recordCollection&&(this.recordCollection.source=n),this.updateScore(n)}},n.prototype.onRecordItemTap=function(t){},n.prototype.onDaySelectHandle=function(t){var e=this.daySelectList.selectedIndex,i=86400,n=new Date(Date.now()),o=new Date(n.getFullYear(),n.getMonth(),n.getDate()-e,0,0,0,0),a=Math.floor(o.valueOf()/1e3),s=a+i;this.setOneDayRang(a),this.onSearchByRange(a,s)},n.prototype.setDateRang=function(e,i){var n=[];n=t.PublicMethed.getDateRang(e,i),this.timeInterval=n,n.length>0&&(this.startTime.data=n.slice(0,n.length-1),this.endTime.data=n.slice(1,n.length),this.endTime.index=this.endTime.data.length-1)},n.prototype.setOneDayRang=function(e){var i=t.PublicMethed.getDayRang(e);this.timeInterval=i,i.length>0&&(this.startTime.data=i.slice(0,i.length-1),this.endTime.data=i.slice(1,i.length),this.startTime.index=0,this.endTime.index=this.endTime.data.length-1)},n.prototype.updateRecordList=function(){this.recordCollection||(this.recordCollection=new eui.ArrayCollection,this.recordList.dataProvider=this.recordCollection,this.recordList.itemRenderer=t.MatchFightingItem),this.recordCollection.source=this.recordData},n.prototype.initUI=function(){this.daySelectList.itemRenderer=i,this.daySelectList.dataProvider=this.dayCollection},n.prototype.setUserData=function(e,i){var n=this;e&&(this._curUid=e,this.idLabel.text="ID:"+e,t.HeadMcManager.instanc.getUserHeadByUid(e,this,function(t){t&&(n.headMc.source=t)})),this.nickName.text="昵称:"+(i?i.slice(0,5):"")},n.prototype.setRecordData=function(t){var e=this;if(t&&!(t.length<=0)&&this._curUid){this.recordData=[];for(var i=0,n=0,o=t;n<o.length;n++){var a=o[n];if(a.beginTime&&a.endTime&&a.list instanceof Array&&a.list.length>0){var s=a.list,r=s.first(function(t){return t.uid==e._curUid});r&&(i+=r.score,s.remove(r),s.unshift(r),this.recordData.push(a))}}i>=0?this.totalScore.font="match_record_win_fnt":this.totalScore.font="match_record_lose_fnt",this.totalScore.text=i+"",this.recordData.length>0&&(this.updateRecordList(),this.setDateRang(1e3*this.recordData[this.recordData.length-1].beginTime,1e3*this.recordData[0].beginTime))}},n.prototype.updateScore=function(t){var e=this;t=null!=t&&t instanceof Array?t:[];var i=0;if(0!=t.length&&this.curUid){for(var n=0,o=t;n<o.length;n++){var a=o[n],s=a&&null!=a.list&&a.list instanceof Array?a.list:[];if(s.length>0){var r=a.list.first(function(t){return t&&t.uid==e.curUid});r&&r.score&&(i+=r.score)}}i>=0?this.totalScore.font="match_record_win_fnt":this.totalScore.font="match_record_lose_fnt",this.totalScore.text=i+""}},n.prototype.destory=function(){t.LobbyPopupManager.removePopUp(this,!1,!0),this.recordData=null,this.recordCollection=null,this._curUid=null,this.startTime&&this.startTime.destory(),this.startTime=null,this.endTime&&this.endTime.destory(),this.endTime=null,n.clearInstance()},n}(game.EuiPanel);t.MatchUserRecordPanel=e,__reflect(e.prototype,"MJLobby.MatchUserRecordPanel");var i=function(t){function e(){var e=t.call(this)||this;return e.skinName=new MatchRecordRadioSkin,e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;t&&(this.dayText.source="match_record_radioText_"+t.dayText)},e}(eui.ItemRenderer);t.MatchRecordRadion=i,__reflect(i.prototype,"MJLobby.MatchRecordRadion")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function i(i,n){var o=e.call(this)||this;return o._data=i,o._bitmap=new egret.Bitmap,o._bitmap.texture=t.LobbyResUtil.createTexture(o._data[0]),o.addChild(o._bitmap),o.touchEnabled=!0,o.gotoAndStop(1),o.addEventListener(egret.TouchEvent.TOUCH_TAP,o.onClick,o),o._label=t.LobbyResUtil.createTextFeild(8204032,egret.HorizontalAlign.CENTER,n,34,3,20,231),o.addChild(o._label),o}return __extends(i,e),i.prototype.setDisabled=function(){this.gotoAndStop(3)},i.prototype.destory=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),t.LobbyResUtil.removeAllChildren(this),t.LobbyResUtil.removeFromParent(this),this._bitmap=null,this._label=null,this._data=null},Object.defineProperty(i.prototype,"id",{get:function(){return this._id},set:function(t){this._id=t},enumerable:!0,configurable:!0}),i.prototype.onClick=function(e){1==this._frame&&(this.gotoAndStop(2),this.dispatchEventWith(t.MenuItem.CHOOSED))},i.prototype.gotoAndStop=function(e){this._frame=e,this._bitmap.texture=t.LobbyResUtil.createTexture(this._data[e-1])},i}(egret.DisplayObjectContainer);e.CHOOSED="CHOOSED",t.CreateMenuItem=e,__reflect(e.prototype,"MJLobby.CreateMenuItem")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function i(n){var o=e.call(this,i.NAME,n)||this;return o._menuVc=n,o._menuVc.addEventListener(t.LobbyUIEventConsts.SHOW_HELP,o.uiEventHandle,o),o._menuVc.addEventListener(t.LobbyUIEventConsts.SHOW_SETTING,o.uiEventHandle,o),o._menuVc.addEventListener(t.LobbyUIEventConsts.SHOW_RECORD,o.uiEventHandle,o),o._menuVc.addEventListener(t.LobbyUIEventConsts.SHOW_REDPACKET,o.uiEventHandle,o),o._menuVc.addEventListener(t.LobbyUIEventConsts.ACTIVE_LIST_ROOM,o.uiEventHandle,o),o._menuVc.addEventListener(t.LobbyUIEventConsts.ROOM_MANAGE,o.uiEventHandle,o),o._menuVc.addEventListener(t.LobbyUIEventConsts.SHOW_NOTICE,o.uiEventHandle,o),o._menuVc.addEventListener(t.LobbyUIEventConsts.SHOW_MARKET,o.uiEventHandle,o),o}return __extends(i,e),i.prototype.onRemove=function(){e.prototype.onRemove.call(this),this._menuVc&&(this._menuVc.removeEventListener(t.LobbyUIEventConsts.SHOW_HELP,this.uiEventHandle,this),this._menuVc.removeEventListener(t.LobbyUIEventConsts.SHOW_SETTING,this.uiEventHandle,this),this._menuVc.removeEventListener(t.LobbyUIEventConsts.SHOW_RECORD,this.uiEventHandle,this),this._menuVc.removeEventListener(t.LobbyUIEventConsts.SHOW_REDPACKET,this.uiEventHandle,this),this._menuVc.removeEventListener(t.LobbyUIEventConsts.ACTIVE_LIST_ROOM,this.uiEventHandle,this),this._menuVc.removeEventListener(t.LobbyUIEventConsts.ROOM_MANAGE,this.uiEventHandle,this),this._menuVc.removeEventListener(t.LobbyUIEventConsts.SHOW_NOTICE,this.uiEventHandle,this),this._menuVc.removeEventListener(t.LobbyUIEventConsts.SHOW_MARKET,this.uiEventHandle,this),this._menuVc.destory(),this._menuVc=null),this.matchMessagePanel&&(this.removeMatchPanel(!1),this.matchMessagePanel.destory(),this.matchMessagePanel=null),this.removeRecordDetail(),this.removeRecordPanel(),this.removeChangeGameConfigPanel()},i.prototype.listNotificationInterests=function(){return[t.MahJongLobbyFacadeConsts.HISTORY_DATA,t.MahJongLobbyFacadeConsts.HISTORY_DETAIL_DATA,t.MahJongLobbyFacadeConsts.RETURN_ACTIVE_LIST_ROOM,t.MahJongLobbyFacadeConsts.ActiveDetailRoom,t.MahJongLobbyFacadeConsts.ReturnRoomMatchGroup,t.MahJongLobbyFacadeConsts.ENTER_MATCHGROUP,t.MahJongLobbyFacadeConsts.ReturnMatchGroup,t.MahJongLobbyFacadeConsts.JoinMemberListMatch,t.MahJongLobbyFacadeConsts.MemberInfoMatchGroup,t.MahJongLobbyFacadeConsts.PlayedListMatchGroup,t.MahJongLobbyFacadeConsts.ReturnYellowList,t.MahJongLobbyFacadeConsts.ReturnWaitList,t.MahJongLobbyFacadeConsts.RETURN_PROMOTE_REWARD,t.MahJongLobbyFacadeConsts.MatchGroupRecord,t.MahJongLobbyFacadeConsts.ReturnShopPointList,t.MahJongLobbyFacadeConsts.PersonalInfo,t.MahJongLobbyFacadeConsts.RefreshMemberInfoMatchGroup,t.MahJongLobbyFacadeConsts.ReturnChangeMatchConfig,t.MahJongLobbyFacadeConsts.ReturnChangeMatchGameConfig,t.MahJongLobbyFacadeConsts.ReturnMatchGroupRoomInfo]},i.prototype.handleNotification=function(e){switch(e.getName()){case t.MahJongLobbyFacadeConsts.ReturnMatchGroupRoomInfo:this.showRoomPlayerList(e.getBody().info);break;case t.MahJongLobbyFacadeConsts.ReturnChangeMatchGameConfig:this.showChangeGameConfigPanel(e.getBody());break;case t.MahJongLobbyFacadeConsts.ReturnChangeMatchConfig:this.matchMessagePanel&&this.matchMessagePanel.showMatchSetPanel(e.getBody());break;case t.MahJongLobbyFacadeConsts.RefreshMemberInfoMatchGroup:this.matchMessagePanel&&this.matchMessagePanel.updateMemberItemInfo(e.getBody());break;case t.MahJongLobbyFacadeConsts.PersonalInfo:var i=e.getBody();null!=i&&(t.MJLobbyData.getInstance().myBaseInfo=i),this.integralMallPanl&&this.integralMallPanl.parent&&null!=i&&i.growth&&this.integralMallPanl.updateUserIntegral(i.growth.shopPoint);break;case t.MahJongLobbyFacadeConsts.ReturnShopPointList:var n=e.getBody();if(!(n.list instanceof Array)||n.list.length<=0)break;var o=n.list.filter(function(t){return 2==t.moneyType});this.integralMallPanl&&this.integralMallPanl.parent&&this.integralMallPanl.updateShopList(o);break;case t.MahJongLobbyFacadeConsts.MatchGroupRecord:var a=e.getBody();if(t.MatchUserRecordPanel.instace&&t.MatchUserRecordPanel.instace.parent)return void t.MatchUserRecordPanel.instace.setRecordData(a.roomList);this.matchMessagePanel&&this.matchMessagePanel.parent&&this.matchMessagePanel.setMatchFightData(a);break;case t.MahJongLobbyFacadeConsts.RETURN_PROMOTE_REWARD:if(this.promotePanel){var s=e.getBody();this.promotePanel.setData(s.list),t.LobbyPopupManager.addPopUp(this.promotePanel,!0,!0)}break;case t.MahJongLobbyFacadeConsts.ReturnWaitList:this.matchMessagePanel&&this.matchMessagePanel.setWaitList(e.getBody());break;case t.MahJongLobbyFacadeConsts.ReturnMatchGroup:var r=e.getBody();this.showMatchPanel(),this.matchMessagePanel&&this.matchMessagePanel.initReturnMatchGroup(r);break;case t.MahJongLobbyFacadeConsts.JoinMemberListMatch:var h=e.getBody();this.matchMessagePanel&&this.matchMessagePanel.JoinMemberListMatch(h);break;case t.MahJongLobbyFacadeConsts.MemberInfoMatchGroup:var c=e.getBody();this.matchMessagePanel&&this.matchMessagePanel.initMemberList(c);break;case t.MahJongLobbyFacadeConsts.PlayedListMatchGroup:var l=e.getBody();this.matchMessagePanel&&this.matchMessagePanel.initPlayerList(l);break;case t.MahJongLobbyFacadeConsts.ReturnYellowList:var d=e.getBody();this.matchMessagePanel&&this.matchMessagePanel.initYelloList(d);break;case t.MahJongLobbyFacadeConsts.ENTER_MATCHGROUP:case t.MahJongLobbyFacadeConsts.ReturnRoomMatchGroup:this._menuVc.refreshFastJoin();break;case t.MahJongLobbyFacadeConsts.HISTORY_DETAIL_DATA:this._recordDetailPanel&&this._recordDetailPanel.addData(e.getBody());break;case t.MahJongLobbyFacadeConsts.HISTORY_DATA:this._recordPanel&&this._recordPanel.showData(e.getBody());var u=e.getBody();this.matchMessagePanel&&this.matchMessagePanel.initHistory(u);break;case t.MahJongLobbyFacadeConsts.RETURN_ACTIVE_LIST_ROOM:this._activePanel?this._activePanel.initData(e.getBody()):(this.showActivePanel(),this._activePanel.initData(e.getBody()));break;case t.MahJongLobbyFacadeConsts.ActiveDetailRoom:this.activeRoomInPanel||(this.activeRoomInPanel=t.ActiveRoomInformationPanel.Instance,this.activeRoomInPanel.addEventListener(t.LobbyUIEventConsts.CLOSE,this.detailRoom,this),this.activeRoomInPanel.addEventListener(t.LobbyUIEventConsts.GET_HISTORY_DETAIL_DATA,this.detailRoom,this),t.LobbyPopupManager.addPopUp(this.activeRoomInPanel,!0,!0,!0),this.activeRoomInPanel.initUI()),this.activeRoomInPanel.initData(e.getBody())}},i.prototype.showRoomPlayerList=function(e){if(e){var i=new t.MatchPlayerListPanel;t.LobbyPopupManager.addPopUp(i,!0,!0,!0),i.addEventListener(t.LobbyUIEventConsts.CLOSE,this.closeRoomPlayerList,this),i.initPlayerList(e)}},i.prototype.closeRoomPlayerList=function(e){var i=e.target;i.removeEventListener(t.LobbyUIEventConsts.CLOSE,this.closeRoomPlayerList,this),t.LobbyPopupManager.removePopUp(i),i.destory()},i.prototype.showChangeGameConfigPanel=function(e){if(this.changeGameConfig){if(this.remoteConfig&&e.matchId==this.remoteConfig.matchId){if(e.config)for(var i in e.config)this.remoteConfig.config[i]=e.config[i];e.proplist&&(this.remoteConfig.proplist=e.proplist)}}else if(this.changeGameConfig=new t.CreateGamePanel,this.changeGameConfig.addEventListener(t.LobbyUIEventConsts.CLOSE,this.removeChangeGameConfigPanel,this),this.changeGameConfig.addEventListener(t.LobbyUIEventConsts.SettingMatch,this.doChangeGameConfig,this),t.LobbyPopupManager.addPopUp(this.changeGameConfig,!0,!0),e&&e.config&&e.gameId){this.remoteConfig=e;var n=new Cmd.CreateRoomCmd_C;n.gameId=e.gameId;for(var i in e.config){var o=e.config[i];o&&(n[i]=o)}e.proplist&&(n.props=e.proplist.slice(0)),this.changeGameConfig.initData(n,!0)}},i.prototype.doChangeGameConfig=function(e){var i=e.data;if(i&&this.remoteConfig){var n=i.props.length,o=this.remoteConfig.proplist.length,a=!0;if(n==o){for(var s=0;n>s;s++)if(-1==this.remoteConfig.proplist.indexOf(i.props[s])){a=!1;break}}else a=!1;var r=new Cmd.ChangetMatchGameConfigMatchGroupCmd_CS;0==a&&(r.proplist=i.props.slice(0));var h=new Cmd.MatchGameConfig,c=!0;for(var l in this.remoteConfig.config)this.remoteConfig.config[l]!=i[l]&&(h[l]=i[l],c=!1);0==c&&(r.config=h),a&&c||(r.matchId=this.remoteConfig.matchId,t.LobbyServerMJProxy.getInstance().sendData(r))}},i.prototype.removeChangeGameConfigPanel=function(){this.changeGameConfig&&(this.changeGameConfig.removeEventListener(t.LobbyUIEventConsts.CLOSE,this.removeChangeGameConfigPanel,this),this.changeGameConfig.removeEventListener(t.LobbyUIEventConsts.SettingMatch,this.doChangeGameConfig,this),t.LobbyPopupManager.removePopUp(this.changeGameConfig,!1,!0),this.changeGameConfig.destory()),this.remoteConfig=null,this.changeGameConfig=null},i.prototype.showSetting=function(){var e=new t.LobbySettingPanel;e.addEventListener(t.LobbyUIEventConsts.CLOSE,this.settingHandle,this),e.addEventListener(t.LobbyUIEventConsts.LOGIN_OUT,this.settingHandle,this),t.LobbyPopupManager.addPopUp(e,!0,!0,!1)},i.prototype.settingHandle=function(e){switch(e.type){case t.LobbyUIEventConsts.LOGIN_OUT:this.sendNotification(t.MahJongLobbyFacadeConsts.SEND_DATA,null,t.LobbyDataRequestCommand.LOGIN_OUT),uniLib.SceneMgr.instance.changeScene(t.LobbyLoginPanel)}var i=e.currentTarget;i.removeEventListener(t.LobbyUIEventConsts.CLOSE,this.settingHandle,this),i.removeEventListener(t.LobbyUIEventConsts.LOGIN_OUT,this.settingHandle,this),t.LobbyPopupManager.removePopUp(i,!1,!0),i.destory()},i.prototype.showHelp=function(){var e=new t.HelpPanel;e.addEventListener(t.LobbyUIEventConsts.CLOSE,this.closeHelpPanel,this),t.LobbyPopupManager.addPopUp(e,!0,!0)},i.prototype.closeHelpPanel=function(e){var i=e.currentTarget;i.removeEventListener(t.LobbyUIEventConsts.CLICK,this.closeHelpPanel,this),t.LobbyPopupManager.removePopUp(i,!1,!0),i.destory()},i.prototype.detailRoom=function(e){var i=e.type;switch(i){case t.LobbyUIEventConsts.GET_HISTORY_DETAIL_DATA:this.removeActivePanel();var n=new Cmd.GetGameDetailHistoryCmd_C;n.globalRoomId=e.data,this.sendNotification(t.MahJongLobbyFacadeConsts.SEND_DATA,n,t.LobbyDataRequestCommand.GAME_DATA),this.showRecordDetail();case t.LobbyUIEventConsts.CLOSE:this.activeRoomInPanel&&(t.LobbyPopupManager.removePopUp(this.activeRoomInPanel,!1,!0),this.activeRoomInPanel.destory(),this.activeRoomInPanel=null)}},i.prototype.uiEventHandle=function(e){switch(e.type){case t.LobbyUIEventConsts.SHOW_MARKET:this.showIntegralMall();var i=new Cmd.ShopPointListLobbyCmd_C;i.lobbyId=t.MJLobbyData.getInstance().lobbyId,t.LobbyServerMJProxy.getInstance().sendData(i);break;case t.LobbyUIEventConsts.SHOW_NOTICE:break;case t.LobbyUIEventConsts.SHOW_SETTING:this.showSetting();break;case t.LobbyUIEventConsts.SHOW_HELP:this.showHelp();break;case t.LobbyUIEventConsts.SHOW_RECORD:this.showRecord();break;case t.LobbyUIEventConsts.ACTIVE_LIST_ROOM:var n=new Cmd.ActiveCreateRoomCmd_C;this.sendNotification(t.MahJongLobbyFacadeConsts.SEND_DATA,n,t.LobbyDataRequestCommand.GAME_DATA),t.NetMgr.setMsgTimeout(5,"ActiveCreateRoomCmd_C");break;case t.LobbyUIEventConsts.ROOM_MANAGE:var o=new Cmd.RequestMatchGroupCmd_C;this.sendNotification(t.MahJongLobbyFacadeConsts.SEND_DATA,o,t.LobbyDataRequestCommand.GAME_DATA)}},i.prototype.showMatchPanel=function(){this.removeMatchPanel(),this.matchMessagePanel||(this.matchMessagePanel=t.MatchManagePanel.Instanc),this.matchMessagePanel.initUI(),this.matchMessagePanel.addEventListener(t.LobbyUIEventConsts.CLOSE,this.removeMatchPanel,this),this.matchMessagePanel.addEventListener(t.LobbyUIEventConsts.GET_HISTORY_DETAIL_DATA,this.recordHandle,this),this.matchMessagePanel.addEventListener("show_promote",this.showPromoteRewardPanel,this),t.LobbyPopupManager.addPopUp(this.matchMessagePanel,!0,!0)},i.prototype.removeMatchPanel=function(e){void 0===e&&(e=!0),this.matchMessagePanel&&(this.matchMessagePanel.removeEventListener(t.LobbyUIEventConsts.CLOSE,this.removeMatchPanel,this),this.matchMessagePanel.removeEventListener(t.LobbyUIEventConsts.GET_HISTORY_DETAIL_DATA,this.recordHandle,this),this.matchMessagePanel.removeEventListener("show_promote",this.showPromoteRewardPanel,this),t.LobbyPopupManager.removePopUp(this.matchMessagePanel,!1,!0),this.matchMessagePanel.onRemove()),e&&(this.matchMessagePanel=null)},i.prototype.showIntegralMall=function(){this.integralMallPanl||(this.integralMallPanl=new t.LobbyIntegralMallPanel),0==this.integralMallPanl.hasEventListener(egret.Event.CLOSE)&&this.integralMallPanl.addEventListener(egret.Event.CLOSE,this.removeIntegralMall,this),t.LobbyPopupManager.addPopUp(this.integralMallPanl,!0,!0)},i.prototype.removeIntegralMall=function(){this.integralMallPanl&&(this.integralMallPanl.removeEventListener(egret.Event.CLOSE,this.removeIntegralMall,this),t.LobbyPopupManager.removePopUp(this.integralMallPanl,!1,!1)),this.integralMallPanl=null},i.prototype.showPromoteRewardPanel=function(e){if(e.data){var i=e.data;this.promotePanel||(this.promotePanel=new t.PromoteRewardPanel,this.promotePanel.addEventListener(t.LobbyUIEventConsts.CLOSE,this.removePromoteRewardPanel,this)),this.promotePanel.setShareInfo(i.matchId,i.matchName,i.wechat,i.extenStr,i.shareInfo)}},i.prototype.removePromoteRewardPanel=function(){this.promotePanel&&(this.promotePanel.removeEventListener(t.LobbyUIEventConsts.CLOSE,this.removePromoteRewardPanel,this),this.promotePanel.destory(),this.promotePanel.parent&&t.LobbyPopupManager.removePopUp(this.promotePanel,!0)),this.promotePanel=null},i.prototype.showRecordDetail=function(e){void 0===e&&(e=!0),this._recordDetailPanel||(this._recordDetailPanel=new t.DetailRecordPanel,this._recordDetailPanel.addEventListener(t.LobbyUIEventConsts.CLOSE,this.removeRecordDetail,this),this._recordDetailPanel.addEventListener(t.LobbyUIEventConsts.CLOSE_RECORD,this.removeRecordDetail,this),this._recordDetailPanel.addEventListener(t.LobbyUIEventConsts.REQ_LOOK_VIDEO,this.removeRecordDetail,this),t.LobbyPopupManager.addPopUp(this._recordDetailPanel,!0,!0)),this._recordDetailPanel.isFromRecord=e
},i.prototype.removeRecordDetail=function(e){if(e){switch(e.type){case t.LobbyUIEventConsts.CLOSE:this.removeDetailPanel();break;case t.LobbyUIEventConsts.REQ_LOOK_VIDEO:var i=new Cmd.RequestRecordLobbyCmd_C;i.curGameNbr=e.data,i.globalRoomId=t.MJLobbyData.getInstance().globalRoomId,this.sendNotification(t.MahJongLobbyFacadeConsts.SEND_DATA,i,t.LobbyDataRequestCommand.GAME_DATA)}this.removeDetailPanel()}},i.prototype.removeDetailPanel=function(){this._recordDetailPanel&&(this._recordDetailPanel.removeEventListener(t.LobbyUIEventConsts.CLOSE,this.removeRecordDetail,this),this._recordDetailPanel.removeEventListener(t.LobbyUIEventConsts.BACK_ROOM,this.removeRecordDetail,this),this._recordDetailPanel.removeEventListener(t.LobbyUIEventConsts.REQ_LOOK_VIDEO,this.removeRecordDetail,this),this._recordDetailPanel.destory(),t.LobbyPopupManager.removePopUp(this._recordDetailPanel,!1,!0),this._recordDetailPanel=null)},i.prototype.copyText=function(){uniLib.ZQGameSdk.nativeCopyStr(t.MJLobbyData.getInstance().redPassword),t.LobbyPopupManager.showMildWarnShow(t.MJLobbyData.getInstance().redPassword+"复制成功")},i.prototype.showRecord=function(){this._recordPanel||(this._recordPanel=new t.LobbyRecordPanel,this._recordPanel.addEventListener(t.LobbyUIEventConsts.GET_HISTORY_DETAIL_DATA,this.recordHandle,this),this._recordPanel.addEventListener(t.LobbyUIEventConsts.GET_HISTORY_DATA,this.recordHandle,this),this._recordPanel.addEventListener(t.LobbyUIEventConsts.CLOSE,this.recordHandle,this),this._recordPanel.addEventListener(t.LobbyUIEventConsts.OPEN_LOOK_RECORDPANEL,this.recordHandle,this),this._recordPanel.getData(),t.LobbyPopupManager.addPopUp(this._recordPanel,!0,!0))},i.prototype.recordHandle=function(e){switch(e.type){case t.LobbyUIEventConsts.GET_HISTORY_DATA:var i=new Cmd.GetGameDataHistoryCmd_C;i.curPage=e.data+1,this.sendNotification(t.MahJongLobbyFacadeConsts.SEND_DATA,i,t.LobbyDataRequestCommand.GAME_DATA);break;case t.LobbyUIEventConsts.GET_HISTORY_DETAIL_DATA:var n=new Cmd.GetGameDetailHistoryCmd_C;n.globalRoomId=e.data,this.sendNotification(t.MahJongLobbyFacadeConsts.SEND_DATA,n,t.LobbyDataRequestCommand.GAME_DATA);var o=e.target instanceof t.LobbyRecordPanel;this.showRecordDetail(o);break;case t.LobbyUIEventConsts.CLOSE:this.removeRecordPanel();break;case t.LobbyUIEventConsts.OPEN_LOOK_RECORDPANEL:this.showLookVideoPanel()}},i.prototype.showLookVideoPanel=function(){this._lookVideoPanel||(this._lookVideoPanel=new t.LobbyLookVideoPanel,this._lookVideoPanel.addEventListener(t.LobbyUIEventConsts.LOOK_RECORD_ID,this.lookVideo,this),this._lookVideoPanel.addEventListener(t.LobbyUIEventConsts.CLOSE,this.lookVideo,this),t.LobbyPopupManager.addPopUp(this._lookVideoPanel,!0,!0))},i.prototype.lookVideo=function(e){if(e.type==t.LobbyUIEventConsts.LOOK_RECORD_ID){var i=e.data.split(":"),n=new Cmd.RequestRecordLobbyCmd_C;n.globalRoomId=Number(i[0]),n.curGameNbr=Number(i[1]),this.sendNotification(t.MahJongLobbyFacadeConsts.SEND_DATA,n,t.LobbyDataRequestCommand.GAME_DATA)}this._lookVideoPanel&&(t.LobbyPopupManager.removePopUp(this._lookVideoPanel,!1,!0),this._lookVideoPanel.destory(),this._lookVideoPanel=null)},i.prototype.removeRecordPanel=function(){this._recordPanel&&(this._recordPanel.removeEventListener(t.LobbyUIEventConsts.GET_HISTORY_DETAIL_DATA,this.recordHandle,this),this._recordPanel.removeEventListener(t.LobbyUIEventConsts.GET_HISTORY_DATA,this.recordHandle,this),this._recordPanel.removeEventListener(t.LobbyUIEventConsts.CLOSE,this.recordHandle,this),this._recordPanel.removeEventListener(t.LobbyUIEventConsts.OPEN_LOOK_RECORDPANEL,this.recordHandle,this),t.LobbyPopupManager.removePopUp(this._recordPanel,!1,!0),this._recordPanel.destory(),this._recordPanel=null)},i.prototype.showActivePanel=function(){this._activePanel||(this._activePanel=new t.ActiveGameListPanel,this._activePanel.addEventListener(t.LobbyUIEventConsts.CLOSE,this.activeUIEvent,this),t.LobbyPopupManager.addPopUp(this._activePanel,!0,!0,!0))},i.prototype.removeActivePanel=function(){this._activePanel&&(this._activePanel.removeEventListener(t.LobbyUIEventConsts.CLOSE,this.activeUIEvent,this),t.LobbyPopupManager.removePopUp(this._activePanel,!1,!0),this._activePanel.destory(),this._activePanel=null)},i.prototype.activeUIEvent=function(t){t.type,this.removeActivePanel()},i}(t.Mediator);e.NAME="MJLobbyMenuDownMediator",t.MJLobbyMenuDownMediator=e,__reflect(e.prototype,"MJLobby.MJLobbyMenuDownMediator")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function i(){return e.call(this)||this}return __extends(i,e),i.prototype.start=function(e){void 0===e&&(e=null),egret.MainContext.instance.stage.setContentSize(uniLib.Global.screenWidth,uniLib.Global.screenHeight),t.MJLobbyInfo.uiLayer=this.uiLayer,t.MJLobbyInfo.mainUILayer=this.uiLayer,this.uiLayer.visible=!0,t.MJLobbyInfo.topLayer=this.tipsLayer,t.MahJongLobbyFacade.getLobbyInstance().startUp(this)},i.prototype.destroy=function(){e.prototype.destroy.call(this),t.MahJongLobbyFacade.getLobbyInstance().sendNotification(t.MahJongLobbyFacadeConsts.DESTORY)},i.prototype.resize=function(){this.width=t.LobbyDataCache.defaultWidth=uniLib.Global.screenWidth,this.height=t.LobbyDataCache.defaultHeight=uniLib.Global.screenHeight},i}(uniLib.LobbyScene);t.MJLobbyScene=e,__reflect(e.prototype,"MJLobby.MJLobbyScene")}(MJLobby||(MJLobby={}));var qr;!function(t){var e=function(){function e(e){this.mode=t.QRMode.MODE_8BIT_BYTE,this.data=e,this.parsedData=[];for(var i=0,n=this.data.length;n>i;i++){var o=[],a=this.data.charCodeAt(i);a>65536?(o[0]=240|(1835008&a)>>>18,o[1]=128|(258048&a)>>>12,o[2]=128|(4032&a)>>>6,o[3]=128|63&a):a>2048?(o[0]=224|(61440&a)>>>12,o[1]=128|(4032&a)>>>6,o[2]=128|63&a):a>128?(o[0]=192|(1984&a)>>>6,o[1]=128|63&a):o[0]=a,this.parsedData.push(o)}this.parsedData=Array.prototype.concat.apply([],this.parsedData),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}return e.prototype.getLength=function(t){return this.parsedData.length},e.prototype.write=function(t){for(var e=0,i=this.parsedData.length;i>e;e++)t.put(this.parsedData[e],8)},e}();t.QR8bitByte=e,__reflect(e.prototype,"qr.QR8bitByte")}(qr||(qr={}));var qr;!function(t){var e=function(){function t(){this.buffer=[],this.length=0}return t.prototype.get=function(t){var e=Math.floor(t/8);return 1==(this.buffer[e]>>>7-t%8&1)},t.prototype.put=function(t,e){for(var i=0;e>i;i++)this.putBit(1==(t>>>e-i-1&1))},t.prototype.getLengthInBits=function(){return this.length},t.prototype.putBit=function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++},t}();t.QRBitBuffer=e,__reflect(e.prototype,"qr.QRBitBuffer")}(qr||(qr={}));var qr;!function(t){var e=function(){function e(){}return e.create=function(i,n,o,a,s,r){void 0===n&&(n=200),void 0===o&&(o=200),void 0===a&&(a=t.QRErrorCorrectLevel.M),void 0===s&&(s=4),void 0===r&&(r=0);var h={color:r,width:n,height:o,correctLevel:a,typeNumer:s},c=new t.QRCodeModel(h.typeNumer,h.correctLevel);return c.addData(i),c.make(),e.draw(c,h)},e.draw=function(t,e){var i=new egret.Sprite,e=e,n=t.getModuleCount(),o=e.width/n,a=e.height/n,s=10;i.graphics.moveTo(-s,-s),i.graphics.beginFill(16777215),i.graphics.drawRect(-s,-s,e.width+2*s,e.height+2*s),i.graphics.endFill();for(var r=0;n>r;r++)for(var h=0;n>h;h++){var c=t.isDark(r,h);c&&(i.graphics.moveTo(h*o,r*a),i.graphics.beginFill(e.color),i.graphics.drawRect(h*o,r*a,o,a),i.graphics.endFill())}return i},e}();t.QRCode=e,__reflect(e.prototype,"qr.QRCode")}(qr||(qr={}));var qr;!function(t){var e=function(){function e(t,e){this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[],this.typeNumber=t,this.errorCorrectLevel=e,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}return e.prototype.addData=function(e){var i=new t.QR8bitByte(e);this.dataList.push(i),this.dataCache=null},e.prototype.isDark=function(t,e){if(0>t||this.moduleCount<=t||0>e||this.moduleCount<=e)throw new Error(t+","+e);return this.modules[t][e]},e.prototype.getModuleCount=function(){return this.moduleCount},e.prototype.make=function(){this.makeImpl(!1,this.getBestMaskPattern())},e.prototype.makeImpl=function(t,i){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var n=0;n<this.moduleCount;n++){this.modules[n]=new Array(this.moduleCount);for(var o=0;o<this.moduleCount;o++)this.modules[n][o]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(t,i),this.typeNumber>=7&&this.setupTypeNumber(t),null==this.dataCache&&(this.dataCache=e.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,i)},e.prototype.setupPositionProbePattern=function(t,e){for(var i=-1;7>=i;i++)if(!(-1>=t+i||this.moduleCount<=t+i))for(var n=-1;7>=n;n++)-1>=e+n||this.moduleCount<=e+n||(i>=0&&6>=i&&(0==n||6==n)||n>=0&&6>=n&&(0==i||6==i)||i>=2&&4>=i&&n>=2&&4>=n?this.modules[t+i][e+n]=!0:this.modules[t+i][e+n]=!1)},e.prototype.getBestMaskPattern=function(){for(var e=0,i=0,n=0;8>n;n++){this.makeImpl(!0,n);var o=t.QRUtil.getLostPoint(this);(0==n||e>o)&&(e=o,i=n)}return i},e.prototype.createMovieClip=function(t,e,i){var n=t.createEmptyMovieClip(e,i),o=1;this.make();for(var a=0;a<this.modules.length;a++)for(var s=a*o,r=0;r<this.modules[a].length;r++){var h=r*o,c=this.modules[a][r];c&&(n.beginFill(0,100),n.moveTo(h,s),n.lineTo(h+o,s),n.lineTo(h+o,s+o),n.lineTo(h,s+o),n.endFill())}return n},e.prototype.setupTimingPattern=function(){for(var t=8;t<this.moduleCount-8;t++)null==this.modules[t][6]&&(this.modules[t][6]=t%2==0);for(var e=8;e<this.moduleCount-8;e++)null==this.modules[6][e]&&(this.modules[6][e]=e%2==0)},e.prototype.setupPositionAdjustPattern=function(){for(var e=t.QRUtil.getPatternPosition(this.typeNumber),i=0;i<e.length;i++)for(var n=0;n<e.length;n++){var o=e[i],a=e[n];if(null==this.modules[o][a])for(var s=-2;2>=s;s++)for(var r=-2;2>=r;r++)-2==s||2==s||-2==r||2==r||0==s&&0==r?this.modules[o+s][a+r]=!0:this.modules[o+s][a+r]=!1}},e.prototype.setupTypeNumber=function(e){for(var i=t.QRUtil.getBCHTypeNumber(this.typeNumber),n=0;18>n;n++){var o=!e&&1==(i>>n&1);this.modules[Math.floor(n/3)][n%3+this.moduleCount-8-3]=o}for(var n=0;18>n;n++){var o=!e&&1==(i>>n&1);this.modules[n%3+this.moduleCount-8-3][Math.floor(n/3)]=o}},e.prototype.setupTypeInfo=function(e,i){for(var n=this.errorCorrectLevel<<3|i,o=t.QRUtil.getBCHTypeInfo(n),a=0;15>a;a++){var s=!e&&1==(o>>a&1);6>a?this.modules[a][8]=s:8>a?this.modules[a+1][8]=s:this.modules[this.moduleCount-15+a][8]=s}for(var a=0;15>a;a++){var s=!e&&1==(o>>a&1);8>a?this.modules[8][this.moduleCount-a-1]=s:9>a?this.modules[8][15-a-1+1]=s:this.modules[8][15-a-1]=s}this.modules[this.moduleCount-8][8]=!e},e.prototype.mapData=function(e,i){for(var n=-1,o=this.moduleCount-1,a=7,s=0,r=this.moduleCount-1;r>0;r-=2)for(6==r&&r--;;){for(var h=0;2>h;h++)if(null==this.modules[o][r-h]){var c=!1;s<e.length&&(c=1==(e[s]>>>a&1));var l=t.QRUtil.getMask(i,o,r-h);l&&(c=!c),this.modules[o][r-h]=c,a--,-1==a&&(s++,a=7)}if(o+=n,0>o||this.moduleCount<=o){o-=n,n=-n;break}}},e.createData=function(i,n,o){for(var a=t.QRRSBlock.getRSBlocks(i,n),s=new t.QRBitBuffer,r=0;r<o.length;r++){var h=o[r];s.put(h.mode,4),s.put(h.getLength(),t.QRUtil.getLengthInBits(h.mode,i)),h.write(s)}for(var c=0,r=0;r<a.length;r++)c+=a[r].dataCount;if(s.getLengthInBits()>8*c)throw new Error("code length overflow. ("+s.getLengthInBits()+">"+8*c+")");for(s.getLengthInBits()+4<=8*c&&s.put(0,4);s.getLengthInBits()%8!=0;)s.putBit(!1);for(;!(s.getLengthInBits()>=8*c)&&(s.put(e.PAD0,8),!(s.getLengthInBits()>=8*c));)s.put(e.PAD1,8);return e.createBytes(s,a)},e.createBytes=function(e,i){for(var n=0,o=0,a=0,s=new Array(i.length),r=new Array(i.length),h=0;h<i.length;h++){var c=i[h].dataCount,l=i[h].totalCount-c;o=Math.max(o,c),a=Math.max(a,l),s[h]=new Array(c);for(var d=0;d<s[h].length;d++)s[h][d]=255&e.buffer[d+n];n+=c;var u=t.QRUtil.getErrorCorrectPolynomial(l),b=new t.QRPolynomial(s[h],u.getLength()-1),p=b.mod(u);r[h]=new Array(u.getLength()-1);for(var d=0;d<r[h].length;d++){var m=d+p.getLength()-r[h].length;r[h][d]=m>=0?p.get(m):0}}for(var y=0,d=0;d<i.length;d++)y+=i[d].totalCount;for(var g=new Array(y),v=0,d=0;o>d;d++)for(var h=0;h<i.length;h++)d<s[h].length&&(g[v++]=s[h][d]);for(var d=0;a>d;d++)for(var h=0;h<i.length;h++)d<r[h].length&&(g[v++]=r[h][d]);return g},e}();e.PAD0=236,e.PAD1=17,t.QRCodeModel=e,__reflect(e.prototype,"qr.QRCodeModel")}(qr||(qr={}));var qr;!function(t){var e=function(){function t(){}return t}();e.L=1,e.M=0,e.Q=3,e.H=2,t.QRErrorCorrectLevel=e,__reflect(e.prototype,"qr.QRErrorCorrectLevel")}(qr||(qr={}));var qr;!function(t){var e=function(){function t(){}return t}();e.PATTERN000=0,e.PATTERN001=1,e.PATTERN010=2,e.PATTERN011=3,e.PATTERN100=4,e.PATTERN101=5,e.PATTERN110=6,e.PATTERN111=7,t.QRMaskPattern=e,__reflect(e.prototype,"qr.QRMaskPattern")}(qr||(qr={}));var qr;!function(t){var e=function(){function t(){}return t.glog=function(e){return t.isInit||t.init(),1>e&&console.log("错误:n="+e),t.LOG_TABLE[e]},t.gexp=function(e){for(t.isInit||t.init();0>e;)e+=255;for(;e>=256;)e-=255;return t.EXP_TABLE[e]},t.init=function(){t.isInit=!0;for(var e=0;8>e;e++)t.EXP_TABLE[e]=1<<e;for(var e=8;256>e;e++)t.EXP_TABLE[e]=t.EXP_TABLE[e-4]^t.EXP_TABLE[e-5]^t.EXP_TABLE[e-6]^t.EXP_TABLE[e-8];for(var e=0;255>e;e++)t.LOG_TABLE[t.EXP_TABLE[e]]=e},t}();e.EXP_TABLE=new Array(256),e.LOG_TABLE=new Array(256),t.QRMath=e,__reflect(e.prototype,"qr.QRMath")}(qr||(qr={}));var qr;!function(t){var e=function(){function t(){}return t}();e.MODE_NUMBER=1,e.MODE_ALPHA_NUM=2,e.MODE_8BIT_BYTE=4,e.MODE_KANJI=8,t.QRMode=e,__reflect(e.prototype,"qr.QRMode")}(qr||(qr={}));var qr;!function(t){var e=function(){function e(t,e){if(void 0==t.length)throw new Error(t.length+"/"+e);for(var i=0;i<t.length&&0==t[i];)i++;this.num=new Array(t.length-i+e);for(var n=0;n<t.length-i;n++)this.num[n]=t[n+i]}return e.prototype.get=function(t){return this.num[t]},e.prototype.getLength=function(){return this.num.length},e.prototype.multiply=function(i){for(var n=new Array(this.getLength()+i.getLength()-1),o=0;o<this.getLength();o++)for(var a=0;a<i.getLength();a++)n[o+a]^=t.QRMath.gexp(t.QRMath.glog(this.get(o))+t.QRMath.glog(i.get(a)));return new e(n,0)},e.prototype.mod=function(i){if(this.getLength()-i.getLength()<0)return this;for(var n=t.QRMath.glog(this.get(0))-t.QRMath.glog(i.get(0)),o=new Array(this.getLength()),a=0;a<this.getLength();a++)o[a]=this.get(a);for(var a=0;a<i.getLength();a++)o[a]^=t.QRMath.gexp(t.QRMath.glog(i.get(a))+n);return new e(o,0).mod(i)},e}();t.QRPolynomial=e,__reflect(e.prototype,"qr.QRPolynomial")}(qr||(qr={}));var qr;!function(t){var e=function(){function t(t,e){this.totalCount=t,this.dataCount=e}return t}();e.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],e.getRSBlocks=function(t,i){var n=e.getRsBlockTable(t,i);if(void 0==n)throw new Error("bad rs block @ typeNumber:"+t+"/errorCorrectLevel:"+i);for(var o=n.length/3,a=[],s=0;o>s;s++)for(var r=n[3*s+0],h=n[3*s+1],c=n[3*s+2],l=0;r>l;l++)a.push(new e(h,c));return a},e.getRsBlockTable=function(i,n){switch(n){case t.QRErrorCorrectLevel.L:return e.RS_BLOCK_TABLE[4*(i-1)+0];case t.QRErrorCorrectLevel.M:return e.RS_BLOCK_TABLE[4*(i-1)+1];case t.QRErrorCorrectLevel.Q:return e.RS_BLOCK_TABLE[4*(i-1)+2];case t.QRErrorCorrectLevel.H:return e.RS_BLOCK_TABLE[4*(i-1)+3];default:return}},t.QRRSBlock=e,__reflect(e.prototype,"qr.QRRSBlock")}(qr||(qr={}));var qr;!function(t){var e=function(){function e(){}return e.getBCHTypeInfo=function(t){for(var i=t<<10;e.getBCHDigit(i)-e.getBCHDigit(e.G15)>=0;)i^=e.G15<<e.getBCHDigit(i)-e.getBCHDigit(e.G15);return(t<<10|i)^e.G15_MASK},e.getBCHTypeNumber=function(t){for(var i=t<<12;e.getBCHDigit(i)-e.getBCHDigit(e.G18)>=0;)i^=e.G18<<e.getBCHDigit(i)-e.getBCHDigit(e.G18);return t<<12|i},e.getBCHDigit=function(t){for(var e=0;0!=t;)e++,t>>>=1;return e},e.getPatternPosition=function(t){return e.PATTERN_POSITION_TABLE[t-1]},e.getMask=function(e,i,n){switch(e){case t.QRMaskPattern.PATTERN000:return(i+n)%2==0;case t.QRMaskPattern.PATTERN001:return i%2==0;case t.QRMaskPattern.PATTERN010:return n%3==0;case t.QRMaskPattern.PATTERN011:return(i+n)%3==0;case t.QRMaskPattern.PATTERN100:return(Math.floor(i/2)+Math.floor(n/3))%2==0;case t.QRMaskPattern.PATTERN101:return i*n%2+i*n%3==0;case t.QRMaskPattern.PATTERN110:return(i*n%2+i*n%3)%2==0;case t.QRMaskPattern.PATTERN111:return(i*n%3+(i+n)%2)%2==0;default:throw new Error("bad maskPattern:"+e)}},e.getErrorCorrectPolynomial=function(e){for(var i=new t.QRPolynomial([1],0),n=0;e>n;n++)i=i.multiply(new t.QRPolynomial([1,t.QRMath.gexp(n)],0));return i},e.getLengthInBits=function(e,i){if(i>=1&&10>i)switch(e){case t.QRMode.MODE_NUMBER:return 10;case t.QRMode.MODE_ALPHA_NUM:return 9;case t.QRMode.MODE_8BIT_BYTE:return 8;case t.QRMode.MODE_KANJI:return 8;default:throw new Error("mode:"+e)}else if(27>i)switch(e){case t.QRMode.MODE_NUMBER:return 12;case t.QRMode.MODE_ALPHA_NUM:return 11;case t.QRMode.MODE_8BIT_BYTE:return 16;case t.QRMode.MODE_KANJI:return 10;default:throw new Error("mode:"+e)}else{if(!(41>i))throw new Error("type:"+i);switch(e){case t.QRMode.MODE_NUMBER:return 14;case t.QRMode.MODE_ALPHA_NUM:return 13;case t.QRMode.MODE_8BIT_BYTE:return 16;case t.QRMode.MODE_KANJI:return 12;default:throw new Error("mode:"+e)}}},e.getLostPoint=function(t){for(var e=t.getModuleCount(),i=0,n=0;e>n;n++)for(var o=0;e>o;o++){for(var a=0,s=t.isDark(n,o),r=-1;1>=r;r++)if(!(0>n+r||n+r>=e))for(var h=-1;1>=h;h++)0>o+h||o+h>=e||(0!=r||0!=h)&&s==t.isDark(n+r,o+h)&&a++;a>5&&(i+=3+a-5)}for(var n=0;e-1>n;n++)for(var o=0;e-1>o;o++){var c=0;t.isDark(n,o)&&c++,t.isDark(n+1,o)&&c++,t.isDark(n,o+1)&&c++,t.isDark(n+1,o+1)&&c++,(0==c||4==c)&&(i+=3)}for(var n=0;e>n;n++)for(var o=0;e-6>o;o++)t.isDark(n,o)&&!t.isDark(n,o+1)&&t.isDark(n,o+2)&&t.isDark(n,o+3)&&t.isDark(n,o+4)&&!t.isDark(n,o+5)&&t.isDark(n,o+6)&&(i+=40);for(var o=0;e>o;o++)for(var n=0;e-6>n;n++)t.isDark(n,o)&&!t.isDark(n+1,o)&&t.isDark(n+2,o)&&t.isDark(n+3,o)&&t.isDark(n+4,o)&&!t.isDark(n+5,o)&&t.isDark(n+6,o)&&(i+=40);for(var l=0,o=0;e>o;o++)for(var n=0;e>n;n++)t.isDark(n,o)&&l++;var d=Math.abs(100*l/e/e-50)/5;return i+=10*d},e.prototype.static_isSupportCanvas=function(){return"undefined"!=typeof CanvasRenderingContext2D},e._getTypeNumber=function(i,n){for(var o=1,a=e._getUTF8Length(i),s=0,r=e.QRCodeLimitLength.length;r>=s;s++){var h=0;switch(n){case t.QRErrorCorrectLevel.L:h=e.QRCodeLimitLength[s][0];break;case t.QRErrorCorrectLevel.M:h=e.QRCodeLimitLength[s][1];break;case t.QRErrorCorrectLevel.Q:h=e.QRCodeLimitLength[s][2];break;case t.QRErrorCorrectLevel.H:h=e.QRCodeLimitLength[s][3]}if(h>=a)break;o++}if(o>e.QRCodeLimitLength.length)throw new Error("Too long data");return o},e._getUTF8Length=function(t){var e=encodeURI(t).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return e.length+(e.length!=t?3:0)},e}();e.PATTERN_POSITION_TABLE=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],e.G15=1335,e.G18=7973,e.G15_MASK=21522,e.QRCodeLimitLength=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]],t.QRUtil=e,__reflect(e.prototype,"qr.QRUtil")}(qr||(qr={}));var MJLobby;!function(t){var e=function(e){function o(){var t=e.call(this)||this;return t.skinName=new RedPacketPanelSkin,t.init(),t.addEvent(),t}return __extends(o,e),Object.defineProperty(o,"instance",{get:function(){return this._instance||(this._instance=new o),this._instance},enumerable:!0,configurable:!0}),o.prototype.clearInstance=function(){o._instance&&(o._instance=null)},o.prototype.init=function(){this.todayButton.selected=!0,this.showGroup(),this._redSumTxt.textFlow=[{text:"累计红包金额:"},{text:"0",style:{textColor:672253}},{text:"元"}]},o.prototype.addEvent=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickHandle,this)},o.prototype.removeEvent=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickHandle,this)},o.prototype.clickHandle=function(e){if(e.target==this.todayButton||e.target==this.histroyButton){if(this.showGroup(),e.target==this.histroyButton){var i=new Cmd.GetOpenRedPackRecordLobbyCmd_C;t.NetMgr.tcpSend(i),uniLib.UIMgr.instance.showLoadingTimeout(LoadSecondPanel),this.showOpenRecords()}}else if(e.target==this.closeButton)this.dispatchEventWith(t.LobbyUIEventConsts.CLOSE);else if(e.target==this.wechatLabel)uniLib.ZQGameSdk.nativeCopyStr("fhskyl"),t.LobbyPopupManager.showMildWarnShow("fhskyl复制成功");else if(e.target==this.openButton){var i=new Cmd.OpenRedPackLobbyCmd_C;i.lobbyId=t.MJLobbyData.getInstance().lobbyId,t.NetMgr.tcpSend(i)}},o.prototype.showGroup=function(){this.groupN.visible=this.todayButton.selected,this.groupM.visible=this.histroyButton.selected},o.prototype.showOpenRecords=function(){var e=t.MJLobbyData.getInstance().redpacket_DepositDetail;null!=e&&(e=null!=e&&e instanceof Array?e:[],this.noDataImage.visible=0==e.length,this.myprizeList.itemRenderer=n,this.myprizeList.dataProvider=new eui.ArrayCollection(e))},o.prototype.setData=function(t){if(null!=t){var e=Math.floor(t.surplusTime/86400),i=Math.floor((t.surplusTime-86400*e)/3600);this._redTimeTxt.text=""+e+"天"+i+"小时",this._redSumTxt.textFlow=[{text:"累计红包金额:"},{text:t.num+"",style:{textColor:16776960}},{text:"元"}];var n="距离提现还少*元,快招呼小伙伴们多来几局吧";this._redDisparity.text=n.replace("*",""+t.distance.toFixed(2)),this.showAwardInfo()}},o.prototype.updateRedSurplus=function(e){if(this._redSumTxt&&(this._redSumTxt.textFlow=[{text:"累计红包金额"},{text:t.MJLobbyData.getInstance().redpacket_surplus,style:{textColor:672253}},{text:"元"}]),this._redDisparity){var i="距离提现还少*元,快招呼小伙伴们多来几局吧";this._redDisparity.text=i.replace("*",""+e.toFixed(2))}},o.prototype.showAwardInfo=function(){var e=t.MJLobbyData.getInstance().redpacket_info;e.infos=null!=e&&null!=e.infos&&e.infos instanceof Array?e.infos:[],e.startTime&&e.endTime&&(this.timeLabel.text=this.formateData(e.startTime)+"-"+this.formateData(e.endTime)),e.infos.length<=0||(this.prizeList.itemRenderer=i,this.prizeList.dataProvider=new eui.ArrayCollection(e.infos))},o.prototype.formateData=function(t){if(null==t)return"";var e=new Date(1e3*t),i=e.getFullYear(),n=e.getMonth()+1,o=e.getDate();return i+"年"+n+"月"+o+"日"},o}(eui.Component);t.RedPacketPanel=e,__reflect(e.prototype,"MJLobby.RedPacketPanel");var i=function(t){function e(){var e=t.call(this)||this;return e.desStrArray=["  幸福来得太突然，##竟在红包活动中开出了xx元，真实羡煞旁人！","  Duang的一声，##从红包中掏出xx元大奖金！","  喜从天降！##在对局后，获得xx元大红包，不由喜极而泣！"],e.skinName=new RedPacketRecordItemSkin,e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;if(null!=t.stringType&&t.stringType<=6){var e=this.desStrArray[t.stringType%3],i=e.split("##"),n=i[1].split("xx");this.tipsLabel.textFlow=[{text:i[0]},{text:t.nickName,style:{textColor:16763481}},{text:n[0]},{text:t.reward+"",style:{textColor:16711680}},{text:n[1]+"\n"}]}},e}(eui.ItemRenderer);t.RedPacketRecordItem=i,__reflect(i.prototype,"MJLobby.RedPacketRecordItem");var n=function(e){function i(){var t=e.call(this)||this;return t.skinName=new OpenRecordItemSkin,t._stateToggle.touchEnabled=!1,t}return __extends(i,e),i.prototype.dataChanged=function(){var e=this.data;this._amountLabel.text=t.MJLobbyData.getInstance().myBaseInfo.nickName;var i=new Date(1e3*e.time),n="*获取红包#元";n=n.replace("*",i.getFullYear()+"年"+(i.getMonth()+1)+"月"+i.getDate()+"日"),n=n.replace("#",e.reward.toString()),this._tiemLabel.text=n,this._stateToggle.selected=null!=e.status&&2==e.status},i}(eui.ItemRenderer);t.OpenRecordItem=n,__reflect(n.prototype,"MJLobby.OpenRecordItem")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.skinName=new AwardPanelSkin,t.addEvent(),t}return __extends(i,e),Object.defineProperty(i,"instance",{get:function(){return this._instance||(this._instance=new i),this._instance},enumerable:!0,configurable:!0}),i.prototype.clearInstance=function(){i._instance&&(i._instance=null)},i.prototype.addEvent=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickHandle,this)},i.prototype.removeEvent=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickHandle,this)},i.prototype.clickHandle=function(e){if(e.target==this._yesBtn)t.LobbyPopupManager.removePopUp(this),this.parent&&this.parent.removeChild(this),this.destroy();else if(e.target==this._sharBtn){var i=new uniLib.WXShareVo;i.shareWay=1;var n=new egret.Bitmap(uniLib.DisplayUtils.catchScreenToTex(this,new egret.Rectangle(0,0,this.width,this.height),.6));i.shareImageData=uniLib.DisplayUtils.catchScreen(n,new egret.Rectangle(0,0,this.width,this.height)),uniLib.ZQGameSdk.share(i,this.shareBack,this)}else e.target==this._awardTxt},i.prototype.shareBack=function(e){e&&(0==e.code&&this.dispatchEventWith(t.LobbyUIEventConsts.OPEN_REDPACKET),egret.Tween.get(this).wait(100).call(this.delayShareBack,this,[e.code]))},i.prototype.delayShareBack=function(e){0==e?t.LobbyPopupManager.showMildWarnShow("分享成功!"):1==e?t.LobbyPopupManager.showMildWarnShow("分享已取消"):2==e&&t.LobbyPopupManager.showMildWarnShow("分享被拒绝")},i.prototype.setData=function(e,i){this._kefuPhone="客服微信：fhsk0822";var n="恭喜您！获取x元红包,请联系#领取红包",o=n.split("x"),a=o[1].split("#");if(this._awardTxt.textFlow=[{text:o[0]},{text:i,style:{textColor:16777215}},{text:a[0]},{text:" "+this._kefuPhone,style:{textColor:10066423,href:"event:"+this._kefuPhone}},{text:a[1]}],e){var s=new t.LobbyHeadMc(190,190,!1);s.headUrl=e,s.x=1042,s.y=505,this.addChild(s)}},i.prototype.destroy=function(){this.removeEvent(),this.clearInstance()},i}(eui.Component);t.RedPacketRewardPanel=e,__reflect(e.prototype,"MJLobby.RedPacketRewardPanel")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.skinName=new ActiveRoomListSkin,t.initUI(),t}return __extends(n,e),n.prototype.addListener=function(){this.gameList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onGameListTap,this),this.closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeHandle,this)},n.prototype.removeListener=function(){this.gameList.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onGameListTap,this),this.closeButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.closeHandle,this)},n.prototype.destory=function(){this.removeListener(),this.removeItems(),this.m_gameArray=null,this._activeRoomListOb=null},n.prototype.initUI=function(){this.addListener(),this.gameList.itemRenderer=t.GameTypeItem},Object.defineProperty(n.prototype,"games",{get:function(){if(this.m_gameArray)return this.m_gameArray;var e=t.MJLobbyData.getInstance().getGameList();this.m_gameArray=Array();for(var i=0,n=e;i<n.length;i++){var o=n[i],a=t.MJLobbyData.getInstance().getGameCreateConfig(o);if(t.MJLobbyData.getInstance().openingGameList&&-1==t.MJLobbyData.getInstance().openingGameList.indexOf(o)&&(a.open=0),!uniLib.Global.isH5){if(2==a.hide)continue;if(1==a.hide){if(0==t.MJLobbyData.getInstance().isAgent)continue}else if(0!=a.hide&&a.hide!=uniLib.NetMgr.UID)continue;if(5240==a.gameId)continue}this.m_gameArray.push(a)}return this.m_gameArray},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectGameConfig",{get:function(){return this.games[this.gameList.selectedIndex]},enumerable:!0,configurable:!0}),n.prototype.initData=function(t){this._activeRoomListOb=t;var e=this.games;this.gameList.dataProvider=new eui.ArrayCollection(e),this.gameList.selectedIndex=0;var i=this.selectGameConfig.gameId;this.refreshSetting(i)},n.prototype.onGameListTap=function(t){uniLib.SoundMgr.instance.playSound("buttonClick_mp3");var e=this.games[t.itemIndex].gameId;e&&this.refreshSetting(e)},n.prototype.removeItems=function(){this.roomList.dataProvider=new eui.ArrayCollection(null)},n.prototype.refreshSetting=function(t){this.removeItems();for(var e=[],i=0,n=0;i<this._activeRoomListOb.length;i++)this._activeRoomListOb[i].gameId==t&&(e[n]=this._activeRoomListOb[i],n++);
this.createActiveRoomList(e)},n.prototype.closeHandle=function(e){uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),this.dispatchEventWith(t.LobbyUIEventConsts.CLOSE)},n.prototype.createActiveRoomList=function(t){t&&t[0]&&(this.roomList.itemRenderer=i,this.roomList.dataProvider=new eui.ArrayCollection(t))},n}(eui.Component);t.ActiveGameListPanel=e,__reflect(e.prototype,"MJLobby.ActiveGameListPanel");var i=function(e){function i(){var t=e.call(this)||this;return t.skinName=new Mj_ActiveRoomSkin,t.addListener(),t}return __extends(i,e),i.prototype.addListener=function(){this.roomInformation.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRoomListTap,this),this.invitingFriends.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRoomListTap,this),this.dissolveRoom.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRoomListTap,this),this.deleteRoom.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRoomListTap,this)},i.prototype.removeListener=function(){this.roomInformation.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRoomListTap,this),this.invitingFriends.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRoomListTap,this),this.dissolveRoom.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRoomListTap,this),this.deleteRoom.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRoomListTap,this)},i.prototype.onRoomListTap=function(e){if(e.target==this.roomInformation){var i=new t.MvcSender,n=new Cmd.ActiveDetailRoomCmd_C;n.roomId=this.data.roomId,n.gid=this.data.gid,i.sendNotification(t.MahJongLobbyFacadeConsts.SEND_DATA,n,t.LobbyDataRequestCommand.GAME_DATA),t.NetMgr.setMsgTimeout(5,"ActiveDetailRoomCmd_C")}else if(e.target==this.invitingFriends){var o=void 0;o=this.data.shareInfo;var a=this.data.roomId,s=new uniLib.WXShareVo;if(s.shareWay=0,""==uniLib.ZQGameSdk.defaultWXShareVo.webpageUrl&&t.LobbyDataCache.bundleInfo&&t.LobbyDataCache.bundleInfo.weixin.wbappid){var r=t.MJLobbyData.getInstance().myBaseInfo.nickName;r.length>8&&(r=r.slice(0,8)),s.webpageUrl="https://open.weixin.qq.com/connect/oauth2/authorize?appid="+t.LobbyDataCache.bundleInfo.weixin.wbappid+"&redirect_uri=http://"+t.PublicMethed.wxShareUrl+"/addons/zqgame/gameshare.php?appid="+t.LobbyDataCache.bundleInfo.weixin.wbappid+"&response_type=code&scope=snsapi_base&state="+uniLib.CompressUtil.base64encode(t.MJLobbyData.getInstance().myBaseInfo.uid+"|"+a+"|"+r)+"&connect_redirect=1#wechat_redirect"}else s.webpageUrl=uniLib.ZQGameSdk.defaultWXShareVo.webpageUrl+"?uid="+t.MJLobbyData.getInstance().myBaseInfo.uid+"&nickName="+t.MJLobbyData.getInstance().myBaseInfo.nickName;s.title=o&&o.title?o.title:"",s.description=o&&o.content?o.content:"",s.description=s.description+this.getAllNames(),uniLib.ZQGameSdk.share(s,null,this)}else if(e.target==this.dissolveRoom||e.target==this.deleteRoom){var i=new t.MvcSender,h=new Cmd.ActiveDissolveRoomCmd_C;h.roomId=this.data.roomId,i.sendNotification(t.MahJongLobbyFacadeConsts.SEND_DATA,h,t.LobbyDataRequestCommand.GAME_DATA),t.NetMgr.setMsgTimeout(5,"ActiveDissolveRoomCmd_C")}},i.prototype.getAllNames=function(){for(var t="",e=0;e<this.data.list.length;e++)""!=t&&(t+=","),t+=this.data.list[e].nickname;return""!=t&&(t+="已入座"),t},i.prototype.destory=function(){this.dataNumber1=null,this.dataNumber0=null,this.removeListener()},i.prototype.dataChanged=function(){var t=this.data;this.dataNumber0.text=t.roomId+" ";var e=0;t.curUserNbr&&(e=t.curUserNbr),this.dataNumber1.text=e+"/"+t.userNbr,(1==t.state||t.endTime)&&(t.endTime?(this.Title2.text="已结束",this.deleteRoom.visible=!0,this.dataNumber1.text=e+"/"+e):(this.Title2.text="游戏中···",this.dataNumber1.text=e+"/"+e),this.invitingFriends.visible=!1,this.dissolveRoom.visible=!1)},i}(eui.ItemRenderer);t.ActiveRoomItem=i,__reflect(i.prototype,"MJLobby.ActiveRoomItem")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t._radio=!0,t}return __extends(i,e),i.prototype.destory=function(){if(e.prototype.destory.call(this),this._checkArr){for(var t=0;t<this._checkArr.length;t++)this._checkArr[t].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCheckHandle,this),this._checkArr[t].destory();this._checkArr=null}this._labelTxt=null,this._data=null},Object.defineProperty(i.prototype,"label",{set:function(e){this._labelTxt?this._labelTxt.text=e:(this._labelTxt=t.LobbyResUtil.createTextFeild(1206199,egret.HorizontalAlign.RIGHT,e,20,-163,8,153),this.addChild(this._labelTxt))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"labelColor",{set:function(t){this._labelTxt.textColor=t},enumerable:!0,configurable:!0}),i.prototype.setData=function(e,i,n,o){this._data=e,this._radio=!o,this._curIndex=i,this._checkArr=[];for(var a,s=0;s<this._data.length;s++){a=new t.CreateCheckMc,a.setLabelSize(24),a.label=this._data[s].label,o&&a.setCheckType(2),a.x=s*n;var r=5295==t.CreateGamePanel.instance.gameId?3:4;5295==t.CreateGamePanel.instance.gameId&&-1!=e[0].label.indexOf("局")&&(r=2),s>=r?(a.x=(s-r)*n,a.y=a.height+20):a.x=s*n,this.addChild(a),a.name="check"+s,a.touchEnabled=!0,this._checkArr.push(a),a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCheckHandle,this)}this.updataCheck()},i.prototype.onCheckHandle=function(e){var i=Number(e.currentTarget.name.slice(5));RES.hasRes("buttonClick_mp3")&&uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),this._curIndex==i&&this._radio||(this._curIndex=i,this.updataCheck(),this.dispatchEventWith(t.LobbyUIEventConsts.CHANGE))},i.prototype.updataCheck=function(){if(this._radio)for(var t=0;t<this._checkArr.length;t++)this._checkArr[t].check=!1;this._curIndex||(this._curIndex=0),this._checkArr[this._curIndex].check=!this._checkArr[this._curIndex].check},Object.defineProperty(i.prototype,"value",{get:function(){return this._idList?this._idList[this._curIndex]:this._radio||this._checkArr[this._curIndex].check?this._data[this._curIndex].value:0},set:function(t){var e;if(this._idList)e=this._idList.indexOf(t);else for(var i=0;i<this._data.length;i++)if(this._data[i].value==t){e=i;break}-1!=e&&(this._curIndex=e,this.updataCheck())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"playType",{get:function(){return this._idList&&this._idList[this._curIndex]?this._idList[this._curIndex].playType:this._data[this._curIndex]?this._data[this._curIndex].playType:null},enumerable:!0,configurable:!0}),i.prototype.setIDArr=function(e,i,n){void 0===n&&(n=170),this._idList=e,this._curIndex=i,this._checkArr=[];for(var o,a=t.MJLobbyData.getInstance().getPlayTypeConfig(),s=0;s<this._idList.length;s++)o=new t.CreateCheckMc,o.setLabelSize(24),o.label=a[this._idList[s]].desc,o.x=s*n,this.addChild(o),o.name="check"+s,o.touchEnabled=!0,this._checkArr.push(o),o.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCheckHandle,this);this.updataCheck()},i.prototype.setExclude=function(t,e){for(var i=0;i<t.length;i++){var n=t[i],o=this._checkArr.first(function(t){return t.label==n});o&&o.setEnable(!e)}this.updataCheck()},i}(t.LobbyBaseVc);t.CheckBox=e,__reflect(e.prototype,"MJLobby.CheckBox")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.skinName=new AudienceListPanelSkin,t.bankBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,t.close,t),t.listRect.addEventListener(egret.TouchEvent.TOUCH_TAP,t.close,t),t.listGroup.x=uniLib.Global.screenWidth,t}return __extends(n,e),Object.defineProperty(n,"instace",{get:function(){return this._instance||(this._instance=new n),this._instance},enumerable:!0,configurable:!0}),n.prototype.setData=function(t){this.matchId=t.matchId,this.audienceList.itemRenderer=i,t.list&&t.list instanceof Array&&t.list.length>0&&(this.audienceList.dataProvider=new eui.ArrayCollection(t.list))},n.prototype.close=function(){var e=this;egret.Tween.removeTweens(this.listGroup),egret.Tween.get(this.listGroup).to({x:uniLib.Global.screenWidth},200,egret.Ease.quadOut).call(function(){e.listRect.visible=!1,e.gameName=null,e.shareInfo=null,e.userNbrStr=null,e.matchId=null,e.audienceList.dataProvider=null,t.LobbyPopupManager.removePopUp(e,!0,!0)})},n.prototype.open=function(){this.listRect.visible=!0,this.listGroup.x=uniLib.Global.screenWidth,egret.Tween.removeTweens(this.listGroup),egret.Tween.get(this.listGroup).to({x:uniLib.Global.screenWidth-730},200,egret.Ease.quadOut)},n}(t.BaseComponent);t.AudienceListPanel=e,__reflect(e.prototype,"MJLobby.AudienceListPanel");var i=function(i){function n(){var t=i.call(this)||this;return t.skinName=new AudienceListItemSkin,t.inviteBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,t.showInvite,t),t}return __extends(n,i),n.prototype.dataChanged=function(){var t=this.data;this.headMc.source=t.headUrl,this.headMc.mask=this.headBg,this.nameLabel.text=t.nickname.length>8?t.nickname.slice(0,8):t.nickname,t.lastMin&&(this.comeTime.text=this.relativeTime(t.lastMin))},n.prototype.relativeTime=function(t){var e=Math.floor(t/525600),i=Math.floor(t/43200),n=Math.floor(t/1440),o=Math.floor(t/60);return e>0?e+"年前来过":i>0?i+"月前来过":n>0?n+"天前来过":o>0?o+"小时前来过":t+"分钟前来过"},n.prototype.showInvite=function(){var i=e.instace.matchId,n=new uniLib.WXShareVo;if(n.shareWay=0,""==uniLib.ZQGameSdk.defaultWXShareVo.webpageUrl&&t.LobbyDataCache.bundleInfo&&t.LobbyDataCache.bundleInfo.weixin.wbappid){var o=t.MJLobbyData.getInstance().myBaseInfo.nickName;o.length>8&&(o=o.slice(0,8)),n.webpageUrl="https://open.weixin.qq.com/connect/oauth2/authorize?appid="+t.LobbyDataCache.bundleInfo.weixin.wbappid+"&redirect_uri=http://"+t.PublicMethed.wxShareUrl+"/addons/zqgame/gameshare.php?appid="+t.LobbyDataCache.bundleInfo.weixin.wbappid+"&response_type=code&scope=snsapi_base&state="+uniLib.CompressUtil.base64encode(t.MJLobbyData.getInstance().myBaseInfo.uid+"|"+i+"|"+o)+"&connect_redirect=1#wechat_redirect"}else n.webpageUrl=uniLib.ZQGameSdk.defaultWXShareVo.webpageUrl+"?uid="+t.MJLobbyData.getInstance().myBaseInfo.uid+"&nickName="+o;var a,s=e.instace.shareInfo,r=e.instace.gameName,h=e.instace.userNbrStr;a=-1!=h.indexOf("缺1")?t.DataManage.inviteStrArr[3]:t.DataManage.inviteStrArr[Math.randomInteger(0,3)],n.title="@"+this.nameLabel.text+a,n.description=r+"<看客邀请>包厢["+i+"]\n"+(s&&s.content?s.content+h:""),t.MJLobbyData.getInstance().hasXianLiao?uniLib.Global.dispatchEvent(uniLib.ZqEvent.SHARE,n,!1):uniLib.ZQGameSdk.share(n,null,this)},n}(eui.ItemRenderer);t.AudienceListItem=i,__reflect(i.prototype,"MJLobby.AudienceListItem")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.skinName=new CertificationPanelSkin,t.init(),t}return __extends(i,e),i.prototype.init=function(){this.closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeHandel,this),this.submitBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.validateHandel,this),uniLib.Utils.getLocalStorage("userName")&&(this.userName.text=uniLib.Utils.getLocalStorage("userName"),this.userName.enabled=!1,this.submitBtn.visible=!1),uniLib.Utils.getLocalStorage("userNumber")&&(this.userNumber.text=uniLib.Utils.getLocalStorage("userNumber"),this.userNumber.enabled=!1,this.submitBtn.visible=!1)},i.prototype.validateHandel=function(e){var i=new t.MatchMsgBox;if(""==this.userName.text)return i.setData("","姓名不能为空！",["确定"]),void t.LobbyPopupManager.addPopUp(i,!0,!0);if(""==this.userNumber.text)return i.setData("","身份证号不能为空！",["确定"]),void t.LobbyPopupManager.addPopUp(i,!0,!0);var n=/^[\u4e00-\u9fa5]{2,4}$/;if(!n.test(this.userName.text))return i.setData("","请填写正确的姓名！",["确定"]),void t.LobbyPopupManager.addPopUp(i,!0,!0);var o=this.isCardNo(this.userNumber.text);return o?(uniLib.Utils.setLocalStorage("userName",this.userName.text),uniLib.Utils.setLocalStorage("userNumber",this.userNumber.text),t.LobbyPopupManager.showMildWarnShow("绑定成功！"),void this.dispatchEventWith(t.LobbyUIEventConsts.CLOSE)):(i.setData("","请填写正确的身份证号！",["确定"]),void t.LobbyPopupManager.addPopUp(i,!0,!0))},i.prototype.closeHandel=function(e){this.dispatchEventWith(t.LobbyUIEventConsts.CLOSE)},i.prototype.isCardNo=function(t){var e=/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/;return e.test(t)===!1?!1:!0},i.prototype.destroy=function(){this.closeButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.closeHandel,this),this.submitBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.validateHandel,this)},i}(eui.Component);t.CertificationPanel=e,__reflect(e.prototype,"MJLobby.CertificationPanel")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function i(i){var n=e.call(this)||this;return n.skinName=new ClubMyDataSkin,n.sureBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,n.onClose,n),n.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,n.onClose,n),n.setData(i),t.LobbyPopupManager.addPopUp(n,!0,!0),n}return __extends(i,e),i.prototype.setData=function(t){for(var e in t)this[e]&&this[e].text&&(this[e].text=t[e]+"")},i.prototype.onClose=function(){t.LobbyPopupManager.removePopUp(this),this.sureBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.closeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this)},i}(eui.Component);t.ClubMyDataPanel=e,__reflect(e.prototype,"MJLobby.ClubMyDataPanel")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.skinName=new ClubPanelSkin,t}return __extends(n,e),Object.defineProperty(n,"instance",{get:function(){return this._instance||(this._instance=new n),this._instance},enumerable:!0,configurable:!0}),n.clearInstance=function(){this._instance=null},n.prototype.init=function(){this.addListener()},n.prototype.addListener=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this)},n.prototype.removeListener=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this)},n.prototype.destory=function(){this.removeListener()},n.prototype.setJoinedList=function(e){if(null!=e){var n=null!=e.list&&e.list instanceof Array?e.list:[];this._joinedList.itemRenderer=i,this._joinedList.dataProvider=new eui.ArrayCollection(n),n.length?this.quicklyCreateBtn.visible=!1:(t.LobbyPopupManager.showMildWarnShow("您还没有加入历史记录，赶快加入游戏吧!"),this.quicklyCreateBtn.visible=!0)}},n.prototype.onBtnClick=function(e){e.target==this.closeBtn?(uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),this.dispatchEventWith(t.LobbyUIEventConsts.CLOSE)):e.target==this.quicklyCreateBtn&&t.MJLobbyVc.m_instance.dispatchEventWith(t.LobbyUIEventConsts.SHOW_CREATE_PANEL)},n}(t.BaseComponent);t.ClubPanel=e,__reflect(e.prototype,"MJLobby.ClubPanel");var i=function(e){function i(){var t=e.call(this)||this;return t.skinName=new ClubItemSkin,t.fundGroup.visible=!1,t.pointGroup.visible=!1,t.entranceGroup.visible=!1,t.playName.visible=!1,t.addEventListener(egret.TouchEvent.TOUCH_TAP,t.clickHandle,t),t}return __extends(i,e),i.prototype.dataChanged=function(){var e=this.data;this._info=e;null!=e.matchName?e.matchName:e.matchId;this.matchId.text=e.matchId+"";var i=e.matchName?e.matchName.slice(0,8):"无";this.matchName.text="包厢名称："+i,this.matchOwner.text="创建者："+e.ownerName,this.matchIdNum=e.matchId,1!=t.MJLobbyData.getInstance().fundType?this.fundGroup.visible=!1:this.fundGroup.visible=!0;var n=t.MJLobbyData.getInstance().getGameCreateConfig(e.gameId);this.gameName.text=n&&n.gameName?n.gameName:"",e.bottomPoint&&(this.pointGroup.visible=!0,this.bottomPoint.text="底注："+e.bottomPoint),e.enteringPoint&&(this.entranceGroup.visible=!0,this.enteringPoint.text="入场："+e.enteringPoint),e.leavingPoint&&(this.entranceGroup.visible=!0,this.leavingPoint.text="离场："+e.leavingPoint),e.matchPoint?(this.extractBtn.visible=!0,this.joinBtn.horizontalCenter=-89):(this.extractBtn.visible=!1,this.joinBtn.horizontalCenter=0),0==this.fundGroup.visible&&0==this.pointGroup.visible&&(this.playName.visible=!0,this.playName.text=this._info.desc.substr(0,this._info.desc.length-2),this.playButton.visible=!1)},i.prototype.clickHandle=function(e){if(e.target instanceof eui.Button&&uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),e.target==this.joinBtn){var i=new Cmd.RequestRoomMatchGroupCmd_C;i.matchId=this.matchIdNum,t.LobbyServerMJProxy.getInstance().sendData(i),t.NetMgr.setMsgTimeout(5,"RequestRoomMatchGroupCmd_C")}else if(e.target==this.clearBtn){var i=new Cmd.DelHistoryMatchIdMatchGroupCmd_C;i.matchId=this.matchIdNum,t.LobbyServerMJProxy.getInstance().sendData(i),t.NetMgr.setMsgTimeout(5,"RequestRoomMatchGroupCmd_C")}else if(e.target==this.extractBtn){var i=new Cmd.MatchPoint2GoldMatchGroupCmd_C;i.matchId=this.matchIdNum,t.LobbyServerMJProxy.getInstance().sendData(i),t.NetMgr.setMsgTimeout(5,"MatchPoint2GoldMatchGroupCmd_C")}else if(e.target==this.playButton){var n=new t.MatchMsgBox;n.setData("玩法",this._info.desc.substr(0,this._info.desc.length-2),["确定"],[null]),t.LobbyPopupManager.addPopUp(n,!0,!0)}else if(e.target==this.historyButton){var i=new Cmd.DonateHistoryMatchRoomCmd_C;i.matchId=this._info.matchId,i.uid=uniLib.NetMgr.UID,t.LobbyServerMJProxy.getInstance().sendData(i)}},i}(eui.ItemRenderer);t.ClubItem=i,__reflect(i.prototype,"MJLobby.ClubItem")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.todayOrYesTerDay=0,t.skinName=new ClubRankSkin,t.rankList.itemRenderer=i,t.todayOrYesTerDay=0,t.today.selected=!0,t}return __extends(n,e),n.prototype.onClick=function(e){var i=this;e.target==this.closeBtn||e.target==this.backRect?(uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),egret.Tween.removeTweens(this.contentGroup),egret.Tween.get(this.contentGroup).to({left:-650},200).wait(50).call(function(){n.rankType=1,i.todayOrYesTerDay=0,egret.Tween.removeTweens(i.contentGroup),i.dispatchEventWith(egret.Event.CLOSE)})):e.target==this.rankType_1||e.target==this.rankType_2||e.target==this.rankType_3?this.changeRankType(e.target.value):e.target==this.today||e.target==this.yesterday||e.target==this.mounth||e.target==this.week?(this.todayOrYesTerDay!=Number(e.target.value)&&(this.todayOrYesTerDay=e.target.value,e.target.selected=!0),this.dispatchEventWith(t.LobbyUIEventConsts.CLICK_RANKBTN,!1,this.todayOrYesTerDay)):e.target==this.rankTypeBtn&&this.showRankType(!this.rankRadioGroup.visible)},n.prototype.showRankType=function(t){this.rankRadioGroup.visible=t,this["rankType_"+n.rankType]&&(this["rankType_"+n.rankType].selected=!0)},n.prototype.changeRankType=function(t){this.showRankType(!1),n.rankType=t,this.updateRank(),this.updateRankIcon(t)},n.prototype.updateRankIcon=function(t){this.rankTypeIcon.source="club_rank_type_"+t},n.prototype.showPanel=function(){if(this.rankRadioGroup.visible=!1,this.contentGroup.left=-this.contentGroup.width,egret.Tween.get(this.contentGroup).to({left:(uniLib.Global.screenWidth-1280)/2+40},200).wait(50).call(this.moveEnd,this),this.playerList&&this.playerList instanceof Array){for(var e=[],i=0,n=this.playerList;i<n.length;i++){var o=n[i];o&&o.uid&&e.push(o.uid)}t.HeadMcManager.instanc.requestHeadurl(e.distinct())}},n.prototype.setDate=function(t){this.playerList=t.list,this.updateRank()},n.prototype.moveEnd=function(){this.contentGroup&&egret.Tween.removeTweens(this.contentGroup),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)},n.prototype.updateRank=function(){if(this.playerList){var t=[];this.playerList instanceof Array&&0!=this.playerList.length&&(1==n.rankType?t=this.playerList.sort(function(t,e){return t.playNum=t.playNum?t.playNum:0,e.playNum=e.playNum?e.playNum:0,t.playNum-e.playNum<0?1:t.playNum-e.playNum==0?0:-1}):2==n.rankType?t=this.playerList.sort(function(t,e){return t.bigWinNum=t.bigWinNum?t.bigWinNum:0,e.bigWinNum=e.bigWinNum?e.bigWinNum:0,t.bigWinNum-e.bigWinNum<0?1:t.bigWinNum-e.bigWinNum==0?0:-1}):3==n.rankType&&(t=this.playerList.sort(function(t,e){return t.score=t.score?t.score:0,e.score=e.score?e.score:0,t.score-e.score<0?1:t.score-e.score==0?0:-1}))),this.rankList.dataProvider=new eui.ArrayCollection(t)}},n.prototype.showUserInfo=function(e){var i=new t.LobbyOtherUserInfoPanel;i.setData(e),t.LobbyPopupManager.addPopUp(i,!1,!0)},n}(t.BaseComponent);e.rankType=1,t.ClubRankPanel=e,__reflect(e.prototype,"MJLobby.ClubRankPanel");var i=function(i){function n(){var t=i.call(this)||this;return t.skinName=new RankItemRenderSkin,t.chipsIcon.visible=!1,t.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onHandle,t),t}return __extends(n,i),n.prototype.dataChanged=function(){var i=this,n=this.data;if(n){this.nameLabel=n.name?n.name.toString().slice(0,6):"",this.nameLabelText.TextImageData=Emoji.toCodePoint(this.nameLabel),this.nameLabelText.textColor=2065332,this.nameLabelText.size=24,this.rankLabel.text=this.itemIndex+1+"";var o="";o=1==e.rankType?"上桌数:"+(n.playNum?n.playNum:0):2==e.rankType?"大赢家:"+(n.bigWinNum?n.bigWinNum:0):"积分:"+(n.score?n.score:0),this.moneycountLabel.text=o,t.HeadMcManager.instanc.getUserHeadByUid(n.uid,this,function(t){t&&(i.headMc.source=t,i.data.headUrl=t)}),this.headMc.mask=this.headBg,this.headMc.x=this.headBg.x+2.5,this.headMc.y=this.headBg.y+2.5,this.idLabel.text="ID:"+(n.uid?n.uid:"")}},n.prototype.onHandle=function(){t.GoldenRankPanel.Instance.showUserInfo(this.data)},n}(eui.ItemRenderer);t.ClubRankItemRender=i,__reflect(i.prototype,"MJLobby.ClubRankItemRender")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.codeVersion=13,i.skinName=new ClubShareSkin,t.MJLobbyData.getInstance().hasXianLiao&&i.setPosition(),i}return __extends(i,e),i.prototype.onClick=function(e){if(uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),e.target==this._wxButton)this.onShare();else if(e.target==this._pyqButton){var i=t.MJLobbyData.getInstance().myBaseInfo.nickName,n=t.TableHouseListPanel.Instanc.getMatchName()?t.TableHouseListPanel.Instanc.getMatchName():"",o=(t.TableHouseListPanel.Instanc.masterId?t.TableHouseListPanel.Instanc.masterId:0,t.TableHouseListPanel.Instanc.wechatNum);t.PublicMethed.sharePromote(i,n,t.TableHouseListPanel.Instanc.selectMatchId,o)}else e.target==this._xlButton&&this.onShare(!0);this.onRemove()},i.prototype.showPanel=function(){this.contentGroup.top=-this.contentGroup.height,egret.Tween.get(this.contentGroup).to({top:95},240).wait(50).call(this.moveEnd,this)},i.prototype.moveEnd=function(){this.contentGroup&&egret.Tween.removeTweens(this.contentGroup),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)},i.prototype.setPosition=function(){this._xlButton.visible=!0,this._wxButton.left=33,this._wxButton.y=this._pyqButton.y=this._xlButton.y=47,this._pyqButton.right=148,this._xlButton.right=31},i.prototype.onShare=function(e){void 0===e&&(e=!1);var i=t.TableHouseListPanel.Instanc.selectMatchId,n=new uniLib.WXShareVo;if(n.shareWay=0,""==uniLib.ZQGameSdk.defaultWXShareVo.webpageUrl&&t.LobbyDataCache.bundleInfo&&t.LobbyDataCache.bundleInfo.weixin.wbappid){var o=t.MJLobbyData.getInstance().myBaseInfo.nickName;o.length>8&&(o=o.slice(0,8)),n.webpageUrl="https://open.weixin.qq.com/connect/oauth2/authorize?appid="+t.LobbyDataCache.bundleInfo.weixin.wbappid+"&redirect_uri=http://"+t.PublicMethed.wxShareUrl+"/addons/zqgame/gameshare.php?appid="+t.LobbyDataCache.bundleInfo.weixin.wbappid+"&response_type=code&scope=snsapi_base&state="+uniLib.CompressUtil.base64encode(t.MJLobbyData.getInstance().myBaseInfo.uid+"|"+i+"|"+o)+"&connect_redirect=1#wechat_redirect"}else n.webpageUrl=uniLib.ZQGameSdk.defaultWXShareVo.webpageUrl+"?uid="+t.MJLobbyData.getInstance().myBaseInfo.uid+"&nickName="+o;var a=t.TableHouseListPanel.Instanc.shareInfo;n.title=a&&a.title?a.title:"";var s=t.TableHouseListPanel.Instanc.getUserNbrStr();n.description=a&&a.content?a.content+s:"",t.PublicMethed.shareLink(n,null,this,e)},i.prototype.shareCode=function(){var e=this,i=new egret.Bitmap,n="http://h5.publish.66yy99.cn/Mahjong.jx/shareimg/club_share_"+t.MJLobbyData.getInstance().lobbyId+".jpg";RES.getResByUrl(n,function(n){if(n){var o=new egret.DisplayObjectContainer;uniLib.Global.isH5&&t.LobbyPopupManager.addPopUp(o),i.texture=n,o.addChild(i);var a=new eui.Label(t.MJLobbyVc.m_instance.nameLabel);o.addChild(a),a.x=270,a.y=310,a.scaleX=1.5,a.scaleY=1.5,a.textColor=3184046;var s=new eui.Label;s.text=t.TableHouseListPanel.Instanc.selectMatchId+"",o.addChild(s),s.x=350,s.y=610,s.scaleX=1.3,s.scaleY=1.3,s.textColor=3184046;var r=t.TableHouseListPanel.Instanc.shareInfo,h=t.TableHouseListPanel.Instanc.getUserNbrStr(),c=new eui.Label;if(c.text=r&&r.content?r.content+h:"",o.addChild(c),c.width=400,c.x=(i.width-c.width)/2-50,c.y=1100,c.scaleX=1.5,c.scaleY=1.5,c.textColor=16777215,c.fontFamily="Microsoft YaHei",""==uniLib.ZQGameSdk.defaultWXShareVo.webpageUrl&&t.LobbyDataCache.bundleInfo&&t.LobbyDataCache.bundleInfo.weixin.wbappid){var l=t.TableHouseListPanel.Instanc.selectMatchId,d=t.MJLobbyData.getInstance().myBaseInfo.nickName;d.length>8&&(d=d.slice(0,8));var u="https://open.weixin.qq.com/connect/oauth2/authorize?appid="+t.LobbyDataCache.bundleInfo.weixin.wbappid+"&redirect_uri=http://"+t.PublicMethed.wxShareUrl+"/addons/zqgame/gameshare.php?appid="+t.LobbyDataCache.bundleInfo.weixin.wbappid+"&response_type=code&scope=snsapi_base&state="+uniLib.CompressUtil.base64encode(t.MJLobbyData.getInstance().myBaseInfo.uid+"|"+l+"|"+d)+"&connect_redirect=1#wechat_redirect";if(u){var b=qr.QRCode.create(u,280,280,qr.QRErrorCorrectLevel.M,e.codeVersion);o.addChild(b),b.x=222,b.y=698;var p=new uniLib.WXShareVo,m=new egret.Bitmap(uniLib.DisplayUtils.catchScreenToTex(o,new egret.Rectangle(0,0,720,1280),.75));p.shareImageData=uniLib.DisplayUtils.catchScreen(m,new egret.Rectangle(0,0,m.width,m.height)),uniLib.Global.dispatchEvent(uniLib.ZqEvent.SHARE,p,!1)}}}else t.LobbyPopupManager.showMildWarnShow("分享图片资源获取失败,请稍后重试!")},this,RES.ResourceItem.TYPE_IMAGE)},i.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.dispatchEventWith(egret.Event.CLOSE)},i}(t.BaseComponent);t.ClubSharePanel=e,__reflect(e.prototype,"MJLobby.ClubSharePanel")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.isNewChange=!1,t.skinName=new CreateRoomSkin,t.initUI(),t}return __extends(n,e),Object.defineProperty(n,"instance",{get:function(){return null==n._instance&&(n._instance=new n),this._instance},enumerable:!0,configurable:!0}),n.clearInstance=function(){this._instance=null},Object.defineProperty(n.prototype,"gameId",{get:function(){return this._gameId},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"rate",{get:function(){return this.rateArr},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"mutilCheckMc",{get:function(){return this._mutilCheckMc},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"timeList",{get:function(){return this._timeList},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottomPoint",{get:function(){return this._bottomTxt},set:function(t){this._bottomTxt=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"enteringPoint",{get:function(){return this._enteringPointTxt},set:function(t){this._enteringPointTxt=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"leavingPoint",{get:function(){return this._leavingPointTxt},set:function(t){this._leavingPointTxt=t},enumerable:!0,configurable:!0}),n.prototype.addListener=function(){this.gameList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onGameListTap,this),this.createBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.createHandle,this),this.closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeHandle,this),this.createMatchBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCreateMatchBtn,this),this.createSijuBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCreateMatchBtn,this),this.changeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCreateMatchBtn,this),this.mahjongBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRadioBtnClick,this),this.pokerBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRadioBtnClick,this)},n.prototype.removeListener=function(){this.mahjongBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRadioBtnClick,this),this.pokerBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRadioBtnClick,this),this.gameList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onGameListTap,this),this.createBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.createHandle,this),this.closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeHandle,this),this.createMatchBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCreateMatchBtn,this),this.createSijuBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCreateMatchBtn,this),this.changeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCreateMatchBtn,this)},n.prototype.destory=function(){n.clearInstance(),this.removeListener(),this.removeCheckBox(),this._arrowMc&&(this._arrowMc.destory(),this._arrowMc=null),this._checkBoxScroll&&(this._checkBoxScroll.removeChildren(),this._checkBoxScroll=null),this._gameNList&&(this._gameNList.destory(),this._gameNList=null),this._costTxt=null,this._exCostTxt=null,this._mounthCost=null,this._mutilCheckMc=null,this._gameId=null},n.prototype.initUI=function(){this.addListener(),this.gameList.itemRenderer=t.GameTypeItem,this._mutilCheckMc=new egret.Sprite,this._mutilCheckMc.x=155,this.setGroup.addChild(this._mutilCheckMc),this._checkBoxScroll=t.LobbyResUtil.createScroll(this._mutilCheckMc,940,451*uniLib.ScreenUtils.scaleFactor,0,0),this._checkBoxScroll.horizontalScrollPolicy="off",this._checkBoxScroll.verticalScrollPolicy="on";var e=new eui.Group;e.width=this._checkBoxScroll.width,e.height=this._checkBoxScroll.height,e.addChild(this._checkBoxScroll),e.x=-this._checkBoxScroll.x,e.y=-this._checkBoxScroll.y,this.setGroup.addChild(e),0!=uniLib.Global.is_sandbox?(this.gameTypeGroup.visible=!1,this.createSijuBtn.visible=this.createMatchBtn.visible=!1,this.createBtn.horizontalCenter=100):t.MJLobbyData.getInstance().isAgent?(this.createMatchBtn.visible=!0,this.createSijuBtn.visible=!1):(this.createMatchBtn.visible=!1,this.createSijuBtn.visible=!0),this.mahjongBtn.selected=!0,this.curPanelIndex=0,this.changeBtn.visible=!1},n.prototype.onRadioBtnClick=function(t){this.mahjongBtn.selected?0!=this.curPanelIndex&&this.updateCurPanel(0):1!=this.curPanelIndex&&this.updateCurPanel(1)},n.prototype.updateCurPanel=function(t,e){this.curPanelIndex=t,this.initData()},Object.defineProperty(n.prototype,"games",{get:function(){this.gameListArr||(this.gameListArr=[]),this.changeGameId&&this.changeGameId>0?this.gameListArr.push(this.changeGameId):this.gameListArr=t.MJLobbyData.getInstance().getGameList();for(var e=Array(),i=!1,n=!1,o=0,a=this.gameListArr;o<a.length;o++){var s=a[o],r=t.MJLobbyData.getInstance().getGameCreateConfig(s);if(t.MJLobbyData.getInstance().openingGameList&&(-1==t.MJLobbyData.getInstance().openingGameList.indexOf(s)?r.open=0:r.open=1),!(uniLib.Global.isH5||this.changeGameId&&0!=this.changeGameId)){if(2==r.hide)continue;if(1==r.hide){if(0==t.MJLobbyData.getInstance().isAgent)continue}else if(r.hide>2&&r.hide!=uniLib.NetMgr.UID)continue;if(5240==r.gameId)continue}t.DataManage.checkIsPoker(r.gameId)?i=!0:n=!0,e.push(r)}return i&&n&&0==uniLib.Global.is_sandbox?this.gameTypeGroup.visible=!0:(this.gameTypeGroup.visible=!1,n?this.curPanelIndex=0:i&&(this.curPanelIndex=1)),e=1==this.curPanelIndex?e.filter(function(e){return t.DataManage.checkIsPoker(e.gameId)}):e.filter(function(e){return!t.DataManage.checkIsPoker(e.gameId)})},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectGameConfig",{get:function(){return this.games[this.gameList.selectedIndex]},enumerable:!0,configurable:!0}),n.prototype.setChangeUI=function(){this.createSijuBtn.visible=this.createBtn.visible=this.createMatchBtn.visible=!1,this.changeBtn.visible=!0},n.prototype.initData=function(e,i){void 0===e&&(e=null),void 0===i&&(i=!1),i&&e&&(this.changeGameId=e.gameId,this.setChangeUI()),this._lastCreateData=e,e&&(t.DataManage.checkIsPoker(e.gameId)?(this.pokerBtn.selected=!0,this.curPanelIndex=1):this.mahjongBtn.selected||(this.mahjongBtn.selected=!0,this.curPanelIndex=0));
var n=this.games;if(0!=uniLib.Global.is_sandbox&&(n=n.splice(0,1)),i&&(this.gameTypeGroup.visible=!1,n=n.filter(function(t){return t.gameId==e.gameId})),this.gameList.dataProvider=new eui.ArrayCollection(n),this.gameList.selectedIndex=0,e&&!i)for(var o=0;o<n.length;o++)if(n[o].gameId==e.gameId){this.gameList.selectedIndex=o;break}var a=i?e.gameId:this.selectGameConfig.gameId;i||this.checkData(e,a)||(this._lastCreateData=null),this.refreshSetting(a)},n.prototype.checkData=function(e,i){if(null==e)return!0;var n=t.MJLobbyData.getInstance().getGameCreateConfig(i);if(!this.checkItem(e,n,"gameNbr"))return!1;if(!this.checkItem(e,n,"payType"))return!1;if(!this.checkItem(e,n,"outTime"))return!1;if(!this.checkItem(e,n,"userNbr"))return!1;var o=!1,a=n.playType;if(!e.props)return!1;if(!a)return!1;for(var s=0,r=e.props;s<r.length;s++){var h=r[s];o=!1;for(var c=0,l=a;c<l.length;c++){var d=l[c];if(1!=d.idArr.indexOf(h)){o=!0;break}}if(0==o)return!1}return!0},n.prototype.checkItem=function(t,e,i){var n=e[i];if(!t||!n)return!1;for(var o=0,a=n;o<a.length;o++){var s=a[o];if(s.value==t[i])return!0}return!1},n.prototype.onCreateMatchBtn=function(){uniLib.SoundMgr.instance.playSound("buttonClick_mp3");var e=new Cmd.CreateRoomCmd_C;for(var i in this._mutilCheckArr)e[i]=this._mutilCheckArr[i].value;this._gameNList&&(e.gameNbr=this._gameNList.value),this._timeList&&(e.outTime=this._timeList.value);var n=this._mutilCheckMc.getChildByName("outTime");n&&(e.props=[n.value]),e.gameId=this.selectGameConfig.gameId,this._playTypeCheckBox&&(e.props=e.props.concat(this._playTypeCheckBox.value),this.changeGameId&&this.changeBtn.visible&&(e.gameId=this.changeGameId)),this.leavingPoint&&(e.leavingPoint=this.leavingPoint),this.enteringPoint&&(e.enteringPoint=this.enteringPoint),this.bottomPoint&&(e.bottomPoint=this.bottomPoint),e.lobbyId=t.MJLobbyData.getInstance().lobbyId,this.beforeCreate(e),this.dispatchEventWith(t.LobbyUIEventConsts.SettingMatch,!1,e)},n.prototype.onGameListTap=function(t){var e=this.games[t.itemIndex].gameId;e&&this.refreshSetting(e)},n.prototype.removeCheckBox=function(e){void 0===e&&(e=0);var i,n=this._mutilCheckMc.numChildren;this._checkBoxScroll.scrollTop=0;for(var o=0;n>o;o++)i=this._mutilCheckMc.removeChildAt(0),i.removeEventListener(t.LobbyUIEventConsts.CHANGE,this.onChange,this);if(0==e){if(this._mutilCheckArr){for(var a in this._mutilCheckArr)this._mutilCheckArr[a].removeEventListener(t.LobbyUIEventConsts.CHANGE,this.onChange,this),this._mutilCheckArr[a].destory();this._mutilCheckArr=null}this._gameNList&&(this._gameNList.destory(),this._gameNList=null)}this._timeList&&(this._timeList.destory(),this._timeList=null),this._playTypeCheckBox&&(this._playTypeCheckBox.destory(),this._playTypeCheckBox=null)},n.prototype.refreshSetting=function(e,n){void 0===n&&(n=0),this._gameId=e,this.removeCheckBox(n),this._mutilCheckArr||(this._mutilCheckArr={}),this._mutilCheckMc.graphics.clear();var o=t.MJLobbyData.getInstance().getGameCreateConfig(e),a=t.LobbyDataCache.langObj.uiTxt.CreateRoomPanel;if(!this._gameNList){var s=o.gameNbr;o.gameNbr_c&&o.gameNbr_c.length>0&&(s=o.gameNbr_c),this.gameListGroup=new eui.Group,this.gameListGroup.width=this.setGroup.width,this._gameNList=this.createRadioCheckBox("gameNbr",s),this._gameNList.y=0,this.gameListGroup.addChild(this._gameNList);var r=t.LobbyResUtil.createBitmapByName("lobby_diamond",this.gameListGroup.width-320,this._gameNList.y-10);this.gameListGroup.addChild(r),r.name="diamont",this._costTxt=t.LobbyResUtil.createTextFeild(1206199,egret.HorizontalAlign.RIGHT,"",28,r.x+r.width,r.y+13),this.gameListGroup.addChild(this._costTxt),this._exCostTxt=t.LobbyResUtil.createTextFeild(1206199,egret.HorizontalAlign.LEFT,"",28,r.x+r.width/2,this._costTxt.y+35),this.gameListGroup.addChild(this._exCostTxt),this._mounthCost&&this._mounthCost.parent||(this._mounthCost=t.LobbyResUtil.createTextFeild(1206199,egret.HorizontalAlign.LEFT,"",28,this.createMatchBtn.x+this.createMatchBtn.width,this.createMatchBtn.y+20),this.addChild(this._mounthCost)),this._mounthCost.visible=this.createBtn.visible,this.gameListGroup.height=this._gameNList.height,this._mutilCheckMc.addChildAt(this.gameListGroup,0)}this.gameListGroup.parent||(this.gameListGroup.y=this.getY(),this._mutilCheckMc.addChild(this.gameListGroup)),this._gameNList.hasEventListener(t.LobbyUIEventConsts.CHANGE)||this._gameNList.addEventListener(t.LobbyUIEventConsts.CHANGE,this.onChange,this);var h;this._lastCreateData&&e==this._lastCreateData.gameId&&0==n&&(h=this._lastCreateData),h&&(this._gameNList.value=h.gameNbr);var c;this._mutilCheckArr.userNbr?(c=this._mutilCheckArr.userNbr,c.y=this.getY()):o.userNbr&&o.userNbr[0]&&(c=this.createRadioCheckBox("userNbr",o.userNbr),c.addEventListener(t.LobbyUIEventConsts.CHANGE,this.onChange,this),h&&(c.value=h.userNbr)),c.parent||this._mutilCheckMc.addChild(c);var l=this._gameNList?this._gameNList.playType:null,d=o.playType;l&&l.length>0&&(d=l);t.MJLobbyData.getInstance().getPlayTypeConfig();if(d&&d.length&&(this._playTypeCheckBox=new t.PlayTypeCheckBox,h&&Array.isArray(h.props)?this._playTypeCheckBox.setPlayTypeData(d,h.props):this._playTypeCheckBox.setPlayTypeData(d,o.defaltPlayType),this._playTypeCheckBox.y=this.getY(),this._mutilCheckMc.addChild(this._playTypeCheckBox)),this._timeList||(this._timeList=new t.List,this._timeList.label=a.outTime),this._timeList.parent||(this._timeList.y=this.getY(),this._mutilCheckMc.addChild(this._timeList)),h&&h.outTime?this._timeList.setData(o.outTime,h.outTime):this._timeList.setData(o.outTime),this._mutilCheckArr.outTime||(c=new t.CheckBox,c.name="outTime",c.setIDArr([143,144],0,172),c.x=250,h&&(h.props&&-1!=h.props.indexOf(143)?c.value=143:h.props&&-1!=h.props.indexOf(144)?c.value=144:c.value=143)),c.parent||(c.y=this._timeList.y+10,this._mutilCheckMc.addChild(c)),2!=uniLib.Global.is_sandbox){var u=o.payType;this._mutilCheckArr.payType?(c=this._mutilCheckArr.payType,c.parent||(c.y=this.getY(),this._mutilCheckMc.addChild(c))):o.payType&&u[0]&&(c=0!=t.MJLobbyData.getInstance().isAgent||uniLib.Global.isH5||5!=u[u.length-1].value?this.createRadioCheckBox("payType",u):this.createRadioCheckBox("payType",u.slice(0,u.length-1)),h&&(c.value=h.payType),c.addEventListener(t.LobbyUIEventConsts.CHANGE,this.onChange,this))}this.onPayChange(),this._mutilCheckMc.height>this._checkBoxScroll.height?(this._arrowMc||(this._arrowMc=new i,this._arrowMc.x=1117,this._arrowMc.y=520*uniLib.ScreenUtils.scaleFactor,this.addChild(this._arrowMc)),this._arrowMc.show()):this._arrowMc&&this._arrowMc.hide(),this._mutilCheckMc.graphics.clear(),this._mutilCheckMc.graphics.beginFill(1206199,0),this._mutilCheckMc.graphics.drawRect(-this._mutilCheckMc.x,0,this._mutilCheckMc.width,this._mutilCheckMc.height),this._mutilCheckMc.graphics.endFill()},n.prototype.getY=function(){var t=this._mutilCheckMc.height;return 0!=t&&(t+=10),t},n.prototype.createRadioCheckBox=function(e,i,n){var o=t.LobbyDataCache.langObj.uiTxt.CreateRoomPanel,a=new t.CheckBox;return a.name=e,a.setData(i,0,172,n),a.label=o[e],a.y=this.getY(),this._mutilCheckArr[e]=a,this._mutilCheckMc.addChild(a),a},n.prototype.onChange=function(t){var e=t.currentTarget;("payType"==e.name||"userNbr"==e.name||"gameNbr"==e.name)&&(this.onPayChange(),"gameNbr"==e.name&&this._gameNList&&this._gameNList.playType&&this._gameNList.playType.length>0&&this.refreshSetting(this.gameId,1))},n.prototype.closeHandle=function(e){uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),this.dispatchEventWith(t.LobbyUIEventConsts.CLOSE)},n.prototype.createHandle=function(e){uniLib.SoundMgr.instance.playSound("buttonClick_mp3");var i=new Cmd.CreateRoomCmd_C;for(var n in this._mutilCheckArr)i[n]=this._mutilCheckArr[n].value;this._gameNList&&(i.gameNbr=this._gameNList.value),this._timeList&&(i.outTime=this._timeList.value);var o=this._mutilCheckMc.getChildByName("outTime");o&&(i.props=[o.value]),this._playTypeCheckBox&&(i.props=i.props.concat(this._playTypeCheckBox.value)),this.leavingPoint&&(i.leavingPoint=this.leavingPoint),this.enteringPoint&&(i.enteringPoint=this.enteringPoint),this.bottomPoint&&(i.bottomPoint=this.bottomPoint);var a=this.selectGameConfig.gameId;i.gameId=a,i.lobbyId=t.MJLobbyData.getInstance().lobbyId,this.beforeCreate(i),this.dispatchEventWith(t.LobbyUIEventConsts.CREATE_ROOM,!1,i)},n.prototype.changeState=function(t,e){void 0===e&&(e=!1)},n.prototype.onPayChange=function(t){if(void 0===t&&(t=null),2!=uniLib.Global.is_sandbox){var e="averdiamondcost",i=this._mutilCheckArr.payType;if(i){1==i.value||3==i.value?e="diamondcost":5==i.value?e="monthdiamondcost":4==i.value&&(e="AAdiamondcost");var n=this.getPayLabel(e);if(this._costTxt.text="×"+n,"diamondcost"!=e)return this._exCostTxt.text="",void(this._mounthCost.text="");var o=this.selectGameConfig,a=o.discount,s=o.maxMonthDiamond;s?this._mounthCost.text="月封顶:"+s:this._mounthCost.text="",a?this._exCostTxt.text=a+"折("+(n*a/10).toFixed(1)+"钻)":this._exCostTxt.text=""}}},n.prototype.getPayLabel=function(e){var i=this._mutilCheckArr.userNbr,n=4;if(i)n=i.value;else{var o=this.selectGameConfig;o.baseUserNbr[0]&&(n=o.baseUserNbr[0])}if(t.MJLobbyData.getInstance().myBaseInfo.vip>0){var a=t.MJLobbyData.getInstance().getVipConfig()[t.MJLobbyData.getInstance().myBaseInfo.vip-1];if(-1!=a.freeType.indexOf(n))return 0}for(var s=0;s<this.costObj.length;s++)if(this.costObj[s].usernbr==n&&this._costObj[s].gamenbr==this._gameNList.value)return this.costObj[s][e];return 0},n.prototype.getByCost=function(t,e){for(var i="monthdiamondcost",n=0;n<this.costObj.length;n++)if(this.costObj[n].usernbr==t&&this._costObj[n].gamenbr==e)return this.costObj[n][i];return 0},Object.defineProperty(n.prototype,"costObj",{get:function(){if(this._costObj)return this._costObj;var e=RES.getRes("TableRoomCostConfig_json");this._costObj=[];for(var i=0;i<e.length;i++)e[i].lobbyId==t.MJLobbyData.getInstance().lobbyId&&this._costObj.push(e[i]);return this._costObj},enumerable:!0,configurable:!0}),n.prototype.setExclude=function(t,e,i,n){if(void 0===n&&(n=4),this._mutilCheckArr){var o=this._mutilCheckArr[t];o&&o.setExclude(e,i)}var o=this._mutilCheckMc.getChildByName("userNbr");o&&(o.value=n)},n.prototype.beforeCreate=function(t){},n}(t.BaseComponent);t.CreateGamePanel=e,__reflect(e.prototype,"MJLobby.CreateGamePanel");var i=function(e){function i(){var i=e.call(this)||this;return i._arrowIcon=t.LobbyResUtil.createBitmapByName("mjl_create_arrow"),i.addChild(i._arrowIcon),i}return __extends(i,e),i.prototype.show=function(){this.stopTimer(),this._arrowIcon.visible=!0,this._arrowIcon.y=0,this._timer=new egret.Timer(400,0),this._timer.addEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this._timer.start()},i.prototype.stopTimer=function(){this._timer&&(this._timer.removeEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this._timer.stop(),this._timer=null)},i.prototype.onTimer=function(t){0==this._arrowIcon.y?this._arrowIcon.y=-15:this._arrowIcon.y=0},i.prototype.hide=function(){this.stopTimer(),this._arrowIcon.visible=!1},i.prototype.destory=function(){this.hide(),t.LobbyResUtil.removeAllChildren(this),t.LobbyResUtil.removeFromParent(this),this._arrowIcon=null},i}(egret.DisplayObjectContainer);t.ArrowMc=i,__reflect(i.prototype,"MJLobby.ArrowMc")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(t){function e(e){var i=t.call(this)||this;return i.dropItemHight=60,i.skinName=e,i}return __extends(e,t),Object.defineProperty(e.prototype,"title",{set:function(t){this.titleLabel&&(this.titleLabel.text=t,this.dropGroup.left=this.titleLabel.width+10)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._index>=0&&this.data[this._index]?this.data[this._index].value:void 0},set:function(t){if(t&&!this.data&&this.data instanceof Array){var e=this.data.find(function(e){e.value==t});e>-1&&(this.index=e)}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"prompt",{get:function(){return this._prompt},set:function(t){this.label&&(this._prompt=t,this.label.text=this._prompt)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},set:function(t){t&&t.length>0&&this.addUiEvent(),this._data=t,this.setData()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){return this._index},set:function(t){0>t||(this._index=t,this.setSelect(t))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"seleceData",{get:function(){return this._data&&this._data[this._index]?this._seleceData=this._data[this._index]:null},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){this._prompt="",this.currentState="up",this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.destory,this)},e.prototype.addUiEvent=function(){this.downBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.dropList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListTap,this)},e.prototype.removeUiEvent=function(){this.downBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.dropList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListTap,this)},e.prototype.onClick=function(){"up"==this.currentState?this.down():this.up()},e.prototype.onListTap=function(t){var e=t.itemIndex;this._index!=e&&this.setSelect(e),this.up(),this.dispatchEventWith(egret.Event.CHANGE)},e.prototype.up=function(){this.currentState="up"},e.prototype.down=function(){this.currentState="down"},e.prototype.setData=function(){if(this.data){var t=this.data;t instanceof Array&&(this.collection||(this.collection=new eui.ArrayCollection,this.dropList.dataProvider=this.collection,this.dropList.itemRenderer=i),this.collection.replaceAll(t))}},e.prototype.setSelect=function(t){this._index=t,this.dropList.selectedIndex=t,this.seleceData&&(this.label.text=this.seleceData.key),this._index-2>0&&(this.dropSc.viewport.scrollV=(this._index-2)*this.dropItemHight)},e.prototype.reset=function(){this._data=null,this._index=0,this._seleceData=null,this.label.text=this._prompt,this.removeUiEvent()},e.prototype.destory=function(){this.removeUiEvent(),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.destory,this)},e}(eui.Component);t.DropDown=e,__reflect(e.prototype,"MJLobby.DropDown");var i=function(t){function e(e){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return this._key},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e.prototype.dataChanged=function(){var t=this.data;this._key=t.key,this._value=t.value,this.label.text=t.key},e}(eui.ItemRenderer);t.DropDownItem=i,__reflect(i.prototype,"MJLobby.DropDownItem")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function i(){return e.call(this)||this}return __extends(i,e),i.prototype.destory=function(){e.prototype.destory.call(this),this._agreeBtn&&(this._agreeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onAgree,this),this._agreeBtn=null)},i.prototype.initUI=function(){var e=t.LobbyResUtil.createBitmapByName("mjl_lobby2_jpg");e.width=uniLib.Global.screenWidth,e.height=uniLib.Global.screenHeight,this.addChild(e);var i=t.LobbyResUtil.createBitmapByName("mjl_declare_title",453,7);i.x=uniLib.Global.screenWidth/2-i.width/2,this.addChild(i),e.touchEnabled=!0;var n=t.LobbyResUtil.createBitmapByName("mjl_common_bg",63,118);n.scale9Grid=new egret.Rectangle(200,100,16,21),n.width=1160,n.height=545,this.addChild(n);var o=t.LobbyResUtil.createBitmapByName("mjl_declare_content");o.x=141,o.y=155,this.addChild(o),this._agreeBtn=new t.LobbyGameButton(["mjl_declare_btn1","mjl_declare_btn1"]),this._agreeBtn.x=uniLib.Global.screenWidth/2-this._agreeBtn.width/2,this._agreeBtn.y=563,this.addChild(this._agreeBtn),this._agreeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onAgree,this)},i.prototype.onAgree=function(e){uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),this.dispatchEventWith(t.LobbyUIEventConsts.CLOSE)},i}(t.LobbyBaseVc);t.DeclarePanel=e,__reflect(e.prototype,"MJLobby.DeclarePanel")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.isFromRecord=!0,t.skinName=new RecordDetailSkin,t.addListener(),t.initPanel(),t.recordList=new Array,t}return __extends(n,e),n.prototype.addListener=function(){this.closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseTap,this)},n.prototype.removeListener=function(){this.closeButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseTap,this)},n.prototype.onCloseTap=function(e){uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),this.dispatchEventWith(t.LobbyUIEventConsts.CLOSE)},n.prototype.destory=function(){if(this._recordMc){for(var t=this._recordMc.numChildren-1;t>=0;t--){var e=this._recordMc.getChildAt(t);e.destory(),e=null}this._recordMc=null}this.closeButton&&(this.closeButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBack,this),this.closeButton=null),this._scroll=null,this.tipGroup&&this.tipGroup.removeChildren(),this.tipGroup=null,this.idGroup&&this.idGroup.removeChildren(),this.idGroup=null,this.nameGroup&&this.nameGroup.removeChildren(),this.nameGroup=null,this.tipLabel=null,uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this)},n.prototype.initPanel=function(){this.tipLabel.visible=!1},n.prototype.onBack=function(e){this.dispatchEventWith(t.LobbyUIEventConsts.CLOSE_RECORD)},n.prototype.addData=function(e){if(e.resultCode)return void(2==e.resultCode&&t.LobbyPopupManager.showMildWarnShow("牌局还未结束！"));var n=e.gameHistroyDetails;if(n&&n[0]){e.reason?(this.reason.text=e.reason,this.reason.visible=!0):(this.reason.text=null,this.reason.visible=!1);this.recordList=n&&n instanceof Array?n:[],this.list.itemRenderer=i,this.list.dataProvider=new eui.ArrayCollection(n);for(var o=n[0].userGameHistoryDetails,a=500/o.length,s=0;s<o.length;s++){var r=new eui.Label;r.text=o[s].nickName.slice(0,5),r.fontFamily="黑体",r.textColor=18687,r.size=24,r.width=a,r.textAlign="center",this.nameGroup.addChild(r)}if(e.gameHostTip){this.tipLabel.visible=!0;for(var h=e.gameHostTip.userGameHistoryDetails,c=0;c<h.length;c++){var l=new eui.Label;l.text=h[c].integral+"",l.fontFamily="黑体",l.textColor=18687,l.size=24,l.width=a,l.textAlign="center",this.tipGroup.addChild(l)}}else{this.tipLabel.visible=!1;for(var s=0;s<o.length;s++){var d=new eui.Label,u=o[s].uid+"";this.isFromRecord&&o[s].uid!=uniLib.NetMgr.UID&&(u="****"+u.slice(u.length-4)),d.text=u,d.fontFamily="黑体",d.textColor=18687,d.size=24,d.width=a,d.textAlign="center",this.idGroup.addChild(d)}}}},n.prototype.lookVideo=function(e){this.dispatchEventWith(t.LobbyUIEventConsts.REQ_LOOK_VIDEO,!1,e.data)},n.prototype.test=function(t){this.recordList[t]},n}(eui.Component);t.DetailRecordPanel=e,__reflect(e.prototype,"MJLobby.DetailRecordPanel");var i=function(e){function i(){var i=e.call(this)||this;return i.skinName=new RecordDetailItemSkin,i.backPlayBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,i.lookHistory,i),i.shareBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,i.shareHistory,i),i.sender=new t.MvcSender,i}return __extends(i,e),i.prototype.dataChanged=function(){var e=this.data;if(this.scoreGroup.removeChildren(),e){this.indexTxt.text=(this.itemIndex+1).toString(),this.dateTxt.text=t.LobbyUtils.changeTimeToStr(e.timeStamp);for(var i=500/e.userGameHistoryDetails.length,n=0;n<e.userGameHistoryDetails.length;n++){var o=new eui.Label;o.text=e.userGameHistoryDetails[n].integral,o.fontFamily="黑体",o.textColor=e.userGameHistoryDetails[n].integral<0?18687:14382400,o.size=24,o.width=i,o.textAlign="center",o.y=28,this.scoreGroup.addChild(o)}}},i.prototype.lookHistory=function(e){uniLib.SoundMgr.instance.playSound("buttonClick_mp3");var i=new Cmd.RequestRecordLobbyCmd_C;i.curGameNbr=this.itemIndex+1,i.globalRoomId=t.MJLobbyData.getInstance().globalRoomId,this.sender.sendNotification(t.MahJongLobbyFacadeConsts.SEND_DATA,i,t.LobbyDataRequestCommand.GAME_DATA)},i.prototype.shareHistory=function(e){uniLib.SoundMgr.instance.playSound("buttonClick_mp3");var i=t.MJLobbyData.getInstance().globalRoomId+":"+this.indexTxt.text;uniLib.ZQGameSdk.nativeCopyStr(i),t.LobbyPopupManager.showMildWarnShow("录像编号复制成功，请粘贴发送给好友")},i.prototype.destory=function(){this.backPlayBtn&&(this.backPlayBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.lookHistory,this),this.backPlayBtn=null),this.shareBtn&&(this.shareBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.shareHistory,this),this.shareBtn=null),this.scoreGroup&&this.scoreGroup.removeChildren(),this.scoreGroup=null,uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this)},i.prototype.getstar=function(){},i}(eui.ItemRenderer);t.DetailRecordItem=i,__reflect(i.prototype,"MJLobby.DetailRecordItem")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.skinName=new DonateHistorySkin,t}return __extends(n,e),Object.defineProperty(n,"Instance",{get:function(){return this._instance||(this._instance=new n),this._instance},enumerable:!0,configurable:!0}),n.prototype.addListener=function(){this.closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onClose,this)},n.prototype.removeListener=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.closeButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onClose,this)},n.prototype.onClose=function(){uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),this.removeListener(),this.donateCollection&&(this.donateCollection.removeAll(),this.donateCollection=null),this.parent&&t.LobbyPopupManager.removePopUp(this,!0)},n.prototype.onClick=function(t){if((t.target==this.uidSort||t.target==this.timeSort)&&this.donateList&&this.donateList instanceof Array&&this.donateList.length>1){var e=[];e=t.target==this.uidSort?this.donateList.sort(function(t,e){return t.uid-e.uid>0?1:t.uid-e.uid==0?0:t.uid-e.uid<0?-1:void 0}):this.donateList.sort(function(t,e){return t.time-e.time<0?1:t.time-e.time==0?0:t.time-e.time>0?-1:void 0}),console.error(e),this.donateCollection.replaceAll(e)}},n.prototype.setData=function(t){var e=t&&t instanceof Array?t:[];this.donateList=e,this.donateCollection||(this.donateCollection=new eui.ArrayCollection,this.donateHistoryList.itemRenderer=i,this.donateHistoryList.dataProvider=this.donateCollection),this.donateCollection.replaceAll(e)},n}(eui.Component);t.DonateHistoryPanel=e,__reflect(e.prototype,"MJLobby.DonateHistoryPanel");var i=function(t){function e(){var e=t.call(this)||this;return e.skinName=new DonateHistoryItemSkin,e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.uid.text=""+(t.uid?t.uid:""),this.nickName.text=t.nickName?t.nickName:"",this.nickName.text=this.nickName.text.slice(0,4),this.opTime.text=GX.timestampToString(t.time?t.time:0),this.change.text=""+(t.change?t.change:0),this.totalTax.text=""+(t.all?t.all:0),this.type.text=t.change>0?"赠送":"捐献"},e}(eui.ItemRenderer);t.DonateHistoryItem=i,__reflect(i.prototype,"MJLobby.DonateHistoryItem")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.skinName=new MoneyRankSkin,t.rankList.itemRenderer=i,t}return __extends(n,e),Object.defineProperty(n,"Instance",{get:function(){return null==this.m_Instance&&(this.m_Instance=new n),this.m_Instance},enumerable:!0,configurable:!0}),n.prototype.onClick=function(e){if(e.target==this.closeBtn||e.target==this.backRect){uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this);var i=this;egret.Tween.get(this.contentGroup).to({left:-i.contentGroup.width},250).wait(50).call(function(){egret.Tween.removeTweens(i.contentGroup),t.LobbyPopupManager.removePopUp(i,!1,!0)})}},n.prototype.showPanel=function(e){this.contentGroup.left=-this.contentGroup.width,t.LobbyPopupManager.addPopUp(t.GoldenRankPanel.Instance,!1,!0);var i=this;egret.Tween.get(this.contentGroup).to({left:(uniLib.Global.screenWidth-1280)/2-40},240).wait(50).call(i.moveEnd,i),this.updateRank(e)},n.prototype.moveEnd=function(){this.contentGroup&&egret.Tween.removeTweens(this.contentGroup),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)},n.prototype.updateRank=function(e){for(var i=[],n=[],o=0;o<e.allChipsRank.length;o++){var a=e.allChipsRank[o];i.push({rank:(o+1).toString(),item:a}),a.headUrl||n.push(a.uid)}t.HeadMcManager.instanc.requestHeadurl(n.distinct()),this.rankList.dataProvider=new eui.ArrayCollection(i)},n.prototype.showUserInfo=function(e){var i=new t.LobbyOtherUserInfoPanel;i.setData(e),t.LobbyPopupManager.addPopUp(i,!1,!0)},n}(t.BaseComponent);t.GoldenRankPanel=e,__reflect(e.prototype,"MJLobby.GoldenRankPanel");var i=function(i){function n(){var t=i.call(this)||this;return t.skinName=new RankItemRenderSkin,t.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onHandle,t),t}return __extends(n,i),n.prototype.dataChanged=function(){var e=this,i=this.data,n=i.item;if(n){this.nameLabel.text=n.nickName?n.nickName.slice(0,6):"",this.rankLabel.text=i.rank+"";var o;o=n.allChips>=1e8?(n.allChips/1e8).toFixed(2)+"亿":n.allChips>=1e4?(n.allChips/1e4).toFixed(2)+"万":n.allChips?Math.floor(n.allChips)+"":"0",this.moneycountLabel.text=o,n.headUrl?this.headMc.source=n.headUrl:t.HeadMcManager.instanc.getUserHeadByUid(n.uid,this,function(t){t&&(e.headMc.source=t,e.data.headUrl=t)}),this.headMc.mask=this.headBg,this.headMc.x=this.headBg.x+2.5,this.headMc.y=this.headBg.y+2.5,this.idLabel.text="ID:"+(n.uid?n.uid:"")}},n.prototype.onHandle=function(){e.Instance.showUserInfo(this.data.item)},n}(eui.ItemRenderer);t.RankItemRender=i,__reflect(i.prototype,"MJLobby.RankItemRender")}(MJLobby||(MJLobby={}));var Emoji;!function(t){function e(e){if("undefined"==typeof e||null==e||""===e)return[];for(var i=[],n=0,o=0,a=0,s=[];a<e.length;)if(n=e.charCodeAt(a++),o){var r=(65536+(o-55296<<10)+(n-56320)).toString(16);i.push(r),s.push(t.emojiIamge(35,35,r)),o=0}else n>=55296&&56319>=n?o=n:(i.push(n.toString(16)),s.push(String.fromCharCode(n)));return s=s.length>=5?s.slice(0,5):s}function i(e,i,n){var o=new eui.Image;o.width=e,o.height=e;var a=t.getEmojiImageByUnicode(n);return null!=a&&RES.hasRes(a)?o.source=a:o.source="",o}function n(t){var e=RES.getRes("emoji_json"),i=e.first(function(e){return e.uniCode==t.toUpperCase()});return null!=i?i.img:""}t.toCodePoint=e,t.emojiIamge=i,t.getEmojiImageByUnicode=n}(Emoji||(Emoji={}));var table;!function(t){var e=function(){function t(){}return t.prototype.GetType=function(){return"table.TableEmojiConfig"},t}();t.TableEmojiConfig=e,__reflect(e.prototype,"table.TableEmojiConfig")}(table||(table={}));var MJLobby;!function(t){var e=function(e){function a(){var t=e.call(this)||this;return t.skinName=new HelpPanelSkin,t.initPanel(),t.addListener(),t}return __extends(a,e),a.prototype.addListener=function(){this.closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeHandle,this)},a.prototype.closeHandle=function(e){uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),this.dispatchEventWith(t.LobbyUIEventConsts.CLOSE)},a.prototype.destory=function(){if(this._gameTypeMenuArr){for(var t=0;t<this._gameTypeMenuArr.length;t++)this._gameTypeMenuArr[t].destory(),this._gameTypeMenuArr[t].removeEventListener(i.CHOOSED,this.onTypeChange,this);this._gameTypeMenuArr=null}if(this._menuArr){for(var t=0;t<this._menuArr.length;t++)this._menuArr[t].destory(),this._menuArr[t].removeEventListener(i.CHOOSED,this.onChoosed,this);this._menuArr=null}this._scroll&&(this._scroll.removeChildren(),this._scroll=null),this._ruleArr=null,this._sysMsgTxt=null,this._curGameTypeMenu=null,this._curMenu=null},a.prototype.initPanel=function(){this._ruleArr=[],this._sysMsgTxt=t.LobbyResUtil.createTextFeild(2969627,egret.HorizontalAlign.LEFT,"",24,0,0,730),this._sysMsgTxt.lineSpacing=6,this.ruleContent.addChild(this._sysMsgTxt),this._scroll=t.LobbyResUtil.createScroll(this._sysMsgTxt,this.ruleContent.width-30,this.ruleContent.height,15,15),this._scroll.horizontalScrollPolicy="off",this._scroll.verticalScrollPolicy="on",this.ruleContent.addChild(this._scroll);this._menuArr=[];var e,i=["基本规则","基本番型","特殊规则","结算"];this.titleList.itemRenderer=o,this.titleList.dataProvider=new eui.ArrayCollection(i),this.titleList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.RuleRequest,this),this.titleList.selectedIndex=0,this.helpGameList=new Array;var a,s=t.MJLobbyData.getInstance().getGameList();this._gameTypeMenuArr={};for(var r,h=0;h<s.length;h++){if(a=t.MJLobbyData.getInstance().getGameCreateConfig(s[h]),!uniLib.Global.isH5){if(2==a.hide)continue;if(1==a.hide){if(0==t.MJLobbyData.getInstance().isAgent)continue}else if(0!=a.hide&&a.hide!=uniLib.NetMgr.UID)continue;if(5240==a.gameId)continue}1==a.open&&(r||(r=s[h]),this._gameTypeMenuArr[s[h]]=e,this.helpGameList.push(a))}0!=uniLib.Global.is_sandbox&&this.helpGameList.length>0&&(this.helpGameList=this.helpGameList.slice(0,1)),this.buttonList.itemRenderer=n,this.buttonList.dataProvider=new eui.ArrayCollection(this.helpGameList),this.buttonList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.gameHelpRequest,this),this.buttonList.selectedIndex=0,this.setCurMenu(0)},a.prototype.RuleRequest=function(t){uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),this.ruleInfoReq(t.itemIndex)},a.prototype.ruleInfoReq=function(t){uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),this.refreshHelpTxt()},a.prototype.gameHelpRequest=function(t){uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),this.gameItemPlayInfoReq(t.itemIndex)},a.prototype.gameItemPlayInfoReq=function(t){uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),this.refreshHelpTxt()},a.prototype.setCurGameTypeMenu=function(t){var e=this._gameTypeMenuArr[t];this._curGameTypeMenu!=e&&(this._curGameTypeMenu&&this._curGameTypeMenu.gotoAndStop(1),this._curGameTypeMenu=e,this._curGameTypeMenu.gotoAndStop(2)),this.refreshHelpTxt()},a.prototype.setCurMenu=function(t){var e=this._menuArr[t];this._curMenu!=e&&(this._curMenu&&this._curMenu.gotoAndStop(1),this._curMenu=e,this._curMenu.gotoAndStop(2)),this.refreshHelpTxt()},a.prototype.onTypeChange=function(t){var e=t.currentTarget;this.setCurGameTypeMenu(e.id)},a.prototype.onChoosed=function(t){var e=t.currentTarget;this.setChildIndex(e,this.numChildren-1),this.setCurMenu(e.id)},a.prototype.refreshHelpTxt=function(){if(this.helpGameList){var t,e=this.helpGameList[this.buttonList.selectedIndex].gameId,i=this.titleList.selectedIndex,n=e;this._ruleArr[n]||(t=RES.getRes("rule_"+n+"_txt"),t||(t=""),this._ruleArr[n]=t.split("########")),this._ruleArr[n][2*i+1]||(this._ruleArr[n][2*i+1]="防止竞争对手抄袭,规则请联系客服"),this._sysMsgTxt.textFlow=(new egret.HtmlTextParser).parser(this._ruleArr[n][2*i+1]),this._scroll.scrollTop=0}},a}(eui.Component);t.HelpPanel=e,__reflect(e.prototype,"MJLobby.HelpPanel");var i=function(e){function i(i,n,o,a){void 0===a&&(a=!1);var s=e.call(this)||this;return s._data=i,s.alwayDispatch=a,s._lableArr=n,s._bitmap=new egret.Bitmap,s._bitmap.texture=t.LobbyResUtil.createTexture(s._data[0]),s.addChild(s._bitmap),s.touchEnabled=!0,s.gotoAndStop(1),s.addEventListener(egret.TouchEvent.TOUCH_TAP,s.onClick,s),o&&(s._labelTxt=t.LobbyResUtil.createTextFeild(2969627,egret.HorizontalAlign.CENTER,o,34,3,20,231),s.addChild(s._labelTxt)),s}return __extends(i,e),i.prototype.destory=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),t.LobbyResUtil.removeAllChildren(this),t.LobbyResUtil.removeFromParent(this),this._bitmap=null,this._label=null,this._lableArr=null,this._data=null,this._labelTxt=null},Object.defineProperty(i.prototype,"id",{get:function(){return this._id},set:function(t){this._id=t},enumerable:!0,configurable:!0}),i.prototype.onClick=function(t){uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),(1==this._frame||this.alwayDispatch)&&(this.gotoAndStop(2),this.dispatchEventWith(i.CHOOSED))
},i.prototype.gotoAndStop=function(e){this._frame=e,this._bitmap.texture=t.LobbyResUtil.createTexture(this._data[e-1]),this._lableArr&&(this._label||(this._label=new egret.Bitmap,this._label.y=19,this.addChild(this._label)),this._label.texture=t.LobbyResUtil.createTexture(this._lableArr[e-1]),this._label.x=Math.round((243-this._label.width)/2))},i}(egret.DisplayObjectContainer);i.CHOOSED="CHOOSED",t.MenuItem=i,__reflect(i.prototype,"MJLobby.MenuItem");var n=function(t){function e(){var e=t.call(this)||this;return e.skinName=new MJ_RadioButton1Skin,e.touchChildren=!1,e.touchEnabled=!0,e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.labelDisplay.text=t.gameName,0==t.open&&0==uniLib.Global.is_sandbox&&(this.currentState="disabled",this.touchEnabled=!1)},e}(eui.ItemRenderer);t.GameTypeItem=n,__reflect(n.prototype,"MJLobby.GameTypeItem");var o=function(t){function e(){var e=t.call(this)||this;return e.skinName=new MJ_RadioButton2Skin,e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.labelDisplay.text=t},e}(eui.ItemRenderer);__reflect(o.prototype,"RuleItem")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function o(){return e.call(this)||this}return __extends(o,e),o.prototype.initPanel=function(){this.title="mjl_action_title",this.setSize(1097,606),this._curIndex=-1,this._menuArr=[];var e;[new egret.Point(220,16),new egret.Point(427,16)];this._menuArr=[],this._contentMc=new egret.DisplayObjectContainer,this.addChild(this._contentMc),this._menuIdArr=[o.INVITE,o.NOTICE],t.MJLobbyData.getInstance().checkInVo&&t.MJLobbyData.getInstance().checkInVo.openSingIn&&this._menuIdArr.push(o.CHECK_IN),4==t.MJLobbyData.getInstance().lobbyId&&this._menuIdArr.push(o.HUNAN_ACTIVITY);for(var i=0;i<this._menuIdArr.length;i++)e=this._menuIdArr[i]==o.HUNAN_ACTIVITY?new t.MenuItem(["mjl_help_btn1","mjl_help_btn1"],["mjl_notice_menu"+this._menuIdArr[i]+1,"mjl_notice_menu"+this._menuIdArr[i]+2],null,!0):new t.MenuItem(["mjl_help_btn1","mjl_help_btn2"],["mjl_notice_menu"+this._menuIdArr[i]+1,"mjl_notice_menu"+this._menuIdArr[i]+2]),e.x=24,e.y=88+86*i,e.id=i,e.addEventListener(t.MenuItem.CHOOSED,this.onChoosed,this),this.addChild(e),this._menuArr.push(e);this._inviteMC=new n,this._inviteMC.addEventListener(t.LobbyUIEventConsts.GET_INVITE_AWARDS,this.dispatch,this),this._contentMc.addChild(this._inviteMC),this.setCurMenu(0)},o.prototype.showNotice=function(){this.setCurMenu(1)},o.prototype.destory=function(){if(e.prototype.destory.call(this),this._menuArr){for(var i=0;i<this._menuArr.length;i++)this._menuArr[i]&&(this._menuArr[i].removeEventListener(t.MenuItem.CHOOSED,this.onChoosed,this),this._menuArr[i].destory());this._menuArr=null}this._inviteMC&&(this._inviteMC.destory(),this._inviteMC.removeEventListener(t.LobbyUIEventConsts.GET_INVITE_AWARDS,this.dispatch,this),this._inviteMC=null)},o.prototype.closeHandle=function(e){this.dispatchEventWith(t.LobbyUIEventConsts.CLOSE)},o.prototype.onChoosed=function(e){var i=e.currentTarget;return this._menuIdArr[i.id]==o.HUNAN_ACTIVITY?void(3==t.MJLobbyData.getInstance().lobbyId?uniLib.ZQGameSdk.openWeb("http://hd.zqgame.com/zqgame/qp/notice/hubei/index.html",uniLib.WEBMODEL.AUTO):1==t.MJLobbyData.getInstance().lobbyId?uniLib.ZQGameSdk.openWeb("http://hd.zqgame.com/zqgame/qp/notice/hunan/index.html",uniLib.WEBMODEL.AUTO):4==t.MJLobbyData.getInstance().lobbyId&&uniLib.ZQGameSdk.openWeb("http://hd.zqgame.com/zqgame/qp/notice/guizhou/index.html",uniLib.WEBMODEL.AUTO)):(this.setChildIndex(i,this.numChildren-1),void this.setCurMenu(i.id))},o.prototype.setCurMenu=function(t){this._curIndex!=t&&(-1!=this._curIndex&&this._menuArr[this._curIndex].gotoAndStop(1),this._curIndex=t,this._menuArr[this._curIndex]||(this._curIndex=0),this._menuArr[this._curIndex].gotoAndStop(2)),this.refresContent()},o.prototype.hideAll=function(){this._inviteMC&&(this._inviteMC.visible=!1),this._noticeMc&&(this._noticeMc.visible=!1)},o.prototype.refresContent=function(){switch(this.hideAll(),this._menuIdArr[this._curIndex]){case o.NOTICE:this._noticeMc||(this._noticeMc=new i,this._contentMc.addChild(this._noticeMc)),this._noticeMc.visible=!0;break;case o.INVITE:this._inviteMC.visible=!0}},o.prototype.dispatch=function(t){this.dispatchEvent(t)},o.prototype.setInviteData=function(t){this._inviteMC&&this._inviteMC.setData(t)},o.prototype.updateInviteData=function(t){this._inviteMC&&this._inviteMC.updateData(t)},o}(t.BasePanel);e.NOTICE=1,e.CHECK_IN=2,e.INVITE=3,e.TGY=4,e.HUNAN_ACTIVITY=7,t.InvitePanel=e,__reflect(e.prototype,"MJLobby.InvitePanel");var i=function(e){function i(){return e.call(this)||this}return __extends(i,e),i.prototype.initUI=function(){var e=t.LobbyResUtil.createBitmapByName("mjl_create_content_bg",268,90);this.addChild(e),this._noticeTxt=t.LobbyResUtil.createTextFeild(3480337,egret.HorizontalAlign.LEFT,"",30,343,164,720),this._noticeTxt.height=393,this._noticeTxt.touchEnabled=!0,this._noticeTxt.textFlow=new Array({text:"客家麻将内测招募代理期间，有问题希望及时代理群反应。\n\n"},{text:"官方活动请关注公众号：",style:{textColor:12603919}},{text:"YMYLFW",style:{textColor:10066423,href:"event:YMYLFW"}},{text:"\n\n代理请咨询微信：",style:{textColor:12603919}},{text:"kejiamajiang001",style:{textColor:10066423,href:"event:kejiamajiang001"}},{text:"\n\n感谢您的支持，祝您游戏愉快。"},{text:"(点击蓝色字可以复制)",style:{textColor:3355443,size:24}}),this._noticeTxt.addEventListener(egret.TextEvent.LINK,this.onLink,this),this.addChild(this._noticeTxt)},i.prototype.onLink=function(e){uniLib.ZQGameSdk.nativeCopyStr(e.text),t.LobbyPopupManager.showMildWarnShow(e.text+"复制成功")},i.prototype.destory=function(){e.prototype.destory.call(this),this._noticeTxt&&(this._noticeTxt.removeEventListener(egret.TextEvent.LINK,this.onLink,this),this._noticeTxt=null)},i}(t.LobbyBaseVc);t.NoticeMc=i,__reflect(i.prototype,"MJLobby.NoticeMc");var n=function(e){function i(){return e.call(this)||this}return __extends(i,e),i.prototype.initUI=function(){var e=t.LobbyResUtil.createBitmapByName("mjl_create_content_bg",268,90);this.addChild(e),this._invitedInfoTxt=t.LobbyResUtil.createTextFeild(6316126,egret.HorizontalAlign.LEFT,"",18,298,105,449),this.addChild(this._invitedInfoTxt),this._myInviteInfoTxt=t.LobbyResUtil.createTextFeild(6316126,egret.HorizontalAlign.LEFT,"",18,750,100,294),this.addChild(this._myInviteInfoTxt);var i=t.LobbyResUtil.createBitmapByName("mjl_invite_userbg",298,173);i.height=302,this.addChild(i),this._userMc=new egret.DisplayObjectContainer,this.addChild(this._userMc),this._userScroll=t.LobbyResUtil.createScroll(this._userMc,366,300,298,175),this._userScroll.horizontalScrollPolicy="off",this._userScroll.verticalScrollPolicy="on",this.addChild(this._userScroll);var n=t.LobbyResUtil.createBitmapByName("mjl_invite_bar",298,140);this.addChild(n);var o=t.LobbyResUtil.createTextFeild(3956832,egret.HorizontalAlign.LEFT,"我推荐的玩家",22,306,147,162);this.addChild(o);var a=t.LobbyResUtil.createTextFeild(3956832,egret.HorizontalAlign.RIGHT,"游戏局数",22,487,147,162);this.addChild(a);var s=t.LobbyResUtil.createBitmapByName("mjl_invite_codebg",747,140);this.addChild(s),this._shareBtn=new t.LobbyGameButton(["mjl_invite_share1","mjl_invite_share2"]),this._shareBtn.x=747,this._shareBtn.y=370,this.addChild(this._shareBtn),this._noDataTxt=t.LobbyResUtil.createTextFeild(4213571,egret.HorizontalAlign.CENTER,"您尚无推荐新玩家\n分享二维码可推广获取奖励",28,294,275,365),this._noDataTxt.lineSpacing=10,this.addChild(this._noDataTxt),this._shareBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShare,this);var r=t.LobbyResUtil.createTextFeild(6645093,egret.HorizontalAlign.LEFT,"已领取",20,304,509,76);this.addChild(r);var h=t.LobbyResUtil.createTextFeild(6645093,egret.HorizontalAlign.LEFT,"待领取",20,304,537,76);this.addChild(h),this._getedTxt=t.LobbyResUtil.createTextFeild(16742429,egret.HorizontalAlign.CENTER,"0",20,363,508,76),this._getTxt=t.LobbyResUtil.createTextFeild(16742429,egret.HorizontalAlign.CENTER,"0",20,363,536,76),this.addChild(this._getedTxt),this.addChild(this._getTxt);var c=t.LobbyResUtil.createBitmapByName("mjl_small_diamont",427,508);this.addChild(c);var l=t.LobbyResUtil.createBitmapByName("mjl_small_diamont",427,536);this.addChild(l),this._codeInfoTxt=t.LobbyResUtil.createTextFeild(6316126,egret.HorizontalAlign.LEFT,"将专属二维码分享给朋友下载安装即可推荐",20,670,446,394),this.addChild(this._codeInfoTxt);var d=t.MJLobbyData.getInstance().getLobbyConfig().returnDiamond;d&&0!=d||(d=5),this._codeInfoTxt.text="1.将二维码分享给朋友下载安装即可绑定！\n2.每推荐一个玩家安装，且新玩家游戏局数超过4局即可领取"+d+"钻！\n3.新玩家进入游戏24小时内不绑定则以后不可绑定！\n4.代理商和推广员期间不能绑定！",this._getBtn=new t.LobbyGameButton(["mjl_invite_get1","mjl_invite_get2"]),this._getBtn.x=478,this._getBtn.y=507,this.addChild(this._getBtn),this._getBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetDiamond,this)},i.prototype.onGetDiamond=function(e){this.dispatchEventWith(t.LobbyUIEventConsts.GET_INVITE_AWARDS)},i.prototype.getHeadCache=function(t){if(uniLib.Global.localCache){if(uniLib.Global.localCache[t])return uniLib.Global.localCache[t]}else uniLib.Global.localCache={};return null},i.prototype.destory=function(){e.prototype.destory.call(this),this._data=null,this._shareBtn&&(this._shareBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShare,this),this._shareBtn=null),this.reset(),this._userScroll=null,this._codeImg=null,this._userMc=null,this._invitedInfoTxt=null,this._myInviteInfoTxt=null,this._codeInfoTxt=null,this._noDataTxt=null},i.prototype.onShare=function(e){if(this.getHeadCache(this._data.codeUrl)){var i=new egret.DisplayObjectContainer,n=t.LobbyResUtil.createBitmapByName("mjl_codeimg_bg_png");i.addChild(n);var o=new t.LobbyHeadMc(210,210,!1);o.headUrl=this._data.codeUrl,o.x=167,o.y=180,i.addChild(o);var a=new t.LobbyHeadMc(80,80);a.headUrl=t.MJLobbyData.getInstance().myBaseInfo.headUrl,a.x=150,a.y=413,i.addChild(a);var s=t.LobbyResUtil.createTextFeild(9520146,egret.HorizontalAlign.CENTER,t.MJLobbyData.getInstance().lobbyConfig.desc,34,152,80,243);s.height=50,i.addChild(s);var r=t.LobbyResUtil.createTextFeild(9520146,egret.HorizontalAlign.LEFT,t.MJLobbyData.getInstance().myBaseInfo.nickName,32,231,415,164);r.height=40,i.addChild(r);var h=t.LobbyResUtil.createTextFeild(9520146,egret.HorizontalAlign.LEFT,t.MJLobbyData.getInstance().myBaseInfo.uid+"",32,231,456,164);h.height=40,i.addChild(h);var c=new uniLib.WXShareVo;c.shareWay=0,c.shareImageData=uniLib.DisplayUtils.catchScreen(i,new egret.Rectangle(0,0,i.width,i.height)),uniLib.ZQGameSdk.share(c,null,null)}},i.prototype.updateData=function(t){this._getedTxt.text=t.alreadyRecv+"",this._getTxt.text=t.notRecv+""},i.prototype.setData=function(e){if(this.reset(),this._data=e,this._invitedInfoTxt.text="您推荐的新玩家人数为"+e.inviteAllNum+"人，总局数为"+e.playAllNum,e.myself&&e.myself.parent?this._myInviteInfoTxt.text="您已被"+e.myself.nickName+"推荐":this._myInviteInfoTxt.text="",this._getedTxt.text=e.alreadyRecv+"",this._getTxt.text=e.notRecv+"",e.inviteList&&e.inviteList[0]){for(var i,n=0;n<e.inviteList.length;n++)i=new o,i.data=e.inviteList[n],i.y=76*n,this._userMc.addChild(i);this._noDataTxt.visible=!1}else this._noDataTxt.visible=!0;this._codeImg||(this._codeImg=new t.LobbyHeadMc(231,231,!1,!0),this._codeImg.headUrl=e.codeUrl,this._codeImg.x=750,this._codeImg.y=133,this.addChild(this._codeImg))},i.prototype.reset=function(){for(var t=this._userMc.numChildren,e=0;t>e;e++){var i=this._userMc.removeChildAt(0);i.destory()}this._userMc.y=0,this._invitedInfoTxt.text="",this._myInviteInfoTxt.text=""},i}(t.LobbyBaseVc);t.InviteMc=n,__reflect(n.prototype,"MJLobby.InviteMc");var o=function(e){function i(){var i=e.call(this)||this,n=new egret.Sprite;n.graphics.beginFill(16777215,0),n.graphics.drawRect(0,0,366,76),n.graphics.endFill(),i.addChild(n),i._nickTxt=t.LobbyResUtil.createTextFeild(1120019,egret.HorizontalAlign.LEFT,"",24,83,12,176),i._nickTxt.height=30,i.addChild(i._nickTxt),i._idTxt=t.LobbyResUtil.createTextFeild(6119261,egret.HorizontalAlign.LEFT,"",20,83,46,176),i.addChild(i._idTxt),i._playNum=t.LobbyResUtil.createTextFeild(1120019,egret.HorizontalAlign.LEFT,"",35,273,21,100),i.addChild(i._playNum);var o=t.LobbyResUtil.createBitmapByName("mjl_invite_line",0,75);i.addChild(o);var a=t.LobbyResUtil.createBitmapByName("mjl_invite_headbg",10,12);return i.addChild(a),i._headMc=new t.LobbyHeadMc(50,50),i._headMc.x=12,i._headMc.y=14,i.addChild(i._headMc),i}return __extends(i,e),i.prototype.destory=function(){t.LobbyResUtil.removeAllChildren(this),t.LobbyResUtil.removeFromParent(this),this._headMc&&(this._headMc.destory(),this._headMc=null),this._nickTxt=null,this._idTxt=null,this._playNum=null,this._data=null},Object.defineProperty(i.prototype,"data",{get:function(){return this._data},set:function(t){this._data=t,this._nickTxt.text=t.nickName,this._idTxt.text=t.uid+"",this._playNum.text=t.playNum+"",this._headMc.headUrl=t.headUrl},enumerable:!0,configurable:!0}),i}(egret.DisplayObjectContainer);t.UserItem=o,__reflect(o.prototype,"MJLobby.UserItem")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function a(){var t=e.call(this)||this;return t._recordList=new Array,t.skinName=new JoinRoomSkin,t.initUI(),t.addListener(),t}return __extends(a,e),a.prototype.initUI=function(){this._inputNArr=[],this._curIndex=0;for(var t=0;6>t;t++){var e=new i;this.inputNumberGroup.addChild(e),this._inputNArr.push(e)}this._keyArr=[];for(var t=0;12>t;t++){var o=new n;o.value=t,this.inputKeyGroup.addChild(o),this._keyArr.push(o)}},a.prototype.addListener=function(){this.closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseTap,this);for(var t=0,e=this._keyArr;t<e.length;t++){var i=e[t];i.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onInput,this)}},a.prototype.removeListener=function(){this.closeButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseTap,this);for(var t=0,e=this._keyArr;t<e.length;t++){var i=e[t];i.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onInput,this)}},a.prototype.destory=function(){this.removeListener()},a.prototype.setData=function(t){null!=t&&t.list instanceof Array?this.neverInfo.visible=!1:this.neverInfo.visible=!0;var e=null!=t.list&&t.list instanceof Array?t.list:[];this.recordList.itemRenderer=o,this.recordList.dataProvider=new eui.ArrayCollection(e)},a.prototype.reqMatchRecord=function(t){},a.prototype.onInput=function(t){RES.hasRes("buttonClick_mp3")&&uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),0==this._inputNArr.length?this.inputPrompt.visible=!0:this.inputPrompt.visible=!1;var e,i=t.target,n=i.value;return 9==n?void this.reset():11==n?void this.removeOneNum():(e=10==n?0:n+1,void this.addNun(e))},a.prototype.onCloseTap=function(t){uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),this.onRemove()},a.prototype.onRemove=function(){this.destory(),t.LobbyPopupManager.removePopUp(this)},a.prototype.reset=function(){for(var t=0;6>t;t++)this._inputNArr[t]["delete"]();this._curIndex=0},a.prototype.removeOneNum=function(){this._curIndex>0&&(this._inputNArr[this._curIndex-1]["delete"](),this._curIndex--)},a.prototype.addNun=function(t){this._curIndex<6&&(this._inputNArr[this._curIndex].value=t,this._curIndex++,6==this._curIndex&&this.joinRoom())},a.prototype.joinRoom=function(){for(var e="",i=0;6>i;i++)e+=this._inputNArr[i].value.toString();this.dispatchEventWith(t.LobbyUIEventConsts.JOIN_ROOM,!1,Number(e))},a}(eui.Component);t.JoinRoomPanel=e,__reflect(e.prototype,"MJLobby.JoinRoomPanel");var i=function(e){function i(){var t=e.call(this)||this;return t.initUI(),t}return __extends(i,e),i.prototype.initUI=function(){var e=t.LobbyResUtil.createBitmapByName("join_numbg");e.scale9Grid=new egret.Rectangle(20,19,29,24),this.addChild(e),this.width=87,this.height=e.height,this._inputTxt=t.LobbyUtils.getBitmapFontTxt("mjl_input_fn1_fnt",62,egret.HorizontalAlign.CENTER,1,13),t.LobbyResUtil.createTextFeild(16777215,egret.HorizontalAlign.CENTER,"",32,3,8,45),this.addChild(this._inputTxt)},Object.defineProperty(i.prototype,"value",{get:function(){return this._value},set:function(t){this._inputTxt.text=t.toString(),this._value=t},enumerable:!0,configurable:!0}),i.prototype["delete"]=function(){this._inputTxt.text=""},i}(eui.Component);t.InputNumItem=i,__reflect(i.prototype,"MJLobby.InputNumItem");var n=function(e){function i(){var t=e.call(this)||this;return t.skinName=new MJ_JoinRoomButtonSkin,t.initUI(),t}return __extends(i,e),i.prototype.initUI=function(){this.addChild(this._inputTxt),this._inputTxt.touchEnabled=!1},Object.defineProperty(i.prototype,"value",{get:function(){return this._value},set:function(e){this._value=e,9==this._value||11==this._value,this._inputTxt.text=t.LobbyDataCache.langObj.uiTxt.JoinRoomPanel["key"+this._value]},enumerable:!0,configurable:!0}),i.prototype.destory=function(){},i}(eui.Button);t.InputKeyItem=n,__reflect(n.prototype,"MJLobby.InputKeyItem");var o=function(e){function i(){var t=e.call(this)||this;return t.skinName=new HistroyJoinItemSkin,t.addEventListener(egret.TouchEvent.TOUCH_TAP,t.clickHandle,t),t}return __extends(i,e),i.prototype.dataChanged=function(){var t=this.data,e=null!=t.matchName?t.matchName:t.matchId;this.roomInfo.text="匹配号Id:"+t.matchId+"\n匹配号名称:"+e},i.prototype.showInfo=function(t){var e=this.data,i=null!=e.matchName?e.matchName:e.matchId;t?this.roomInfo.text=e.desc:this.roomInfo.text="匹配号Id:"+e.matchId+"\n匹配号名称:"+i},i.prototype.clickHandle=function(e){if(e.target==this.detailsBtn)this.showInfo(this.detailsBtn.selected);else if(e.target==this.joinBtn){var i=new Cmd.EnterRoomCmd_C;i.roomId=this.data.matchId,t.LobbyServerMJProxy.getInstance().sendData(i),t.NetMgr.setMsgTimeout(5,"EnterRoomCmd_C")}else if(e.target==this.deleteBtn){var n=new t.MatchMsgBox,o=this,a=function(e){var i=new Cmd.DelHistoryMatchIdMatchGroupCmd_C;e&&1==e["退出包厢"]&&(i.leave=1),i.matchId=o.data.matchId,t.LobbyServerMJProxy.getInstance().sendData(i),t.NetMgr.setMsgTimeout(5,"DelHistoryMatchIdMatchGroupCmd_C")};n.setData("温馨提示","您确定要删除该历史记录吗？",["确定","取消"],[a]);var s=[{str:"退出包厢",check:0}];n.addCheck(2,s),t.LobbyPopupManager.addPopUp(n,!0,!0)}},i}(eui.ItemRenderer);t.HistroyJoinRecordItem=o,__reflect(o.prototype,"MJLobby.HistroyJoinRecordItem")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.skinName=new JoinweixinPanelSkin,t.addListener(),t}return __extends(i,e),Object.defineProperty(i,"Instance",{get:function(){return this._instance||(this._instance=new i),this._instance},enumerable:!0,configurable:!0}),i.prototype.addListener=function(){this.copyWeixin_button.addEventListener(egret.TouchEvent.TOUCH_TAP,this.copyWeixin,this),this.close_button.addEventListener(egret.TouchEvent.TOUCH_TAP,this.close,this)},i.prototype.copyWeixin=function(){uniLib.ZQGameSdk.nativeCopyStr(this.weChatNum.text),t.LobbyPopupManager.showMildWarnShow("复制成功")},i.prototype.close=function(){this.parent&&t.LobbyPopupManager.removePopUp(this,!1)},i}(eui.Component);t.JoinweixinPanel=e,__reflect(e.prototype,"MJLobby.JoinweixinPanel")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function n(t){void 0===t&&(t=0);var i=e.call(this)||this;return i.skinName=new LobbyActivitySkin,i.addEventListener(egret.Event.REMOVED_FROM_STAGE,i.onRemove,i),i.initUI(t),i}return __extends(n,e),n.prototype.initUI=function(e){void 0===e&&(e=0),this.gotoUrl=null,this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseHandel,this),this.activeList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.setCurActive,this),this.activityBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRadioBtnClick,this),this.noticeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRadioBtnClick,this),this.shareButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShare,this),this.activityBtn.selected=this.noticeBtn.selected=!1;var n=t.MJLobbyData.getInstance().popActiveData;n instanceof Array&&n.length>0?(this.activeCollection||(this.activeList.itemRenderer=i,this.activeCollection=new eui.ArrayCollection,this.activeList.dataProvider=this.activeCollection),this.activeCollection.replaceAll(n),this.activeList.selectedIndex=0,this.setCurActive(),0==e?(this.noticeBtn.selected=!1,this.activityBtn.selected=!0):(this.activityBtn.selected=!1,this.noticeBtn.selected=!0)):(this.buttonGroup.visible=!1,this.noticeBtn.selected=!0,this.activityBtn.selected=!1),0!=uniLib.Global.is_sandbox&&(this.noticeBtn.selected=!0,this.activityBtn.selected=this.buttonGroup.visible=!1),this.onRadioBtnClick()},n.prototype.addIframe=function(){if(t.PublicMethed.noticeUrl&&""!==t.PublicMethed.noticeUrl){var e=this.noticeGroup.localToGlobal(0,0);this.iframe=t.PublicMethed.addIFrame(e.x,e.y,this.noticeGroup.width,this.noticeGroup.height),this.iframe.src=t.PublicMethed.noticeUrl,this.noticeImage.visible=!1}},n.prototype.onRadioBtnClick=function(){var t=this;this.activityBtn.selected?(this.leftGroup.visible=this.rightGroup.visible=!0,this.noticeGroup.visible=!1,this.iframe&&(this.iframe.style.visibility="hidden")):this.noticeBtn.selected&&(this.leftGroup.visible=this.rightGroup.visible=!1,this.noticeGroup.visible=!0,this.iframe?this.iframe.style.visibility="":this.timer=egret.setTimeout(function(){t.addIframe()},this,50))},n.prototype.onShare=function(){var e="http://h5.publish.66yy99.cn/Mahjong.jx/shareimg/share_"+t.MJLobbyData.getInstance().lobbyId+"_"+this.curMatchId+".jpg";t.PublicMethed.DoShare(2,1,this.shareBack,this,e)},n.prototype.shareBack=function(e){e&&(0==e.code&&this.dispatchEventWith(t.LobbyUIEventConsts.SHARE_SUCCESS,!1,this.curMatchId),egret.Tween.get(this).wait(100).call(t.PublicMethed.delayShareBack,this,[e.code]))},n.prototype.onRemove=function(){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemove,this),this.closeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseHandel,this),this.activeList.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.setCurActive,this),this.activityBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRadioBtnClick,this),this.noticeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRadioBtnClick,this),this.shareButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShare,this),this.activeImg&&this.activeImg.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onImgHandel,this),egret.clearTimeout(this.timer),this.iframe&&t.PublicMethed.removeIFrame(this.iframe),this.iframe=null},n.prototype.onCloseHandel=function(){this.dispatchEventWith(egret.Event.CLOSE)},n.prototype.onImgHandel=function(){return this.gotoUrl?void uniLib.ZQGameSdk.openWeb(this.gotoUrl,uniLib.WEBMODEL.EXPLORER):0===this.curMatchId?void this.onShare():void(this.curMatchId&&this.dispatchEventWith(t.LobbyUIEventConsts.JOIN_ROOM,!1,this.curMatchId))},n.prototype.setCurActive=function(){var e=this.activeList.selectedItem;this.gotoUrl=e.url;var i=e.id,n="";(i||0===i)&&i!=this.curMatchId&&(this.curMatchId=i,n="http://h5.publish.66yy99.cn/Mahjong.jx/shareimg/news_"+t.MJLobbyData.getInstance().lobbyId+"_"+i+".jpg",this.setActiveImg(n))},n.prototype.setActiveImg=function(t){var e=this;this.activeImg||(this.activeImg=new eui.Image,this.imgGroup.addChild(this.activeImg),this.activeImg.touchEnabled=!0,this.activeImg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onImgHandel,this)),this.activeImg.bitmapData=null,this.showLoading(),RES.getResByUrl(t,function(t){t&&e.setImgData(t)},this)},n.prototype.showLoading=function(){this.loadingGroup.visible=!0,egret.Tween.removeTweens(this.loadMask),egret.Tween.get(this.loadMask,{loop:!0}).to({rotation:360},3e3)},n.prototype.hideLoading=function(){this.loadingGroup.visible=!1,egret.Tween.removeTweens(this.loadMask)},n.prototype.setImgData=function(t){this.hideLoading(),this.activeImg.bitmapData=t,this.activeImg.horizontalCenter=0,this.activeImg.verticalCenter=0,this.activeImg.height=this.imgGroup.height,this.activeImg.width=this.imgGroup.width},n}(eui.Component);t.LobbyActivity=e,__reflect(e.prototype,"MJLobby.LobbyActivity");var i=function(t){function e(){var e=t.call(this)||this;return e.skinName=new MJ_RadioButton1Skin,e.touchChildren=!1,e.touchEnabled=!0,e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.labelDisplay.text=t.name,this.labelDisplay.size=30},e}(eui.ItemRenderer);t.ActiveRadioItem=i,__reflect(i.prototype,"MJLobby.ActiveRadioItem")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.isOpen=!1,t.closeY=-460,t.skinName=new LobbyAgentSkin,t.initUI(),t.openGroup.y=t.closeY,t.height=90,t.addListener(),t}return __extends(i,e),i.prototype.onRemove=function(){this.removeListener()},i.prototype.initUI=function(){if(this.btnGroup){this.btnGroup.removeChildren();for(var e=0;5>e;e++)this.btnGroup.addChild(this["agentBtn_"+e]);this.btnGroup.addChild(this.arrowBtn);var i=t.MJLobbyData.getInstance().rechargeType;t.MJLobbyData.getInstance().lobbyId;this.btnGroup.removeChild(this.agentBtn_0),i?1==i?this.btnGroup.removeChild(this.agentBtn_4):2==i&&this.btnGroup.removeChild(this.agentBtn_1):(this.btnGroup.removeChild(this.agentBtn_1),this.btnGroup.removeChild(this.agentBtn_4)),1==t.MJLobbyData.getInstance().isAgent?this.btnGroup.removeChild(this.agentBtn_3):this.btnGroup.removeChild(this.agentBtn_2),this.openGroup.height=110*this.btnGroup.numChildren,this.closeY=-this.openGroup.height+90}},i.prototype.addListener=function(){this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemove,this),this.arrowBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.openOrClose,this);for(var t=0;5>t;t++)this["agentBtn_"+t]&&this["agentBtn_"+t].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)},i.prototype.removeListener=function(){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemove,this),this.arrowBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.openOrClose,this);for(var t=0;5>t;t++)this["agentBtn_"+t]&&this["agentBtn_"+t].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)},i.prototype.onClick=function(e){uniLib.SoundMgr.instance.playSound("buttonClick_mp3");var i=Number(e.target.name);if(i>0)uniLib.Global.getPlatToken(function(e){if(e){var n=uniLib.Global.platId,o=uniLib.Global.lobbyGameId,a=uniLib.CompressUtil.base64encode(JSON.stringify(e)),s=t.PublicMethed.agentUrl+"?code="+a+"&gameid="+o+"&state="+i+"&platid="+n;uniLib.ZQGameSdk.openWeb(s,uniLib.WEBMODEL.EXPLORER)}},this);else if(0==i){var n=uniLib.NetMgr.UID,o=t.MJLobbyData.getInstance().myBaseInfo,a=o.nickname?o.nickname:"",s="http://mab.xinkefu.net/Web/im.aspx?_=t&accountid=107685&visitorid="+n+"&visitorname="+a;t.PublicMethed.kefuUrl&&(s=t.PublicMethed.kefuUrl+n+"&visitorname="+a),uniLib.Global.isH5?window.open(s):uniLib.ZQGameSdk.openWeb(s,uniLib.WEBMODEL.EXPLORER)}},i.prototype.openOrClose=function(){uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),this.removeListener();var t=0,e=1,i=0,n=0;egret.Tween.removeTweens(this.arrowBtn),egret.Tween.removeTweens(this.openGroup),this.isOpen?(e=0,t=this.closeY,n=250,i=180):this.height=550,egret.Tween.get(this.arrowBtn).wait(n).to({rotation:i},100),egret.Tween.get(this.openGroup).to({y:t},300).call(this.onMoveEnd,this,[e])},i.prototype.onMoveEnd=function(t){1==t||(this.height=90),this.addListener(),this.isOpen=1==t?!0:!1},i}(eui.Component);t.LobbyAgentMenuPanel=e,__reflect(e.prototype,"MJLobby.LobbyAgentMenuPanel")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function n(){var i=e.call(this)||this;i.skinName=new LobbyIntegralMallSkin,t.MJLobbyData.getInstance().myBaseInfo&&t.MJLobbyData.getInstance().myBaseInfo.growth&&(i.integral.text=""+(t.MJLobbyData.getInstance().myBaseInfo.growth.shopPoint?t.MJLobbyData.getInstance().myBaseInfo.growth.shopPoint:0));var n="联系方式:"+t.DataManage.customerWeChat;return i.tips.text="实物兑换请联系客服领取,"+n,i}return __extends(n,e),n.prototype.addUIListener=function(){this.backBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.destroy,this)},n.prototype.removeUIListener=function(){this.backBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.destroy,this)},n.prototype.updateShopList=function(e){if(e instanceof Array&&!(e.length<=0)){this.shopList.itemRenderer=i;for(var n=e,o=[],a=0;a<n.length;a++){var s=n[a];2==s.moneyType&&(1!=s.number||0!=t.MJLobbyData.getInstance().isAgent)&&o.push(s)}o.distinct(),this.shopList.dataProvider=new eui.ArrayCollection(o)}},n.prototype.destroy=function(){this.dispatchEventWith(egret.Event.CLOSE),e.prototype.destroy.call(this)},n.prototype.updateUserIntegral=function(t){Number(t)>=0&&(this.integral.text=""+t)},n}(game.EuiPanel);t.LobbyIntegralMallPanel=e,__reflect(e.prototype,"MJLobby.LobbyIntegralMallPanel");var i=function(e){function i(){var t=e.call(this)||this;return t.skinName=new IntegralShopSkin,t}return __extends(i,e),i.prototype.partAdded=function(){this.buyBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onExchange,this),this.costLabel=this.buyBtn.costLabel},i.prototype.partRemoved=function(){this.buyBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onExchange,this),this.limitIcon=null,this.costLabel=null,this.data=null,this.shopIcon=null,this.shopId=null},i.prototype.onExchange=function(){var e=function(){var e=new Cmd.BuyShopPointItemLobbyCmd_C;e.lobbyId=t.MJLobbyData.getInstance().lobbyId,e.goodId=this.shopId,t.LobbyServerMJProxy.getInstance().sendData(e)},i=new t.MatchMsgBox,n="\n兑换:"+this.data.name+",所需积分:"+this.data.cost;i.setData("兑换确认",n,["确定","取消"],[e],this),t.LobbyPopupManager.addPopUp(i,!0,!0)},i.prototype.dataChanged=function(){var e=this.data;2==e.moneyType&&(this.shopId=e.id,this.costLabel.text=(e.cost?e.cost:0)+"",this.limitIcon.source=1==e.number&&t.MJLobbyData.getInstance().isAgent?"mjl_market_testicon":2==e.number?"mjl_market_limitIcon":"")},i}(eui.ItemRenderer);t.IntegralShopItem=i,__reflect(i.prototype,"MJLobby.IntegralShopItem")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.initUI(),t}return __extends(i,e),i.prototype.initUI=function(){var e="HZ_login_bg_png",i=t.LobbyResUtil.createBitmapByName(e);if(i.width=uniLib.Global.screenWidth,i.height=uniLib.Global.screenHeight,this.addChild(i),0==uniLib.Global.is_sandbox){this._weiXinLogin=new t.LobbyGameButton(["mjl_login_wx1","mjl_login_wx2"]),this._weiXinLogin.x=uniLib.Global.screenWidth/2+(290-this._weiXinLogin.width),this._weiXinLogin.y=uniLib.Global.screenHeight-220*uniLib.ScreenUtils.scaleFactor,this.addChild(this._weiXinLogin),this._weiXinLogin.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLoginHandle,this),this._phoneLogin=new t.LobbyGameButton(["mjl_login_phone1","mjl_login_phone2"]),this._phoneLogin.x=uniLib.Global.screenWidth/2-290,this._phoneLogin.y=uniLib.Global.screenHeight-220*uniLib.ScreenUtils.scaleFactor,this.addChild(this._phoneLogin),this._phoneLogin.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPhoneLoginHandle,this),this._checkBg=new t.LobbyGameButton(["mjl_login_chenkbg","mjl_login_chenkbg"]),this._checkBg.addClickArea(10),this._checkBg.x=543*t.ScreenFixedUtils.instance.scaleFactor,this._checkBg.y=uniLib.Global.screenHeight-108*uniLib.ScreenUtils.scaleFactor,this.addChild(this._checkBg),this._checkBg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCheckChange,this),this._checkIcon=t.LobbyResUtil.createBitmapByName("mjl_login_chenk",544*t.ScreenFixedUtils.instance.scaleFactor,uniLib.Global.screenHeight-108*uniLib.ScreenUtils.scaleFactor-10),this.addChild(this._checkIcon),this._checkIcon.rotation=15;var n=t.LobbyResUtil.createTextFeild(11357476,egret.HorizontalAlign.LEFT,"同意用户协议",22,603*t.ScreenFixedUtils.instance.scaleFactor,uniLib.Global.screenHeight-100*uniLib.ScreenUtils.scaleFactor,200);this.addChild(n),t.MJLobbyData.getInstance().hasXianLiao&&(this._xianliaoLogin=new t.LobbyGameButton(["mjl_loginxianbtn1","mjl_loginxianbtn2"]),this.addChild(this._xianliaoLogin),this._xianliaoLogin.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLoginHandle,this),this._weiXinLogin.x=uniLib.Global.screenWidth/2-this._weiXinLogin.width/2,this._xianliaoLogin.x=this._weiXinLogin.x+this._weiXinLogin.width+22,this._xianliaoLogin.y=uniLib.Global.screenHeight-220*uniLib.ScreenUtils.scaleFactor,this._phoneLogin.x=this._weiXinLogin.x-23-this._phoneLogin.width),("true"==uniLib.BrowersUtils.GetRequest("isexe")||uniLib.Global.isH5)&&(this._phoneLogin.x=(uniLib.Global.screenWidth-this._phoneLogin.width)/2,this._weiXinLogin.visible=!1,this._xianliaoLogin&&(this._xianliaoLogin.visible=!1))
}this._versionTxt=t.LobbyResUtil.createTextFeild(9276561,egret.HorizontalAlign.RIGHT,t.LobbyDataCache.version,20,942,615,250),this._versionTxt.x=uniLib.Global.screenWidth-this._versionTxt.width,this._versionTxt.y=uniLib.Global.screenHeight-this._versionTxt.height,this.addChild(this._versionTxt),uniLib.Global.removeEventListener(uniLib.ZqEvent.NATIVE_TO_EGERET,this.onExiteGame,this)},i.prototype.onExiteGame=function(){this.msgBox||(this.msgBox=new t.LobbyMsgBox(!1),this.msgBox.setData("","是否退出游戏?",["确定","取消"],[this.onSureBox,this.onCancel],this),this.msgBox.x=Math.round((t.LobbyDataCache.defaultWidth-this.msgBox.width)/2),this.msgBox.y=Math.round((t.LobbyDataCache.defaultHeight-this.msgBox.height)/2),this.addChild(this.msgBox))},i.prototype.onSureBox=function(){uniLib.ZQGameSdk.exit()},i.prototype.onCancel=function(){this.msgBox&&this.msgBox.parent&&this.msgBox.parent.removeChild(this.msgBox),this.msgBox=null},i.prototype.onLoginHandle=function(e){if(uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),uniLib.Global.isH5){var i=new t.MJLobbyScene;this.addChild(i)}if(this._checkIcon.visible)e.target==this._weiXinLogin?(uniLib.Utils.clearLocalStorage(),uniLib.ZQGameSdk.Login(this.onLogin,this.onLogout,this)):(uniLib.Utils.clearLocalStorage(),uniLib.ZQGameSdk.Login(this.onLogin,this.onLogout,this,311));else{var n=new t.LobbyMildAlertVC;n.setText("请同意用户协议"),this.addChild(n)}},i.prototype.onPhoneLoginHandle=function(e){if(!this._checkIcon.visible){var i=new t.LobbyMildAlertVC;return i.setText("请同意用户协议"),void this.addChild(i)}this._phoneLoginPanel||(uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),this._phoneLoginPanel=new t.PhoneLoginPanel,this._phoneLoginPanel.x=(uniLib.Global.screenWidth-this._phoneLoginPanel.width)/2,this._phoneLoginPanel.addEventListener("phone_login_succ",this.phoneLogin,this),this._phoneLoginPanel.addEventListener("phone_reset_password",this.phoneReset,this),this._phoneLoginPanel.addEventListener(t.LobbyUIEventConsts.CLOSE,this.closePhoneLogin,this),this.addChild(this._phoneLoginPanel))},i.prototype.phoneLogin=function(){this.closePhoneLogin(),uniLib.SceneMgr.instance.changeScene(t.MJLobbyScene)},i.prototype.phoneReset=function(e){this._phoneResetPanel||(this._phoneResetPanel=new t.PhoneBindPanel(e.data),this._phoneResetPanel.addEventListener(t.LobbyUIEventConsts.CLOSE,this.closePhoneReset,this),this.addChild(this._phoneResetPanel))},i.prototype.closePhoneLogin=function(){this._phoneLoginPanel&&(this._phoneLoginPanel.removeEventListener("phone_login_succ",this.phoneLogin,this),this._phoneLoginPanel.removeEventListener("phone_reset_password",this.phoneReset,this),this._phoneLoginPanel.removeEventListener(t.LobbyUIEventConsts.CLOSE,this.closePhoneLogin,this),this._phoneLoginPanel.destroy()),this._phoneLoginPanel=null},i.prototype.closePhoneReset=function(){this._phoneResetPanel&&(this._phoneResetPanel.removeEventListener(t.LobbyUIEventConsts.CLOSE,this.closePhoneReset,this),this._phoneResetPanel.destroy()),this._phoneResetPanel=null},i.prototype.onLogout=function(){},i.prototype.onLogin=function(e){if(console.error("login back"+JSON.stringify(e)),0==e.code)var i={};e.data.platid&&(i.platid=e.data.platid),e.data.payplatid&&(uniLib.Global.payPlatId=e.data.payplatid),e.data.uid&&(i.uid=e.data.uid),i.sign=e.data.session,e.data.extData&&(i.extdata=e.data.extData),t.LobbyDataCache.imei&&(i.imei=t.LobbyDataCache.imei),e.data.deviceToken&&(i.imei=e.data.deviceToken+":"+uniLib.Global.bundleId.substring(0,uniLib.Global.bundleId.indexOf("_"))),i.osname=egret.Capabilities.os,uniLib.Global.initPlatInfo(i),uniLib.SceneMgr.instance.changeScene(t.MJLobbyScene)},i.prototype.onCheckChange=function(t){uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),this._checkIcon.visible=!this._checkIcon.visible},i.prototype.destroy=function(){e.prototype.destroy.call(this),this._weiXinLogin&&(this._weiXinLogin.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onLoginHandle,this),this._weiXinLogin=null),this._xianliaoLogin&&(this._xianliaoLogin.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onLoginHandle,this),this._xianliaoLogin=null),this._phoneLogin&&(this._phoneLogin.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onLoginHandle,this),this._phoneLogin=null),this._checkBg&&(this._checkBg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCheckChange,this),this._checkBg=null),this._checkIcon=null,this._infoTxt=null,this._versionTxt=null},i}(uniLib.LobbyScene);t.LobbyLoginPanel=e,__reflect(e.prototype,"MJLobby.LobbyLoginPanel")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.skinName=new LobbyLogoutTipsSkin,t.addListener(),t}return __extends(i,e),i.prototype.addListener=function(){this.applyBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onApple,this),this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this)},i.prototype.onClose=function(){this.applyBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onApple,this),this.closeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),t.LobbyPopupManager.removePopUp(this,!1,!0)},i.prototype.onApple=function(){var e=new Cmd.DeleteAccountLobbyCmd_CS;e.uid=uniLib.NetMgr.UID,t.LobbyServerMJProxy.getInstance().sendData(e),this.onClose()},i}(eui.Component);t.LobbyLogoutTips=e,__reflect(e.prototype,"MJLobby.LobbyLogoutTips")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.skinName=new LooKVideoSkin,t.initUI(),t}return __extends(i,e),i.prototype.initUI=function(){var e=this;this.submitBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.joinVideo,this),this.cancelBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),e.dispatchEventWith(t.LobbyUIEventConsts.CLOSE)},this)},i.prototype.joinVideo=function(e){uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),""!=this.inputLabel.text&&this.dispatchEventWith(t.LobbyUIEventConsts.LOOK_RECORD_ID,!1,this.inputLabel.text)},i.prototype.destory=function(){},i}(eui.Component);t.LobbyLookVideoPanel=e,__reflect(e.prototype,"MJLobby.LobbyLookVideoPanel")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function o(){var t=e.call(this)||this;return t.skinName=new MailSkin,t.init(),t}return __extends(o,e),Object.defineProperty(o,"Instance",{get:function(){return null==this.m_Instance&&(this.m_Instance=new o),this.m_Instance},enumerable:!0,configurable:!0}),o.prototype.init=function(){this.informationList.itemRenderer=i,this.buttonImage=new eui.Image},o.prototype.addListener=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)},o.prototype.removeListener=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)},o.prototype.changeScr=function(){this.viewpoint=this.infoScroller.viewport.scrollV},o.prototype.onClick=function(e){if(e.target instanceof eui.Button&&uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),e.target==this.closeBtn)this.onClosePanel();else if(e.target==this.quickdelButton){var i=[],n=new Cmd.DeleteMailCmd_CS;if(null==this.mailList||null!=this.mailList&&this.mailList instanceof Array&&0==this.mailList.length)return void t.LobbyPopupManager.showMildWarnShow("邮件列表已为空");for(var o=0;o<this.mailList.length;o++)this.mailList[o].state==Cmd.MailInfo.State.ReadOver&&i.push(this.mailList[o].id);if(n.ids=i,i.length<=0)return;t.NetMgr.tcpSend(n)}else if(e.target==this.quickgetButton){var a=new Cmd.GetItemMailCmd_CS,s=[];if(null==this.mailList||null!=this.mailList&&this.mailList instanceof Array&&0==this.mailList.length)return void t.LobbyPopupManager.showMildWarnShow("邮件列表为空");var r=this.mailList.filter(function(t){return t.state!=Cmd.MailInfo.State.ReadOver});if(!r||null!=r&&r instanceof Array&&0==r.length)return void t.LobbyPopupManager.showMildWarnShow("暂无可领取的邮件");for(var o=0;o<this.mailList.length;o++)s.push(this.mailList[o].id);if(a.ids=s,s.length<=0)return;t.NetMgr.tcpSend(a)}else e.target==this.registerBtn&&this.showRegisterPanel()},o.prototype.showRegisterPanel=function(){t.LobbyPopupManager.addPopUp(n.Instance,!0,!0,!1),n.Instance.showRegisterInfo()},o.prototype.onClosePanel=function(){this.parent&&(this.removeListener(),t.LobbyPopupManager.removePopUp(this))},o.prototype.requestMailList=function(){var e=new Cmd.GetListMailCmd_CS;t.NetMgr.tcpSend(e)},o.prototype.updataInfor=function(t){t.length<=0?this.noticeLabel.visible=!0:this.noticeLabel.visible=!1,this.mailList=t;for(var e=!0,i=0,n=this.mailList;i<n.length;i++){var o=n[i];o.state==Cmd.MailInfo.State.UnRead&&(e=!1)}e?this.buttonImage.parent&&this.buttonImage.parent.removeChild(this.buttonImage):(this.buttonImage.source="new_main_markpoint",this.buttonImage.x=15),this.mailList.sort(function(t,e){return e.stamp-t.stamp}),this.informationList.dataProvider=new eui.ArrayCollection(this.mailList)},o.prototype.getMoney=function(t){if(t){for(var e=0;e<this.mailList.length;e++)for(var i=0,n=t.ids;i<n.length;i++){var o=n[i];o==this.mailList[e].id&&(this.mailList[e].state=Cmd.MailInfo.State.ReadOver)}this.updataInfor(this.mailList)}},o}(eui.Component);t.LobbyMailPanel=e,__reflect(e.prototype,"MJLobby.LobbyMailPanel");var i=function(i){function o(){var t=i.call(this)||this;return t.skinName=new MailItemSkin,t.addListener(),t}return __extends(o,i),o.prototype.addListener=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)},o.prototype.onClick=function(e){if(uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),this.state==Cmd.MailInfo.State.UnRead){var i=new Cmd.ReadMailCmd_CS;i.ids=[this.id],t.NetMgr.tcpSend(i),this.showMailInfo(!1)}else this.data.state==Cmd.MailInfo.State.ReadOver?this.showMailInfo(!0):this.showMailInfo(!1)},o.prototype.dataChanged=function(){var t=this.data;this._mailInfo=this.data,this.gameName.text=t.subject+"",this.money=""+t.diamond;var e=t.stamp,i=new Date;switch(i.setTime(1e3*e),this.time=i.getFullYear()+"/"+(i.getUTCMonth()+1)+"/"+i.getDate(),this.info=t.content,this.title=t.subject,this.id=t.id,this.state=t.state,this.cdKey=null!=t.cdkey?t.cdkey:null,this.state){case Cmd.MailInfo.State.ReadHasItem:this.statusImg.source="email_icon_readed",this.statusInfo.text="未领取";break;case Cmd.MailInfo.State.ReadOver:this.statusImg.source="email_icon_readed",this.statusInfo.text="已读";break;case Cmd.MailInfo.State.UnRead:this.statusImg.source="email_icon_unread",this.statusInfo.text="未读"}},o.prototype.showMailInfo=function(i){for(var o=0,a=e.Instance.mailList;o<a.length;o++){var s=a[o];s.id==this.id&&this.state==Cmd.MailInfo.State.UnRead&&(s.state=Cmd.MailInfo.State.ReadHasItem)}n.Instance.mailData=this.data,n.Instance.changeInfo(this.title,this.money,this.time,this.info,i,this.id,this.cdKey),e.Instance.updataInfor(e.Instance.mailList),t.LobbyPopupManager.addPopUp(n.Instance,!0,!0,!1),n.Instance.addListener()},o}(eui.ItemRenderer);__reflect(i.prototype,"MailItemRender");var n=function(e){function i(){var t=e.call(this)||this;return t.skinName=new MailInfoPanelSkin,t}return __extends(i,e),Object.defineProperty(i,"Instance",{get:function(){return null==this.m_Instance&&(this.m_Instance=new i),this.m_Instance},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"mailData",{get:function(){return this._mainData},set:function(t){this._mainData=t},enumerable:!0,configurable:!0}),i.prototype.changeInfo=function(t,e,i,n,o,a,s){this.mailInfo.visible=!0,this.userInfo.visible=!1,null!=s?(this._cdKey=s,this.informationLabel.text="兑奖码："+s+"\n"+n):this.informationLabel.text=n,this.titleInfo.source="email_system",this.titleLabel.text=t+"",this.moneyLabel.text=e,this.timeLabel.text=i+"",this.id=a,o?(this.getBtn.touchEnabled=!1,this.getBtn.enabled=!1):(this.getBtn.touchEnabled=!0,this.getBtn.enabled=!0)},i.prototype.showRegisterInfo=function(){this.mailInfo.visible=!1,this.userInfo.visible=!0,this.titleInfo.source="emai_player_info",this.addListener()},i.prototype.registerHandel=function(){var e=/^1\d{10}$/,i=new Cmd.RedeemItemShopPointLobbyCmd_C,n=new Cmd.DeliverAddr;if(""==this.inputPhone.text)return void t.LobbyPopupManager.showMildWarnShow("手机号不能为空！");if(!e.test(this.inputPhone.text))return void t.LobbyPopupManager.showMildWarnShow("手机号输入不正确，请重新输入!");if(""==this.inputWeChat.text)return void t.LobbyPopupManager.showMildWarnShow("微信号不能为空！ ");n.phone=this.inputPhone.text,n.wechat=this.inputWeChat.text,i.addr=n,i.cdkey=null!=this._mainData.cdkey?this.mailData.cdkey:this.inputCode.text,t.LobbyServerMJProxy.getInstance().sendData(i);var o=new Cmd.GetItemMailCmd_CS;o.ids=[this.id],t.NetMgr.tcpSend(o),this.close()},i.prototype.addListener=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)},i.prototype.removeListener=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)},i.prototype.onClick=function(e){if(e.target instanceof eui.Button&&uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),e.target==this.closeBtn)this.close();else if(e.target==this.getBtn)if(0!=this.mailData.diamond){var i=new Cmd.GetItemMailCmd_CS;i.ids=[this.id],t.NetMgr.tcpSend(i),this.close()}else this.showRegisterInfo(),this.inputCode.text=this.mailData.cdkey,this.inputCode.touchEnabled=!1,null!=this.mailData.addr&&(this.inputPhone.text=null!=this.mailData.addr.phone?this.mailData.addr.phone:"",this.inputAddress.text=null!=this.mailData.addr.addr?this.mailData.addr.addr:"",this.inputWeChat.text=null!=this.mailData.addr.wechat?this._mainData.addr.wechat:"");else e.target==this.awardButton&&this.registerHandel()},i.prototype.close=function(){this.inputPhone.text="",this.inputAddress.text="",this.inputCode.text="",this.inputWeChat.text="",this.parent&&(t.LobbyPopupManager.removePopUp(this),this.removeListener())},i}(eui.Component);__reflect(n.prototype,"MailInfoPanel")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function o(t){void 0===t&&(t=!0);var i=e.call(this)||this;return i.diamondModle=!0,i.skinName=new ShopPanelSkin,i.diamondModle=t,0!=uniLib.Global.is_sandbox&&t&&(i.shopGroup.width=1200),i.addListener(),i.initPanel(),i}return __extends(o,e),o.prototype.addListener=function(){this.closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseTap,this),this.list.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.shopItemBuyRequest,this)},o.prototype.removeListener=function(){this.closeButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseTap,this),this.list.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.shopItemBuyRequest,this)},o.prototype.onCloseTap=function(e){uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),this.dispatchEventWith(t.LobbyUIEventConsts.CLOSE)},o.prototype.shopItemBuyRequest=function(t){uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),this.itemRequest(t.item)},o.prototype.itemRequest=function(e){if(this.diamondModle){var i=o.GetShop(e.goodId),n=new Pmd.CreatePlatOrderRequestSdkPmd_C;n.roleid=Number(uniLib.NetMgr.UID),n.rolename="",n.originalmoney=i.price/100,n.ordermoney=i.price/100,n.goodid=i.shopId,n.goodnum=1,n.goodname=e.goodName,n.gooddesc=e.goodName,n.extdata=t.MJLobbyData.getInstance().lobbyId+"",n.redirecturl=uniLib.BrowersUtils.getLocationUrl(),0/0!=uniLib.Global.payPlatId||void 0!=uniLib.Global.payPlatId||0!=uniLib.Global.payPlatId?n.payplatid=uniLib.Global.payPlatId:(n.payplatid=uniLib.Global.platInfo.platid,n.payplatid=uniLib.Global.platInfo.platid==Pmd.PlatType.PlatType_Normal?Pmd.PlatType.PlatType_AiBei:uniLib.Global.platInfo.platid),uniLib.UIMgr.instance.showLoadingTimeout(LoadSecondPanel,"recharge"),t.NetMgr.tcpSend(n)}else{var a=new Cmd.RedeemGoldByDiamondLobbyCmd_C;a.num=e.giftGoods[0].goodNbr/100,t.NetMgr.tcpSend(a)}},o.prototype.initPanel=function(){if(this.diamondModle){this.title.source="buy_title2",this.list.itemRenderer=i;var t=this.goodList;this.list.dataProvider=new eui.ArrayCollection(t)}else{this.title.source="buy_title1",this.list.itemRenderer=n;var t=this.goodList;this.list.dataProvider=new eui.ArrayCollection(t)}},Object.defineProperty(o.prototype,"goodList",{get:function(){var e=(t.MJLobbyData.getInstance().lobbyConfig,RES.getRes("TableGoodsConfig_json")),i=e.filter(function(e){return e.lobbyId==t.MJLobbyData.getInstance().lobbyId});if(!this.diamondModle){var n=[{goodId:30,goodName:"100个金币",goodType:2,goodDesc:"金币",goodIcon:"buy_goldbean1",isShow:0,giftGoods:[{goodId:6,goodNbr:100}],lobbyId:t.MJLobbyData.getInstance().lobbyId},{goodId:31,goodName:"500个金币",goodType:2,goodDesc:"金币",goodIcon:"buy_goldbean2",isShow:0,giftGoods:[{goodId:6,goodNbr:500}],lobbyId:t.MJLobbyData.getInstance().lobbyId},{goodId:32,goodName:"1000个金币",goodType:2,goodDesc:"金币",goodIcon:"buy_goldbean3",isShow:0,giftGoods:[{goodId:6,goodNbr:1e3}],lobbyId:t.MJLobbyData.getInstance().lobbyId},{goodId:33,goodName:"5000个金币",goodType:2,goodDesc:"金币",goodIcon:"buy_goldbean4",isShow:0,giftGoods:[{goodId:6,goodNbr:5e3}],lobbyId:t.MJLobbyData.getInstance().lobbyId}];return n}if(0!=uniLib.Global.is_sandbox)return this.diamondModle?i.filter(function(t){return null!=o.GetShop(t.goodId)&&4==o.GetShop(t.goodId).shopType&&t.isSandbox}):a;if(t.DataManage.sandboxMarket){if(this.diamondModle)var a=[{goodId:30,goodName:uniLib.Global.is_sandbox?"5个钻石":"1个钻石",goodType:4,goodDesc:"钻石",goodIcon:"buy_diamond105",isShow:0,giftGoods:[{goodId:6,goodNbr:uniLib.Global.is_sandbox?5:1}],lobbyId:t.MJLobbyData.getInstance().lobbyId},{goodId:31,goodName:uniLib.Global.is_sandbox?"10个钻石":"2个钻石",goodType:4,goodDesc:"钻石",goodIcon:"buy_diamond106",isShow:0,giftGoods:[{goodId:6,goodNbr:uniLib.Global.is_sandbox?10:2}],lobbyId:t.MJLobbyData.getInstance().lobbyId},{goodId:32,goodName:uniLib.Global.is_sandbox?"21个钻石":"5个钻石",goodType:4,goodDesc:"钻石",goodIcon:"buy_diamond107",isShow:0,giftGoods:[{goodId:6,goodNbr:uniLib.Global.is_sandbox?21:5}],lobbyId:t.MJLobbyData.getInstance().lobbyId},{goodId:33,goodName:uniLib.Global.is_sandbox?"42个钻石":"10个钻石",goodType:4,goodDesc:"钻石",goodIcon:"buy_diamond108",isShow:0,giftGoods:[{goodId:6,goodNbr:uniLib.Global.is_sandbox?42:10}],lobbyId:t.MJLobbyData.getInstance().lobbyId}];return a}return this.diamondModle?i.filter(function(t){return null!=o.GetShop(t.goodId)&&4==o.GetShop(t.goodId).shopType&&0==t.isSandbox}):i.filter(function(t){return null!=o.GetShop(t.goodId)&&1==o.GetShop(t.goodId).shopType})},enumerable:!0,configurable:!0}),o.GetShop=function(t){var e=RES.getRes("TableShopConfig_json");return e.first(function(e){return e.goodId==t})},o}(eui.Component);t.LobbyMarketPanel=e,__reflect(e.prototype,"MJLobby.LobbyMarketPanel");var i=function(t){function i(){var e=t.call(this)||this;return e.skinName=new ShopDiamondItemSkin,e.buyBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,e.buyHandel,e),e}return __extends(i,t),i.prototype.dataChanged=function(){var t=this.data;this.numLabel.text=t.giftGoods[0].goodNbr;var i=e.GetShop(t.goodId);i&&(this.name=t.goodNbr,this.priceLabel.text=i.price/100+"",this.bgIcon.source=t.goodIcon)},i.prototype.buyHandel=function(t){},i}(eui.ItemRenderer);t.ShopItem=i,__reflect(i.prototype,"MJLobby.ShopItem");var n=function(t){function i(){var e=t.call(this)||this;return e.skinName=new GoldBeanItemSkin,e}return __extends(i,t),i.prototype.dataChanged=function(){var t=this.data;e.GetShop(t.goodId);this.numLabel.text=t.giftGoods[0].goodNbr+"",this.priceLabel.text=t.giftGoods[0].goodNbr/100+"钻",this.bgIcon.source=t.goodIcon},i}(eui.ItemRenderer);t.GoldBeanItem=n,__reflect(n.prototype,"MJLobby.GoldBeanItem")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.skinName=new LobbyNoAgentSkin,t.init(),t.addEventListener(egret.Event.ADDED_TO_STAGE,t.addListener,t),t.addEventListener(egret.Event.REMOVED_FROM_STAGE,t.removeListener,t),t}return __extends(i,e),i.prototype.init=function(){this.wxLabel.text=t.DataManage.customerWeChat},i.prototype.addListener=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)},i.prototype.removeListener=function(){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.addListener,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeListener,this),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)},i.prototype.onClick=function(e){switch(e.target){case this.closeButton:this.parent&&t.LobbyPopupManager.removePopUp(this,!1,!0);break;case this.copyButton:uniLib.ZQGameSdk.nativeCopyStr(this.wxLabel.text),1!=uniLib.Global.is_sandbox&&t.LobbyPopupManager.showMildWarnShow("复制成功"+this.wxLabel.text)}},i}(eui.Component);t.LobbyNoAgentPanel=e,__reflect(e.prototype,"MJLobby.LobbyNoAgentPanel")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.skinName=new LobbyOtherUserInfoPanelSkin,t.closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,t.closeHandle,t),t.rectPanel.addEventListener(egret.TouchEvent.TOUCH_TAP,t.closeHandle,t),t}return __extends(i,e),i.prototype.closeHandle=function(e){uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),this.closeButton&&this.closeButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.closeHandle,this),this.rectPanel&&this.rectPanel.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.closeHandle,this),uniLib.DisplayUtils.removeAllChildren(this),t.LobbyResUtil.removeFromParent(this)},i.prototype.setData=function(t){var e=t;e.headUrl&&(this.headMc.source=e.headUrl,this._nameTxt.text="昵称:"+(e.nickName?e.nickName:""),this._idTxt.text="ID:"+(e.uid?e.uid:""),"男"==e.gender?this.gender_icon.source="male_icon":"女"==e.gender&&(this.gender_icon.source="famale_icon"),this._signatureTxt.text=e.signature?e.signature:"什么都没有!",this._rankTxt.text="排名:"+(t.rank?t.rank:""))},i}(eui.Component);t.LobbyOtherUserInfoPanel=e,__reflect(e.prototype,"MJLobby.LobbyOtherUserInfoPanel")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t._pageNum=10,t.recordItemHeight=110,t.skinName=new RecordSkin,t.recordList=new Array,t.addListener(),t.initPanel(),t}return __extends(n,e),n.prototype.addListener=function(){this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onCloseTap,this),this.scanOtherBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.openRecorePanel,this),this.closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseTap,this),this.clearBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClearTap,this)},n.prototype.removeListener=function(){this.scanOtherBtn&&this.scanOtherBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.openRecorePanel,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onCloseTap,this),this.closeButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseTap,this),this.clearBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClearTap,this)},n.prototype.onClearTap=function(e){function i(){var e=new Cmd.DelPlayedDataHistoryCmd_C;t.LobbyServerMJProxy.getInstance().sendData(e)}uniLib.SoundMgr.instance.playSound("buttonClick_mp3");var n=new t.MatchMsgBox;n.setData("","是否删除全部战绩信息？",["确定","取消"],[i],this),t.LobbyPopupManager.addPopUp(n,!0,!0)},n.prototype.onCloseTap=function(e){uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),this.dispatchEventWith(t.LobbyUIEventConsts.CLOSE)},n.prototype.recordConfirmRequest=function(t){this.recordRequest(t.itemIndex)},n.prototype.recordRequest=function(e){var i=this.recordList[e];t.MJLobbyData.getInstance().globalRoomId=i.globalRoomId,this.dispatchEventWith(t.LobbyUIEventConsts.GET_HISTORY_DETAIL_DATA,!1,i.globalRoomId)},n.prototype.initPanel=function(){this._curPage=0,this._recordMc=new egret.DisplayObjectContainer,this.scrollerGroup.addChild(this._recordMc),this._scroll=t.LobbyResUtil.createScroll(this._recordMc,this.scrollerGroup.width,this.scrollerGroup.height),this._scroll.horizontalScrollPolicy="off",this._scroll.verticalScrollPolicy="on",this.scrollerGroup.addChild(this._scroll)},n.prototype.destory=function(){egret.Tween.removeTweens(this),this._scroll&&(this._scroll.removeContent(),this._scroll.removeEventListener(egret.Event.CHANGE,this.checkTop,this),this._scroll=null),this._recordMc&&(this.removeItems(),this._recordMc=null),this.recordList&&this.recordList instanceof Array&&(this.recordList.clear(),this.recordList=null),this.removeListener()},n.prototype.removeItems=function(){for(var t,e=this._recordMc.numChildren,i=0;e>i;i++)t=this._recordMc.getChildAt(0),t&&(t.touchEnabled=!1,t.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.getDetailData,this),this._recordMc.removeChild(t),t.destory())},n.prototype.getData=function(){this.dispatchEventWith(t.LobbyUIEventConsts.GET_HISTORY_DATA,!1,this._curPage)},n.prototype.checkTop=function(t){this._scroll.scrollTop>=this._scroll.getMaxScrollTop()-10&&this._curPage<this._totalPage-1&&(this._scroll.removeEventListener(egret.Event.CHANGE,this.checkTop,this),this._curPage++,this.getData(),egret.Tween.get(this).wait(2e3).call(this.addListen,this))},n.prototype.addListen=function(){this._scroll.hasEventListener(egret.Event.CHANGE)||this._scroll.addEventListener(egret.Event.CHANGE,this.checkTop,this)},n.prototype.showData=function(t){egret.Tween.removeTweens(this),this.addListen(),this._totalPage=t.maxPage,this._curPage=t.curPage-1,1!=t.curPage||t.gameHistroys[0]?this.addData(t.gameHistroys):this.showNoData(!0)},n.prototype.showNoData=function(t){this.clearBtn.visible=!1,this.scanOtherBtn.horizontalCenter=0},n.prototype.addData=function(t){if(!t||!t[0])return void this.showNoData(!0);this.clearBtn.visible||(this.clearBtn.visible=!0,this.scanOtherBtn.horizontalCenter=300);for(var e,n=0;n<t.length;n++)e=new i,e.setData(t[n],10*this._curPage+n+1),e.y=115*(10*this._curPage+n)+10,e.x=(this.scrollerGroup.width-e.width)/2,e.horizontalCenter=0,this._recordMc.addChild(e),e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.getDetailData,this)},n.prototype.getDetailData=function(e){var i=e.currentTarget;t.MJLobbyData.getInstance().globalRoomId=i.data.globalRoomId,this.dispatchEventWith(t.LobbyUIEventConsts.GET_HISTORY_DETAIL_DATA,!1,i.data.globalRoomId)},n.prototype.openRecorePanel=function(e){uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),this.dispatchEventWith(t.LobbyUIEventConsts.OPEN_LOOK_RECORDPANEL)},n}(eui.Component);t.LobbyRecordPanel=e,__reflect(e.prototype,"MJLobby.LobbyRecordPanel");var i=function(e){function i(){var t=e.call(this)||this;return t.skinName=new RecordItemSkin,t}return __extends(i,e),i.prototype.destory=function(){this.indexNum=null,this.roomNumber=null,this.time=null},i.prototype.setData=function(e,i){this._data=e,this.indexNum.text=i.toString(),this.roomNumber.text=e.roomId.toString(),this.time.text="对战时间："+t.LobbyUtils.changeTimeToStr(e.timeStamp);var o=e.userGameHistorys;o instanceof Array&&(this.userList.itemRenderer=n,this.userList.dataProvider=new eui.ArrayCollection(o))},Object.defineProperty(i.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),i}(eui.Component);t.RecordItem=i,__reflect(i.prototype,"MJLobby.RecordItem");var n=function(t){function e(){var e=t.call(this)||this;return e.skinName=new Mj_RecordUserLabelSkin,e}return __extends(e,t),e.prototype.destory=function(){this.userName=null,this.score=null},e.prototype.dataChanged=function(){var t=this.data,e=t.nickName?t.nickName:"";this.userName=e.slice(0,3),this.userNameText.TextImageData=Emoji.toCodePoint(this.userName),this.userNameText.textColor=87217,this.userNameText.size=22,this.score.text=t.integral},e}(eui.ItemRenderer);t.userItem=n,__reflect(n.prototype,"MJLobby.userItem")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.skinName=new SetPanelSkin,t.initPanel(),t}return __extends(i,e),i.prototype.destory=function(){this._exitBtn&&(this._exitBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.loginOutHandle,this),this._exitBtn=null),this._voiceBtn&&(this._voiceBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.voiceBtnClick,this),this._voiceBtn=null),this._soundBtn&&(this._soundBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.soundBtnClick,this),this._soundBtn=null),this._voiceHilder&&(this._voiceHilder.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTrackTouch,this),this._voiceHilder.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onTrackTouch,this),this._voiceHilder=null),this._soundHilder&&(this._soundHilder.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSoundTouch,this),this._soundHilder.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onSoundTouch,this),this._soundHilder=null),this._restartGameBtn&&(this._restartGameBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.restartGame,this),this._restartGameBtn=null),uniLib.Utils.setLocalStorage("soundVolume",uniLib.SoundMgr.instance.soundVolume),uniLib.Utils.setLocalStorage("musicVolume",uniLib.SoundMgr.instance.musicVolume),this.disturb1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onDisturbHandel,this),this.disturb2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onDisturbHandel,this)},i.prototype.initPanel=function(){this.closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeHandle,this);var e=t.LobbyDataCache.langObj.uiTxt.SettingPanel,i=t.LobbyResUtil.createTextFeild(165859,egret.HorizontalAlign.LEFT,e.sound,32,30,28,104);this.content.addChild(i);var n=t.LobbyResUtil.createTextFeild(165859,egret.HorizontalAlign.LEFT,e.music,32,30,128,104);this.content.addChild(n),this._exitBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.loginOutHandle,this),this._restartGameBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.restartGame,this),0!=uniLib.Global.is_sandbox&&(this._exitBtn.visible=!1,this._restartGameBtn.visible=!1,this.disturbGroup.visible=!1),this._voiceHilder=new ui.HSlide("setting_bar_bg_new","setdice",540,"setting_bar_new",new egret.Rectangle(53,1,392,13),new egret.Rectangle(17,0,42,42)),this._voiceHilder.x=100,this._voiceHilder.y=120,this._voiceHilder.updateThumbPos(527*uniLib.SoundMgr.instance.musicVolume),this._voiceHilder.minValue=0,this._voiceHilder.maxValue=100,this.content.addChild(this._voiceHilder),this._voiceHilder.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTrackTouch,this),this._voiceHilder.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onTrackTouch,this),this._soundHilder=new ui.HSlide("setting_bar_bg_new","setdice",540,"setting_bar_new",new egret.Rectangle(53,1,392,13),new egret.Rectangle(17,0,42,42)),this._soundHilder.x=100,this._soundHilder.y=20,this._soundHilder.updateThumbPos(527*uniLib.SoundMgr.instance.soundVolume),this._soundHilder.minValue=0,this._soundHilder.maxValue=100,this.content.addChild(this._soundHilder),this._soundHilder.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSoundTouch,this),this._soundHilder.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onSoundTouch,this),this._soundBtn=uniLib.DisplayUtils.createBitmapByName("setting_min_sound_sign_new"),this.content.addChild(this._soundBtn),this._soundBtn.x=660,this._soundBtn.y=10,this._voiceBtn=uniLib.DisplayUtils.createBitmapByName("setting_min_music_sign_new"),this.content.addChild(this._voiceBtn),this._voiceBtn.x=660,this._voiceBtn.y=110,this._soundBtn.touchEnabled=!0,this._voiceBtn.touchEnabled=!0,this._soundBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.soundBtnClick,this),this._voiceBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.voiceBtnClick,this),this.updateMusicVolime(),this.updateSoundVolime(),game.RoomInfo.getInstance().disturbSwitch?this.disturb1.selected=!0:this.disturb2.selected=!0,this.disturb1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onDisturbHandel,this),this.disturb2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onDisturbHandel,this)},i.prototype.restartGame=function(t){uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),uniLib.ZQGameSdk.getConfig("确定要更新游戏吗?","","确定","取消")},i.prototype.soundBtnClick=function(t){uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),0==uniLib.SoundMgr.instance.soundOpen?(uniLib.SoundMgr.instance.soundVolume=.7,uniLib.SoundMgr.instance.soundOpen=!0,this._soundBtn.texture=RES.getRes("setting_max_sound_sign_new")):(uniLib.SoundMgr.instance.soundVolume=0,uniLib.SoundMgr.instance.soundOpen=!1,this._soundBtn.texture=RES.getRes("setting_min_sound_sign_new")),this.updateSoundVolime()
},i.prototype.voiceBtnClick=function(t){uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),0==uniLib.SoundMgr.instance.musicOpen?(uniLib.SoundMgr.instance.musicVolume=.7,uniLib.SoundMgr.instance.musicOpen=!0,this._voiceBtn.texture=RES.getRes("setting_max_music_sign_new")):(uniLib.SoundMgr.instance.musicVolume=0,uniLib.SoundMgr.instance.musicOpen=!1,this._voiceBtn.texture=RES.getRes("setting_min_music_sign_new")),this.updateMusicVolime()},i.prototype.updateMusicVolime=function(){this._voiceHilder.value=100*uniLib.SoundMgr.instance.musicVolume,0==uniLib.SoundMgr.instance.musicOpen?this._voiceBtn.texture=RES.getRes("setting_min_music_sign_new"):this._voiceBtn.texture=RES.getRes("setting_max_music_sign_new"),uniLib.Utils.setLocalStorage("music_toggle",Number(uniLib.SoundMgr.instance.musicOpen)),uniLib.Utils.setLocalStorage("musicVolume",uniLib.SoundMgr.instance.musicVolume)},i.prototype.updateSoundVolime=function(){this._soundHilder.value=100*uniLib.SoundMgr.instance.soundVolume,0==uniLib.SoundMgr.instance.soundOpen?this._soundBtn.texture=RES.getRes("setting_min_sound_sign_new"):this._soundBtn.texture=RES.getRes("setting_max_sound_sign_new"),uniLib.Utils.setLocalStorage("sound_toggle",Number(uniLib.SoundMgr.instance.soundOpen)),uniLib.Utils.setLocalStorage("soundVolume",uniLib.SoundMgr.instance.soundVolume)},i.prototype.loginOutHandle=function(e){uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),this.dispatchEventWith(t.LobbyUIEventConsts.LOGIN_OUT)},i.prototype.onTrackTouch=function(t){uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),this._voiceHilder.value<0&&(this._voiceHilder.value=0),uniLib.SoundMgr.instance.musicVolume=this._voiceHilder.value/100,0==uniLib.SoundMgr.instance.musicVolume?(uniLib.SoundMgr.instance.musicOpen=!1,this._voiceBtn.texture=RES.getRes("setting_min_music_sign_new")):(uniLib.SoundMgr.instance.musicOpen=!0,this._voiceBtn.texture=RES.getRes("setting_max_music_sign_new")),uniLib.Utils.setLocalStorage("musicVolume",uniLib.SoundMgr.instance.musicVolume)},i.prototype.onSoundTouch=function(t){uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),this._soundHilder.value<0&&(this._soundHilder.value=0),uniLib.SoundMgr.instance.soundVolume=this._soundHilder.value/100,0==uniLib.SoundMgr.instance.soundVolume?(this._soundBtn.texture=RES.getRes("setting_min_sound_sign_new"),uniLib.SoundMgr.instance.soundOpen=!1):(this._soundBtn.texture=RES.getRes("setting_max_sound_sign_new"),uniLib.SoundMgr.instance.soundOpen=!0),uniLib.Utils.setLocalStorage("soundVolume",uniLib.SoundMgr.instance.soundVolume)},i.prototype.closeHandle=function(e){uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),this.dispatchEventWith(t.LobbyUIEventConsts.CLOSE)},i.prototype.onDisturbHandel=function(t){t.target==this.disturb1?game.RoomInfo.getInstance().disturbSwitch=!0:game.RoomInfo.getInstance().disturbSwitch=!1},i}(eui.Component);t.LobbySettingPanel=e,__reflect(e.prototype,"MJLobby.LobbySettingPanel")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(t){function e(e){void 0===e&&(e=[]);var i=t.call(this)||this;return i._TextImageData=e,i._verticalAlign=egret.VerticalAlign.MIDDLE,i._horizontalAlign=egret.HorizontalAlign.CENTER,i._lineSpacing=0,i.lineHeightArray=[],i.components=[],i._textColor=12368629,i.invalidate_Flag=!1,i.init(),i}return __extends(e,t),Object.defineProperty(e.prototype,"TextImageData",{get:function(){return console.error("xxxx3"),this._TextImageData},set:function(t){this._TextImageData=t,this.init()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._size},set:function(t){this._size=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t,this.invalidate()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"verticalAlign",{get:function(){return this._verticalAlign},set:function(t){this._verticalAlign=t,this.invalidate()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"horizontalAlign",{get:function(){return this._horizontalAlign},set:function(t){this._horizontalAlign=t,this.invalidate()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxWidth",{get:function(){return this._maxWidth},set:function(t){this._maxWidth=t,this.templet.width>t&&(this.width=t,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineSpacing",{get:function(){return this._lineSpacing},set:function(t){this._lineSpacing!==t&&(this._lineSpacing=t,this.invalidate())},enumerable:!0,configurable:!0}),e.prototype.validateNow=function(){this.init(),this.invalidate_Flag=!1},e.prototype.init=function(){var t=this;if(this.removeChildren(),0==this._TextImageData.length)return void(this.width=this.height=0);this.components=[],this._TextImageData.forEach(function(e){"object"==typeof e&&(t.components.push(e),e.watch||(egret.is(e,"eui.Image")&&e.once(egret.Event.COMPLETE,t.invalidate,t),eui.Watcher.watch(e,["width"],t.invalidate,t),eui.Watcher.watch(e,["height"],t.invalidate,t),e.watch=!0))});var e=this._TextImageData.map(function(t){return"string"==typeof t||egret.is(t,"eui.Label")?{text:egret.is(t,"eui.Label")?t.text:t}:{text:"樂",style:{size:t.width}}}),i=this.templet=new egret.TextField;i.size=this.size,i.lineSpacing=0,i.width=this.width,i.textFlow=e,i.height=i.height,this.height=0,this.lineHeightArray=[];var n=0,o=0;i.linesArr.forEach(function(e,i){var a=t.size;e.elements.forEach(function(e){if("樂"==e.text){var i=t.components[n++];i&&(a=Math.max(a,i.height))}}),a=t._lineSpacing+a,t.lineHeightArray.push(a);var s=0;e.elements.forEach(function(e){var i;"樂"!==e.text?(i=new egret.TextField,i.x=s,i.size=t.size,i.text=e.text,i.width=e.width,i.textColor=t._textColor,i.height=a,i.y=t.height,i.verticalAlign=t._verticalAlign,i.horizontalAlign=t._horizontalAlign,i.font="Microsoft YaHei"):(i=t.components[o++],i&&(i.x=s,i.y=t.height+(a-i.height)/2)),i&&(s+=i.width,t.addChild(i))}),t.height+=a}),this._width=this.templet.width},Object.defineProperty(e.prototype,"textColor",{get:function(){return this._textColor},set:function(t){this._textColor=t,this.invalidate()},enumerable:!0,configurable:!0}),e.prototype.invalidate=function(t){var e=this;this.invalidate_Flag||(this.invalidate_Flag=!0,this.once(egret.Event.ENTER_FRAME,function(){e.init(),e.invalidate_Flag=!1},this))},e}(eui.Group);t.TextImage=e,__reflect(e.prototype,"MJLobby.TextImage")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function i(t){var i=e.call(this)||this;return i.skinName=new LobbyUserInfoPanelSkin,i._info=t,i.initPanel(),i._info&&i.updateUIData(i._info),i}return __extends(i,e),i.prototype.destory=function(){this._headMc&&(this._headMc.destory(),this._headMc=null),this.removeLister(),this._nameTxt=null,this._idTxt=null,this._ipTxt=null,this._data=null,this._info=null},i.prototype.initPanel=function(){this.weekRadioBtn.selected=!0,this.closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeHandle,this),this.weChatBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.syncWeChat,this),this._headMc=new t.LobbyHeadMc(93,93),this._headMc.x=0,this._headMc.y=0,this.head.addChild(this._headMc),this.initLister(),this.maleBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSexChange,this),this.famaleBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSexChange,this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickHandle,this),0!=uniLib.Global.is_sandbox&&(this.weChatBtn.visible=this.logoutBtn.visible=!1)},i.prototype.clickHandle=function(e){if(e.target instanceof eui.Button&&uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),e.target==this.weekRadioBtn||e.target==this.monthRadioBtn||e.target==this.totalRadioBtn)null!=this._growthData&&this.showGrowthData(this._growthData);else if(e.target==this.logoutBtn){var i=new t.LobbyLogoutTips;t.LobbyPopupManager.addPopUp(i,!0,!0)}},i.prototype.syncWeChat=function(){var e=function(){var e=new Cmd.SyncUserWeChatInfoCmd_CS;t.LobbyServerMJProxy.getInstance().sendData(e)};t.LobbyPopupManager.showConfirmPanel("提示:点击确认可将微信头像、昵称立即同步到游戏！",["确认同步","取消"],[e],"同步微信",this,0/0,!0)},i.prototype.onSexChange=function(e){uniLib.SoundMgr.instance.playSound("buttonClick_mp3");var i=new Cmd.UserInfoModifyRequestLobyCmd_C;e.target==this.maleBtn?(i.gender="男",t.LobbyServerMJProxy.getInstance().sendData(i)):e.target==this.famaleBtn&&(i.gender="女",t.LobbyServerMJProxy.getInstance().sendData(i))},i.prototype.removeLister=function(){t.MJLobbyEventListener.getInstance().removeEventListener(t.MahJongLobbyFacadeConsts.USER_INFO_DATA,this.listenHandle,this),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickHandle,this),this.maleBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSexChange,this),this.famaleBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSexChange,this),this.closeButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.closeHandle,this),this.weChatBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.syncWeChat,this)},i.prototype.initLister=function(){t.MJLobbyEventListener.getInstance().addEventListener(t.MahJongLobbyFacadeConsts.USER_INFO_DATA,this.listenHandle,this)},i.prototype.listenHandle=function(t){this.setData(t.data)},i.prototype.updateUIData=function(e){if(e==t.MJLobbyData.getInstance().myBaseInfo.uid)this.setData(t.MJLobbyData.getInstance().myBaseInfo);else{var i=new Cmd.UserInfoGetLobbyCmd_C;i.uid=e,t.LobbyServerMJProxy.getInstance().sendData(i)}},i.prototype.closeHandle=function(e){uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),this.dispatchEventWith(t.LobbyUIEventConsts.CLOSE)},i.prototype.setData=function(t){this._headMc.headUrl=t.headUrl,this._nameTxt.text=t.nickName,this._idTxt.text="ID："+t.uid,this._ipTxt.text="IP："+t.ip,this.maleBtn.selected="男"==t.gender,this.famaleBtn.selected="女"==t.gender,this._data=t,0!=uniLib.Global.is_sandbox&&(this._ipTxt.visible=this._idTxt.visible=!1)},i.prototype.showGrowthData=function(t){return null==t?(this.inningLabel_1.text="无",this.inningLabel_2.text="无",this.inningLabel_3.text="无",this.rateLabel_1.text="无",this.rateLabel_2.text="无",void(this.rateLabel_3.text="无")):(this._growthData=t,this.weekRadioBtn.selected?(this.inningLabel_1.text=null!=t.playNumWeek?t.playNumWeek+"":"无",this.inningLabel_2.text=null!=t.winNumWeek?t.winNumWeek+"":"无",this.inningLabel_3.text=null!=t.bigWinNumWeek?t.bigWinNumWeek+"":"无",this.rateLabel_1.text=null!=t.playOrderWeek?t.playOrderWeek+"":"无",this.rateLabel_2.text=null!=t.winOrderWeek?t.winOrderWeek+"":"无",this.rateLabel_3.text=null!=t.bigWinOrderWeek?t.bigWinOrderWeek+"":"无"):this.monthRadioBtn.selected?(this.inningLabel_1.text=null!=t.playNumMon?t.playNumMon+"":"无",this.inningLabel_2.text=null!=t.winNumMon?t.winNumMon+"":"无",this.inningLabel_3.text=null!=t.bigWinNumMon?t.bigWinNumMon+"":"无",this.rateLabel_1.text=null!=t.playOrderMon?t.playOrderMon+"":"无",this.rateLabel_2.text=null!=t.winOrderMon?t.winOrderMon+"":"无",this.rateLabel_3.text=null!=t.bigWinOrderMon?t.bigWinOrderMon+"":"无"):(this.inningLabel_1.text=null!=t.playNumAll?t.playNumAll+"":"无",this.inningLabel_2.text=null!=t.winNumAll?t.winNumAll+"":"无",this.inningLabel_3.text=null!=t.bigWinNumAll?t.bigWinNumAll+"":"无",this.rateLabel_1.text=null!=t.playOrderAll?t.playOrderAll+"":"无",this.rateLabel_2.text=null!=t.winOrderAll?t.winOrderAll+"":"无",this.rateLabel_3.text=null!=t.bigWinOrderAll?t.bigWinOrderAll+"":"无"),this.rateLabel.text=null!=t.winRate?t.winRate+"%":"无",void(t.winRate<50?this.rateLabel.textColor=14108700:this.rateLabel.textColor=4424192))},i}(eui.Component);t.LobbyUserInfoPanel=e,__reflect(e.prototype,"MJLobby.LobbyUserInfoPanel")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.isStart=!1,t.startSpeed=90,t.maxAngleSpeed=360,t.minAngleSpeed=30,t.addSpeed=90,t.itemRotation=36,t.skinName=new LuckPoorPanelSkin,t.init(),t.dailyTaskGroup.cacheAsBitmap=!0,t}return __extends(n,e),Object.defineProperty(n,"Instance",{get:function(){return this._instance||(this._instance=new n),this._instance},enumerable:!0,configurable:!0}),n.clearInstance=function(){this._instance=null},n.prototype.init=function(){this.addListener(),this.iconGroup.touchChildren=!1,this.iconGroup.visible=!0,this.iconGroup.touchEnabled=!0,egret.Tween.removeTweens(this.activityBgImage);var e=this;setTimeout(function(){egret.Tween.get(e.activityBgImage,{loop:!0}).to({alpha:.2},500).to({alpha:1},500)},200),this.dailyTaskList.itemRenderer=t.DailyTaskItem,this.dailyTaskListArr=new eui.ArrayCollection,this.dailyTaskList.dataProvider=this.dailyTaskListArr,this.showTips(),this.isClickEffect(!0)},n.prototype.showTips=function(){},Object.defineProperty(n.prototype,"isShow",{get:function(){return this.luckyGroup.visible},enumerable:!0,configurable:!0}),n.prototype.isClickEffect=function(t){t?this.dailyTaslRect.parent&&(this.dailyTaslRect.parent.removeChild(this.dailyTaslRect),this.dailyTaskGroup.touchChildren=!0,this.startButton.touchEnabled=!0):this.dailyTaslRect.parent||(this.dailyTaskGroup.addChild(this.dailyTaslRect),this.dailyTaskGroup.touchChildren=!1,this.startButton.touchEnabled=!1)},n.prototype.addListener=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)},n.prototype.removeListener=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)},n.prototype.updateUserIntegral=function(t){Number(t)>=0&&(this.luckCountLabel.text=""+t)},n.prototype.setLuckPanelVisible=function(e){if(e){var i=new Cmd.ShopPointListLobbyCmd_C;i.lobbyId=t.MJLobbyData.getInstance().lobbyId,t.LobbyServerMJProxy.getInstance().sendData(i);var n=new Cmd.RequestDailyTaskLobbyCmd_C;t.LobbyServerMJProxy.getInstance().sendData(n),t.MJLobbyData.getInstance().myBaseInfo&&t.MJLobbyData.getInstance().myBaseInfo.growth&&(this.luckCountLabel.text=""+(t.MJLobbyData.getInstance().myBaseInfo.growth.shopPoint?t.MJLobbyData.getInstance().myBaseInfo.growth.shopPoint:0))}else this.rotateGroup.rotation=0;this.luckyGroup.visible=e},n.prototype.setIconPos=function(t,e){this.iconGroup.x=t,this.iconGroup.y=e},n.prototype.setInviteData=function(t){this.inviteData=t},n.prototype.onRemove=function(){e.prototype.onRemove.call(this),egret.Tween.removeTweens(this.activityBgImage),this.removeListener(),this.parent&&uniLib.DisplayUtils.removeFromParent(this),n._instance=null},n.prototype.initShopData=function(){this.rotateGroup.anchorOffsetX=this.rotateGroup.width/2,this.rotateGroup.anchorOffsetY=this.rotateGroup.height/2,this.rotateGroup.rotation=0,this.itemArr=[];for(var t=0;t<this.ShopItemList.length;t++){var e=new i;e.data=this.ShopItemList[t],e.x=268.5,e.y=268.5,e.anchorOffsetX=82.5,e.anchorOffsetY=250,e.rotation=t*this.itemRotation+18,this.rotateGroup.addChild(e),this.itemArr.push(e)}this.lastSelectItem=this.itemArr[0]},n.prototype.onClick=function(t){t.target instanceof eui.Button&&uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),t.target==this.startButton?this.reqJackpotResult():t.target==this.closeButton?this.setLuckPanelVisible(!1):t.target==this.iconGroup&&(uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),this.setLuckPanelVisible(!0))},n.prototype.updateJackpotData=function(t){t&&(this.ShopItemList=t.list instanceof Array?t.list.filter(function(t){return 2!=t.moneyType}):[],this.itemCount=this.ShopItemList.length,this.initShopData())},n.prototype.updateDailyTaskData=function(e,i){e=e instanceof Array?e:[],this.updateUserIntegral(i),i>=0&&t.MJLobbyData.getInstance().myBaseInfo&&(t.MJLobbyData.getInstance().myBaseInfo.growth||(t.MJLobbyData.getInstance().myBaseInfo.growth=new Cmd.GrowthAttr),t.MJLobbyData.getInstance().myBaseInfo.growth.shopPoint=i);for(var n=[],o=function(t){if("number"!=typeof t.id)return"continue";var e=n.first(function(e){return e.id==t.id});e&&n.remove(e),n.push(t)},a=0,s=e;a<s.length;a++){var r=s[a];o(r)}this.dailyTaskListArr.replaceAll(n)},n.prototype.reqJackpotResult=function(){var e=new Cmd.LuckShopPointItemLobbyCmd_CS;e.lobbyId=t.MJLobbyData.getInstance().lobbyId,e.luckyType=2,t.LobbyServerMJProxy.getInstance().sendData(e)},n.prototype.setJackpotResult=function(t){t&&t.goodId&&this.startTurnning(t.goodId)},n.prototype.getGoodIndexByGoodId=function(t){for(var e=0;e<this.itemArr.length;e++){var i=this.itemArr[e];if(i&&i.goodId==t)return e}return 0/0},n.prototype.getGoodNameByGoodId=function(t){for(var e=0;e<this.itemArr.length;e++){var i=this.itemArr[e];if(i&&i.goodId==t)return i.nameLabel.text}return""},n.prototype.getGoodByGoodId=function(t){for(var e=0;e<this.itemArr.length;e++){var i=this.itemArr[e];if(i&&i.goodId==t)return i}return null},n.prototype.startTurnning=function(t){if(!this.isStart){this.isClickEffect(!1),this.isStart=!0,this.endIndex=this.getGoodIndexByGoodId(t);var e=Math.randomInteger(5,8),i=360*e+this.endIndex*(360/this.itemArr.length)+18;+Math.randomFloat(-8,8),egret.Tween.removeTweens(this.rotateGroup);var n=1e3*Math.randomFloat(5,8);egret.Tween.get(this.rotateGroup).to({rotation:-i},n,egret.Ease.sineInOut).wait(500).call(this.stopTurnning,this,[t]),console.log("endIndex:________________________________"+this.endIndex)}},n.prototype.stopTurnning=function(e){if(this.isStart){this.isStart=!1,this.isClickEffect(!0);var i=new t.MatchMsgBox,n=this.getGoodByGoodId(e),o="温馨提示",a="恭喜您抽中"+this.getGoodNameByGoodId(e),s="领奖";5==n.rewardType?(a="再接再厉!",o="",s="确定"):3==n.rewardType&&(a+="，请在邮件里领取。",s="前往邮箱"),i.setData(o,a,[s],[function(){"前往邮箱"==s&&(t.LobbyMailPanel.Instance.addListener(),t.LobbyMailPanel.Instance.updataInfor(t.Mail.Instance.mailList),t.LobbyPopupManager.addPopUp(t.LobbyMailPanel.Instance,!0,!0))}]),t.LobbyPopupManager.addPopUp(i,!0,!0);var r=new Cmd.GetLuckShopReusltLobbyCmd_C;r.lobbyId=t.MJLobbyData.getInstance().lobbyId,t.LobbyServerMJProxy.getInstance().sendData(r)}},Object.defineProperty(n.prototype,"lastSelectItem",{get:function(){return this._lastSelectItem},set:function(t){t&&(this._lastSelectItem&&(this._lastSelectItem.selected=!1),t.selected=!0,this._lastSelectItem=t)},enumerable:!0,configurable:!0}),n.prototype.checkSelectItem=function(){var t=this.rotateGroup.rotation+this.itemRotation;t=(this.itemCount-Math.floor((this.rotateGroup.rotation+this.itemRotation)/this.itemRotation))%this.itemCount,this.lastSelectItem!=this.itemArr[t]&&(this.lastSelectItem=this.itemArr[t])},n.prototype.turnFrame=function(){var e=egret.getTimer(),i=e-this.lastTime;this.lastTime=e;var n=this.angleSpeed*i/1e3;if(this.rotateGroup.rotation+=n,this.turnState==o.SpeedUp)this.angleSpeed+=this.addSpeed*i/1e3,this.angleSpeed>this.maxAngleSpeed&&(this.turnState=o.Uniform,this.angleSpeed=this.maxAngleSpeed);else if(this.turnState==o.Uniform){if(this.uniformTime+=i/1e3,this.uniformTime>this.maxUniformTime){this.turnState=o.SpeedDown;var a=3+Math.floor(2*Math.random());this.MaxReduceRotation=360*a-(this.endIndex+1)*this.itemRotation-this.rotateGroup.rotation,this.reduceSpeed=(Math.pow(this.maxAngleSpeed,2)-Math.pow(this.minAngleSpeed,2))/(2*(360*a-(this.endIndex+1)*this.itemRotation-this.rotateGroup.rotation))}}else this.turnState==o.SpeedDown?(this.reduceRotation+=n,this.angleSpeed<this.minAngleSpeed?this.angleSpeed=this.minAngleSpeed:this.angleSpeed>this.minAngleSpeed&&(this.angleSpeed-=this.reduceSpeed*i/1e3),this.reduceRotation>=this.MaxReduceRotation&&(this.MaxReduceRotation=this.itemRotation+2+Math.floor(Math.random()*(this.itemRotation-4)),this.reduceSpeed=Math.pow(this.angleSpeed,2)/(2*this.MaxReduceRotation),this.turnState=o.Stopping,this.reduceRotation=0)):this.turnState==o.Stopping&&(this.reduceRotation+=n,this.reduceRotation>this.MaxReduceRotation&&(this.angleSpeed=0),this.angleSpeed>0&&(this.angleSpeed-=this.reduceSpeed*i/1e3),this.angleSpeed<=0&&t.LobbyPopupManager.showMildWarnShow("恭喜您抽中物品"+this.endIndex));this.rotateGroup.rotation>360&&(this.rotateGroup.rotation%=360),this.checkSelectItem()},n}(t.BaseComponent);t.LuckPoorPanel=e,__reflect(e.prototype,"MJLobby.LuckPoorPanel");var i=function(t){function e(){var e=t.call(this)||this;return e.skinName=new LobbyDrawItemSkin,e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.nameLabel.text=t.name,this.goodId=t.id?t.id:0,this.rewardType=t.rewardType,t.iconUrl?(this.goodsIcon.visible=!0,this.goodsIcon.source="http://h5.publish.66yy99.cn/Mahjong.jx/shareimg/shopItem/"+t.iconUrl,this.nameLabel.visible=!1):t.icon?(this.goodsIcon.visible=!0,this.goodsIcon.source="drawItem_"+t.icon,this.nameLabel.visible=!1):(this.goodsIcon.visible=!1,this.nameLabel.visible=!0,this.goodsIcon.source="")},Object.defineProperty(e.prototype,"selected",{set:function(t){},enumerable:!0,configurable:!0}),e}(eui.ItemRenderer);t.LobbyDrawItem=i,__reflect(i.prototype,"MJLobby.LobbyDrawItem");var n=function(i){function n(){var t=i.call(this)||this;return t.skinName=new DailyTaskItemSkin,t.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onTouchTap,t),t.addEventListener(egret.Event.REMOVED_FROM_STAGE,t.onRemoveStage,t),t}return __extends(n,i),n.prototype.dataChanged=function(){var t=this.data,e=RES.getRes("TableQuestConfig_json");if(e instanceof Array){var i=e.first(function(e){return e.id===t.id});if(i){this._quest=i,this.titleLabel.text=this.itemIndex+1+". "+i.taskName;var n="number"!=typeof t.state?0:t.state;n=n>i.finishNum?i.finishNum:n;var o=0===i.finishNum?0:n/i.finishNum;this.noProgressBarImage.width=this.progressBarImage.width*o,this.completeNumLabel.text=n+" / "+i.finishNum,n===i.finishNum?(this.leaveForButton.image.source="mjl_luck_finish",this.leaveForButton.touchEnabled=!1):(this.leaveForButton.image.source="mjl_luck_daily_leave_for",this.leaveForButton.touchEnabled=!0)}}},n.prototype.onRemoveStage=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveStage,this)},n.prototype.onTouchTap=function(i){switch(i.target){case this.leaveForButton:if(!this._quest)return;var n=this._quest.tasktype;14===n?(e.Instance.setLuckPanelVisible(!1),e.Instance.dispatchEventWith(t.LobbyUIEventConsts.SHOW_SHARE)):n>=1&&4>=n||n>=10&&11>=n||13===n||18==n?(e.Instance.setLuckPanelVisible(!1),e.Instance.dispatchEventWith(t.LobbyUIEventConsts.SHOW_CREATE_PANEL)):15===n?(e.Instance.setLuckPanelVisible(!1),e.Instance.dispatchEventWith(t.LobbyUIEventConsts.SHOW_VIP)):16===n?(e.Instance.setLuckPanelVisible(!1),e.Instance.dispatchEventWith(t.LobbyUIEventConsts.CERTIFICATION_CLICK)):(5===n||12===n)&&(e.Instance.setLuckPanelVisible(!1),e.Instance.dispatchEventWith(t.LobbyUIEventConsts.SHOW_JOIN_PANEL))}},n}(eui.ItemRenderer);t.DailyTaskItem=n,__reflect(n.prototype,"MJLobby.DailyTaskItem");var o;!function(t){t[t.SpeedUp=0]="SpeedUp",t[t.Uniform=1]="Uniform",t[t.SpeedDown=2]="SpeedDown",t[t.Stopping=3]="Stopping"}(o=t.TurnState||(t.TurnState={}))}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.skinName=new LobbyMenuDownSkin,t.touchEnabled=!0,t.touchChildren=!0,t.initUI(),t.addListener(),t}return __extends(i,e),i.prototype.addListener=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onMenuHandle,this)},i.prototype.removeListener=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onMenuHandle,this)},i.prototype.destory=function(){this.removeListener()},i.prototype.initUI=function(){this.refreshFastJoin(),0!=uniLib.Global.is_sandbox&&(this.fastJoinBtn.visible=this.shopButton.visible=!1,this.matchBtn.parent&&uniLib.DisplayUtils.removeFromParent(this.matchBtn),this.roomButton.parent&&uniLib.DisplayUtils.removeFromParent(this.roomButton))},i.prototype.refreshFastJoin=function(){var e=t.MJLobbyData.getInstance().lastRoomId;e?(this.fastJoinBtn.currentState="up",this.fastJoinBtn.labelDisplay.text=e+""):this.fastJoinBtn.currentState="disabled"},i.prototype.fastJoin=function(){var e=t.MJLobbyData.getInstance().lastRoomId;if(!e)return void t.LobbyPopupManager.showMildWarnShow("没有最近加入房间!");var i=new Cmd.EnterRoomCmd_C;i.roomId=e,t.LobbyServerMJProxy.getInstance().sendData(i)},i.prototype.onMenuHandle=function(e){e.target instanceof eui.Button&&uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),e.target==this.recordButton?this.dispatchEventWith(t.LobbyUIEventConsts.SHOW_RECORD):e.target==this.shopButton?this.onShowMarket():e.target==this.matchBtn?this.dispatchEventWith(t.LobbyUIEventConsts.ROOM_MANAGE):e.target==this.roomButton?this.dispatchEventWith(t.LobbyUIEventConsts.ACTIVE_LIST_ROOM):e.target==this.ruleButton?this.dispatchEventWith(t.LobbyUIEventConsts.SHOW_HELP):e.target==this.setButton?this.dispatchEventWith(t.LobbyUIEventConsts.SHOW_SETTING):e.target==this.fastJoinBtn&&this.fastJoin()},i.prototype.onShowMarket=function(){var e=t.PublicMethed.shopLink;e&&uniLib.ZQGameSdk.openWeb(e,uniLib.WEBMODEL.EXPLORER)},i}(t.BaseComponent);t.MJLobbyMenuDownVc=e,__reflect(e.prototype,"MJLobby.MJLobbyMenuDownVc")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function i(){return e.call(this)||this}return __extends(i,e),i.prototype.initUI=function(){this._labelBg=t.LobbyResUtil.createBitmapByName("mjl_create_match_inputBg",30,1),this.addChild(this._labelBg),this._labelBg.width=160,this._addBtn=new t.LobbyGameButton(["jia","jia"],"",!1),this._addBtn.x=164,this.addChild(this._addBtn),this._reduceBtn=new t.LobbyGameButton(["jian","jian"],"",!1),this.addChild(this._reduceBtn),this._labelTxt=t.LobbyResUtil.createTextFeild(16777215,egret.HorizontalAlign.CENTER,"",24,50,15,116),this._labelTxt.height=40,this.addChild(this._labelTxt),this._addBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onAdd,this),this._reduceBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onReduce,this),this._addBtn.addClickArea(6),this._reduceBtn.addClickArea(6)},Object.defineProperty(i.prototype,"label",{set:function(e){this._titleTxt?this._titleTxt.text=e:(this._titleTxt=t.LobbyResUtil.createTextFeild(1206199,egret.HorizontalAlign.RIGHT,e,20,-168,12,153),this.addChild(this._titleTxt))},enumerable:!0,configurable:!0}),i.prototype.setWidth=function(t){this._labelTxt.width=this._labelBg.width=t-this._addBtn.width-this._reduceBtn.width,this._addBtn.x=this._labelBg.x+this._labelBg.width},i.prototype.onAdd=function(e){RES.hasRes("buttonClick_mp3")&&uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),this._curIndex>=this._data.length-1?this._curIndex=0:this._curIndex++,this.showLabel(),this.dispatchEventWith(t.LobbyUIEventConsts.CHANGE,!1,this.value)},i.prototype.onReduce=function(e){RES.hasRes("buttonClick_mp3")&&uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),this._curIndex<=0?this._curIndex=this._data.length-1:this._curIndex--,this.showLabel(),this.dispatchEventWith(t.LobbyUIEventConsts.CHANGE,!1,this.value)},i.prototype.setData=function(t,e){if(void 0===e&&(e=null),this._data=t,e)for(var i=0;i<t.length;i++)if(t[i].value==e)return this._curIndex=i,void this.showLabel();this._curIndex=0,this.showLabel()},i.prototype.showLabel=function(){this._labelTxt.text=this._data[this._curIndex].label},Object.defineProperty(i.prototype,"value",{get:function(){return this._data[this._curIndex].value},enumerable:!0,configurable:!0}),i.prototype.destory=function(){e.prototype.destory.call(this)},i}(t.LobbyBaseVc);t.List=e,__reflect(e.prototype,"MJLobby.List")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function n(){var i=e.call(this)||this;return i.skinName=new MultiplayerMatchSkin,i.closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,i.onCloseTap,i),i.promoteBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,i.reqPromoteReward,i),i.signOutButton.addEventListener(egret.TouchEvent.TOUCH_TAP,i.exitMatch,i),i.shareButton.addEventListener(egret.TouchEvent.TOUCH_TAP,i.onShareTap,i),i.inviteButton.addEventListener(egret.TouchEvent.TOUCH_TAP,i.onInviteTap,i),i.updataWaitList(null),i.promotionLabelVisible(!1),i.curMatchRound.visible=!1,t.MJLobbyData.getInstance().fundType||(i.fundNum.visible=!1),1003==t.MJLobbyData.getInstance().lobbyId&&(i.promoteBtn.visible=!1),i}return __extends(n,e),n.prototype.destory=function(){this.closeButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseTap,this),this.promoteBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.reqPromoteReward,this),this.signOutButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.exitMatch,this),this.shareButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShareTap,this),this.inviteButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onInviteTap,this),egret.clearInterval(this.timer)},n.prototype.reqPromoteReward=function(){var e="";e=this.curUserNum+"缺"+(this.maxUserNum-this.curUserNum),this.dispatchEventWith("show_promote",!1,{matchId:this.matchId,matchName:this.matchName,wechat:this.wechat,extenStr:e,shareInfo:this.shareInfo});var i=new Cmd.TaxRewardMatchRoomCmd_C;i.matchId=this.codeId,t.LobbyServerMJProxy.getInstance().sendData(i),t.NetMgr.setMsgTimeout(5,"TaxRewardMatchRoomCmd_C")},n.prototype.updataWaitList=function(t){t=t&&t instanceof Array?t:[],this.waitList.itemRenderer=i,this.waitList.dataProvider=new eui.ArrayCollection(t)},n.prototype.promotionLabelVisible=function(t){this.promotionLabel.visible=t},n.prototype.setMemberNum=function(t,e){t&&e&&(this.curUserNum=t,this.maxUserNum=e,this.curMatchLabel.text="当前房间人数 "+t+"/"+e)},n.prototype.showMatchId=function(t){t&&(this.matchIdLabel.text="匹配号："+t,this.matchId=t)},n.prototype.showNickName=function(t){t&&(this.ownerLabel.text="房主名："+t)},n.prototype.updataLeftLabel=function(t){this.leftTimeLabel.text=t},n.prototype.showTime=function(t){var e=this;return null==t||t&&1>t?(egret.clearInterval(this.timer),void this.updataLeftLabel("")):(this.updataLeftLabel("游戏于"+t+"s后开始"),egret.clearInterval(this.timer),void(this.timer=egret.setInterval(function(){t--,e.updataLeftLabel("游戏于"+t+"s后开始"),1>t&&(egret.clearInterval(e.timer),e.updataLeftLabel("游戏开始"))},this,1e3)))},n.prototype.onCloseTap=function(){uniLib.SoundMgr.instance.playSound("buttonClick_mp3");var e=this,i=new t.MatchMsgBox,n=function(){e.leaveMatch&&e.leaveMatch()};i.setData("温馨提示","关闭界面您将退出匹配，确定要退出吗？",["确定","取消"],[n]),t.LobbyPopupManager.addPopUp(i,!0,!0)},n.prototype.exitMatch=function(e){uniLib.SoundMgr.instance.playSound("buttonClick_mp3");var i=this,n=new t.MatchMsgBox,o=function(){i.leaveMatch&&i.leaveMatch()};n.setData("温馨提示","您确定要退出匹配吗？",["确定","取消"],[o]),t.LobbyPopupManager.addPopUp(n,!0,!0)},n.prototype.onInviteTap=function(){var e=new Cmd.RecentVisitListMatchGroupCmd_C;e.matchId=this.matchId,t.LobbyServerMJProxy.getInstance().sendData(e),t.LobbyPopupManager.addPopUp(t.AudienceListPanel.instace,!0,!0),t.AudienceListPanel.instace.shareInfo=this.shareInfo;var i="",n=this.shareInfo.title.indexOf("<"),o=this.shareInfo.title.indexOf(">");i=this.shareInfo.title,i=i.slice(n+1,o),t.AudienceListPanel.instace.gameName=i,t.AudienceListPanel.instace.userNbrStr=this.curUserNum+"缺"+(this.maxUserNum-this.curUserNum)},n.prototype.onShareTap=function(){uniLib.SoundMgr.instance.playSound("buttonClick_mp3");var e=new uniLib.WXShareVo;if(e.shareWay=0,""==uniLib.ZQGameSdk.defaultWXShareVo.webpageUrl&&t.LobbyDataCache.bundleInfo&&t.LobbyDataCache.bundleInfo.weixin.wbappid){var i=t.MJLobbyData.getInstance().myBaseInfo.nickName;i.length>8&&(i=i.slice(0,8)),e.webpageUrl="https://open.weixin.qq.com/connect/oauth2/authorize?appid="+t.LobbyDataCache.bundleInfo.weixin.wbappid+"&redirect_uri=http://"+t.PublicMethed.wxShareUrl+"/addons/zqgame/gameshare.php?appid="+t.LobbyDataCache.bundleInfo.weixin.wbappid+"&response_type=code&scope=snsapi_base&state="+uniLib.CompressUtil.base64encode(t.MJLobbyData.getInstance().myBaseInfo.uid+"|"+this.codeId+"|"+i)+"&connect_redirect=1#wechat_redirect"}else e.webpageUrl=uniLib.ZQGameSdk.defaultWXShareVo.webpageUrl+"?uid="+t.MJLobbyData.getInstance().myBaseInfo.uid+"&nickName="+t.MJLobbyData.getInstance().myBaseInfo.nickName;e.title=this.shareInfo&&this.shareInfo.title?this.shareInfo.title.replace("房号","匹配号"):"";var n="";n=this.curUserNum+"缺"+(this.maxUserNum-this.curUserNum),e.description=this.shareInfo&&this.shareInfo.content?this.shareInfo.content.replace("房号","匹配号")+n:"",t.MJLobbyData.getInstance().hasXianLiao?(e.roomId=JSON.stringify({matchId:this.codeId}),uniLib.Global.dispatchEvent(uniLib.ZqEvent.SHARE,e,!0)):uniLib.ZQGameSdk.share(e,null,this)
},n.prototype.refre=function(t){this.promotionLabelVisible(!1),t&&(this.codeId=t.matchId,this.showMatchId(t.matchId),this.setMemberNum(t.curNum,t.maxNum),this.showTime(t.leftTime),this.describeLabel.text="该房间开启防作弊模式，满"+t.maxNum+"人后立即开启，随机分配牌桌",this.updataWaitList(t.list))},n.prototype.enterMatchGroup=function(e){if(e){this.fundNum.text=e.matchPoint?"当前基金："+e.matchPoint:"",this.codeId=e.matchId,this.shareInfo=e.shareInfo,this.showNickName(e.ownername),this.matchName=e.matchName,this.wechat=e.wechat,this.showMatchId(e.matchId),this.updataWaitList(e.list),this.describeLabel.text="",this.curMatchLabel.text="";var i=null!=e.lastStartSec&&0!=e.lastStartSec?e.lastStartSec:0;0!=i&&(this.lastSecLabel.text="上一局已开局时间"+i+"秒",this.showAlreadyStartTime(i)),e.curGameNbr&&e.gameNbr?(this.totaoRound=e.gameNbr,this.curMatchRound.visible=!0,this.curMatchLabel.visible=!1,this.curMatchRound.text="上一房间已进行"+e.curGameNbr+"/"+e.gameNbr+"局"):(this.curMatchRound.visible=!1,this.curMatchLabel.visible=!0),-1!=this.shareInfo.content.indexOf("GPS防作弊")&&t.DataManage.getLocation()}},n.prototype.showAlreadyStartTime=function(t){var e=this;this._startTimer&&this._startTimer.stop(),this._startTimer=uniLib.SetUniTimerTimeout(this,function(){t++,e.lastSecLabel.text="上一局已开局时间"+t+"秒"},1e3,!1,this)},n.prototype.removeStartTimer=function(){this._startTimer&&(this._startTimer.stop(),this._startTimer=null)},n.prototype.refreshCurMatchRound=function(t){this.curMatchRound.visible=!0,this.curMatchLabel.visible=!1,this.curMatchRound.text="上一房间已进行"+t+"/"+this.totaoRound+"局"},n}(eui.Component);t.MultiplayerMatchPanel=e,__reflect(e.prototype,"MJLobby.MultiplayerMatchPanel");var i=function(e){function i(){var t=e.call(this)||this;return t.skinName=new MatchWaitMemberItemSkin,t}return __extends(i,e),i.prototype.dataChanged=function(){var e=this.data;this.rankingLabel.text=this.itemIndex+1+"",this.nameLabel.text=e.nickname,this.stateLabel.text=t.DataManage.StateToString(e.state),e.type?1==e.type?this.identityLabel.text="白名单":2==e.type?this.identityLabel.text="黑名单":4==e.type&&(this.identityLabel.text="副群主"):this.identityLabel.text="游客"},i}(eui.ItemRenderer);t.MatchWaitMemberItem=i,__reflect(i.prototype,"MJLobby.MatchWaitMemberItem")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function i(t){var i=e.call(this)||this;return i.startCount=60,i.isCpatcha=!1,i._type=t,i.skinName=new BindPhonePanelSkin,i.init(),i}return __extends(i,e),i.prototype.operateRecRefresh=function(){t.MJLobbyData.getInstance().myBaseInfo.phonenumber&&(this.phoneNum.text=t.MJLobbyData.getInstance().myBaseInfo.phonenumber+"",this.phoneNum.enabled=!1,this.tipsTxt.text="已绑定手机号"+t.MJLobbyData.getInstance().myBaseInfo.phonenumber+",不能重复绑定",this.submitBtn.visible=!1,this.yesButton.visible=!1,this.changeButton.visible=!1,this.registeredBtn.visible=!1)},i.prototype.init=function(){this.isCpatcha=!1,this.tipsTxt.text="绑定手机后可用手机号+密码登录本账号",this.pswTxt.inputType=egret.TextFieldInputType.PASSWORD,this.pswTxt.displayAsPassword=!0,this.pswAgainTxt.inputType=egret.TextFieldInputType.PASSWORD,this.pswAgainTxt.displayAsPassword=!0,this.phoneNum.inputType=egret.TextFieldInputType.TEL,this.keyNum.inputType=egret.TextFieldInputType.TEL,this.closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeHandel,this),this.getKeyBtn&&this.getKeyBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetKey,this),1==this._type?(t.MJLobbyData.getInstance().myBaseInfo.phonenumber&&(this.phoneNum.text=t.MJLobbyData.getInstance().myBaseInfo.phonenumber+"",this.phoneNum.enabled=!1,this.tipsTxt.text="已绑定手机号"+t.MJLobbyData.getInstance().myBaseInfo.phonenumber+",不能重复绑定"),this.submitBtn.visible=!0,this.yesButton.visible=!1,this.changeButton.visible=!1,this.registeredBtn.visible=!1,this.submitBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sendInfo,this)):2==this._type||4==this._type?(this.passWordLabel.text="新密码",this.submitBtn.visible=!1,this.yesButton.visible=!0,this.changeButton.visible=!1,this.registeredBtn.visible=!1,this.yesButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sendInfo,this)):3==this._type?(this.phoneTxt.text="新手机号",this.submitBtn.visible=!1,this.yesButton.visible=!1,this.changeButton.visible=!0,this.registeredBtn.visible=!1,this.changeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sendInfo,this)):5==this._type&&(this.passWordLabel.text="密码",this.changeButton.visible=this.yesButton.visible=this.submitBtn.visible=!1,this.registeredBtn.visible=!0,this.registeredBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sendInfo,this))},i.prototype.closeHandel=function(){uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),this.dispatchEventWith(t.LobbyUIEventConsts.CLOSE)},i.prototype.sendInfo=function(){uniLib.SoundMgr.instance.playSound("buttonClick_mp3");var e=/^1\d{10}$/;if(""==this.phoneNum.text)return void t.LobbyPopupManager.showMildWarnShow("手机号不能为空！");if(!e.test(this.phoneNum.text))return void t.LobbyPopupManager.showMildWarnShow("手机号输入不正确，请重新输入!");if(""==this.keyNum.text)return void t.LobbyPopupManager.showMildWarnShow("验证码不能为空，请重新输入!");if(""==this.pswTxt.text)return void t.LobbyPopupManager.showMildWarnShow("密码不能为空，请重新输入!");if(""==this.pswAgainTxt.text)return void t.LobbyPopupManager.showMildWarnShow("确认密码不能为空，请重新输入!");if(this.pswTxt.text!=this.pswAgainTxt.text)return void t.LobbyPopupManager.showMildWarnShow("两次密码输入不相同，请重新输入!");var i=new Cmd.BindAccountLobbyCmd_C;if(i.platAccount=this.phoneNum.text,i.code=this.keyNum.text,i.platId=129,i.passwd=uniLib.StringUtils.MD5(this.pswTxt.text),1==this._type)i.opType=1,t.LobbyServerMJProxy.getInstance().sendData(i);else if(2==this._type)i.opType=3,t.LobbyServerMJProxy.getInstance().sendData(i);else if(3==this._type)i.opType=2,t.LobbyServerMJProxy.getInstance().sendData(i);else if(4==this._type||5==this._type){var n=Number(uniLib.BrowersUtils.GetRequest("gameId")),o=Number(uniLib.BrowersUtils.GetRequest("zoneId")),a=uniLib.Global.gameConfig?uniLib.Global.gameConfig:RES.getRes("lobbyConfig_json");uniLib.Global.gameConfig?t.NetMgr.init(a.login_url,n?n:a.gameid,o?o:a.zoneid):t.NetMgr.init(a["default"].login_url,n?n:a["default"].gameid,o?o:a["default"].zoneid);var s=4==this._type?1:0;t.NetMgr.CodeLogin(this.phoneNum.text,this.keyNum.text,uniLib.StringUtils.MD5(this.pswTxt.text),0,s,this.Loginhandle,this.loginerror,this)}},i.prototype.Loginhandle=function(t){this.closeHandel()},i.prototype.onGetKey=function(e){uniLib.SoundMgr.instance.playSound("buttonClick_mp3");var i=/^1\d{10}$/;if(""==this.phoneNum.text)return this.phone="",void t.LobbyPopupManager.showMildWarnShow("手机号不能为空！");if(!i.test(this.phoneNum.text))return this.phone="",void t.LobbyPopupManager.showMildWarnShow("手机号输入不正确，请重新输入!");if(this.phone=this.phoneNum.text,1==this._type){var n=new Cmd.GetBindAccountIdentifyCodeLobbyCmd_C;n.phoneNumber=Number(this.phoneNum.text),n.opType=1,t.LobbyServerMJProxy.getInstance().sendData(n)}else if(2==this._type){var n=new Cmd.GetBindAccountIdentifyCodeLobbyCmd_C;n.phoneNumber=Number(this.phoneNum.text),n.opType=3,t.LobbyServerMJProxy.getInstance().sendData(n)}else if(3==this._type){var n=new Cmd.GetBindAccountIdentifyCodeLobbyCmd_C;n.phoneNumber=Number(this.phoneNum.text),n.opType=2,t.LobbyServerMJProxy.getInstance().sendData(n)}else(4==this._type||5==this._type)&&this.getCaptcha();this.updateGetKeyBtn(2),this.countDown||(this.countDown=new egret.Timer(1e3),this.countDown.addEventListener(egret.TimerEvent.TIMER,this.timeDown,this),this.countDown.start(),this.startCount=60)},i.prototype.timeDown=function(t){return this.startCount>0?(this.startCount--,void(this.getKeyBtn.labelDisplay.text="("+this.startCount+"S)")):(this.countDown.stop(),this.countDown.removeEventListener(egret.TimerEvent.TIMER,this.timeDown,this),this.countDown=null,void this.updateGetKeyBtn(1))},i.prototype.updateGetKeyBtn=function(t){if(this.getKeyBtn)switch(t){case 1:this.getKeyBtn.touchEnabled=!0,this.getKeyBtn.filters=[],this.getKeyBtn.labelDisplay.text="获取验证码";break;case 2:this.getKeyBtn.touchEnabled=!1;var e=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0];this.getKeyBtn.labelDisplay.text="(60S)";var i=new egret.ColorMatrixFilter(e);this.getKeyBtn.filters=[i]}},i.prototype.getCaptcha=function(){console.error("请求验证码请求验证码");var e=Number(uniLib.BrowersUtils.GetRequest("gameId")),i=Number(uniLib.BrowersUtils.GetRequest("zoneId")),n=uniLib.Global.gameConfig?uniLib.Global.gameConfig:RES.getRes("lobbyConfig_json");uniLib.Global.gameConfig?t.NetMgr.init(n.login_url,e?e:n.gameid,i?i:n.zoneid):t.NetMgr.init(n["default"].login_url,e?e:n["default"].gameid,i?i:n["default"].zoneid),this.getCode()},i.prototype.getCode=function(){this.isCpatcha=!0,this.tipsTxt.text="",""!=this.phone&&t.NetMgr.GetPhoneCode(this.phone,"",function(e){return e&&0==e.retcode?t.LobbyPopupManager.showMildWarnShow("发送成功"):t.LobbyPopupManager.showMildWarnShow("短信发送速度过快,请稍等"),!0},this)},i.prototype.loginerror=function(t){return this.tipsTxt.text=t.desc,!0},i.prototype.destroy=function(){this.closeButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.closeHandel,this),this.submitBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.sendInfo,this),this.yesButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.sendInfo,this),this.changeButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.sendInfo,this),this.getKeyBtn&&this.getKeyBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetKey,this),this.countDown&&(this.countDown.stop(),this.countDown.hasEventListener(egret.TimerEvent.TIMER)&&this.countDown.removeEventListener(egret.TimerEvent.TIMER,this.timeDown,this),this.countDown=null),uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this)},i}(eui.Component);t.PhoneBindPanel=e,__reflect(e.prototype,"MJLobby.PhoneBindPanel")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.remPassword=!0,t.skinName=new PhoneLoginPanelSkin,t.init(),t}return __extends(i,e),i.prototype.init=function(){if(this.tipsTxt.text="",this.registeredBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.resetPsw,this),this.resetBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.resetPsw,this),this.submitBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sendInfo,this),this.closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeHandel,this),this.remPswBtn=new t.CreateCheckMc,this.remPswBtn.touchEnabled=!0,this.remPswBtn.setCheckType(2),this.remPswBtn.label="记住密码",this.remPswBtn.x=540,this.remPswBtn.y=400,this.addChild(this.remPswBtn),this.remPswBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCheckHandler,this),uniLib.Utils.getLocalStorage("rem")){var e=JSON.parse(uniLib.Utils.getLocalStorage("rem"));this.phoneNum.text=e.count,this.keyNum.text="",this.remPassword&&(this.remPswBtn.check=!0,this.keyNum.text=e.password)}},i.prototype.resetPsw=function(t){var e=t.target==this.registeredBtn?5:4;this.dispatchEventWith("phone_reset_password",!1,e)},i.prototype.onCheckHandler=function(t){this.remPswBtn.check?(this.remPswBtn.check=!1,this.remPassword=!1):(this.remPswBtn.check=!0,this.remPassword=!0)},i.prototype.closeHandel=function(){this.dispatchEventWith(t.LobbyUIEventConsts.CLOSE)},i.prototype.sendInfo=function(){var e=/^1\d{10}$/;if(""==this.phoneNum.text)return void t.LobbyPopupManager.showMildWarnShow("手机号不能为空！");if(!e.test(this.phoneNum.text))return void t.LobbyPopupManager.showMildWarnShow("手机号输入不正确，请重新输入!");if(""==this.keyNum.text)return void t.LobbyPopupManager.showMildWarnShow("验证码不能为空，请重新输入!");var i=Number(uniLib.BrowersUtils.GetRequest("gameId")),n=Number(uniLib.BrowersUtils.GetRequest("zoneId")),o=uniLib.Global.gameConfig?uniLib.Global.gameConfig:RES.getRes("lobbyConfig_json");t.NetMgr.http||(uniLib.Global.gameConfig?t.NetMgr.init(o.login_url,i?i:o.gameid,n?n:o.zoneid):t.NetMgr.init(o["default"].login_url,i?i:o["default"].gameid,n?n:o["default"].zoneid)),t.NetMgr.LoginByTel(this.phoneNum.text,uniLib.StringUtils.MD5(this.keyNum.text),this.loginPhoneSuccess,this.loginFaol,this)},i.prototype.loginFaol=function(t){return console.error("param.desc"+t.desc),this.tipsTxt.text=t.desc,!0},i.prototype.loginPhoneSuccess=function(t){console.error("loginPhoneSuccess back"+JSON.stringify(t)),this.tipsTxt.text="";var e={count:"",password:""};e.count=this.phoneNum.text,e.password=this.keyNum.text,this.remPassword?uniLib.Utils.setLocalStorage("rem",JSON.stringify(e)):uniLib.Utils.clearLocalStorage("rem"),uniLib.Global.platId=129,this.dispatchEventWith("phone_login_succ")},i.prototype.destroy=function(){this.registeredBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.resetPsw,this),this.resetBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.resetPsw,this),this.closeButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.closeHandel,this),this.submitBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.sendInfo,this),this.remPswBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCheckHandler,this),uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this)},i}(eui.Component);t.PhoneLoginPanel=e,__reflect(e.prototype,"MJLobby.PhoneLoginPanel")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.skinName=new PromoteRewardSkin,t.addListener(),t}return __extends(n,e),Object.defineProperty(n,"Instance",{get:function(){return this._instance||(this._instance=new n),this._instance},enumerable:!0,configurable:!0}),n.prototype.addListener=function(){this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onClose,this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.resetRewardBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onReset,this)},n.prototype.removeListener=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onClose,this),this.resetRewardBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onReset,this)},n.prototype.onClose=function(){this.dispatchEventWith(t.LobbyUIEventConsts.CLOSE,!1,this)},n.prototype.onReset=function(){var e=function(){var e=new Cmd.ResetTaxRewardMatchRoomCmd_C;e.uid=uniLib.NetMgr.UID,e.matchId=t.MatchManagePanel.Instanc.selectMatchId,t.LobbyServerMJProxy.getInstance().sendData(e)},i=new t.MatchMsgBox;i.setData("温馨提示","您确定要重置奖励吗？",["确定","取消"],[e]),t.LobbyPopupManager.addPopUp(i,!0,!0)},n.prototype.destory=function(){this.removeListener(),this.rewardCollection&&(this.rewardCollection.removeAll(),this.rewardCollection=null),this.rewardDataList&&(this.rewardDataList=null)},n.prototype.showPromote=function(){if(!this.matchId)return void t.LobbyPopupManager.showMildSingleWarnShow("未找到分享包厢号！请关闭重试。");var e=t.MJLobbyData.getInstance().myBaseInfo.nickName,i=this.matchName?this.matchName:"";t.PublicMethed.sharePromote(e,i,this.matchId,this.wechat)},n.prototype.onShare=function(){var e=this.matchId,i=new uniLib.WXShareVo;i.shareWay=0;var n=t.MJLobbyData.getInstance().myBaseInfo.nickName;n.length>8&&(n=n.slice(0,8)),""==uniLib.ZQGameSdk.defaultWXShareVo.webpageUrl&&t.LobbyDataCache.bundleInfo&&t.LobbyDataCache.bundleInfo.weixin.wbappid?i.webpageUrl="https://open.weixin.qq.com/connect/oauth2/authorize?appid="+t.LobbyDataCache.bundleInfo.weixin.wbappid+"&redirect_uri=http://"+t.PublicMethed.wxShareUrl+"/addons/zqgame/gameshare.php?appid="+t.LobbyDataCache.bundleInfo.weixin.wbappid+"&response_type=code&scope=snsapi_base&state="+uniLib.CompressUtil.base64encode(t.MJLobbyData.getInstance().myBaseInfo.uid+"|"+e+"|"+n)+"&connect_redirect=1#wechat_redirect":i.webpageUrl=uniLib.ZQGameSdk.defaultWXShareVo.webpageUrl+"?uid="+t.MJLobbyData.getInstance().myBaseInfo.uid+"&nickName="+n;var o=this.shareInfo;","==o.content.substring(o.content.length-1)&&(o.content=o.content.substring(0,o.content.length-1)),i.title=o&&o.title?o.title:"";var a=this.extenStr?this.extenStr:"";i.description=o&&o.content?o.content+a:"",t.MJLobbyData.getInstance().hasXianLiao?(i.roomId=JSON.stringify({matchId:e}),uniLib.Global.dispatchEvent(uniLib.ZqEvent.SHARE,i,!0)):uniLib.ZQGameSdk.share(i,null,this)},n.prototype.onClick=function(t){t.target instanceof eui.Button&&uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),t.target==this.uidSort?this.sortByStr("uid"):t.target==this.rewardYstSort?this.sortByStr("rewardY"):t.target==this.rewardTdySort?this.sortByStr("rewardT"):t.target==this.rewardMoutSort?this.sortByStr("all"):t.target==this.closeButton?this.onClose():t.target==this.promoteBtn?this.showPromote():t.target==this.recallBtn&&this.onShare()},n.prototype.sortByStr=function(t){if(this.rewardDataList&&this.rewardDataList instanceof Array&&this.rewardDataList.length>1){var e=[];e=this.rewardDataList.sort(function(e,i){e[t]?e[t]:0,i[t]?i[t]:0;return e[t]-i[t]>0?1:e[t]-i[t]==0?0:e[t]-i[t]<0?-1:void 0}),this.rewardCollection.replaceAll(e)}},n.prototype.setData=function(t){var e=t&&t instanceof Array?t:[];this.rewardDataList=e,this.rewardCollection||(this.rewardCollection=new eui.ArrayCollection,this.rewardLIst.itemRenderer=i,this.rewardLIst.dataProvider=this.rewardCollection),this.rewardCollection.replaceAll(e),0==e.length?this.rewardtip.visible=!0:this.rewardtip.visible=!1},n.prototype.setShareInfo=function(t,e,i,n,o){this.matchId=t,this.matchName=e,this.wechat=i,this.extenStr=n,this.shareInfo=o},n}(eui.Component);t.PromoteRewardPanel=e,__reflect(e.prototype,"MJLobby.PromoteRewardPanel");var i=function(t){function e(){var e=t.call(this)||this;return e.skinName=new PromoteRewardItemSkin,e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.uid.text=""+(t.uid?t.uid:""),this.nickName.text=t.name?t.name.slice(0,4):"",this.rewardYst.text=""+(t.rewardY?t.rewardY:0),this.rewardTdy.text=""+(t.rewardT?t.rewardT:0),this.rewardMou.text=""+(t.all?t.all:0)},e}(eui.ItemRenderer);t.PromoteRewardItem=i,__reflect(i.prototype,"MJLobby.PromoteRewardItem")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function i(){return e.call(this)||this}return __extends(i,e),i.prototype.initUI=function(){var e=t.LobbyResUtil.createBitmapByName("mjl_creat_bg");this.addChild(e),e.touchEnabled=!0,this._back=t.LobbyResUtil.createBitmapByName("mjl_create_back",11,8),this.addChild(this._back),this._back.touchEnabled=!0,this._back.addEventListener(egret.TouchEvent.TOUCH_TAP,this.backHandle,this);var i=t.LobbyResUtil.createBitmapByName("mjl_create_contentbg",11,108);i.scale9Grid=new egret.Rectangle(100,100,130,30),i.width=1111,i.height=526,this.addChild(i),this._sysMsgTxt=t.LobbyResUtil.createTextFeild(5525056,egret.HorizontalAlign.LEFT,"",30,0,0,898),this.addChild(this._sysMsgTxt),this._scroll=t.LobbyResUtil.createScroll(this._sysMsgTxt,898,474,125,138),this._scroll.horizontalScrollPolicy="off",this._scroll.verticalScrollPolicy="on",this.addChild(this._scroll)},i.prototype.showMsg=function(t){this._sysMsgTxt.text=t},i.prototype.backHandle=function(e){this.dispatchEventWith(t.LobbyUIEventConsts.CLOSE),this.destory()},i}(t.BasePanel);t.SystemMsgPanel=e,__reflect(e.prototype,"MJLobby.SystemMsgPanel")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i._playTypeConfig=t.MJLobbyData.getInstance().getPlayTypeConfig(),i._parentData={},i._checkRadio={},i.bottomTxt||(i.bottomTxt=new eui.TextInput,i.bottomTxt.skinName=new MJ_TextInputSkin,i.bottomTxt.skin.title.text="底注："),i.enteringPointTxt||(i.enteringPointTxt=new eui.TextInput,i.enteringPointTxt.skinName=new MJ_TextInputSkin,i.enteringPointTxt.skin.title.text="入场："),i.leavingPointTxt||(i.leavingPointTxt=new eui.TextInput,i.leavingPointTxt.skinName=new MJ_TextInputSkin,i.leavingPointTxt.skin.title.text="离场："),i.addListener(),i}return __extends(i,e),i.prototype.addListener=function(){this.bottomTxt.addEventListener(egret.TouchEvent.FOCUS_OUT,this.pointChange,this),this.enteringPointTxt.addEventListener(egret.TouchEvent.FOCUS_OUT,this.pointChange,this)},i.prototype.destory=function(){if(e.prototype.destory.call(this),this._checkArr){for(var i=0;i<this._checkArr.length;i++)this._checkArr[i].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCheckHandle,this),this._checkArr[i].removeEventListener(t.LobbyUIEventConsts.CHANGE,this.onCheckHandle,this),this._checkArr[i].destory();this._checkArr=null}if(this._radioArr){for(var i=0;i<this._radioArr.length;i++)this._radioArr[i]&&this._radioArr[i].destory();this._radioArr=null}this._checkRadio=null,this._parentData=null,this._playTypeConfig=null,this._idList=null,this._playTypeIdArr=null,this.leavingPointTxt=null,this.bottomTxt=null,this.enteringPointTxt=null},i.prototype.setPlayTypeData=function(e,i){this._playTypeIdArr=[];var n;this._checkArr=[],this._parentData={},this._radioArr=[],this._idList=[];for(var o=0,a=0;a<e.length;a++)n=""!=e[a].label?e[a].label+"：":"",this._playTypeIdArr=this._playTypeIdArr.concat(e[a].idArr),o=0==a?0:"比牌"==e[a].label?o:this.height+20,this.setData(e[a].idArr,i,o,n);for(var s in this._parentData){var r=this._parentData[s];this._playTypeConfig[r[0]].buttonType!=t.PlayTypeConsts.MUlT_CHECK&&this.setRadioBox(r,i,Number(s))}for(var h,c=0;c<i.length;c++)h=this.getChildByName("check"+i[c]),h&&(h.check=!0,this.checkPlayTypeById(i[c]))},Object.defineProperty(i.prototype,"value",{get:function(){for(var t=[],e=0;e<this._checkArr.length;e++)this._checkArr[e].check&&t.push(Number(this._checkArr[e].name.slice(5)));for(var i,e=0;e<this._radioArr.length;e++)this._radioArr[e]&&(i=this._radioArr[e].value,i&&t.push(i));return t},enumerable:!0,configurable:!0}),i.prototype.setData=function(e,i,n,o,a){void 0===a&&(a=170);var s,r=[],h=t.LobbyResUtil.createTextFeild(1206199,egret.HorizontalAlign.RIGHT,o,20,-163,8+n,153);"比牌："==o&&(h.visible=!1),this.addChild(h);var c=!1;e.length>4&&(c=!0);for(var l,d=0;d<e.length;d++)if(s=new t.CreateCheckMc,this._playTypeConfig.hasOwnProperty(e[d])){var u=this._playTypeConfig[e[d]].parent,b=this._playTypeConfig[e[d]].buttonType;u&&-1!=this._playTypeIdArr.indexOf(u)?(this._playTypeConfig[e[d]].buttonType==t.PlayTypeConsts.RADIO?s.setCheckType(1):s.setCheckType(3),this._parentData[u]||(this._parentData[u]=[]),this._parentData[u].push(e[d])):b==t.PlayTypeConsts.MUlT_CHECK?s.setCheckType(2):(s.setCheckType(1),r.push(e[d])),s.setLabelSize(24),s.label=this._playTypeConfig[e[d]].desc,d%4==0?s.x=0:(l=this.getChildByName("check"+e[d-1]),l.x+l.checkWidth<a*(d%4)?s.x=a*(d%4):l.checkWidth>a?s.x=l.x+l.checkWidth:s.x=l.x+a),10514==e[d]?s.visible=!1:c?s.y=70*Math.floor(d/4)+n:s.y=n,this.addChild(s),s.name="check"+e[d],s.touchEnabled=!0,b==t.PlayTypeConsts.MUlT_CHECK?(this._checkArr.push(s),s.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCheckHandle,this)):s.addEventListener(t.LobbyUIEventConsts.CHANGE,this.onChange,this)}r.length>0&&this.setRadioBox(r,i),this._idList=this._idList.concat(e)},i.prototype.setRadioBox=function(e,i,n){var o,a;if(this._playTypeConfig[e[0]].buttonType!=t.PlayTypeConsts.MUlT_CHECK){o=[],a=0;for(var s=0;s<e.length;s++){var r=this.getChildByName("check"+e[s]);o.push(r),-1!=i.indexOf(e[s])&&(a=e[s]),n&&r.setCheckType(4)}for(var h=new t.RadioRelate(o,e,a,this._playTypeConfig[e[0]].buttonType),s=0;s<e.length;s++)this._checkRadio[e[s]]=h;!n||this._playTypeConfig[e[0]].buttonType!=t.PlayTypeConsts.RADIO_NO_DEFAULT&&this._playTypeConfig[e[0]].buttonType!=t.PlayTypeConsts.RADIO||-1!=i.indexOf(n)||h.setEnabled(!1),this._radioArr.push(h)}},i.prototype.onChange=function(t){"check95"==t.target.name&&this.checkGold(95),RES.hasRes("buttonClick_mp3")&&uniLib.SoundMgr.instance.playSound("buttonClick_mp3");var e=t.currentTarget;this.checkPlayTypeById(Number(e.name.slice(5)))},i.prototype.onCheckHandle=function(t){RES.hasRes("buttonClick_mp3")&&uniLib.SoundMgr.instance.playSound("buttonClick_mp3");var e=t.currentTarget;e.check=!e.check,this.checkPlayTypeById(Number(e.name.slice(5)))},i.prototype.checkPlayTypeById=function(e){var i=this.getChildByName("check"+e);if(this._playTypeConfig[e].parent){var n=this.getChildByName("check"+this._playTypeConfig[e].parent);i.check?n&&!n.check&&(n.check=!0,this.checkPlayTypeById(this._playTypeConfig[e].parent),n.dispatchEventWith(t.LobbyUIEventConsts.RESET_CHECKBOX)):n&&n.check&&this._playTypeConfig[e].interact&&this.checkPlayTypeById(this._playTypeConfig[e].parent)}if(this._parentData[e])if(this._playTypeConfig[this._parentData[e][0]].buttonType==t.PlayTypeConsts.RADIO||this._playTypeConfig[this._parentData[e][0]].buttonType==t.PlayTypeConsts.RADIO_NO_DEFAULT){if(this._checkRadio[this._parentData[e][0]]){var o=this._checkRadio[this._parentData[e][0]];o.setEnabled(i.check)}}else for(var a=0;a<this._parentData[e].length;a++){var s=this.getChildByName("check"+this._parentData[e][a]);s.check&&!i.check&&(s.check=!1,this.checkPlayTypeById(this._parentData[e][a])),this._playTypeConfig[e].buttonType==t.PlayTypeConsts.RADIO_NO_DEFAULT&&(s.visible=s.check)}if(this._playTypeConfig[e].exclude&&this.exclude(this._playTypeConfig[e].exclude,i.check),this._playTypeConfig[e].interact&&i.check&&this.interact(this._playTypeConfig[e].interact),10432==e&&t.CreateGamePanel.instance.setExclude("userNbr",["6人"],i.check,5),10317==e&&t.CreateGamePanel.instance.setExclude("userNbr",["5人"],i.check),10430==e&&i.check){var r=this.getChildByName("check10431");r&&(r.check=!1)}else if(10431==e&&i.check){var r=this.getChildByName("check10430");r&&(r.check=!1)}var h=this.getChildByName("check10496"),c=this.getChildByName("check10497"),l=this.getChildByName("check10498"),d=this.getChildByName("check10499"),u=this.getChildByName("check10506"),b=this.getChildByName("check10507"),p=this.getChildByName("check10508"),m=this.getChildByName("check10509"),y=this.getChildByName("check10510"),g=this.getChildByName("check10511"),v=this.getChildByName("check10512"),L=this.getChildByName("check10513"),_=this.getChildByName("check10514"),f=this.getChildByName("check10458"),C=this.getChildByName("check10459"),T=this.getChildByName("check10460"),M=this.getChildByName("check10461"),E=this.getChildByName("check10462");"check10457"==i.name?c&&l&&u&&g&&b&&p&&m&&y&&h&&_&&f&&C&&T&&M&&E&&(c.setEnable(!i.check),l.setEnable(!i.check),d.setEnable(!i.check),u.setEnable(!i.check),g.setEnable(!i.check),b.setEnable(!i.check),p.setEnable(!i.check),m.setEnable(!i.check),y.setEnable(!i.check),h.setEnable(!i.check),_.setEnable(!i.check),v.setEnable(!i.check),L.setEnable(!i.check),L.check=!1,v.check=!1,u.check=!0,u.dispatchEventWith(egret.TouchEvent.TOUCH_TAP),m.check=!0,m.dispatchEventWith(egret.TouchEvent.TOUCH_TAP),h.check=!0,h.dispatchEventWith(egret.TouchEvent.TOUCH_TAP),f.dispatchEventWith(egret.TouchEvent.TOUCH_TAP),_.check=!1,c.check=!1,l.check=!1,d.check=!1,u.check=!1,b.check=!1,g.check=!1,p.check=!1,m.check=!1,y.check=!1,h.check=!1,C.check=!1,T.check=!1,M.check=!1,E.check=!1):"check10463"==i.name&&(L&&v&&f&&C&&T&&M&&(f.setEnable(!i.check),f.check=!1,C.setEnable(!i.check),C.check=!1,T.setEnable(!i.check),T.check=!1,M.setEnable(!i.check),E.setEnable(!i.check),M.check=!1,E.check=!1),L&&c&&l&&u&&g&&b&&p&&m&&y&&h&&_&&(_.dispatchEventWith(egret.TouchEvent.TOUCH_TAP),u.check=!0,u.dispatchEventWith(egret.TouchEvent.TOUCH_TAP),h.check=!0,h.dispatchEventWith(egret.TouchEvent.TOUCH_TAP),p.check=!0,p.dispatchEventWith(egret.TouchEvent.TOUCH_TAP),v.check=!0,v.dispatchEventWith(egret.TouchEvent.TOUCH_TAP)))},i.prototype.interact=function(t){for(var e,i=0;i<t.length;i++)e=this.getChildByName("check"+t[i]),e&&e.setEnable(!0)},i.prototype.exclude=function(t,e){for(var i,n=0;n<t.length;n++)if(i=this.getChildByName("check"+t[n])){var o=!1;if(i.check==!e&&(o=!0),this._checkRadio[t[n]]){var a=this._checkRadio[t[n]];1==i.check&&a.excludeCheckId(i)}else i.check=!e;i.setEnable(!e),o&&this.checkPlayTypeById(t[n])}},i.prototype.checkGold=function(e){var i=this.getChildByName("check"+e);if(i)if(1==i.check){t.CreateGamePanel.instance.gameId;this.bottomTxt.name="bottom",this.enteringPointTxt.name="enter",this.leavingPointTxt.name="leave",this.curBottomPoint=100,this.bottomTxt.text=this.curBottomPoint+"",this.enteringPointTxt.text=this.curBottomPoint+"",this.leavingPointTxt.text=this.enteringPointTxt.text,this.bottomTxt.x=250,this.bottomTxt.y=i.y,this.enteringPointTxt.x=0,this.enteringPointTxt.y=i.y+46,this.leavingPointTxt.x=250,this.leavingPointTxt.y=this.enteringPointTxt.y,this.addChild(this.bottomTxt),this.addChild(this.leavingPointTxt),this.addChild(this.enteringPointTxt),this.txtChange(),t.CreateGamePanel.instance.mutilCheckMc.getChildByName("outTime")&&(t.CreateGamePanel.instance.mutilCheckMc.getChildByName("outTime").y+=50),t.CreateGamePanel.instance.mutilCheckMc.getChildByName("payType")&&(t.CreateGamePanel.instance.mutilCheckMc.getChildByName("payType").y+=50),t.CreateGamePanel.instance.mutilCheckMc.getChildByName("hostTip")&&(t.CreateGamePanel.instance.mutilCheckMc.getChildByName("hostTip").y+=50),t.CreateGamePanel.instance.timeList&&(t.CreateGamePanel.instance.timeList.y+=50)}else this.bottomTxt.parent&&this.bottomTxt.parent.removeChild(this.bottomTxt),this.enteringPointTxt.parent&&this.enteringPointTxt.parent.removeChild(this.enteringPointTxt),this.leavingPointTxt.parent&&this.leavingPointTxt.parent.removeChild(this.leavingPointTxt),t.CreateGamePanel.instance.leavingPoint=0,t.CreateGamePanel.instance.bottomPoint=0,t.CreateGamePanel.instance.enteringPoint=0,t.CreateGamePanel.instance.mutilCheckMc.getChildByName("outTime")&&(t.CreateGamePanel.instance.mutilCheckMc.getChildByName("outTime").y-=50),t.CreateGamePanel.instance.mutilCheckMc.getChildByName("payType")&&(t.CreateGamePanel.instance.mutilCheckMc.getChildByName("payType").y-=50),t.CreateGamePanel.instance.mutilCheckMc.getChildByName("hostTip")&&(t.CreateGamePanel.instance.mutilCheckMc.getChildByName("hostTip").y-=50),t.CreateGamePanel.instance.timeList&&(t.CreateGamePanel.instance.timeList.y-=50)},i.prototype.txtChange=function(){t.CreateGamePanel.instance.leavingPoint=Number(this.leavingPointTxt.text),t.CreateGamePanel.instance.bottomPoint=Number(this.bottomTxt.text),t.CreateGamePanel.instance.enteringPoint=Number(this.enteringPointTxt.text)},i.prototype.pointChange=function(e){var i=e.target.parent;if("bottom"==i.name){if(""!=this.bottomTxt.text){var n=Number(this.bottomTxt.text);0==n?(t.LobbyPopupManager.showMildWarnShow("底分不能为0"),this.bottomTxt.text="100"):this.curBottomPoint=n}else this.bottomTxt.text="100";this.checkPoint()}else"enter"==i.name;t.CreateGamePanel.instance.leavingPoint=Number(this.leavingPointTxt.text),t.CreateGamePanel.instance.bottomPoint=Number(this.bottomTxt.text),t.CreateGamePanel.instance.enteringPoint=Number(this.enteringPointTxt.text)},i.prototype.checkPoint=function(e){void 0===e&&(e=!1);var i=(t.CreateGamePanel.instance.gameId,this.curBottomPoint);this.enteringPointTxt.text=i+"",""==this.enteringPointTxt.text?this.enteringPointTxt.text=i+"":Number(this.enteringPointTxt.text)<i&&(e&&t.LobbyPopupManager.showMildWarnShow("入场不能少于"+i),this.enteringPointTxt.text="",this.enteringPointTxt.prompt=i+"");var n=""!=this.enteringPointTxt.text?Number(this.enteringPointTxt.text):Number(this.enteringPointTxt.prompt);this.leavingPointTxt.text=n+""},i}(t.LobbyBaseVc);t.PlayTypeCheckBox=e,__reflect(e.prototype,"MJLobby.PlayTypeCheckBox")}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.skinName=new IdentifyPanelSkin,t.init(),t}return __extends(i,e),i.prototype.init=function(){this.closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeHandel,this),this.submitBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sendInfo,this)},i.prototype.closeHandel=function(){this.dispatchEventWith(t.LobbyUIEventConsts.CLOSE)},i.prototype.sendInfo=function(){var e=this.userName.text,i=(this.WeChatNumber.text,new Cmd.WechatLobbyCmd_CS);i.name=e,i.mobile=this.phoneNum.text,i.wechat=this.WeChatNumber.text,t.NetMgr.tcpSend(i),this.closeHandel()},i.prototype.destroy=function(){this.closeButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.closeHandel,this),this.submitBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.sendInfo,this)
},i}(eui.Component);t.VerifyPanel=e,__reflect(e.prototype,"MJLobby.VerifyPanel")}(MJLobby||(MJLobby={}));var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,i){function n(n){e.call(i,n,t)}if(RES.hasRes(t)){var o=RES.getRes(t);o?n(o):RES.getResAsync(t,n,this)}else RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var uniLib;!function(t){t.sounds={},t.lastSoundTime=0,t.soundNumber=0,t.playSoundTime=0,t.stopSoundTime=0,t.soundError=!1}(uniLib||(uniLib={})),RES.SoundAnalyzer.prototype.loadFile=function(t,e,i){if(this.soundDic[t.name])return void e.call(i,t);var n=new egret.Sound;n.addEventListener(egret.Event.COMPLETE,this.onLoadFinish,this),n.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadFinish,this),this.resItemDic[n.$hashCode]={item:t,func:e,thisObject:i},n.load(RES.$getVirtualUrl(t.url)),t.data&&!n.type&&(uniLib.musics&&uniLib.musics.first(function(e){return e==t.name})?n.type=egret.Sound.MUSIC:n.type=egret.Sound.EFFECT),console.log("libOpenSLES sound.type: "+n.type)};var destorySound=function(t,e,i,n,o){var a=uniLib.sounds[e],s=a.first(function(e){return e==t});s&&s.sound&&s.soundChannel&&(console.log("libOpenSLES playSoundComplete:",e+"   "+o),o||s.soundChannel.stop(),s.sound=null,s.soundChannel=null,a&&a instanceof Array&&a.removeFirst(function(t){return t==s}),i&&i.call(n))};uniLib.SoundMgr&&(uniLib.SoundMgr.prototype.playSound=function(t,e,i,n,o){void 0===e&&(e=1),void 0===i&&(i=0),uniLib.soundError;var a=RES.getRes(t);if(a){var s=Date.now();if(s-uniLib.playSoundTime>12e4&&uniLib.soundNumber>0&&(uniLib.soundNumber=0),uniLib.soundNumber>2||s-uniLib.stopSoundTime<300)return void setTimeout(function(){n&&n.call(o)},500);console.log("libOpenSLES soundName：",t+""+i+" "+e+" "+a.length);try{a.type=egret.Sound.EFFECT;var r=a.play(i,e);if(null==r)return void console.log("libOpenSLES soundName：",r," isnull");uniLib.SoundMgr.instance.soundOpen?((null==uniLib.SoundMgr.instance.soundVolume||0/0==uniLib.SoundMgr.instance.soundVolume)&&(uniLib.SoundMgr.instance.soundVolume=1),r.volume=uniLib.SoundMgr.instance.soundVolume):r.volume=0;var h={sound:a,soundChannel:r,startTime:Date.now()},c=function(){destorySound(h,t,n,o,!0)};uniLib.playSoundTime=s,r.once(egret.Event.SOUND_COMPLETE,c,null),setTimeout(function(){console.log("libOpenSLES playSoundComplete Error:"+t),r.removeEventListener(egret.Event.SOUND_COMPLETE,c,null),destorySound(h,t,n,o,!1)},3e3);var l=uniLib.sounds[t];return l&&l instanceof Array||(uniLib.sounds[t]=[]),uniLib.sounds[t].push(h),r}catch(d){return void console.log("libOpenSLES soundName error：",t," error")}}else RES.getResAsync(t,function(a){a&&uniLib.SoundMgr.instance.playSound(t,e,i,n,o)},null)},uniLib.SoundMgr.prototype.stopSound=function(t){var e=Date.now(),i=uniLib.sounds[t];if(i&&i instanceof Array&&!(i.length<1)){for(var n=0,o=i;n<o.length;n++){var a=o[n];if(a.sound&&a.soundChannel){var s=a.startTime,r=e-s;if(300>r){console.log("libOpenSLES音效停止太快,延迟一会:"+t);a.soundChannel;egret.setTimeout(function(e){if(console.log("libOpenSLES stopSound:"+t),e.sound&&e.soundChannel){var i=Date.now();uniLib.stopSoundTime=i,e.soundChannel.stop(),e.sound=null,e.soundChannel=null}},this,300,a)}else uniLib.stopSoundTime=e,a.soundChannel.stop(),a.sound=null,a.soundChannel=null}}uniLib.sounds[t]=[]}},uniLib.SoundMgr.prototype.stopSounds=function(){for(var t in uniLib.sounds)uniLib.SoundMgr.instance.stopSound(t);uniLib.sounds={}},uniLib.SoundMgr.prototype.playBgMusic=function(t,e){if(null!=t&&(uniLib.musics=t,uniLib.Global.isActive&&uniLib.SoundMgr.instance.musicOpen)){var i=t.random(),n=RES.getRes(i);if(null==n)return void RES.getResAsync(i,function(i){i&&uniLib.SoundMgr.instance.playBgMusic(t,e)},null);try{uniLib.SoundMgr.instance.stopBgMusic(),uniLib.musics=t,n.type=egret.Sound.MUSIC,uniLib.bgMusic=n.play(e,0),uniLib.bgMusic.volume=uniLib.SoundMgr.instance.musicVolume,uniLib.bgMusic=uniLib.bgMusic}catch(o){return}}},uniLib.SoundMgr.prototype.stopBgMusic=function(){uniLib.bgMusic&&(uniLib.bgMusic.stop(),uniLib.bgMusic=null,uniLib.musics=null)},uniLib.SoundMgr.prototype.pauseBgMusic=function(){uniLib.bgMusic&&(uniLib.bgMusic.stop(),uniLib.bgMusic=null)},uniLib.SoundMgr.prototype.resumeBgMusic=function(){uniLib.SoundMgr.instance.playBgMusic(uniLib.musics)},uniLib.SoundMgr.prototype.isPlayingBgMusic=function(){return!1});var MJLobbyLoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},e.prototype.setProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);__reflect(MJLobbyLoadingUI.prototype,"MJLobbyLoadingUI");var MJLobbyMain=function(t){function e(e){var i=t.call(this)||this;return i.lobbyId=1003,i._isExe=!1,uniLib.BrowersUtils.GetRequest("cache")&&(RES.web.Html5VersionController.prototype.getVirtualUrl=function(t){return t+="?v="+Math.random()}),i._isExe="true"==uniLib.BrowersUtils.GetRequest("isexe")?!0:!1,MJLobby.ViewConfig.loginPanelName=uniLib.getQualifiedClassName(MJLobby.LobbyLoginPanel),MJLobby.ViewConfig.mainMediatorName=uniLib.getQualifiedClassName(MJLobby.MahJongLobbyMediator),i.addEventListener(egret.Event.ADDED_TO_STAGE,i.start,i),egret&&"true"!=uniLib.BrowersUtils.GetRequest("debug")&&egret.MainContext.instance.stage.addEventListener(egret.Event.DEACTIVATE,i.onActive,i),game.DataCache.destroyResOnExit=!1,egret.ImageLoader.crossOrigin="anonymous",i}return __extends(e,t),e.prototype.onActive=function(t){uniLib.ZQGameSdk.speakerActive()},e.prototype.start=function(t){void 0===t&&(t=null);var i=new AssetAdapter;this.stage.registerImplementation("eui.IAssetAdapter",i),this.stage.registerImplementation("eui.IThemeAdapter",new ThemeAdapter);var n={};n.compressType=uniLib.CompressType.FLATE,n.lobbyMode=!0,n.designWidth=1280,n.designHeight=720,n.debug=!0,n.logLevel=0,uniLib.init(n);var o=Math.max(uniLib.Global.screenWidth,uniLib.Global.screenHeight),a=Math.min(uniLib.Global.screenWidth,uniLib.Global.screenHeight);1.7>o/a?n.scaleMode=egret.StageScaleMode.SHOW_ALL:n.scaleMode=egret.StageScaleMode.FIXED_HEIGHT,egret.MainContext.instance.stage.scaleMode=n.scaleMode,MJLobby.ScreenFixedUtils.instance.init(n.scaleMode),uniLib.Global.lobbyMode=!0,uniLib.UIMgr.instance.showLoadingTimeout(TJLoadingUI,"",0),uniLib.UIMgr.instance.commonLoadUI=PublicLoadingView,uniLib.UIMgr.instance.tipsLoadUI=LoadSecondPanel,this._globalControl=MJLobby.GlobalControl.getInstance(),uniLib.Global.isH5&&window&&window.closeLoading&&window.closeLoading(),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,e.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,e.LoadError,this),this.loadSelfResConfig()},e.prototype.loadSelfResConfig=function(){RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.loadLobbyResConfig,this),RES.loadConfig("resource/mjLobby_self.res.json","resource/")},e.prototype.loadLobbyResConfig=function(){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.loadLobbyResConfig,this),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/MahjongLobbyRes/mjLobby.res.json","resource/MahjongLobbyRes/")},e.onResourceProgress=function(t){t.resItem.loaded||console.error("group："+t.groupName+"url："+t.resItem.url+"loaded:"+t.resItem.loaded)},e.LoadError=function(t){console.warn("group："+t.groupName+"..."+t.itemsLoaded+"..."+t.itemsTotal+" has failed to load")},e.prototype.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var e=new eui.Theme("resource/default.thm.json",this.stage);e.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this)},e.prototype.onThemeLoadComplete=function(t){uniLib.UIMgr.instance.hideLoading(TJLoadingUI);var e=[];e=["mjl_preload","mjl_preload_self"],RES.createGroup("mjl_preLoad",e),uniLib.ResLoadMgr.instance.load("mjl_preLoad",this.onResourceLoadComplete,this.onResourceLoadError,this,uniLib.GameScene)},e.prototype.onResourceLoadComplete=function(t){"preLoadAll"==t.groupName?this.preLoadEnd():this.preloadGame()},e.prototype.preLoadEnd=function(){var t={};t.recognizeEnable=!1,t.playNow=!0,t.appId="1000632",t.uploadUrl="http://image.mj.ucjoy.com:8888/form/uploa",uniLib.ZQGameSdk.recordInit(t),MJLobby.LobbyDataCache.langObj=JSON.parse(RES.getRes("mjlTxt_cn_txt")),0!=uniLib.Global.is_sandbox?this.createGameScene():this.showLogin()},e.prototype.onInitZQGameSkd=function(t){if(MJLobby.LobbyResUtil.trace("onInitZQGameSkd"+JSON.stringify(t)),0==t.code&&t.data.bundleId){uniLib.Global.bundleId=t.data.bundleId;var e=t.data.bundleId.split("_");this.bundleId=e[0],"dz"==this.bundleId.slice(0,2)?MJLobby.LobbyDataCache.costType=MJLobby.CostsTypeConst.CARD:MJLobby.LobbyDataCache.costType=MJLobby.CostsTypeConst.DIAMOND,MJLobby.LobbyDataCache.version=e[1]+"_"+uniLib.Global.version,this.bundleInfo=t.data.bundleInfo,MJLobby.LobbyDataCache.bundleInfo=this.bundleInfo,uniLib.Global.gameConfig=this.bundleInfo,uniLib.Global.payPlatId=this.bundleInfo.pay_platid,uniLib.Global.platId=this.bundleInfo.platid,uniLib.ZQGameSdk.defaultWXShareVo||(uniLib.ZQGameSdk.defaultWXShareVo=new uniLib.WXShareVo);var i=uniLib.ZQGameSdk.defaultWXShareVo;i.webpageUrl=this.bundleInfo.share_url,uniLib.ZQGameSdk.defaultWXShareVo=i,t.data.deviceToken&&(MJLobby.LobbyDataCache.imei=t.data.deviceToken+":"+this.bundleId),t.imei&&(MJLobby.LobbyDataCache.imei=t.imei),uniLib.Global.is_sandbox=this.bundleInfo.is_sandbox;var n=uniLib.Utils.getLocalStorage("is_sandbox");uniLib.Global.is_sandbox!=Number(n)&&(void 0!=n&&(MJLobby.LobbyResUtil.trace("清除缓存"),uniLib.Utils.clearLocalStorage()),uniLib.Utils.setLocalStorage("is_sandbox",uniLib.Global.is_sandbox)),MJLobby.LobbyResUtil.trace("uniLib.Global.is_sandbox:"+uniLib.Global.is_sandbox),1==uniLib.Global.is_sandbox}this.loadGameResConfig()},e.prototype.onItemLoadError=function(t){console.warn("Url:"+t.resItem.url+" has failed to load")},e.prototype.onResourceLoadError=function(t){MJLobby.LobbyResUtil.trace("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},e.prototype.onResourceProgress=function(t){"mjl_preload"==t.groupName&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},e.prototype.createGameScene=function(){var t=new MJLobby.MJLobbyScene;this.addChild(t)},e.prototype.showLogin=function(){var t;if(uniLib.Global.gameConfig)t=uniLib.Global.gameConfig.gameid;else{var e=RES.getRes("lobbyConfig_json"),i=e["default"];uniLib.Global.defaultConfig=i,t=i.gameid}var n=this;uniLib.Global.isH5&&!uniLib.Global.platId&&(uniLib.Global.platId=129),uniLib.Utils.getCachedPlatInfo(function(t){MJLobby.LobbyResUtil.trace("获取缓存返回："+JSON.stringify(t)),t?(uniLib.Global.initPlatInfo(t.platinfo),n.createGameScene()):uniLib.SceneMgr.instance.changeScene(MJLobby.LobbyLoginPanel)},t,uniLib.Global.platId?uniLib.Global.platId:0)},e.prototype.preloadGame=function(){0==uniLib.Global.isH5?uniLib.ZQGameSdk.init(this.onInitZQGameSkd,this):this.loadGameResConfig()},e.prototype.loadGameResConfig=function(){"true"==uniLib.BrowersUtils.GetRequest("sandbox")&&uniLib.Global.isH5&&(uniLib.Global.is_sandbox=1),MJLobby.MJLobbyData.getInstance().lobbyId=this.lobbyId,game.DataCache.destroyResOnExit=!0,RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onGameConfigComplete,this),RES.loadConfig("resource/gameCommon/gameCommon.res.json","resource/gameCommon/")},e.prototype.onGameConfigComplete=function(){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onGameConfigComplete,this);var t=[];t=["mjl_assets","mjl_assets_self","gameCommon"],MJLobby.LobbyResUtil.trace("onGameConfigComplete:"+t),RES.createGroup("preLoadAll",t);var e=RES.getRes("TableCoreResources_json");uniLib.ResLoadMgr.instance.load("preLoadAll",this.onResourceLoadComplete,this.onResourceLoadError,this,PublicLoadingView,null,null,e)},e.prototype.destory=function(){},e}(egret.DisplayObjectContainer);MJLobbyMain.isConfig=!0,__reflect(MJLobbyMain.prototype,"MJLobbyMain");var MJLobby;!function(t){t.LobbySharePanel.prototype.changeSkin=function(){this.downloadUrl1="https://h5publish.66yy99.cn/down/daliandownload/index.html",this.downloadUrl2="",this.downloadUrl3=""},t.MJLobbyVc.prototype.updateUI=function(){this.weixinJoinqun.visible=!1},t.GoldenPanel.prototype.updateUi=function(){this.helpButton.visible=!1},t.CreatMatchSetPanel.prototype.beforeCreateMatch=function(e){var i=t.MJLobbyData.getInstance().getGameOfficalEventConfigByMatchId(e.roomId);i&&i.eventId&&i.gameId[0]&&(e.createRoom.gameId=i.gameId[0])},t.PublicMethed.showOfficialNumPanel=function(){var e="乐达大连麻将\n官方公众号：ledamj\n客服微信号：leda777777\n或aileda234";t.LobbyPopupManager.showConfirmPanel(e,["确定"],[],"",this)},t.TableHouseListPanel.prototype.updateUI=function(){this.promoteBtn.visible=!1},t.MatchManagePanel.prototype.updateUI=function(){this.withdrawalButton.visible=!1,this.donateHisButton.visible=!1,this.tax.visible=!1,this.cloundBtn.visible=!0},t.MahJongLobbyMediator.prototype.startMusic=function(){1==Number(uniLib.Utils.getLocalStorage("sound_toggle"))||null==uniLib.Utils.getLocalStorage("sound_toggle")?(uniLib.SoundMgr.instance.soundVolume=.7,uniLib.SoundMgr.instance.soundOpen=!0):(uniLib.SoundMgr.instance.soundVolume=0,uniLib.SoundMgr.instance.soundOpen=!1),1==Number(uniLib.Utils.getLocalStorage("music_toggle"))?(uniLib.SoundMgr.instance.musicVolume=.7,uniLib.SoundMgr.instance.musicOpen=!0):(uniLib.SoundMgr.instance.musicVolume=0,uniLib.SoundMgr.instance.musicOpen=!1),uniLib.Utils.setLocalStorage("musicVolume",uniLib.SoundMgr.instance.musicVolume),uniLib.Utils.setLocalStorage("soundVolume",uniLib.SoundMgr.instance.soundVolume),uniLib.SoundMgr.instance.playBgMusic(["bg_mp3"]),uniLib.ZQGameSdk.speakerActive()},t.MJLobbyVc.prototype.onToCoin=function(){t.LobbyPopupManager.showMildWarnShow("敬请期待！")}}(MJLobby||(MJLobby={}));var MJLobby;!function(t){var e=function(e){function o(){var t=e.call(this)||this;return t.skinName=new ActiveRoomSkin,t}return __extends(o,e),Object.defineProperty(o,"Instance",{get:function(){return null==this._instance&&(this._instance=new o),this._instance},enumerable:!0,configurable:!0}),o.prototype.addListener=function(){this.recordButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.recordTap,this),this.closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeHandle,this)},o.prototype.removeListener=function(){this.recordButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.recordTap,this),this.closeButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.closeHandle,this)},o.prototype.destory=function(){this.removeListener()},o.prototype.initUI=function(){this.addListener()},o.prototype.initData=function(t){this.waitList.visible=!1,this.playerGroup.visible=!0,this._activeRoomListOb=t,this.topTableNumber.text="桌号："+this._activeRoomListOb.roomId,t.gid&&this._activeRoomListOb.list[0]&&this._activeRoomListOb.list[0].score?this.recordButton.visible=!0:this.recordButton.visible=!1;var e=t.list&&t.list instanceof Array?t.list:[];this.playerItemList.itemRenderer=n,this.playerItemList.dataProvider=new eui.ArrayCollection(e)},o.prototype.closeHandle=function(e){uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),this.dispatchEventWith(t.LobbyUIEventConsts.CLOSE)},o.prototype.recordTap=function(){uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),t.MJLobbyData.getInstance().globalRoomId=this._activeRoomListOb.gid,this.dispatchEventWith(t.LobbyUIEventConsts.GET_HISTORY_DETAIL_DATA,!1,this._activeRoomListOb.gid)},o.prototype.showWaitList=function(e){this.topTableNumber.text="等待列表",this.waitList.visible=!0,this.playerGroup.visible=!1,this.recordButton.visible=!1,e=null!=e&&e instanceof Array?e:[],this.playerList.itemRenderer=i,this.playerList.dataProvider=new eui.ArrayCollection(e),0==e.length&&t.LobbyPopupManager.showMildWarnShow("当前房间没有等待玩家！")},o}(eui.Component);t.ActiveRoomInformationPanel=e,__reflect(e.prototype,"MJLobby.ActiveRoomInformationPanel");var i=function(e){function i(){var t=e.call(this)||this;return t.skinName=new WaitPlayerItemSkin,t.kickBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onClick,t),t}return __extends(i,e),i.prototype.dataChanged=function(){var e=this.data;this.uid=null!=e.uid?e.uid:0,this.uidLabel.text=null!=e.uid?e.uid+"":"",this.nameLabel.text=null!=e.nickname?e.nickname.slice(0,6):"",this.stateLabel.text=t.DataManage.StateToString(e.state)},i.prototype.onClick=function(){var e=new Cmd.KickLeaveRoomCmd_C;e.roomId=this.data.matchId,e.uid=this.uid,t.LobbyServerMJProxy.getInstance().sendData(e)},i}(eui.ItemRenderer);t.WaitListItem=i,__reflect(i.prototype,"MJLobby.WaitListItem");var n=function(i){function n(){var t=i.call(this)||this;return t.skinName=new ActivePlayerItemSkin,t.kickBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onClick,t),t}return __extends(n,i),n.prototype.dataChanged=function(){var t=this.data;this.playerScore.text=(t.score?t.score:0)+"",this.nickName.text=t.nickname?t.nickname.slice(0,7):"",this.uid=t.uid},n.prototype.onClick=function(){var i=new Cmd.KickLeaveRoomCmd_C;i.roomId=e.Instance._activeRoomListOb.roomId,i.uid=this.uid,t.LobbyServerMJProxy.getInstance().sendData(i)},n}(eui.ItemRenderer);t.ActivePlayerItem=n,__reflect(n.prototype,"MJLobby.ActivePlayerItem")}(MJLobby||(MJLobby={}));