var __reflect=this&&this.__reflect||function(t,e,n){t.__class__=e,n?n.push(e):n=[e],t.__types__=t.__types__?n.concat(t.__types__):n},__extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},game;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.init(),this.addEvent()},e.prototype.init=function(){},e.prototype.addEvent=function(){},e.prototype.removeEvent=function(){},e.prototype.destroy=function(){this.removeEvent()},e}(eui.Component);t.BaseEui=e,__reflect(e.prototype,"game.BaseEui",["game.EuiSkinInt"])}(game||(game={}));var game;!function(t){var e=function(){function e(){this.playCard=new Array,this.playCardValue=new Array}return Object.defineProperty(e,"Instance",{get:function(){return null==this.m_Instance&&(this.m_Instance=new e),this.m_Instance},enumerable:!0,configurable:!0}),e.clearInstance=function(){this.m_Instance=null},e.getCardPoints=function(t){var e=[];if(null==t)return e;for(var n=0,i=t;n<i.length;n++){var a=i[n];e.push(Math.floor(a/100))}return e},Object.defineProperty(e.prototype,"isPlay",{get:function(){var e=this.operateSeatId,i=t.RoomData.Instance.landlordUid,a=t.PokerFunction.GetSeatDataBySeatId(e);if(!a||!a.user)return!0;if(i==a.user.uid)return!0;var r=t.PokerFunction.GetSeatDataByUid(i),o=r?r.seatId:null,s=e-1;s=1>s?s+3:s;var h=this.getPlayCardValue(s);if(null==h)return!0;if(h.cardType==t.CardType.Error_Card)return!0;if(s==o)return!0;var d=this.getCardOperableList(e),l=null==d?null:d[0],u=new n(l),c=u.cardValue.value;return(u.cardType==t.CardType.Single_Card||u.cardType==t.CardType.Double_Card)&&14>c?!0:!1},enumerable:!0,configurable:!0}),e.getCardPoint=function(t){return Math.floor(t/100)},e.prototype.getMainCardByPoint=function(t){var e=this.operateHandCard;if(null!=e)return e.filter(function(e){return Math.floor(e/100)==t})},e.prototype.setPlayCard=function(t,e){this.playCard[t]=e,this.playCardValue[t]=new n(e)},Object.defineProperty(e.prototype,"operationType",{get:function(){var e=this.beforePlayCardValue,n=t.RoomData.Instance.operate,i=null==n?null:n.cardSetList;return e.cardType==t.CardType.Error_Card?t.OperationType.FirstHand:i&&i instanceof Array&&i.length?t.OperationType.Play:t.OperationType.PassOnly},enumerable:!0,configurable:!0}),e.prototype.getPlayCardValue=function(t){return this.playCardValue[t]},Object.defineProperty(e.prototype,"beforePlayCardValue",{get:function(){return this.getBeforePlayCardValue(this.operateSeatId)},enumerable:!0,configurable:!0}),e.prototype.getBeforePlayCardValue=function(e){var i=e-1;i=1>i?i+3:i;var a=this.operateSeatId-2;a=1>a?a+3:a;var r=this.playCardValue,o=r[i]&&r[i].cardType!=t.CardType.Error_Card?r[i]:r[a];return o?o:new n(null)},e.prototype.clearPlayCard=function(){this.playCard.clear(),this.playCardValue.clear()},Object.defineProperty(e.prototype,"operateHandCard",{get:function(){var e=t.PokerFunction.GetSeatDataBySeatId(this.operateSeatId);if(null!=e)return e.handCards},enumerable:!0,configurable:!0}),e.prototype.getCardOperableList=function(e){this.operateSeatId=e,this.handCardAnalysis=new n(this.operateHandCard);var i,a=this.beforePlayCardValue;switch(a.cardType){case t.CardType.Single_Card:i=this.single();break;case t.CardType.Double_Card:i=this["double"]();break;case t.CardType.Three_Card:i=this.three();break;case t.CardType.ThreeOne_Card:i=this.threeOne();break;case t.CardType.ThreeTwo_Card:i=this.threeTwo();break;case t.CardType.Bomb_Card:i=this.bomb();break;case t.CardType.KingBomb_Card:break;case t.CardType.Four_TwoSingle_Card:i=this.fourTwoSingle();break;case t.CardType.Four_TwoDouble_Card:i=this.fourTwoDouble();break;case t.CardType.Feiji_Card:i=this.feiji();break;case t.CardType.Feiji_TwoSingle_Card:i=this.feijiTwoSingle();break;case t.CardType.Feiji_TwoDouble_Card:i=this.feijiTwoDouble();break;case t.CardType.Lian_Card:i=this.lian();break;case t.CardType.Double_Lian_Card:i=this.doubleLian();break;case t.CardType.Error_Card:i=this.firstHand()}return this.cardSetList=i,i},e.prototype.firstHand=function(){var e=this.handCardAnalysis,n=new Array;e.cardType!=t.CardType.Error_Card&&n.push(this.operateHandCard);for(var i=0,a=e.singles;i<a.length;i++){var r=a[i];n.push(this.getMainCardByPoint(r))}for(var o=0,s=e.doubles;o<s.length;o++){var r=s[o];n.push(this.getMainCardByPoint(r))}for(var h=function(t){var i=d.getMainCardByPoint(t);if(e.singleLength>0){var a=d.getMainCardByPoint(e.singles[0]);n.push(i.concat(a))}if(e.doublesLength>0){var r=d.getMainCardByPoint(e.doubles[0]);n.push(i.concat(r))}if(e.threesLength>1){var o=d.getMainCardByPoint(e.threes.first(function(e){return e!=t}));n.push(i.concat([o[0]]))}n.push(i)},d=this,l=0,u=e.threes;l<u.length;l++){var r=u[l];h(r)}for(var c=0,p=e.fours;c<p.length;c++){var r=p[c],m=this.getMainCardByPoint(r);if(n.push(m),e.singleLength>0){var g=this.getMainCardByPoint(e.singles[0]);n.push(m.concat(g))}if(e.doublesLength>0){var f=this.getMainCardByPoint(e.doubles[0]);n.push(m.concat(f))}}if(e.maxLian&&e.maxLian.length>0)for(var C=0,y=e.maxLian;C<y.length;C++){for(var r=y[C],v=new Array,_=0,b=r;_<b.length;_++){var T=b[_],L=this.getMainCardByPoint(T);v.push(L[0])}n.push(v)}if(e.maxDoubleLian&&e.maxDoubleLian.length>0)for(var I=0,E=e.maxDoubleLian;I<E.length;I++){for(var r=E[I],v=new Array,D=0,P=r;D<P.length;D++){var T=P[D],L=this.getMainCardByPoint(T);v.push(L[0]),v.push(L[1])}n.push(v)}if(e.kingBomb&&e.kingBomb.length>0){for(var S=new Array,B=0,k=e.kingBomb;B<k.length;B++){var r=k[B],w=this.getMainCardByPoint(r);S=S.concat(w)}n.push(S)}return n.sort(function(t,e){return t[0]-e[0]}),n},e.prototype.single=function(){for(var t=this.handCardAnalysis,e=new Array,n=this.beforePlayCardValue.cardValue.value,i=0,a=t.singles;i<a.length;i++){var r=a[i];r>n&&e.push(this.getMainCardByPoint(r))}for(var o=0,s=t.doubles;o<s.length;o++){var r=s[o];if(r>n){var h=this.getMainCardByPoint(r).first();e.push([h])}}for(var d=0,l=t.threes;d<l.length;d++){var r=l[d];if(r>n){var h=this.getMainCardByPoint(r).first();e.push([h])}}for(var u=0,c=t.fours;u<c.length;u++){var r=c[u],p=this.getMainCardByPoint(r);e.push(p)}if(t.kingBomb&&t.kingBomb.length>0){for(var m=new Array,g=0,f=t.kingBomb;g<f.length;g++){var r=f[g],C=this.getMainCardByPoint(r);m=m.concat(C)}e.push(m)}return e},e.prototype["double"]=function(){for(var t=this.handCardAnalysis,e=new Array,n=this.beforePlayCardValue.cardValue.value,i=0,a=t.doubles;i<a.length;i++){var r=a[i];r>n&&e.push(this.getMainCardByPoint(r))}for(var o=0,s=t.threes;o<s.length;o++){var r=s[o];if(r>n){var h=this.getMainCardByPoint(r);h.removeAt(2),e.push(h)}}for(var d=0,l=t.fours;d<l.length;d++){var r=l[d],u=this.getMainCardByPoint(r);if(e.push(u),r>n){var h=this.getMainCardByPoint(r);h.removeAt(2),h.removeAt(3),e.push(h)}}if(t.kingBomb&&t.kingBomb.length>0){for(var c=new Array,p=0,m=t.kingBomb;p<m.length;p++){var r=m[p],g=this.getMainCardByPoint(r);c=c.concat(g)}e.push(c)}return e},e.prototype.three=function(){for(var t=this.handCardAnalysis,e=new Array,n=this.beforePlayCardValue.cardValue.value,i=0,a=t.threes;i<a.length;i++){var r=a[i];r>n&&e.push(this.getMainCardByPoint(r))}for(var o=0,s=t.fours;o<s.length;o++){var r=s[o],h=this.getMainCardByPoint(r);if(e.push(h),r>n){var d=this.getMainCardByPoint(r);d.removeAt(3),e.push(d)}}if(t.kingBomb&&t.kingBomb.length>0){for(var l=new Array,u=0,c=t.kingBomb;u<c.length;u++){var r=c[u],p=this.getMainCardByPoint(r);l=l.concat(p)}e.push(l)}return e},e.prototype.threeOne=function(){for(var t=this.handCardAnalysis,e=new Array,n=this.beforePlayCardValue.cardValue.value,i=function(i){if(i>n){var r=a.getMainCardByPoint(i);if(t.singleLength>0){var o=a.getMainCardByPoint(t.singles[0]);e.push(r.concat(o))}if(t.doublesLength>0){var s=a.getMainCardByPoint(t.doubles[0]);e.push(r.concat([s[0]]))}if(t.threesLength>1){var h=a.getMainCardByPoint(t.threes.first(function(t){return t!=i}));e.push(r.concat([h[0]]))}}},a=this,r=0,o=t.threes;r<o.length;r++){var s=o[r];i(s)}for(var h=0,d=t.fours;h<d.length;h++){var s=d[h],l=this.getMainCardByPoint(s);e.push(l)}if(t.kingBomb&&t.kingBomb.length>0){for(var u=new Array,c=0,p=t.kingBomb;c<p.length;c++){var s=p[c],m=this.getMainCardByPoint(s);u=u.concat(m)}e.push(u)}return e},e.prototype.threeTwo=function(){for(var t=this.handCardAnalysis,e=new Array,n=this.beforePlayCardValue.cardValue.value,i=function(i){if(i>n){var r=a.getMainCardByPoint(i);if(t.doublesLength>0){var o=a.getMainCardByPoint(t.doubles[0]);e.push(r.concat(o))}if(t.threesLength>1){var s=a.getMainCardByPoint(t.threes.first(function(t){return t!=i}));e.push(r.concat([s[0],s[1]]))}if(t.foursLength>0){var h=a.getMainCardByPoint(t.fours[0]);e.push(r.concat([h[0],h[1]]))}}},a=this,r=0,o=t.threes;r<o.length;r++){var s=o[r];i(s)}for(var h=0,d=t.fours;h<d.length;h++){var s=d[h],l=this.getMainCardByPoint(s);e.push(l)}if(t.kingBomb&&t.kingBomb.length>0){for(var u=new Array,c=0,p=t.kingBomb;c<p.length;c++){var s=p[c],m=this.getMainCardByPoint(s);u=u.concat(m)}e.push(u)}return e},e.prototype.bomb=function(){for(var t=this.handCardAnalysis,e=new Array,n=this.beforePlayCardValue.cardValue.value,i=0,a=t.fours;i<a.length;i++){var r=a[i];if(r>n){var o=this.getMainCardByPoint(r);e.push(o)}}if(t.kingBomb&&t.kingBomb.length>0){for(var s=new Array,h=0,d=t.kingBomb;h<d.length;h++){var r=d[h],l=this.getMainCardByPoint(r);s=s.concat(l)}e.push(s)}return e},e.prototype.fourTwoSingle=function(){for(var t=this.handCardAnalysis,e=new Array,n=this.beforePlayCardValue.cardValue.value,i=0,a=t.fours;i<a.length;i++){var r=a[i];if(!(n>r)){var o=this.getMainCardByPoint(r);if(e.push(o),t.singleLength>1){var s=this.getMainCardByPoint(t.singles[0]),h=this.getMainCardByPoint(t.singles[1]);e.push(o.concat(s).concat(h))}else if(t.doublesLength>0){var d=this.getMainCardByPoint(t.doublesLength[0]);e.push(o.concat(d))}}}if(t.kingBomb&&t.kingBomb.length>0){for(var l=new Array,u=0,c=t.kingBomb;u<c.length;u++){var r=c[u],p=this.getMainCardByPoint(r);l=l.concat(p)}e.push(l)}return e},e.prototype.fourTwoDouble=function(){for(var t=this.handCardAnalysis,e=new Array,n=this.beforePlayCardValue.cardValue.value,i=0,a=t.fours;i<a.length;i++){var r=a[i];if(!(n>r)){var o=this.getMainCardByPoint(r);if(e.push(o),t.doublesLength>1){var s=this.getMainCardByPoint(t.doublesLength[0]),h=this.getMainCardByPoint(t.doublesLength[1]);e.push(o.concat(s).concat(h))}}}if(t.kingBomb&&t.kingBomb.length>0){for(var d=new Array,l=0,u=t.kingBomb;l<u.length;l++){var r=u[l],c=this.getMainCardByPoint(r);d=d.concat(c)}e.push(d)}return e},e.prototype.feiji=function(){var t=this.handCardAnalysis,e=new Array,n=this.beforePlayCardValue.cardValue.value,i=this.beforePlayCardValue.cardValue.length;if(9==i&&t.threesLength>2)for(var a=0;a<t.threesLength;a++){var r=t.threes[a],o=t.threes[a+1],s=t.threes[a+2];if(!(n>r)&&o&&r-o==-1&&s&&o-s==-1){var h=this.getMainCardByPoint(r),d=this.getMainCardByPoint(o),l=this.getMainCardByPoint(s);e.push(h.concat(d).concat(l))}}else if(6==i&&t.threesLength>1)for(var a=0;a<t.threesLength;a++){var r=t.threes[a],o=t.threes[a+1];if(!(n>r||o||r-o!=-1)){var h=this.getMainCardByPoint(r),d=this.getMainCardByPoint(o);e.push(h.concat(d))}}for(var u=0,c=t.fours;u<c.length;u++){var r=c[u],p=this.getMainCardByPoint(r);e.push(p)}if(t.kingBomb&&t.kingBomb.length>0){for(var m=new Array,g=0,f=t.kingBomb;g<f.length;g++){var r=f[g],C=this.getMainCardByPoint(r);m=m.concat(C)}e.push(m)}return e},e.prototype.feijiTwoSingle=function(){var t=this.handCardAnalysis,e=new Array,n=this.beforePlayCardValue.cardValue.value,i=this.beforePlayCardValue.cardValue.length;if(12==i&&t.threesLength>2)for(var a=this.operateHandCard,r=function(i){var r=t.threes[i],s=t.threes[i+1],h=t.threes[i+2];if(n>r||!s||r-s!=-1||!h||s-h!=-1)return"continue";var d=o.getMainCardByPoint(r),l=o.getMainCardByPoint(s),u=o.getMainCardByPoint(h);if(t.singleLength>2){var c=o.getMainCardByPoint(t.singles[0]),p=o.getMainCardByPoint(t.singles[1]),m=o.getMainCardByPoint(t.singles[2]);e.push(d.concat(l).concat(u).concat(c).concat(p).concat(m))}else{var g=a.filter(function(t){return d.seek(function(e){return e!=t})&&l.seek(function(e){return e!=t})&&u.seek(function(e){return e!=t})});g.length>3&&e.push(d.concat(l).concat(u).concat([g[0],g[1],g[2]]))}},o=this,s=0;s<t.threesLength;s++)r(s);else if(8==i&&t.threesLength>1)for(var s=0;s<t.threesLength;s++){var h=t.threes[s],d=t.threes[s+1];if(!(n>h)&&d&&h-d==-1){var l=this.getMainCardByPoint(h),u=this.getMainCardByPoint(d);if(t.singleLength>1){var c=this.getMainCardByPoint(t.singles[0]),p=this.getMainCardByPoint(t.singles[1]);e.push(l.concat(u).concat(c).concat(p))}else if(t.doublesLength>0){var m=this.getMainCardByPoint(t.doubles[0]);e.push(l.concat(u).concat(m))}}}for(var g=0,f=t.fours;g<f.length;g++){var h=f[g],C=this.getMainCardByPoint(h);e.push(C)}if(t.kingBomb&&t.kingBomb.length>0){for(var y=new Array,v=0,_=t.kingBomb;v<_.length;v++){var h=_[v],b=this.getMainCardByPoint(h);y=y.concat(b)}e.push(y)}return e},e.prototype.feijiTwoDouble=function(){var t=this.handCardAnalysis,e=new Array,n=this.beforePlayCardValue.cardValue.value,i=this.beforePlayCardValue.cardValue.length;if(15==i&&t.threesLength>2)for(var a=function(i){var a=t.threes[i],o=t.threes[i+1],s=t.threes[i+2];if(n>a||!o||a-o!=-1||!s||o-s!=-1)return"continue";var h=r.getMainCardByPoint(a),d=r.getMainCardByPoint(o),l=r.getMainCardByPoint(s);if(t.doublesLength>2){var u=r.getMainCardByPoint(t.doubles[0]),c=r.getMainCardByPoint(t.doubles[1]),p=r.getMainCardByPoint(t.doubles[1]);e.push(h.concat(d).concat(l).concat(u).concat(c).concat(p))}else if(t.doublesLength+t.threesLength>5){for(var m=[],g=0,f=t.doubles;g<f.length;g++){var C=f[g],y=r.getMainCardByPoint(C[0]);m.concat(y)}for(var v=t.threes.filter(function(t){return t!=a&&t!=o&&t!=s}),_=0,b=v;_<b.length;_++){var T=b[_],L=r.getMainCardByPoint(T[0]);m.concat([L[0],L[1]])}m.splice(0,6),e.push(h.concat(d).concat(l).concat(m))}},r=this,o=0;o<t.threesLength;o++)a(o);else if(11==i&&t.threesLength>1)for(var o=0;o<t.threesLength;o++){var s=t.threes[o],h=t.threes[o+1];if(!(n>s)&&h&&s-h==-1){var d=this.getMainCardByPoint(s),l=this.getMainCardByPoint(h);if(t.doublesLength>1){var u=this.getMainCardByPoint(t.doubles[0]),c=this.getMainCardByPoint(t.doubles[1]);e.push(d.concat(l).concat(u).concat(c))}}}for(var p=0,m=t.fours;p<m.length;p++){var s=m[p],g=this.getMainCardByPoint(s);e.push(g)}if(t.kingBomb&&t.kingBomb.length>0){for(var f=new Array,C=0,y=t.kingBomb;C<y.length;C++){var s=y[C],v=this.getMainCardByPoint(s);f=f.concat(v)}e.push(f)}return e},e.prototype.lian=function(){for(var t=this.handCardAnalysis,e=new Array,n=this.beforePlayCardValue.cardValue,i=0,a=t.maxLian;i<a.length;i++){var r=a[i],o=r.length-n.length;if(!(r[r.length-1]-n.value<=0||0>o)){for(var s=0;o>=s;s++){var h=r.length-1-s;if(!(r[h]<=n.value)){for(var d=new Array,l=h;l>h-n.length;l--){var u=this.getMainCardByPoint(r[l]);d.push(u[0])}e.push(d)}}e.sort(function(t,e){return t[0]-e[0]})}}for(var c=0,p=t.fours;c<p.length;c++){var r=p[c],m=this.getMainCardByPoint(r);e.push(m)}if(t.kingBomb&&t.kingBomb.length>0){for(var g=new Array,f=0,C=t.kingBomb;f<C.length;f++){var r=C[f],y=this.getMainCardByPoint(r);g=g.concat(y)}e.push(g)}return e},e.prototype.doubleLian=function(){for(var t=this.handCardAnalysis,e=new Array,n=this.beforePlayCardValue.cardValue,i=0,a=t.maxDoubleLian;i<a.length;i++){var r=a[i],o=r.length-n.length;if(!(r[r.length-1]-n.value<=0||0>o)){for(var s=0;o>=s;s++){var h=r.length-1-s;if(!(r[h]<=n.value)){for(var d=new Array,l=h;l>h-n.length;l--){var u=this.getMainCardByPoint(r[l]);d.push(u[0]),d.push(u[1])}e.push(d)}}e.sort(function(t,e){return t[0]-e[0]})}}for(var c=0,p=t.fours;c<p.length;c++){var r=p[c],m=this.getMainCardByPoint(r);e.push(m)}if(t.kingBomb&&t.kingBomb.length>0){for(var g=new Array,f=0,C=t.kingBomb;f<C.length;f++){var r=C[f],y=this.getMainCardByPoint(r);g=g.concat(y)}e.push(g)}return e},e}();e.SmallKingPoint=20,e.LargeKingPoint=21,t.DDZAI=e,__reflect(e.prototype,"game.DDZAI");var n=function(){function n(t){this.m_singles=new Array,this.m_dobles=new Array,this.m_threes=new Array,this.m_fours=new Array,this.m_kingBomb=new Array,this.m_maxLian=new Array,this.m_maxDoubleLian=new Array,this.cardList=t,this.m_points=e.getCardPoints(t),this.m_points&&this.m_points.sort(function(t,e){return t-e}),this.initCardValue(),this.line(),this.doubleLine(),this.checkKingBomb()}return Object.defineProperty(n.prototype,"points",{get:function(){return this.m_points},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"singles",{get:function(){return this.m_singles},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"singleLength",{get:function(){return this.m_singles.length},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"doubles",{get:function(){return this.m_dobles},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"doublesLength",{get:function(){return this.m_dobles.length},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"threes",{get:function(){return this.m_threes},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"threesLength",{get:function(){return this.m_threes.length},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"fours",{get:function(){return this.m_fours},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"foursLength",{get:function(){return this.m_fours.length},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"kingBomb",{get:function(){return this.m_kingBomb},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"maxLian",{get:function(){return this.m_maxLian},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"maxDoubleLian",{get:function(){return this.m_maxDoubleLian},enumerable:!0,configurable:!0}),n.prototype.initCardValue=function(){for(var t=this.points,e=0;e<t.length;){for(var n=0,i=e;i<t.length;i++)t[e]==t[i]&&n++;1==n?this.m_singles.push(t[e]):2==n?this.m_dobles.push(t[e]):3==n?this.m_threes.push(t[e]):4==n&&this.m_fours.push(t[e]),e+=n}},n.prototype.line=function(){var t=this.points,e=t.distinct();if(e&&!(e.length<5)){var n=new Array,i=0;n[i]=new Array;for(var a=0;a<e.length-1;a++){var r=e[a],o=e[a+1];r-o==-1?n[i].push(r):(n[i].length>3&&n[i].push(r),n[i].length<5?n[i].clear():(i++,n[i]=new Array))}n[i]&&n[i].length>3&&e[e.length-2]-e[e.length-1]==-1?n[i].push(e[e.length-1]):n.removeAt(i),this.m_maxLian=n}},n.prototype.doubleLine=function(){var t=this.doubles,e=t.distinct();if(e&&!(e.length<3)){var n=new Array,i=0;n[i]=new Array;for(var a=0;a<e.length-1;a++){var r=e[a],o=e[a+1];r-o==-1?n[i].push(r):(n[i].length>1&&n[i].push(r),n[i].length<3?n[i].clear():(i++,n[i]=new Array))}n[i]&&n[i].length>1&&e[e.length-2]-e[e.length-1]==-1?n[i].push(e[e.length-1]):n.removeAt(i),this.m_maxDoubleLian=n}},n.prototype.checkKingBomb=function(){for(var t=!1,n=!1,i=0,a=this.points;i<a.length;i++){var r=a[i];r==e.SmallKingPoint&&(t=!0),r==e.LargeKingPoint&&(n=!0)}t&&n&&(this.m_kingBomb.push(e.SmallKingPoint),this.m_kingBomb.push(e.LargeKingPoint))},n.prototype.checkContinuous=function(){if(0!=this.foursLength||0!=this.threesLength||0!=this.doublesLength||this.singleLength<5)return!1;for(var t,e=0,n=this.singles;e<n.length;e++){var i=n[e];if(t-i!=-1)return!1;t=i}return!0},n.prototype.checkDoubleContinuous=function(){if(0!=this.foursLength||0!=this.threesLength||this.doublesLength<3||0!=this.singleLength)return!1;for(var t,e=0,n=this.doubles;e<n.length;e++){var i=n[e];if(t-i!=-1)return!1;t=i}return!0},Object.defineProperty(n.prototype,"cardType",{get:function(){return this.cardValue.type},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"cardValue",{get:function(){return null==this.m_cardValue&&(this.m_cardValue=this.getCardValue()),this.m_cardValue},enumerable:!0,configurable:!0}),n.prototype.getCardValue=function(){var n=new i,a=this.cardList;if(null==a||0==a.length)return n.type=t.CardType.Error_Card,n;var r=a.length;if(1==r)return n.type=t.CardType.Single_Card,n.value=this.singles[0],n;if(2==r){if(2==this.singleLength&&this.singles[0]==e.SmallKingPoint&&this.singles[1]==e.LargeKingPoint)return n.type=t.CardType.KingBomb_Card,n.value=e.LargeKingPoint,n;if(1==this.doublesLength)return n.type=t.CardType.Double_Card,n.value=this.doubles[0],n}if(3==r&&1==this.threesLength)return n.type=t.CardType.Three_Card,n.value=this.threes[0],n;if(4==r){if(1==this.foursLength)return n.type=t.CardType.Bomb_Card,n.value=this.fours[0],n;if(1==this.threesLength)return n.type=t.CardType.ThreeOne_Card,n.value=this.threes[0],n}if(5==r&&1==this.threesLength&&1==this.doublesLength)return n.type=t.CardType.ThreeTwo_Card,n.value=this.threes[0],n;if(6==r){if(1==this.foursLength&&(2==this.singleLength||1==this.doublesLength))return n.type=t.CardType.Four_TwoSingle_Card,n.value=this.fours[0],n;if(2==this.threesLength&&this.threes[0]-this.threes[1]==-1)return n.type=t.CardType.Feiji_Card,n.length=r,n.value=this.threes[1],n}if(8==r){if(1==this.foursLength&&2==this.doublesLength)return n.type=t.CardType.Four_TwoSingle_Card,n.value=this.fours[0],n;if(2==this.threesLength&&this.threes[0]-this.threes[1]==-1&&(2==this.singleLength||1==this.doublesLength))return n.type=t.CardType.Feiji_TwoSingle_Card,n.length=r,n.value=this.threes[1],n}return 10==r&&2==this.threesLength&&this.threes[0]-this.threes[1]==-1&&2==this.doublesLength?(n.type=t.CardType.Feiji_TwoDouble_Card,n.length=r,n.value=this.threes[1],n):9==r&&3==this.threesLength&&this.threes[0]-this.threes[1]==-1&&this.threes[1]-this.threes[2]==-1?(n.type=t.CardType.Feiji_Card,n.length=r,n.value=this.threes[2],n):12==r&&3==this.threesLength&&this.threes[0]-this.threes[1]==-1&&this.threes[1]-this.threes[2]==-1?(n.type=t.CardType.Feiji_TwoSingle_Card,n.length=r,n.value=this.threes[2],n):15==r&&3==this.threesLength&&this.threes[0]-this.threes[1]==-1&&this.threes[1]-this.threes[2]==-1?(n.type=t.CardType.Feiji_TwoDouble_Card,n.length=r,n.value=this.threes[2],n):this.threesLength>3?(n.type=t.CardType.Feiji_Card,n.length=r,n.value=this.threes[2],n):this.maxLian&&this.maxLian.length>0&&this.maxLian[0].length>4&&this.maxLian[0].length==this.cardList.length?(n.type=t.CardType.Lian_Card,n.length=this.maxLian[0].length,n.value=this.maxLian[0][this.maxLian[0].length-1],n):this.maxDoubleLian&&this.maxDoubleLian.length>0&&this.maxDoubleLian[0].length>2&&2*this.maxDoubleLian[0].length==this.cardList.length?(n.type=t.CardType.Double_Lian_Card,n.length=this.maxDoubleLian[0].length,n.value=this.maxDoubleLian[0][this.maxDoubleLian[0].length-1],n):(n.type=t.CardType.Error_Card,n)},n}();t.CardAnalysis=n,__reflect(n.prototype,"game.CardAnalysis");var i=function(){function t(){}return t}();t.CardValue=i,__reflect(i.prototype,"game.CardValue")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return Object.defineProperty(e,"Instance",{get:function(){return null==this.m_Instance&&(this.m_Instance=new e),this.m_Instance},enumerable:!0,configurable:!0}),e.clearInstance=function(){egret.clearTimeout(this.timeId),this.m_Instance=null},e.prototype.initCardList=function(){this.CardList=[];for(var t=3;15>t;t++)for(var e=100*t,n=1;5>n;n++){var i=e+10*n;i+=1,this.CardList.push(i)}this.CardList.push(1611),this.CardList.push(1621),this.CardList.push(1631),this.CardList.push(1641),this.CardList.push(2051),this.CardList.push(2151)},e.prototype.initUser=function(){var t="",e=MJLobby.MJLobbyData.getInstance().myBaseInfo;e&&(t=e.headUrl),uniLib.NetMgr.UID=111111;var n={roomData:{seatList:[{handCardList:{},seatId:1,isReady:!1,role:{diamond:100,seatId:1,gender:"男",onlineState:0,name:"1401304",headurl:t,uid:uniLib.NetMgr.UID,points:0,ip:"36.47.160.36"},outCardList:{}},{handCardList:{},seatId:2,isReady:!0,role:{diamond:100,seatId:2,gender:"男",onlineState:0,name:"电脑",headurl:"http://img.bwgame.com.cn/img/230.jpg",uid:1401306,points:0,ip:"36.47.160.35"},outCardList:{}},{handCardList:{},seatId:3,isReady:!0,role:{diamond:100,seatId:3,gender:"男",onlineState:0,name:"电脑",headurl:"http://img.bwgame.com.cn/img/231.jpg",uid:1401308,points:0,ip:"36.47.160.35"},outCardList:{}}],roomId:"练习场",props:{}}};Cmd.OnRoomDataUpdateCmd_S(n)},e.prototype.deal=function(){for(var e=0,n=t.RoomData.Instance.seatList;e<n.length;e++){var i=n[e];i.clearHandCard()}t.RoomData.Instance.landlordUid=null,t.RoomData.Instance.startGame=!0;for(var a=this.CardList,r=function(t){var e=a.randomItems(17);e.sort(function(t,e){return e-t});for(var n=0,i=e;n<i.length;n++){var r=i[n];t.addHandCard(r)}a=a.filter(function(t){return!e.seek(function(e){return e==t})})},o=0,s=t.RoomData.Instance.seatList;o<s.length;o++){var i=s[o];r(i)}this.threeCard=a,GX.PokerEvent.Instance.dealCardAnimation.call(),egret.setTimeout(this.landlordRob,this,2550)},e.prototype.landlordRob=function(){for(var e=0,n=t.RoomData.Instance.seatList;e<n.length;e++){var i=n[e];if(i.user.uid!=uniLib.NetMgr.UID){var a=new Cmd.LandlordRobCmd_CS;a.uid=i.user.uid,a.yesOrNo=!1,Cmd.OnLandlordRobCmd_CS(a)}}var r=new t.RobLordOperateData;r.uid=uniLib.NetMgr.UID,r.endTime=Date.now()+3e4,t.RoomData.Instance.robLordOperate=r},e.prototype.roundResultCmd=function(e){var n=new Cmd.RoundResultCmd_S;n.resultList=[];for(var i=0,a=t.RoomData.Instance.seatList;i<a.length;i++){var r=a[i],o=new Cmd.GameObjectData,s=new Cmd.UserBriefInfo;s.headurl=r.user.headUrl,s.name=r.user.nickName,s.uid=r.user.uid,s.point=0,o.user=s,o.profit=0,o.multiple=0,n.haveNextRound=!0,n.resultList.push(o)}n.landlord=t.RoomData.Instance.landlordUid,n.winnerList=[e],Cmd.OnRoundResultCmd_S(n)},e.prototype.tcpSend=function(e){var n=this,i=uniLib.NetMgr.UID;if("Cmd.DissolveRoomRequestCmd_C"==e.GetType())Cmd.OnLeaveRoomCmd_CS(e);else if("Cmd.LeaveRoomCmd_CS"==e.GetType())Cmd.OnLeaveRoomCmd_CS(e);else if("Cmd.ReadyUpdateRoomCmd_CS"==e.GetType()){var a=e;a.uid=i,a.yesOrNo=!0,Cmd.OnReadyUpdateRoomCmd_CS(a);for(var r=0,o=t.RoomData.Instance.seatList;r<o.length;r++){var s=o[r];s.isReady=!0}this.deal()}else if("Cmd.PlayCardCmd_CS"==e.GetType()){var a=e;a.uid=i;var h=new t.CardAnalysis(a.cardList);if(a.cardList&&h.cardType==t.CardType.Error_Card)return;Cmd.OnPlayCardCmd_CS(a);var d=this.getCardTypeTime(a.cardList);if(0==t.PokerFunction.MainSeat.handCards.length)return void egret.setTimeout(function(){return n.roundResultCmd(i)},this,d);egret.setTimeout(this.playerAI,this,d)}else if("Cmd.LandlordRobCmd_CS"==e.GetType()){var a=e;if(a.yesOrNo){var l=new Cmd.LandlordRobCmd_CS;l.uid=i,l.yesOrNo=!0,Cmd.OnLandlordRobCmd_CS(l);var u=new Cmd.LandlordUpdateCmd_S;u.uid=i,u.threeCard=this.threeCard,Cmd.OnLandlordUpdateCmd_S(u);var c=new Cmd.NewOperateSeatCmd_S;c.seatId=1,c.endTime=Date.now()+3e4,egret.setTimeout(function(){return Cmd.OnNewOperateSeatCmd_S(c)},this,1e3)}else this.deal()}},e.prototype.playerAI=function(){var n=this,i=new Cmd.NewOperateSeatCmd_S;i.seatId=2,i.endTime=Date.now()+3e4,Cmd.OnNewOperateSeatCmd_S(i);var a=(uniLib.NetMgr.UID,t.RoomData.Instance.seatList,t.DDZAI.Instance.getCardOperableList(2)),r=null==a?null:a[0];e.timeId=egret.setTimeout(function(){var e=new Cmd.PlayCardCmd_CS;t.PokerFunction.GetUserInfoBySeatId(2)&&(e.uid=t.PokerFunction.GetUserInfoBySeatId(2).uid),t.DDZAI.Instance.isPlay?e.cardList=r:e.cardList=[],Cmd.OnPlayCardCmd_CS(e);var i=n.getCardTypeTime(e.cardList);return t.PokerFunction.GetSeatDataBySeatId(2)&&0==t.PokerFunction.GetSeatDataBySeatId(2).handCards.length?void egret.setTimeout(function(){return n.roundResultCmd(e.uid)},n,i):void egret.setTimeout(function(){var e=new Cmd.NewOperateSeatCmd_S;e.seatId=3,e.endTime=Date.now()+3e4,Cmd.OnNewOperateSeatCmd_S(e),a=t.DDZAI.Instance.getCardOperableList(3),r=null==a?null:a[0],i+=n.getCardTypeTime(r),egret.setTimeout(function(){var e=new Cmd.PlayCardCmd_CS;if(t.PokerFunction.GetUserInfoBySeatId(3)&&(e.uid=t.PokerFunction.GetUserInfoBySeatId(3).uid),t.DDZAI.Instance.isPlay?e.cardList=r:e.cardList=[],Cmd.OnPlayCardCmd_CS(e),t.PokerFunction.GetSeatDataBySeatId(3)&&0==t.PokerFunction.GetSeatDataBySeatId(3).handCards.length)return void egret.setTimeout(function(){return n.roundResultCmd(e.uid)},n,i);var a=new Cmd.NewOperateSeatCmd_S;a.seatId=1,a.endTime=Date.now()+3e4,egret.setTimeout(function(){return Cmd.OnNewOperateSeatCmd_S(a)},n,i)},n,2e3)},n,i)},this,2e3)},e.prototype.getCardTypeTime=function(e){var n=new t.CardAnalysis(e).cardType;switch(n){case t.CardType.Error_Card:return 0;case t.CardType.Single_Card:case t.CardType.Double_Card:case t.CardType.Lian_Card:return 500;default:return 1500}},e}();t.DDZStandAlone=e,__reflect(e.prototype,"game.DDZStandAlone")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return Object.defineProperty(e,"Instance",{get:function(){return null==this.m_Instance&&(this.m_Instance=new e),this.m_Instance},enumerable:!0,configurable:!0}),e.prototype.warningEffect=function(){if(this.warnArmature)return this.warnArmature.display;var t=uniLib.DisplayUtils.createDragonBonesDisplay("doudizhu_jingbao_effect_ske_json","doudizhu_jingbao_effect_tex_json","doudizhu_jingbao_effect_tex_png","MovieClip");return dragonBones.WorldClock.clock.add(t),this.warnArmature=t,t.display},e.prototype.stopWarning=function(){null!=this.warnArmature&&this.warnArmature.animation.stop()},e.prototype.playWarning=function(){null!=this.warnArmature&&this.warnArmature.animation.play("jingbaoqi")},e.prototype.addCardAnimation=function(e){1==e?this.dealCardAnimation():t.RoomData.Instance.shuffleUid&&1!=t.RoomInfo.getInstance().video?(uniLib.SetUniEventTimeout(t.GameView.Instance,function(){t.EffectCreate.Instance.addShuffleMc(t.RoomData.Instance.shuffleUid)},500,1,this,null),uniLib.SetUniEventTimeout(t.GameView.Instance,function(){t.EffectCreate.Instance.removeShuffleMc(),this.dealCardAnimation()},t.GameConstant.shuffleTime,1,this,null)):this.dealCardAnimation()},e.prototype.cardTypeEffect=function(){if(this.cardTypeArmature)return this.cardTypeArmature.display;var t=uniLib.DisplayUtils.createDragonBonesDisplay("doudizhu_paixing_effect_ske_json","doudizhu_paixing_effect_tex_json","doudizhu_paixing_effect_tex_png","MovieClip");return dragonBones.WorldClock.clock.add(t),this.cardTypeArmature=t,this.cardTypeArmature.addEventListener(dragonBones.AnimationEvent.LOOP_COMPLETE,this.onAnimationComplete,this),t.display},e.prototype.stopCardType=function(){null!=this.cardTypeArmature&&this.cardTypeArmature.animation.stop()},e.prototype.playCardType=function(e,n){if(null!=this.cardTypeArmature){var i=this.getEffectByCardType(e,n);if(null==i)return void this.onAnimationComplete();(e==t.CardType.Bomb_Card||e==t.CardType.KingBomb_Card)&&ShakeTool.Instance.shakeObj(t.GameInfo.uiLayer,.5,60,5),this.cardTypeArmature.animation.play(i,1)}},e.prototype.playChuntian=function(){this.cardTypeArmature.animation.play("chuntian",1)},e.prototype.playFanChun=function(){this.cardTypeArmature.animation.play("fanchun",1)},e.prototype.onAnimationComplete=function(){var t=this.cardTypeArmature.display;t.parent&&t.parent.removeChild(t)},e.prototype.callCardAnimation=function(e,n,i){t.OperateLayer.Instance.sCard;if(null!=e&&null!=n&&null!=i){var a=t.GameConstant.GetClientNoByUid(i),r=t.GameConstant.seatPosArr[a];if(null!=r){var o=t.PokerFunction.MainSeat.handCards.first(function(t){return t==n});i==uniLib.NetMgr.UID&&null!=o?egret.Tween.get(e).wait(800).to({scaleX:1.5,scaleY:1.5,y:t.GameConstant.HandCardY},800,egret.Ease.sineOut).call(function(){t.OperateLayer.Instance.removeCallCard()}):egret.Tween.get(e).wait(800).to({scaleX:0,scaleY:0,x:r.x,y:r.y},800,egret.Ease.sineOut).call(function(){t.OperateLayer.Instance.removeCallCard()})}}},e.prototype.getEffectByCardType=function(e,n){if(e){var i;switch(e){case t.CardType.Error_Card:case t.CardType.Single_Card:case t.CardType.Double_Card:case t.CardType.Feiji_Card:break;case t.CardType.Lian_Card:i="danshun";break;case t.CardType.Double_Lian_Card:i="shuangshun";break;case t.CardType.Three_Card:i="sanzhang";break;case t.CardType.ThreeOne_Card:i="sandaiyi";break;
case t.CardType.ThreeTwo_Card:i="sandaiyidui";break;case t.CardType.Feiji_TwoSingle_Card:case t.CardType.Feiji_TwoDouble_Card:i="feijidaichibang";break;case t.CardType.Four_TwoSingle_Card:case t.CardType.Four_TwoDouble_Card:i="sidaier";break;case t.CardType.Bomb_Card:case t.CardType.KingBomb_Card:i="zhadan"}return i}},e.prototype.dealCardAnimation=function(){if(1!=t.RoomInfo.getInstance().video){t.OperateLayer.Instance.removeLandlordRobImage();for(var e=t.CardLayer.Instance.handCards,n=0,i=e;n<i.length;n++){var a=i[n];a.parent&&(egret.Tween.removeTweens(a),t.CardLayer.Instance.removeChild(a))}e.clear();var r=t.PokerFunction.MainSeat.handCards;if(r&&r.length)for(var o=function(n){var i=r[n];if(null==i||t.CardLayer.Instance.handCards.seek(function(t){return t.cardId==i}))return{value:void 0};var a=new t.HandCardSprite(i);a.touchEnabled=!0,a.touchChildren=!1,t.CardLayer.Instance.addChild(a);var o=t.CardLayer.Instance.handCardX;a.x=o+(e.length-1)*t.GameConstant.CardGap,e.push(a),s.cardAnimation();for(var h=0,d=t.SeatLayer.Instance.seatSprites;h<d.length;h++){var l=d[h];l.handCardCountChanged(n+1)}if(t.SoundHand.Instance.playCardClick(),n==r.length-1)for(var u=0,c=t.SeatLayer.Instance.seatSprites;u<c.length;u++){var p=c[u];p.handCardCountChanged(p.seatData.handCardSum)}},s=this,h=0;h<r.length;h++){var d=o(h);if("object"==typeof d)return d.value}}},e.prototype.cardAnimation=function(){for(var e=this,n=t.CardLayer.Instance.handCards,i=n.length,a=t.CardLayer.Instance.handCardX,r=0;i>r;r++){var o=n[r];egret.Tween.removeTweens(o),egret.Tween.get(o).to({x:a+t.GameConstant.CardGap*r},t.GameConstant.DealCardTime),i==t.GameConstant.HandCardSum&&r==i-1&&egret.Tween.get(o).call(function(){return e.dealCardEnd()})}},e.prototype.dealCardEnd=function(){t.CardLayer.Instance.updataHandCardPosition(),t.GameView.Instance.threeCardChanged(null)},e.prototype.dealThreeCardAnimation=function(){for(var e=3*t.GameConstant.BluffCardGap-(t.GameConstant.BluffCardGap-t.GameConstant.BluffCardWidth),n=(uniLib.Global.screenWidth-e)/2+t.GameConstant.BluffCardWidth/2,i=t.GameView.Instance.threeCards,a=function(e){var a=i[e];a.x=0,a.parent&&t.GameView.Instance.removeChild(a),egret.Tween.get(a).wait(e*t.GameConstant.DealCardTime).call(function(){return t.GameView.Instance.addChild(a)}).to({x:n+t.GameConstant.BluffCardGap*e},t.GameConstant.DealCardTime)},r=0;r<i.length;r++)a(r)},e.prototype.brightThreeCardEffect=function(){for(var e=t.GameView.Instance.threeCards,n=t.RoomData.Instance.threeCard,i=function(i){var r=n[i],o=e[i];o.texture=RES.getRes("DDZ_BackCard2"),egret.Tween.removeTweens(o),egret.Tween.get(o).wait(i*t.GameConstant.BrightThreeCardBack).to({scaleX:0},t.GameConstant.BrightThreeCardBack).call(function(){return o.texture=t.GameConstant.GetPokerTextureByCardId(r)}).to({scaleX:1},t.GameConstant.BrightThreeCardPositive),i==e.length-1&&egret.Tween.get(o).call(a.threeCardGoHandEffect,a)},a=this,r=0;r<e.length;r++)i(r)},e.prototype.threeCardGoHandEffect=function(){var e=t.RoomData.Instance.threeCard,n=t.CardLayer.Instance.handCards.filter(function(t){return e.seek(function(e){return e==t.cardId})});if(n)for(var i=0,a=n;i<a.length;i++){var r=a[i];r.y=t.GameConstant.HandCardY-t.GameConstant.CardHeight,egret.Tween.get(r).wait(200).to({y:t.GameConstant.HandCardY},300,egret.Ease.circOut)}},e.prototype.multipleEffect=function(e){var n=this,i="x"+(e%1==0?e:Math.ceil(e));null==this.label&&(this.label=new eui.BitmapLabel(i),this.label.font="glodBrightFont_fnt",this.label.y=t.GameConstant.OperationY-200,t.GameView.Instance.addChild(this.label),this.label.x=(uniLib.Global.screenWidth-this.label.width)/2,egret.setTimeout(function(){t.GameView.Instance.removeChild(n.label),n.label=null},this,1e3)),null!=this.label&&(this.label.text=i),this.lastValue=e},e.prototype.changeEffect=function(){var t,e=RES.getRes("change_json"),n=RES.getRes("change_png"),i=new egret.MovieClipDataFactory(e,n);return t=new egret.MovieClip(i.generateMovieClipData("change")),t.frameRate=12,t.gotoAndPlay(1,1),t},e.prototype.farmerWinEffect=function(){var t,e=RES.getRes("farmer_laugh_json"),n=RES.getRes("farmer_laugh_png"),i=new egret.MovieClipDataFactory(e,n);return t=new egret.MovieClip(i.generateMovieClipData("farmer_laugh")),uniLib.DisplayUtils.createMovieClicp,t.frameRate=6,t.gotoAndPlay(1,-1),t},e.prototype.farmerLoseEffect=function(){var t,e=RES.getRes("farmer_cry_json"),n=RES.getRes("farmer_cry_png"),i=new egret.MovieClipDataFactory(e,n);return t=new egret.MovieClip(i.generateMovieClipData("farmer_cry")),t.frameRate=6,t.gotoAndPlay(1,-1),t},e.prototype.lordWinEffect=function(){var t,e=RES.getRes("lord_laugh_json"),n=RES.getRes("lord_laugh_png"),i=new egret.MovieClipDataFactory(e,n);return t=new egret.MovieClip(i.generateMovieClipData("lord_laugh")),t.frameRate=6,t.gotoAndPlay(1,-1),t},e.prototype.lordLoseEffect=function(){var t,e=RES.getRes("lord_cry_json"),n=RES.getRes("lord_cry_png"),i=new egret.MovieClipDataFactory(e,n);return t=new egret.MovieClip(i.generateMovieClipData("lord_cry")),t.frameRate=6,t.gotoAndPlay(1,-1),t},e.prototype.gameLoseEffect=function(){var t,e=RES.getRes("gameLose_json"),n=RES.getRes("gameLose_png"),i=new egret.MovieClipDataFactory(e,n);return t=new egret.MovieClip(i.generateMovieClipData("lose")),t.frameRate=24,t.gotoAndPlay(1,1),t},e.prototype.winLightEffect=function(){var t,e=RES.getRes("winLight_DDZ_json"),n=RES.getRes("winLight_DDZ_png"),i=new egret.MovieClipDataFactory(e,n);return t=new egret.MovieClip(i.generateMovieClipData("winLight")),t.frameRate=24,t.gotoAndPlay(0,-1),t},e.prototype.giftEffect=function(e,n,i){var a=new t.GiftAnItem;a.giftId=e;var r=t.GameConstant.seatPosArr[t.GameConstant.GetClientNoByUid(n)],o=t.GameConstant.seatPosArr[t.GameConstant.GetClientNoByUid(i)];r&&o&&(a.x=o.x+t.GameConstant.HeadWidth/2,a.y=o.y+t.GameConstant.HeadHeight/2,t.GameInfo.topLayer.addChild(a),egret.Tween.get(a).to({x:r.x+t.GameConstant.HeadWidth/2,y:(r.y+t.GameConstant.HeadHeight/2)*uniLib.ScreenUtils.scaleFactor},400,egret.Ease.circOut).call(function(){egret.Tween.removeTweens(a),a.play()}))},e.prototype.addShuffleMc=function(e){uniLib.SoundMgr.instance.playSound("DDZ_shufflecard_mp3"),this._shuffleMc=uniLib.DisplayUtils.createMovieClicp("shuffle_mc"),t.GameView.Instance.addChild(this._shuffleMc),this._shuffleMc.scaleX=1,this._shuffleMc.scaleY=1,this._shuffleMc.x=(uniLib.Global.screenWidth-400)/2,this._shuffleMc.y=(uniLib.Global.screenHeight-this._shuffleMc.height)/2-20,this._shuffleMc.frameRate=18,this._shuffleMc.play(1);var n=t.GameConstant.GetSeatSpriteByUid(e);n&&(this._shuffleBg=new eui.Image("shuffle_bg"),this._shuffleBg.x=(uniLib.Global.screenWidth-this._shuffleBg.width)/2-220,this._shuffleBg.y=uniLib.Global.screenHeight/2+110,t.GameView.Instance.addChild(this._shuffleBg),this._shuffleLabel=new eui.Label,this._shuffleLabel.text=n.user.nickName+"正在洗牌中...",this._shuffleLabel.textColor=16767334,this._shuffleLabel.x=(uniLib.Global.screenWidth-this._shuffleLabel.width)/2,this._shuffleLabel.y=uniLib.Global.screenHeight/2+120,t.GameView.Instance.addChild(this._shuffleLabel))},e.prototype.removeShuffleMc=function(){this._shuffleMc&&this._shuffleMc.parent&&(this._shuffleMc.stop(),t.GameView.Instance.removeChild(this._shuffleMc),this._shuffleMc=null),this._shuffleLabel&&this._shuffleLabel.parent&&(t.GameView.Instance.removeChild(this._shuffleLabel),this._shuffleLabel=null),this._shuffleBg&&this._shuffleBg.parent&&(t.GameView.Instance.removeChild(this._shuffleBg),this._shuffleBg=null)},e}();t.EffectCreate=e,__reflect(e.prototype,"game.EffectCreate")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return Object.defineProperty(e,"seatPosArr",{get:function(){return[new egret.Point(20,400),new egret.Point(uniLib.Global.screenWidth-132,160),new egret.Point(20,160)]},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ReadyPos",{get:function(){return[new egret.Point(uniLib.Global.screenWidth/2-85,470),new egret.Point(uniLib.Global.screenWidth-350,217),new egret.Point(250,217)]},enumerable:!0,configurable:!0}),e.GetWidthForCardNumber=function(t){return e.PlayCardWidth+(t-1)*e.PlayCardGap},e.GetClientNoBySeatId=function(e){var n=t.PokerFunction.MainSeatId;if(null==n)return e-1;var i=e-n;return 0>i?2==t.RoomData.Instance.playerNumber?i+2:i+3:i},e.GetClientNoByUid=function(e){var n=t.SeatLayer.Instance.seatSprites.first(function(t){return t.uid==e});return null==n?null:n.clientNo},e.GetSeatSpriteByUid=function(e){return t.SeatLayer.Instance.seatSprites.first(function(t){return t.uid==e})},e.GetSeatSpriteBySeatId=function(e){return t.SeatLayer.Instance.seatSprites.first(function(t){return t.seatData.seatId==e})},e.GetPokerTextureByCardId=function(t){var n="";return n=1==e.PokerTextureType?"DL_"+table.TablePokerCard.resNormal(t):table.TablePokerCard.resNormal(t),RES.getRes(n)},e}();e.HeadWidth=114,e.HeadHeight=114,e.HandCardY=500,e.HandCardSelectY=480,e.OperationY=370,e.PlayCardMainY=340,e.CardGap=58,e.CardWidth=160,e.CardHeight=220,e.PlayCardWidth=82,e.PlayCardHeight=114,e.PlayCardGap=40,e.BluffCardWidth=50,e.BluffCardHeight=65,e.BluffCardGap=65,e.DealCardTime=150,e.CountDown=15,e.HandCardSum=17,e.LandlordHandCardSum=20,e.BrightThreeCardBack=150,e.BrightThreeCardPositive=150,e.OperationOffsetRight=130,e.RobLordOperateTimerButtonX=310,e.CallLordOperateTimerButtonX=120,e.OperateTimerButtonX=210,e.PassOnlyTimerButtonX=440,e.MaxCardNumLine=10,e.PokerTextureType=0,e.shuffleTime=3800,e.ResGroup_DDZ="DDZ_gameres",t.GameConstant=e,__reflect(e.prototype,"game.GameConstant")}(game||(game={}));var game;!function(t){var e=function(e){function r(){var t=e.call(this)||this;return t.landlordRobImage=new Array,t.curMaxPoint=0,t.playCardSprites=new Array,t}return __extends(r,e),Object.defineProperty(r,"Instance",{get:function(){return null==this.m_Instance&&(this.m_Instance=new r),this.m_Instance},enumerable:!0,configurable:!0}),r.clearInstance=function(){this.m_Instance=null},r.prototype.addListener=function(){},r.prototype.destroy=function(){this.removeListener()},r.prototype.removeListener=function(){this.removeRobLandlord(),this.removeOperateMain(),this.stopTimer(),r.clearInstance(),i.clearInstance(),n.clearInstance()},r.prototype.operateChanged=function(e){for(var n=0,i=t.SeatLayer.Instance.seatSprites;n<i.length;n++){var a=i[n];a.removeReadyIcon()}null!=e.leftSec?this.endTime=t.GameTime.localNow()+1e3*e.leftSec:this.endTime=t.GameTime.localNow()+(e.endTime-t.GameTime.serverNow()),t.CardLayer.Instance.removeupNotUp(),this.addTimeButton();var r=e.uid;if(this.setTimeButtonPosition(r),r==uniLib.NetMgr.UID){this.addOperateMain(e.cardSetList);var o=t.DDZAI.Instance.operationType;o==t.OperationType.PassOnly?this.timeButton.x=t.GameConstant.PassOnlyTimerButtonX:this.timeButton.x=t.GameConstant.OperateTimerButtonX}else this.removeOperateMain();this.removePlayCard(r),this.removeRobLandlord()},r.prototype.kickOperateChanged=function(e){null!=e.leftSec?this.endTime=t.GameTime.localNow()+1e3*e.leftSec:this.endTime=t.GameTime.localNow()+(e.endTime-t.GameTime.serverNow()),this.addTimeButton();var n=e.uid;t.PokerFunction.GetUserInfoByUid(e.uid);this.setTimeButtonPosition(n),n==uniLib.NetMgr.UID?(this.addRobLandlord(),this.robLandlord.kickPlayOperate(!0),this.timeButton.x=t.GameConstant.RobLordOperateTimerButtonX):this.removeRobLandlord()},r.prototype.addOperateMain=function(e){null==this.operateMain&&(this.operateMain=n.Instance,this.operateMain.x=(uniLib.Global.screenWidth-this.operateMain.width)/2,this.operateMain.y=t.GameConstant.OperationY),this.operateMain.updata(e),this.operateMain.addListener(),this.addChild(this.operateMain)},r.prototype.removeOperateMain=function(){this.operateMain&&this.operateMain.parent&&(this.operateMain.removeListener(),this.removeChild(this.operateMain))},r.prototype.addLandlordRobResult=function(e){this.stopTimer();var n=t.GameConstant.GetClientNoByUid(e.uid),i=t.PokerFunction.GetUserInfoByUid(e.uid),a=new egret.Bitmap;if(e.yesOrNo?this.landlordUid?(a.texture=RES.getRes("player_grab_landlord"),t.SoundHand.Instance.playCallLandlord(3,i.gender),this.landlordUid=e.uid):(a.texture=RES.getRes("player_call_landlord"),this.landlordUid=e.uid,t.SoundHand.Instance.playCallLandlord(1,i.gender)):this.landlordUid?(t.SoundHand.Instance.playCallLandlord(4,i.gender),a.texture=RES.getRes("player_pass_call")):(t.SoundHand.Instance.playCallLandlord(2,i.gender),a.texture=RES.getRes("player_pass_score")),e.uid==uniLib.NetMgr.UID)a.x=(uniLib.Global.screenWidth-a.width)/2,a.y=t.GameConstant.OperationY,this.removeRobLandlord();else{var r=t.GameConstant.GetSeatSpriteByUid(e.uid),o=r.localToGlobal();a.y=o.y+t.GameConstant.HeadHeight+70-a.height,1==n?a.x=o.x-a.width-40:a.x=o.x+t.GameConstant.HeadWidth+40}var s=this.landlordRobImage[n];s&&s.parent&&this.removeChild(s),this.landlordRobImage[n]=a,this.addChild(a)},r.prototype.removeLandlordRobImage=function(){for(var t=0,e=this.landlordRobImage;t<e.length;t++){var n=e[t];n&&n.parent&&this.removeChild(n)}this.landlordRobImage.clear(),this.landlordUid=null,this.curMaxPoint=0},r.prototype.addCalllordRobResult=function(e){this.stopTimer();var n=t.GameConstant.GetClientNoByUid(e.uid),i=t.PokerFunction.GetUserInfoByUid(e.uid),a=new egret.Bitmap;if(0!=e.point&&(this.curMaxPoint=e.point),e.point?(a.texture=RES.getRes("callScore"+e.point),t.SoundHand.Instance.playPoint(i?i.gender:null,e.point)):(a.texture=RES.getRes("player_pass_score"),t.SoundHand.Instance.playCallLandlord(2,i?i.gender:null)),e.uid==uniLib.NetMgr.UID||1==t.RoomInfo.getInstance().video&&0==n)a.x=(uniLib.Global.screenWidth-a.width)/2,a.y=t.GameConstant.OperationY,this.removeRobLandlord();else{var r=t.GameConstant.GetSeatSpriteByUid(e.uid),o=r.localToGlobal();a.y=o.y+t.GameConstant.HeadHeight+70-a.height,1==n?a.x=o.x-a.width-40:a.x=o.x+t.GameConstant.HeadWidth+40}var s=this.landlordRobImage[n];s&&s.parent&&this.removeChild(s),this.landlordRobImage[n]=a,this.addChild(a)},r.prototype.updataRobLandlord=function(e){this.removeCallCard();var n=t.GameConstant.GetClientNoByUid(e.uid),i=this.landlordRobImage[n];i&&i.parent&&this.removeChild(i),null!=e.leftSec?this.endTime=t.GameTime.localNow()+1e3*e.leftSec:this.endTime=t.GameTime.localNow()+(e.endTime-t.GameTime.serverNow()),this.addTimeButton(),this.setTimeButtonPosition(e.uid),e.uid==uniLib.NetMgr.UID?(this.addRobLandlord(e.operateList),this.robLandlord.kickPlayOperate(!1),t.RoomData.Instance.callOrRob?this.timeButton.x=t.GameConstant.CallLordOperateTimerButtonX:this.timeButton.x=t.GameConstant.RobLordOperateTimerButtonX):this.removeRobLandlord()},r.prototype.autoLandLord=function(){var e=new Cmd.LandlordRobCmd_CS;e.yesOrNo=!1,t.PokerFunction.tcpSend(e)},r.prototype.addTimeButton=function(){null==this.timeButton&&(this.timeButton=new a),this.addChild(this.timeButton),this.updataTimer(),this.timer&&this.timer.stop(),this.timer=uniLib.SetUniTimerTimeout(this,this.updataTimer,1e3,!1,this)},r.prototype.addWarningEffect=function(){var e=t.RoomData.Instance.operateSeatId;if(null!=e){null==this.warningEffect&&(this.warningEffect=t.EffectCreate.Instance.warningEffect()),t.SeatLayer.Instance.addChild(this.warningEffect),t.EffectCreate.Instance.playWarning();var n=t.GameConstant.GetClientNoBySeatId(e),i=t.GameConstant.GetSeatSpriteBySeatId(e);if(null!=i){var a=i.localToGlobal();0==n?(this.warningEffect.x=a.x+t.GameConstant.HeadWidth/2,this.warningEffect.y=a.y-30):2==n?(this.warningEffect.x=a.x+t.GameConstant.HeadWidth+25,this.warningEffect.y=a.y+t.GameConstant.HeadHeight/2-10):(this.warningEffect.x=a.x-25,this.warningEffect.y=a.y+t.GameConstant.HeadHeight/2-10)}}},r.prototype.removeWarningEffect=function(){this.warningEffect&&this.warningEffect.parent&&(t.SeatLayer.Instance.removeChild(this.warningEffect),t.EffectCreate.Instance.stopWarning())},r.prototype.setTimeButtonPosition=function(e){if(null!=e){var n=t.GameConstant.GetClientNoByUid(e),i=t.GameConstant.GetSeatSpriteByUid(e);if(null!=i){var a=i.localToGlobal();0==n?(this.timeButton.x=(uniLib.Global.screenWidth-this.timeButton.width)/2,this.timeButton.y=t.GameConstant.OperationY+10):2==n?(this.timeButton.x=a.x+t.GameConstant.HeadWidth+40,this.timeButton.y=a.y+t.GameConstant.HeadHeight-this.timeButton.height/2+10):(this.timeButton.x=a.x-this.timeButton.width-40,this.timeButton.y=a.y+t.GameConstant.HeadHeight-this.timeButton.height/2+10)}}},r.prototype.stopTimer=function(){this.timeButton&&this.timeButton.parent&&this.removeChild(this.timeButton),this.timer&&this.timer.stop()},r.prototype.updataTimer=function(){this.time=Math.floor(this.endTime/1e3-t.GameTime.localNow()/1e3),this.time>5?this.removeWarningEffect():(this.addWarningEffect(),t.RoomData.Instance.operateSeatId==t.PokerFunction.MainSeatId&&t.SoundHand.Instance.playReminded()),this.time<0&&(this.time=0),this.timeButton.label=this.time+""},r.prototype.addRobLandlord=function(e){null==this.robLandlord&&(this.robLandlord=i.Instance,this.robLandlord.x=(uniLib.Global.screenWidth-this.robLandlord.width)/2,this.robLandlord.y=t.GameConstant.OperationY),this.landlordUid?this.robLandlord.setBtnsVisible(!1):this.robLandlord.setBtnsVisible(!0),this.robLandlord.updata(),this.robLandlord.addListener(),this.addChild(this.robLandlord),this.robLandlord.showBtns(e)},r.prototype.removeRobLandlord=function(){this.robLandlord&&this.robLandlord.parent&&(this.robLandlord.removeListener(),this.removeChild(this.robLandlord))},r.prototype.playCard=function(e,n,i){void 0===i&&(i=!1),e.cardList&&e.cardList instanceof Array&&e.cardList.length>0&&t.SoundHand.Instance.playOutCard(),e.uid==uniLib.NetMgr.UID&&t.CardLayer.Instance.resetCardPosition(),this.stopTimer();var a=t.GameConstant.GetClientNoByUid(e.uid);if(e.uid==uniLib.NetMgr.UID&&(this.removeOperateMain(),i))return this.removePlayCard(e.uid),void this.removeRobLandlord();var o=this.getPlayCardSprite(e.cardList,e.uid);this.playCardSprites[a]&&this.playCardSprites[a].parent&&this.removeChild(this.playCardSprites[a]),this.addChild(o),this.playCardSprites[a]=o;var s=t.PokerFunction.GetSeatDataByUid(e.uid),h=this.getPlayCardPosition(o,e.uid);if(!e.cardList||!e.cardList.length){if(i)return;return o.x=h.x,o.y=h.y,void t.SoundHand.Instance.playPass(s.user.gender)}var d,l;i||(d=t.PokerFunction.GetSeatDataByUid(e.uid).seatId,l=t.DDZAI.Instance.getPlayCardValue(d).cardType);var u=function(){n&&(t.SoundHand.Instance.playCard(s.user.gender,l,e.cardList),r.Instance.addCardTypeEffect(),t.EffectCreate.Instance.playCardType(l,e.cardList))},c=t.PokerFunction.GetSeatDataByUid(e.uid),p=c.handCards.length;2==p?t.SoundHand.Instance.playLast(c.user.gender,2):1==p&&t.SoundHand.Instance.playLast(c.user.gender,1),o.x=h.x,o.y=h.y,u()},r.prototype.playNineCard=function(e){if(null!=e||e instanceof Array){null==this.nineCard&&(this.nineCard=this.getPlayCardSprite(e),this.addChild(this.nineCard));var n=t.GameConstant.seatPosArr[2];this.nineCard.x=n.x,this.nineCard.y=n.y,this.nineCard.alpha=.2,this.nineCard.scaleX=1.2,this.nineCard.scaleY=1.2,egret.Tween.get(this.nineCard).wait(50).to({alpha:1,x:n.x,scaleX:1,y:n.y,scaleY:1},500,egret.Ease.circInOut)}},r.prototype.removeNineCard=function(){this.nineCard&&this.nineCard.parent&&(this.nineCard.removeChildren(),this.removeChild(this.nineCard),this.nineCard=null)},r.prototype.chechChuntian=function(){for(var e=0,n=0,i=0,a=t.RoomData.Instance.seatList;i<a.length;i++){var r=a[i];if(0!=r.handCardSum){if(r.user.uid==t.RoomData.Instance.landlordUid){if(20==r.handCardSum){e++;continue}}else if(17==r.handCardSum){e++;continue}}else n++}return 2==e&&1==n?!0:!1},r.prototype.getPlayCardPosition=function(e,n){var i=new egret.Point,a=t.GameConstant.GetClientNoByUid(n);if(n==uniLib.NetMgr.UID||1==t.RoomInfo.getInstance().video&&0==a)i.x=(uniLib.Global.screenWidth-e.width)/2,i.y=t.GameConstant.OperationY-10;else{var r=t.GameConstant.seatPosArr[a];i.y=r.y+t.GameConstant.HeadHeight+70-e.height,1==a?i.x=r.x-e.width-40:i.x=r.x+t.GameConstant.HeadWidth+40}return i},r.prototype.removePlayCardSprites=function(){for(var t=0,e=this.playCardSprites;t<e.length;t++){var n=e[t];n&&egret.Tween.removeTweens(n),n&&n.parent&&this.removeChild(n)}this.playCardSprites.clear(),this.removeNineCard()},r.prototype.showCallCard=function(e,n){this.sCard||(this.callCardId=e,this.sCard=new egret.Bitmap,this.sCard.width=t.GameConstant.PlayCardWidth,this.sCard.height=t.GameConstant.PlayCardHeight,this.sCard.texture=t.GameConstant.GetPokerTextureByCardId(e),t.GameInfo.topLayer.addChild(this.sCard),this.sCard.x=(uniLib.Global.screenWidth-this.sCard.width)/2,this.sCard.y=(uniLib.Global.screenHeight-this.sCard.height)/2,t.EffectCreate.Instance.callCardAnimation(this.sCard,e,n))},r.prototype.removeCallCard=function(){this.sCard&&this.sCard.parent&&(t.GameInfo.topLayer.removeChild(this.sCard),this.sCard=null)},r.prototype.getPlayCardSprite=function(e,n){var i=new egret.Sprite;if(!e||!e.length){var a=new egret.Bitmap(RES.getRes("player_pass"));return i.addChild(a),i.width=a.width,i.height=a.height,i}for(var r,o=0;o<e.length;o++){var a=new egret.Bitmap;a.width=t.GameConstant.PlayCardWidth,a.height=t.GameConstant.PlayCardHeight,a.texture=t.GameConstant.GetPokerTextureByCardId(e[o]),a.x=t.GameConstant.PlayCardGap*o,i.addChild(a),o>=t.GameConstant.MaxCardNumLine&&n!=uniLib.NetMgr.UID&&(a.x=(t.GameConstant.GetWidthForCardNumber(t.GameConstant.MaxCardNumLine)-t.GameConstant.GetWidthForCardNumber(e.length-t.GameConstant.MaxCardNumLine))/2+t.GameConstant.PlayCardGap*(o-t.GameConstant.MaxCardNumLine),a.y=50),o==e.length-1&&(r=a)}if(n==t.RoomData.Instance.landlordUid){var s=new egret.Bitmap(RES.getRes("lord"));i.addChild(s),s.width=50,s.height=50,s.x=r.x+r.width-s.width,s.y=r.y}return e.length>11&&n!=uniLib.NetMgr.UID?(i.width=t.GameConstant.GetWidthForCardNumber(t.GameConstant.MaxCardNumLine),i.height=t.GameConstant.PlayCardHeight+50):(i.width=t.GameConstant.GetWidthForCardNumber(e.length),i.height=t.GameConstant.PlayCardHeight),i},r.prototype.removePlayCard=function(e){var n=t.GameConstant.GetClientNoByUid(e);this.playCardSprites[n]&&this.playCardSprites[n].parent&&this.removeChild(this.playCardSprites[n])},r.prototype.addCardTypeEffect=function(){null==this.cardTypeEffect&&(this.cardTypeEffect=t.EffectCreate.Instance.cardTypeEffect(),this.cardTypeEffect.x=uniLib.Global.screenWidth/2,this.cardTypeEffect.y=uniLib.Global.screenHeight/2-20),this.addChild(this.cardTypeEffect)},r.prototype.removeCardTypeEffect=function(){this.cardTypeEffect&&this.cardTypeEffect.parent&&(this.removeChild(this.cardTypeEffect),t.EffectCreate.Instance.stopCardType())},r}(egret.DisplayObjectContainer);t.OperateLayer=e,__reflect(e.prototype,"game.OperateLayer");var n=function(e){function n(){var t=e.call(this)||this;return t.tipNumber=0,t.skinName=new OperationPlay_DDZ_Skin,t.addListener(),t}return __extends(n,e),Object.defineProperty(n,"Instance",{get:function(){return null==this.m_Instance&&(this.m_Instance=new n),this.m_Instance},enumerable:!0,configurable:!0}),n.clearInstance=function(){this.m_Instance=null},n.prototype.addListener=function(){this.passButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.tipButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.playButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.passOnlyBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this)},n.prototype.removeListener=function(){this.passButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.tipButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.playButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.passOnlyBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this)},n.prototype.updata=function(e){this.tipNumber=0,this.tipCardList=e;var n=t.DDZAI.Instance.operationType;n==t.OperationType.FirstHand?(this.passButton.enabled=!1,this.buttonVisible(!0)):n==t.OperationType.PassOnly?(t.CardLayer.Instance.notUp(),this.buttonVisible(!1)):(this.buttonVisible(!0),this.passButton.enabled=!0),this.playButtonEnabled()},n.prototype.buttonVisible=function(t){this.passOnlyBtn.visible=!t,this.passButton.visible=t,this.tipButton.visible=t,this.playButton.visible=t},n.prototype.playButtonEnabled=function(){for(var e=t.CardLayer.Instance.handCards,n=new Array,i=0,a=e;i<a.length;i++){var r=a[i];r.selected&&n.push(r.cardId)}if(n.length<1)return void(this.playButton.enabled=!1);var o=new t.CardAnalysis(n);if(uniLib.Global.lobbyMode&&1005==MJLobby.MJLobbyData.getInstance().lobbyId&&(o.cardType==t.CardType.ThreeTwo_Card||o.cardType==t.CardType.Feiji_TwoDouble_Card)&&t.RoomData.Instance.noThreeAttachDouble)return void(this.playButton.enabled=!1);if(o.cardType==t.CardType.Error_Card)this.playButton.enabled=!1;else{var s=t.DDZAI.Instance.beforePlayCardValue;s.cardType==t.CardType.Error_Card||o.cardType==s.cardType&&o.cardValue.value>s.cardValue.value||o.cardType==t.CardType.Bomb_Card||o.cardType==t.CardType.KingBomb_Card?this.playButton.enabled=!0:this.playButton.enabled=!1}},n.prototype.selectTip=function(){if(null!=this.tipCardList){this.tipNumber>this.tipCardList.length-1&&(this.tipNumber=0);for(var e=t.CardLayer.Instance.handCards,n=0,i=e;n<i.length;n++){var a=i[n];a.selected=!1}for(var r=this.tipCardList[this.tipNumber],o=null==r?null:r,s=function(t){var n=e.first(function(e){return e.cardId==t});n&&(n.selected=!0)},h=0,d=o;h<d.length;h++){var a=d[h];s(a)}this.tipNumber++}},n.prototype.onClickTap=function(e){if(e.target==this.passButton||e.target==this.passOnlyBtn){var n=new Cmd.PlayCardCmd_CS;t.PokerFunction.tcpSend(n),t.CardLayer.Instance.resetCardPosition()}else if(e.target==this.tipButton)this.selectTip(),this.playButtonEnabled();else if(e.target==this.playButton){var n=new Cmd.PlayCardCmd_CS,i=t.CardLayer.Instance.handCards;if(i.length<1)return;for(var a=new Array,r=0,o=i;r<o.length;r++){var s=o[r];s.selected&&a.push(s.cardId)}if(a.length<1)return;n.cardList=a,t.PokerFunction.tcpSend(n)}t.SoundHand.Instance.playButtonClick()},n}(eui.Component);t.OperationPlay=n,__reflect(n.prototype,"game.OperationPlay");var i=function(n){function i(){var t=n.call(this)||this;return t.skinName=new OperateRobLandlord_DDZ_Skin,t.addListener(),t.passCallButton.name="0",t.callScoreButton1.name="1",t.callScoreButton2.name="2",t.callScoreButton3.name="3",t}return __extends(i,n),Object.defineProperty(i,"Instance",{get:function(){return null==this.m_Instance&&(this.m_Instance=new i),this.m_Instance},enumerable:!0,configurable:!0}),i.clearInstance=function(){i.Instance.removeListener(),this.m_Instance=null},i.prototype.showBtns=function(t){null!=t&&t instanceof Array&&!(t.length<1)&&(this.passCallButton.enabled=t.seek(function(t){return t==Cmd.Operation.LordCall0}),this.callScoreButton1.enabled=t.seek(function(t){return t==Cmd.Operation.LordCall1}),this.callScoreButton2.enabled=t.seek(function(t){return t==Cmd.Operation.LordCall2}),this.callScoreButton3.enabled=t.seek(function(t){return t==Cmd.Operation.LordCall3}),this.noRobBtn.enabled=t.seek(function(t){return t==Cmd.Operation.LordRobNo}),this.RobBtn.enabled=t.seek(function(t){return t==Cmd.Operation.LordRobYes}),this.passButton.enabled=t.seek(function(t){return t==Cmd.Operation.LordCallNo}),this.landlordButton.enabled=t.seek(function(t){return t==Cmd.Operation.LordCallYes}))},i.prototype.setBtnsVisible=function(t){this.passButton.visible=t,this.landlordButton.visible=t,this.noRobBtn.visible=!t,this.RobBtn.visible=!t},i.prototype.updata=function(){t.RoomData.Instance.callOrRob?(this.callLordGroup.visible=!0,this.robLordGroup.visible=!1):(this.callLordGroup.visible=!1,this.robLordGroup.visible=!0);for(var n=e.Instance.curMaxPoint,i=1;4>i;i++){var a=this.skin["callScoreButton"+i];n>=i?a.enabled=!1:a.enabled=!0}},i.prototype.kickPlayOperate=function(t){this.kickPlayGroup.visible=t,this.kickPlayGroup.visible&&(this.callLordGroup.visible=!1,this.robLordGroup.visible=!1)},i.prototype.addListener=function(){this.passButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.landlordButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.noRobBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.RobBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.callScoreButton1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.callScoreButton2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.callScoreButton3.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.passCallButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.kickPlayButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.noKickButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this)},i.prototype.removeListener=function(){this.passButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.landlordButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.noRobBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.RobBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.callScoreButton1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.callScoreButton2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.callScoreButton3.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.passCallButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.kickPlayButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.noKickButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this)},i.prototype.onClickTap=function(e){if(e.target==this.passButton||e.target==this.noRobBtn){var n=new Cmd.LandlordRobCmd_CS;n.yesOrNo=!1,t.PokerFunction.tcpSend(n)}else if(e.target==this.landlordButton||e.target==this.RobBtn){var n=new Cmd.LandlordRobCmd_CS;n.yesOrNo=!0,t.PokerFunction.tcpSend(n)}else if(e.target==this.callScoreButton1||e.target==this.callScoreButton2||e.target==this.callScoreButton3||e.target==this.passCallButton){var n=new Cmd.LandlordCallCmd_CS;n.point=Number(e.target.name),t.PokerFunction.tcpSend(n)}else if(e.target==this.kickPlayButton){var n=new Cmd.KickPlayCmd_CS;n.uid=uniLib.NetMgr.UID,n.yesOrNo=!0,t.PokerFunction.tcpSend(n)}else if(e.target==this.noKickButton){var n=new Cmd.KickPlayCmd_CS;n.uid=uniLib.NetMgr.UID,n.yesOrNo=!1,t.PokerFunction.tcpSend(n)}t.SoundHand.Instance.playButtonClick()},i}(eui.Component);t.OperateRobLandlord=i,__reflect(i.prototype,"game.OperateRobLandlord");var a=function(t){function e(){var e=t.call(this)||this;return e.skinName=new TimeButton_DDZEvent_Skin,e}return __extends(e,t),Object.defineProperty(e.prototype,"label",{set:function(t){null!=t&&"NaN"!=t&&(this.labelDisplay.text=t)},enumerable:!0,configurable:!0}),e}(eui.Component);t.TimerButton=a,__reflect(a.prototype,"game.TimerButton")}(game||(game={}));var game;!function(t){var e=function(e){function n(){return e.call(this)||this}return __extends(n,e),n.prototype.start=function(){e.prototype.start.call(this),t.DataCache.gameInfo&&t.DataCache.gameInfo.defaultOrientation!=egret.OrientationMode.LANDSCAPE&&(uniLib.ScreenUtils.landscape=!0),t.GameInfo.uiLayer=this.uiLayer,t.GameInfo.mainUILayer=this.topLayer,t.GameInfo.topLayer=this.mainUILayer,t.GameInfo.main=this.tipsLayer,t.GameInfo.uiLayer.name="uiLayer",t.GameInfo.mainUILayer.name="mainUILayer",t.GameInfo.topLayer.name="topLayer",t.GameInfo.main.name="tipsLayer",this.initPositionData(),t.GameViewConfig.mainMediatorName=uniLib.getQualifiedClassName(t.DDZPokerMediator),t.MahJongFourFacede.getInstance().startUp(this)},n.prototype.destroy=function(){e.prototype.destroy.call(this),t.MahJongFourFacede.getInstance().sendNotification(t.MahjongFourFacadeConst.DESTORY)},n.prototype.initPositionData=function(){this.width=t.DataCache.defaultWidth=uniLib.Global.screenWidth,this.height=t.DataCache.defaultHeight=uniLib.Global.screenHeight},n}(uniLib.GameScene);t.PokerGameScene=e,__reflect(e.prototype,"game.PokerGameScene")
}(game||(game={}));var game;!function(t){var e=function(e){function n(n,i){var a=e.call(this)||this;return a.width=n,a.height=i,a._headBg=t.ResUtil.createBitmapByName("Room_HeadFrame"),a.addChild(a._headBg),a._headBg.x=(n-a._headBg.width)/2,a._headBg.y=(i-a._headBg.height)/2,a._headMc=t.ResUtil.createBitmapByName("room_default_head_icon"),a.addChild(a._headMc),a._headMc.x=(a.width-a._headMc.width)/2,a._headMc.y=(a.height-a._headMc.height)/2,a}return __extends(n,e),n.prototype.destory=function(){t.ResUtil.removeAllChildren(this),t.ResUtil.removeFromParent(this),this._headLoad&&(this._headLoad.destroy(),this._headLoad=null),this._headMc=null},Object.defineProperty(n.prototype,"headUrl",{set:function(e){return e?(this._headUrl=e,this._headLoad||(this._headLoad=new t.HeadLoader),void this._headLoad.load(this._headUrl,this.loaded,null,this)):void(this._headMc.texture=null)},enumerable:!0,configurable:!0}),n.prototype.setPlayerIconMask=function(t){var e=RES.getRes("mask_head"),n=new egret.Bitmap;this.addChild(n),n.texture=e,n.width=this._headMc.width,n.height=this._headMc.height,n.x=(this.width-n.width)/2,n.y=(this.height-n.height)/2,t.mask=n},n.prototype.loaded=function(t){this._headMc?this._headMc.bitmapData=t:(this._headMc=new egret.Bitmap(t),this.addChild(this._headMc)),this._headMc.width=this._headMc.height=110,this._headMc.x=(this.width-this._headMc.width)/2,this._headMc.y=(this.height-this._headMc.height)/2,this.setPlayerIconMask(this._headMc)},n}(egret.Sprite);t.PokerHead=e,__reflect(e.prototype,"game.PokerHead")}(game||(game={}));var game;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.m_seatSprites=new Array,t.addListen(),t}return __extends(n,e),Object.defineProperty(n,"Instance",{get:function(){return null==this.m_Instance&&(this.m_Instance=new n),this.m_Instance},enumerable:!0,configurable:!0}),n.prototype.addListen=function(){t.RoomData.Instance.addSeatChanged.removeAll(),t.RoomData.Instance.delectSeatChanged.removeAll(),t.RoomData.Instance.addSeatChanged.add(this.addSeatSprite,this),t.RoomData.Instance.delectSeatChanged.add(this.delectSeatSprite,this)},n.prototype.removeListen=function(){},n.prototype.addSeatSprite=function(e){var n=new t.SeatSprite(e);this.m_seatSprites.push(n)},n.prototype.delectSeatSprite=function(t){var e=this.m_seatSprites.first(function(e){return e.seatData.seatId==t});e&&(e&&e.parent&&e.parent.removeChild(e),e.destroy(),this.m_seatSprites.removeFirst(function(t){return t==e}))},n.prototype.initSeatSprite=function(){for(var e=t.RoomData.Instance.seatList,n=0;n<e.length;n++)if(null!=e[n]){var i=new t.SeatSprite(e[n]);this.m_seatSprites.push(i),this.addChild(i);var a=t.GameConstant.seatPosArr[n];i.x=a.x,i.y=a.y}},n.prototype.resetSeat=function(){for(var t=0;t<this.m_seatSprites.length;t++)this.m_seatSprites[t].resetUserSprite()},Object.defineProperty(n.prototype,"seatSprites",{get:function(){return this.m_seatSprites},enumerable:!0,configurable:!0}),n}(egret.DisplayObjectContainer);t.SeatLayer=e,__reflect(e.prototype,"game.SeatLayer")}(game||(game={}));var ShakeTool=function(){function t(){this.count=0,this.timer=new egret.Timer(1e3)}return Object.defineProperty(t,"Instance",{get:function(){return null==this.instance&&(this.instance=new t),this.instance},enumerable:!0,configurable:!0}),t.prototype.shakeObj=function(t,e,n,i){this.target=t,this.initX=t.x,this.initY=t.y,this.maxDis=i,this.count=e*n,this.rate=n,this.timer.delay=1e3/n,this.timer.repeatCount=this.count,this.timer.addEventListener(egret.TimerEvent.TIMER,this.shaking,this),this.timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.shakeComplete,this),this.timer.reset(),this.timer.start()},t.prototype.shaking=function(){egret.Tween.removeTweens(this.target),this.target.x=this.initX-this.maxDis+Math.random()*this.maxDis*2,this.target.y=this.initY-this.maxDis+Math.random()*this.maxDis*2,egret.Tween.get(this.target).to({x:this.initX,y:this.initY},999/this.rate)},t.prototype.shakeComplete=function(){this.target&&(egret.Tween.removeTweens(this.target),this.target.x=this.initX,this.target.y=this.initY),this.timer.removeEventListener(egret.TimerEvent.TIMER,this.shaking,this),this.timer.removeEventListener(egret.TimerEvent.TIMER_COMPLETE,this.shakeComplete,this)},t.prototype.stop=function(){this.shakeComplete()},t}();__reflect(ShakeTool.prototype,"ShakeTool");var game;!function(t){var e=function(){function e(){}return Object.defineProperty(e,"Instance",{get:function(){return null==this.m_Instance&&(this.m_Instance=new e),this.m_Instance},enumerable:!0,configurable:!0}),e.prototype.playCard=function(e,n,i){switch(n){case t.CardType.Single_Card:this.playSingle(e,i);break;case t.CardType.Double_Card:this.playDouble(e,i);break;case t.CardType.Lian_Card:this.playStraightSingle(e);break;case t.CardType.Double_Lian_Card:this.playStraightDouble(e);break;case t.CardType.Three_Card:this.playThree(e);break;case t.CardType.ThreeOne_Card:this.playThreeTakeOne(e);break;case t.CardType.ThreeTwo_Card:this.playThreeTakeDouble(e);break;case t.CardType.Feiji_Card:case t.CardType.Feiji_TwoSingle_Card:case t.CardType.Feiji_TwoDouble_Card:this.playPlane(e);break;case t.CardType.Four_TwoSingle_Card:this.playFourTake2(e);break;case t.CardType.Four_TwoDouble_Card:this.playFourTake2Double(e);break;case t.CardType.Bomb_Card:case t.CardType.KingBomb_Card:this.playBomb(e);break;case t.CardType.Error_Card:}},e.prototype.playDDZBg=function(){uniLib.SoundMgr.instance.playBgMusic(["DouDiZhu_Bg_mp3"])},e.prototype.playDDZWin=function(){uniLib.SoundMgr.instance.playSound("You_Win_mp3")},e.prototype.playDDZLose=function(){uniLib.SoundMgr.instance.playSound("You_Lose_mp3")},e.prototype.playReminded=function(){uniLib.SoundMgr.instance.playSound("Reminded_Myself_mp3")},e.prototype.playUser=function(){uniLib.SoundMgr.instance.playSound("User_AI_mp3")},e.prototype.playPass=function(t){var e=["Pass1_","Pass2_","Pass3_"],n=e.random()+this.getNameForGender(t)+"_mp3";uniLib.SoundMgr.instance.playSound(n)},e.prototype.playYaSi=function(t){var e=["Yasi1_","Yasi1_","Yasi1_"],n=e.random()+this.getNameForGender(t)+"_mp3";uniLib.SoundMgr.instance.playSound(n)},e.prototype.playButtonClick=function(){uniLib.SoundMgr.instance.playSound("ButtonClick_mp3")},e.prototype.playCardClick=function(){uniLib.SoundMgr.instance.playSound("Card_Click_mp3")},e.prototype.playCallLandlord=function(t,e){var n="";1==t&&(n+="CallLandlord_JDZ_"),2==t&&(n+="CallLandlord_BJDZ_"),3==t&&(n+="CallLandlord_QDZ_"),4==t&&(n+="CallLandlord_BQDZ_"),n+=this.getNameForGender(e),n+="_mp3",uniLib.SoundMgr.instance.playSound(n)},e.prototype.playSingle=function(t,e){var n="Card_Single_"+this.getNameForCardId(e[0])+"_"+this.getNameForGender(t)+"_mp3";uniLib.SoundMgr.instance.playSound(n)},e.prototype.playDouble=function(t,e){var n="Card_Double_"+this.getNameForCardId(e[0])+"_"+this.getNameForGender(t)+"_mp3";uniLib.SoundMgr.instance.playSound(n)},e.prototype.playStraightSingle=function(t){var e="Card_StraightSingle_"+this.getNameForGender(t)+"_mp3";uniLib.SoundMgr.instance.playSound(e)},e.prototype.playStraightDouble=function(t){var e="Card_StraightDouble_"+this.getNameForGender(t)+"_mp3";uniLib.SoundMgr.instance.playSound(e)},e.prototype.playThree=function(t){var e="Card_Three_"+this.getNameForGender(t)+"_mp3";uniLib.SoundMgr.instance.playSound(e)},e.prototype.playThreeTakeOne=function(t){var e="Card_Three_Take_One_"+this.getNameForGender(t)+"_mp3";uniLib.SoundMgr.instance.playSound(e)},e.prototype.playThreeTakeDouble=function(t){var e="Card_Three_Take_Double_"+this.getNameForGender(t)+"_mp3";uniLib.SoundMgr.instance.playSound(e)},e.prototype.playPlane=function(t){var e="Card_Plane_"+this.getNameForGender(t)+"_mp3";uniLib.SoundMgr.instance.playSound(e)},e.prototype.playFourTake2=function(t){var e="Card_Four_Take_2_"+this.getNameForGender(t)+"_mp3";uniLib.SoundMgr.instance.playSound(e)},e.prototype.playFourTake2Double=function(t){var e="Card_Four_Take_2Double_"+this.getNameForGender(t)+"_mp3";uniLib.SoundMgr.instance.playSound(e)},e.prototype.playBomb=function(t){var e="Card_Bomb_"+this.getNameForGender(t)+"_mp3";uniLib.SoundMgr.instance.playSound(e)},e.prototype.playLast=function(t,e){var n="Card_Last_"+e+"_"+this.getNameForGender(t)+"_mp3";uniLib.SoundMgr.instance.playSound(n)},e.prototype.playChat=function(t,e){var n="Chat_String"+e+"_"+this.getNameForGender(t)+"_mp3";uniLib.SoundMgr.instance.playSound(n)},e.prototype.playPoint=function(t,e){var n="CallLandlord_Score"+e+"_"+this.getNameForGender(t)+"_mp3";uniLib.SoundMgr.instance.playSound(n)},e.prototype.playRedouble=function(t,e){var n;n=e?"Redouble_"+this.getNameForGender(t)+"_mp3":"No_Redouble_"+this.getNameForGender(t)+"_mp3",uniLib.SoundMgr.instance.playSound(n)},e.prototype.playOutCard=function(){uniLib.SoundMgr.instance.playSound("Out_Card_Table_mp3")},e.prototype.getNameForCardId=function(t){var e,n=table.TablePokerCard.instance().first(function(e){return e.thisId==t});return null!=n?(e=n.point+"",16==n.point?e="2":1==n.point?e="A":11==n.point?e="J":12==n.point?e="Q":13==n.point?e="K":14==n.point?e="A":20==n.point?e="Joker1":21==n.point&&(e="Joker2"),e):void 0},e.prototype.getNameForGender=function(t){return"男"==t?"M":"W"},e.prototype.getNameForCardType=function(t){switch(t){case Cmd.CardSetType.CardSetType_None:return"";case Cmd.CardSetType.CardSetType_Single:return"Single";case Cmd.CardSetType.CardSetType_Double:return"Double";case Cmd.CardSetType.CardSetType_StraightSingle:return"StraightSingle";case Cmd.CardSetType.CardSetType_StraightDouble:return"StraightDouble";case Cmd.CardSetType.CardSetType_ThreeWithX:return"Three";case Cmd.CardSetType.CardSetType_FourWithX:return"Four";case Cmd.CardSetType.CardSetType_Bomb:return"Bomb"}},e}();t.SoundHand=e,__reflect(e.prototype,"game.SoundHand")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return Object.defineProperty(e,"Instance",{get:function(){return null==this.m_Instance&&(this.m_Instance=new e),this.m_Instance},enumerable:!0,configurable:!0}),e.clearInstance=function(){this.m_Instance=null},e.prototype.initCardList=function(){this.CardList=[];for(var t=3;15>t;t++)for(var e=100*t,n=1;5>n;n++){var i=e+10*n;i+=1,this.CardList.push(i)}this.CardList.push(1611),this.CardList.push(1621),this.CardList.push(1631),this.CardList.push(1641),this.CardList.push(2051),this.CardList.push(2151)},e.prototype.initUser=function(){uniLib.NetMgr.UID=111111;var t={roomData:{seatList:[{handCardList:{},seatId:1,isReady:!1,role:{diamond:100,seatId:1,gender:"男",onlineState:0,nickName:"1401304",headUrl:"http://img.bwgame.com.cn/img/254.jpg",uid:uniLib.NetMgr.UID,points:0,ip:"36.47.160.35"},outCardList:{}},{handCardList:{},seatId:2,isReady:!0,role:{diamond:100,seatId:2,gender:"男",onlineState:0,nickName:"电脑",headUrl:"http://img.bwgame.com.cn/img/256.jpg",uid:1401306,points:0,ip:"36.47.160.35"},outCardList:{}},{handCardList:{},seatId:3,isReady:!0,role:{diamond:100,seatId:3,gender:"男",onlineState:0,nickName:"电脑",headUrl:"http://img.bwgame.com.cn/img/258.jpg",uid:1401308,points:0,ip:"36.47.160.35"},outCardList:{}}],roomId:"练习场",props:{}}};Cmd.OnRoomDataUpdateCmd_S(t)},e.prototype.deal=function(){for(var e=0,n=t.RoomData.Instance.seatList;e<n.length;e++){var i=n[e];i.clearHandCard()}t.RoomData.Instance.landlordUid=null,t.RoomData.Instance.startGame=!0;for(var a=this.CardList,r=function(t){var e=a.randomItems(17);e.sort(function(t,e){return e-t});for(var n=0,i=e;n<i.length;n++){var r=i[n];t.addHandCard(r)}a=a.filter(function(t){return!e.seek(function(e){return e==t})})},o=0,s=t.RoomData.Instance.seatList;o<s.length;o++){var i=s[o];r(i)}this.threeCard=a,GX.PokerEvent.Instance.dealCardAnimation.call(),egret.setTimeout(this.landlordRob,this,2550)},e.prototype.landlordRob=function(){for(var e=0,n=t.RoomData.Instance.seatList;e<n.length;e++){var i=n[e];if(i.user.uid!=uniLib.NetMgr.UID){var a=new Cmd.LandlordRobCmd_CS;a.uid=i.user.uid,a.yesOrNo=!1,Cmd.OnLandlordRobCmd_CS(a)}}var r=new t.RobLordOperateData;r.uid=uniLib.NetMgr.UID,r.endTime=Date.now()+3e4,t.RoomData.Instance.robLordOperate=r},e.prototype.roundResultCmd=function(e){var n=new Cmd.RoundResultCmd_S;n.resultList=[];for(var i=0,a=t.RoomData.Instance.seatList;i<a.length;i++){var r=a[i],o=new Cmd.GameObjectData,s=new Cmd.UserBriefInfo;s.headurl=r.user.headUrl,s.name=r.user.nickName,s.uid=r.user.uid,s.point=1e3,o.user=s,o.profit=0,o.multiple=0,o.point=1e3,n.resultList.push(o)}n.landlord=t.RoomData.Instance.landlordUid,n.winnerList=[e],Cmd.OnRoundResultCmd_S(n)},e.prototype.tcpSend=function(e){var n=this,i=uniLib.NetMgr.UID;if("Cmd.DissolveRoomRequestCmd_C"==e.GetType())Cmd.OnLeaveRoomCmd_CS(e);else if("Cmd.LeaveRoomCmd_CS"==e.GetType())Cmd.OnLeaveRoomCmd_CS(e);else if("Cmd.ReadyUpdateRoomCmd_CS"==e.GetType()){var a=e;a.uid=i,a.yesOrNo=!0,Cmd.OnReadyUpdateRoomCmd_CS(a);for(var r=0,o=t.RoomData.Instance.seatList;r<o.length;r++){var s=o[r];s.isReady=!0}this.deal()}else if("Cmd.PlayCardCmd_CS"==e.GetType()){var a=e;a.uid=i;var h=new t.CardAnalysis(a.cardList);if(a.cardList&&h.cardType==t.CardType.Error_Card)return;Cmd.OnPlayCardCmd_CS(a);var d=this.getCardTypeTime(a.cardList);if(0==t.PokerFunction.MainSeat.handCards.length)return void egret.setTimeout(function(){return n.roundResultCmd(i)},this,d);egret.setTimeout(this.playerAI,this,d)}else if("Cmd.LandlordRobCmd_CS"==e.GetType()){var a=e;if(a.yesOrNo){var l=new Cmd.LandlordRobCmd_CS;l.uid=i,l.yesOrNo=!0,Cmd.OnLandlordRobCmd_CS(l);var u=new Cmd.LandlordUpdateCmd_S;u.uid=i,u.threeCard=this.threeCard,Cmd.OnLandlordUpdateCmd_S(u);var c=new Cmd.NewOperateSeatCmd_S;c.seatId=1,c.endTime=Date.now()+3e4,egret.setTimeout(function(){return Cmd.OnNewOperateSeatCmd_S(c)},this,1e3)}else this.deal()}},e.prototype.playerAI=function(){var e=this,n=new Cmd.NewOperateSeatCmd_S;n.seatId=2,n.endTime=Date.now()+3e4,Cmd.OnNewOperateSeatCmd_S(n);var i=(uniLib.NetMgr.UID,t.RoomData.Instance.seatList,t.DDZAI.Instance.getCardOperableList(2)),a=null==i?null:i[0];egret.setTimeout(function(){var n=new Cmd.PlayCardCmd_CS;t.PokerFunction.GetUserInfoBySeatId(2)&&(n.uid=t.PokerFunction.GetUserInfoBySeatId(2).uid),t.DDZAI.Instance.isPlay?n.cardList=a:n.cardList=[],Cmd.OnPlayCardCmd_CS(n);var r=e.getCardTypeTime(n.cardList);return t.PokerFunction.GetSeatDataBySeatId(2)&&0==t.PokerFunction.GetSeatDataBySeatId(2).handCards.length?void egret.setTimeout(function(){return e.roundResultCmd(n.uid)},e,r):void egret.setTimeout(function(){var n=new Cmd.NewOperateSeatCmd_S;n.seatId=3,n.endTime=Date.now()+3e4,Cmd.OnNewOperateSeatCmd_S(n),i=t.DDZAI.Instance.getCardOperableList(3),a=null==i?null:i[0],r+=e.getCardTypeTime(a),egret.setTimeout(function(){var n=new Cmd.PlayCardCmd_CS;if(t.PokerFunction.GetUserInfoBySeatId(3)&&(n.uid=t.PokerFunction.GetUserInfoBySeatId(3).uid),t.DDZAI.Instance.isPlay?n.cardList=a:n.cardList=[],Cmd.OnPlayCardCmd_CS(n),t.PokerFunction.GetSeatDataBySeatId(3)&&0==t.PokerFunction.GetSeatDataBySeatId(3).handCards.length)return void egret.setTimeout(function(){return e.roundResultCmd(n.uid)},e,r);var i=new Cmd.NewOperateSeatCmd_S;i.seatId=1,i.endTime=Date.now()+3e4,egret.setTimeout(function(){return Cmd.OnNewOperateSeatCmd_S(i)},e,r)},e,2e3)},e,r)},this,2e3)},e.prototype.getCardTypeTime=function(e){var n=new t.CardAnalysis(e).cardType;switch(n){case t.CardType.Error_Card:return 0;case t.CardType.Single_Card:case t.CardType.Double_Card:case t.CardType.Lian_Card:return 500;default:return 1500}},e}();t.StandAlone=e,__reflect(e.prototype,"game.StandAlone")}(game||(game={}));var game;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.leftCardRecrods=[],t.skinName=new CardNotePanel_DDZ_Skin,t.addListener(),t}return __extends(n,e),Object.defineProperty(n,"Instatnce",{get:function(){return n._instance||(n._instance=new n),n._instance},enumerable:!0,configurable:!0}),n.clearInstance=function(){n._instance&&(n._instance=null)},n.prototype.getLabel=function(t){return this["label_"+t]},n.prototype.addListener=function(){t.RoomData.Instance.leftCardChangeHandel.add(this.leftCardChanged,this),this.leftCardChanged(t.RoomData.Instance.leftCardList),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickHandel,this)},n.prototype.removeListener=function(){t.RoomData.Instance.leftCardChangeHandel.remove(this.leftCardChanged),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickHandel,this)},n.prototype.clickHandel=function(t){this.parent&&this.parent.removeChild(this),this.removeListener(),n.clearInstance()},n.prototype.leftCardChanged=function(t){if(t=t&&t instanceof Array?t:[],!(t.length<1)){this.visible=!0;for(var e=function(e){var n=i.getLabel(e),a=t.filter(function(t){return Math.floor(t/100)==e});n.text=a&&0!=a.length?a.length+"":""},i=this,a=0,r=n.CardPoint;a<r.length;a++){var o=r[a];e(o)}}},n.prototype.showRecord=function(){if(0!=this.leftCardRecrods.length)for(var t=0,e=this.leftCardRecrods;t<e.length;t++){var n=e[t],i=n.point;this.getLabel(i).text=n.count+""}},n}(eui.Component);e.CardPoint=[3,4,5,6,7,8,9,10,11,12,13,14,16,20,21],t.CardNotePanel=e,__reflect(e.prototype,"game.CardNotePanel");var n=function(){function t(t,e){this._point=t,this._count=e}return Object.defineProperty(t.prototype,"point",{get:function(){return this._point},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"count",{get:function(){return this._count},set:function(t){this._count=t},enumerable:!0,configurable:!0}),t}();__reflect(n.prototype,"CardRecordItem")}(game||(game={}));var game;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t._isClick=!0,t.skinName=new Chat_DDZEvent_Skin,t.initUI(),t}return __extends(n,e),n.prototype.initUI=function(){for(var e=1;18>=e;e++){var n=new eui.RadioButton;n.skinName=new FaceButton_DDZEvent_Skin,n.iconDisplay.texture=RES.getRes("face_DDZ"+e),n.groupName="face",n.value=e,this.faceGroup.addChild(n)}for(var e=0;6>e;e++){var i=new eui.RadioButton;i.skinName=new ChatRadioButton_DDZEvent_Skin,i.groupName="chat",i.value=e,i.label=e+1+"."+t.GameData.getInstance().ShortTalkArr[e],i.y=56*e,this.chatGroup.addChild(i)}this.touchEnabled=!1,this.chatRadioButton.selected=!0,this.faceScroller.visible=!1,this.chat.visible=!0,this.chatRadioButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRaduiButtonTap,this),this.faceRadioButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRaduiButtonTap,this),this.bgRect.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.faceGroup.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onFaceGroupTap,this),this.chatGroup.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChatGroupTap,this),this.textField.name="short_input",this.textField.size=28,this.textField.type=egret.TextFieldType.INPUT,this.textField.text="请输入聊天内容",this.touchEnabled=!0,this.textField.addEventListener(egret.FocusEvent.FOCUS_IN,this.onTextFieldFocusIn,this),this.textField.addEventListener(egret.FocusEvent.FOCUS_OUT,this.onTextFieldFocusOut,this),this.sendBtn.name="short_send",this.sendBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sendClickHandler,this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this)},n.prototype.addUIListener=function(){},n.prototype.removeUIListener=function(){},n.prototype.adaptationWidth=function(){e.prototype.adaptationWidth.call(this)},n.prototype.onChatGroupTap=function(e){var n=this;if(!this._isClick)return void t.PublicManage.getInstance().showMildWarnShow("您的操作太频繁了！请休息一下吧");var i=e.target;if(i instanceof eui.RadioButton){var a="2"+i.value,r=new Cmd.CommonChat_C;r.words=a,t.PokerFunction.tcpSend(r),t.PopupManager.removePopUp(this),this._isClick=!1,setTimeout(function(){n._isClick=!0},3e3)}},n.prototype.onFaceGroupTap=function(e){var n=this;if(!this._isClick)return void t.PublicManage.getInstance().showMildWarnShow("您的操作太频繁了！请休息一下吧");var i=e.target;if(i instanceof eui.RadioButton){var a=new Cmd.CommonChat_C,r="1"+i.value;a.words=r,t.PokerFunction.tcpSend(a),t.PopupManager.removePopUp(this),this._isClick=!1,setTimeout(function(){n._isClick=!0},3e3)}},n.prototype.onRaduiButtonTap=function(t){t.target==this.chatRadioButton?(this.faceScroller.visible=!1,this.chat.visible=!0):t.target==this.faceRadioButton&&(this.faceScroller.visible=!0,this.chat.visible=!1)},n.prototype.onTouchTap=function(t){t.target==this.textField&&t.target.setFocus()},n.prototype.sendClickHandler=function(e){var n=this.textField.text;if(-1!=n.indexOf("请输入聊天内容"))return this.textField.text="",void(this._isClick=!0);if(""==n)return this._isClick=!0,void t.PublicManage.getInstance().showMildWarnShow("聊天内容不能为空");var i=new Cmd.CommonChat_C;i.words=this.textField.text,t.PokerFunction.tcpSend(i),this.textField.text="",t.PopupManager.removePopUp(this)},n.prototype.onTextFieldFocusIn=function(t){t.target.setFocus(),-1!=this.textField.text.indexOf("请输入聊天内容")&&(this.textField.text="")},n.prototype.onTextFieldFocusOut=function(t){""==this.textField.text&&(this.textField.text="请输入聊天内容")},n.prototype.createRecordYetOpen=function(){this._yetOpen||(this._yetOpen=t.ResUtil.createTextFeild(1456961,egret.HorizontalAlign.CENTER,"此功能暂未开放",30),this.addChild(this._yetOpen),this._yetOpen.x=540,this._yetOpen.y=280),this._yetOpen.visible=!0},n.prototype.destory=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this.chatRadioButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRaduiButtonTap,this),this.faceRadioButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRaduiButtonTap,this),this.bgRect.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.faceGroup.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onFaceGroupTap,this),this.chatGroup.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChatGroupTap,this),this.textField.removeEventListener(egret.FocusEvent.FOCUS_IN,this.onTextFieldFocusIn,this),this.textField.removeEventListener(egret.FocusEvent.FOCUS_OUT,this.onTextFieldFocusOut,this),this.sendBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.sendClickHandler,this),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this.sendBtn=null,uniLib.DisplayUtils.removeAllChildren(this._content),uniLib.DisplayUtils.removeFromParent(this._content),uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this)},n.prototype.setRecordData=function(t){},n.prototype.onClose=function(e){t.PopupManager.removePopUp(this),this.destory()},n}(t.EuiPanel);t.ChatPanel=e,__reflect(e.prototype,"game.ChatPanel")}(game||(game={}));var game;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.init(),t}return __extends(n,e),n.prototype.init=function(){this._facePanel=[];for(var t=0;3>t;t++){var e=new egret.Sprite;this._facePanel.push(e),this.addChild(e)}this._quickTalkPanel=[];for(var t=0;3>t;t++){var e=new egret.Sprite;this._quickTalkPanel.push(e),this.addChild(e)}this._talkPanel=[];for(var t=0;3>t;t++){var e=new egret.Sprite;this._talkPanel.push(e),this.addChild(e)}},n.prototype.showCommonChat=function(e,n){var i=t.GameConstant.GetSeatSpriteByUid(e);if(i&&i.uid){var a=i.clientNo,r=i.seatData.user?i.seatData.user.gender:null;switch(a){case 0:case 2:this._quickTalkPanel[a].x=t.GameConstant.seatPosArr[a].x+115,this._quickTalkPanel[a].y=t.GameConstant.seatPosArr[a].y,this._facePanel[a].x=t.GameConstant.seatPosArr[a].x+120,this._facePanel[a].y=t.GameConstant.seatPosArr[a].y;break;case 1:this._quickTalkPanel[a].x=t.GameConstant.seatPosArr[a].x-190,this._quickTalkPanel[a].y=t.GameConstant.seatPosArr[a].y,this._facePanel[a].x=t.GameConstant.seatPosArr[a].x-150,this._facePanel[a].y=t.GameConstant.seatPosArr[a].y}var o;if("1"==n.charAt(0)){o=n.substr(1,n.length-1);var s=t.ResUtil.createBitmapByName("face_DDZ"+o);this._facePanel[a].addChild(s);var h=250,d=0,l=s.y;egret.Tween.get(s).wait(2e3).call(this.showCompelete,this,[s,a]),egret.Tween.get(s,{loop:!0}).to({y:l-22},h,egret.Ease.sineIn).wait(d).to({y:l},h,egret.Ease.sineIn)}else if("2"==n.charAt(0)){o=n.substr(1,n.length-1),t.SoundHand.Instance.playChat(r,o);var u=this._quickTalkPanel[a];if(!u)return;this.creatChatPop(a,t.GameData.getInstance().ShortTalkArr[o],u),egret.Tween.get(u).wait(3e3).call(this.quickTalkCompelete,this,[u])}else{var u=this._quickTalkPanel[a];if(!u)return;this.showCommonTalk(e,n),egret.Tween.get(this._quickTalkPanel[a]).wait(3e3).call(this.quickTalkCompelete,this,[u])}}},n.prototype.showCommonTalk=function(e,n){var i=t.GameConstant.GetClientNoByUid(e);if(!(0>i||i>2)){var a=this._talkPanel[i],r=t.GameConstant.seatPosArr[i];if(a){switch(i){case 0:a.x=r.x+115,a.y=r.y;break;case 1:a.x=r.x-190,a.y=r.y;break;case 2:a.x=r.x+115,a.y=r.y}this.creatChatPop(i,n,a),egret.Tween.get(a).wait(3e3).call(this.talkCompelete,this,[a,i])}}},n.prototype.creatChatPop=function(e,n,i){if(i){var a=t.ResUtil.createBitmapByName("chat_pop_DDZ");a.scale9Grid=new egret.Rectangle(28,33,13,5),a.width=245,i.addChild(a);var r=t.ResUtil.createTextFeild(1456961,egret.HorizontalAlign.LEFT,"",28,35,10,210,!1,4);r.text=n,i.addChild(r),a.height=10+r.height+20,1==e?(a.scaleX=-1,a.x=180,r.x=-45):r.x-=10}},n.prototype.talkCompelete=function(t,e){t&&egret.Tween.removeTweens(t),uniLib.DisplayUtils.removeAllChildren(this._talkPanel[e]),this.parent&&this.parent.removeChild(this)},n.prototype.showCompelete=function(e,n){e&&egret.Tween.removeTweens(e),uniLib.DisplayUtils.removeAllChildren(this._facePanel[n]),t.GameInfo.topLayer.removeChild(this)},n.prototype.quickTalkCompelete=function(e,n){e&&egret.Tween.removeTweens(e),uniLib.DisplayUtils.removeAllChildren(e),t.GameInfo.topLayer.removeChild(this)},n}(eui.Component);t.ChatPop=e,__reflect(e.prototype,"game.ChatPop")}(game||(game={}));var game;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t._colorArr=[13235711,1151744,16714752],t.protocolType=1,t.skinName=new DismissPanel_DDZEvent_Skin,t.initPanel(),t}return __extends(n,e),n.prototype.initPanel=function(){this.touchEnabled=!0,this.yesBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onAgreeHandler,this),this.noBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRefuse,this),this.info=t.ResUtil.createTextFeild(14548215,egret.HorizontalAlign.LEFT,"",32,100,100,500),this.info.lineSpacing=10,this.addChild(this.info);for(var e=0;4>e;e++)this["_userName"+e]=t.ResUtil.createTextFeild(14548215,egret.HorizontalAlign.LEFT,"",32,167,270+53*e,222),this.addChild(this["_userName"+e]),this["_status"+e]=t.ResUtil.createTextFeild(14548215,egret.HorizontalAlign.CENTER,"",32,358,270+53*e,150),this.addChild(this["_status"+e]);this._timeTxt=t.ResUtil.createTextFeild(1271669,egret.HorizontalAlign.RIGHT,"",30,600,100,50),this.addChild(this._timeTxt)},n.prototype.stopTimer=function(){this._timer&&(this._timer.removeEventListener(egret.TimerEvent.TIMER,this.timerHandle,this),this._timer.stop(),this._timer=null)},n.prototype.timerHandle=function(t){var e=new Date,n=e.getTime(),i=this._totalTime-(n-this._startTime)/1e3;i>0?this._timeTxt.text=Math.floor(this._totalTime-(n-this._startTime)/1e3).toString():this.parent&&this.parent.removeChild(this)},n.prototype.setData=function(e){if(this.protocolType=1,null!=e.leftSec?this.endTime=t.GameTime.localNow()+1e3*e.leftSec:this.endTime=t.GameTime.localNow()+(e.endTime-t.GameTime.serverNow()),this.time=Math.floor(this.endTime/1e3-t.GameTime.localNow()/1e3),e.sponsor){var n="玩家"+e.sponsor+"\n申请解散房间请问是否同意(超过"+this.time+"秒未做出选择，则默认同意)？";this.info.text=n}var i=e.voterList;this._userList=[];for(var a=0;a<i.length;a++)this["_userName"+a].text=i[a].name,this["_status"+a].text=1==i[a].yesOrWait?"同意":"等待选择",this["_status"+a].textColor=this._colorArr[0],i[a].uid==uniLib.NetMgr.UID&&1==i[a].yesOrWait&&this.setButtonState(!1);this.updataTimer(),egret.clearInterval(this.timer),this.timer=egret.setInterval(this.updataTimer,this,1e3)},n.prototype.setData_Mjhong=function(e){this.protocolType=2,this.endTime=t.GameTime.localNow()+1e3*e.waitTime;var n=Math.floor(this.endTime/1e3-t.GameTime.localNow()/1e3);if(e.uid){var i="玩家"+e.uid+"\n申请解散房间请问是否同意(超过"+n+"秒未做出选择，则默认同意)？";this.info.text=i}for(var a=t.RoomData.Instance.seatList,r=0;r<a.length;r++){var o=a[r].user;o&&(this["_userName"+r].text=o.nickName,this["_status"+r].text="等待选择",this["_status"+r].textColor=this._colorArr[0],o.uid==e.uid&&(this["_status"+r].text="同意",this.setButtonState(!1)))}this.updataTimer(),egret.clearInterval(this.timer),this.timer=egret.setInterval(this.updataTimer,this,1e3)},n.prototype.updataTimer=function(){this.time=Math.floor(this.endTime/1e3-t.GameTime.localNow()/1e3),this.time<0&&(this.time=0,egret.clearInterval(this.timer)),this._timeTxt.text=this.time+""},n.prototype.setButtonState=function(t){this.yesBtn.visible=t,this.noBtn.visible=t,this.infoIcon1.visible=t,this.infoIcon2.visible=t},n.prototype.refrenshData=function(t){var e=t.voterList;if(!e||e&&e.length<1)this.parent&&this.parent.removeChild(this);else{var n=e.first(function(t){return 0==t.yesOrWait});!n&&this.parent&&this.parent.removeChild(this)}},n.prototype.enableBtns=function(){this.yesBtn&&this.yesBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onAgreeHandler,this),this.noBtn&&this.noBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRefuse,this)},n.prototype.updateStatus=function(e,n){0==e&&(e=2);var i=this._userList.indexOf(n);i>=0&&(this["_status"+i].text=t.DataCache.langObj.uiTxt.DismissPanel["status"+e],this["_status"+i].textColor=this._colorArr[e])},n.prototype.onAgreeHandler=function(e){if(2==this.protocolType){var n=new Cmd.ReplyDissolveRoom_C;return n.isAgree=1,void t.PokerFunction.tcpSend(n)}var i=new Cmd.DissolveRoomReturnCmd_C;i.yesOrNo=!0,t.PokerFunction.tcpSend(i)},n.prototype.onRefuse=function(e){if(2==this.protocolType){var n=new Cmd.ReplyDissolveRoom_C;return n.isAgree=0,void t.PokerFunction.tcpSend(n)}var i=new Cmd.DissolveRoomReturnCmd_C;i.yesOrNo=!1,t.PokerFunction.tcpSend(i)},n.prototype.destory=function(){this.enableBtns(),this.yesBtn&&this.yesBtn.destory(),this.yesBtn=null,this.noBtn&&this.noBtn.destory(),this.noBtn=null,this._timer&&(this._timer.removeEventListener(egret.TimerEvent.TIMER,this.timerHandle,this),this._timer.stop()),this._timer=null,this.info=null,this._timeTxt=null,this._userList=null},n}(eui.Component);t.DismissPanel=e,__reflect(e.prototype,"game.DismissPanel")}(game||(game={}));var game;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.skinName=new GpsPanel_BSDDZ_Skin,t.init(),t}return __extends(i,e),i.prototype.init=function(){this.addEvent()},i.prototype.setDate=function(t){t.list&&(this._ipGpsList=t.list),this.reset(t)},i.prototype.getNearset=function(e){if(this._nearestUserName="",this._distance=Number.MAX_VALUE,e.lat&&e.lng){for(var n=0;n<this._ipGpsList.length;n++)if(e.uid!=this._ipGpsList[n].uid){var i=uniLib.Utils.getDistance(e.lat,e.lng,this._ipGpsList[n].lat,this._ipGpsList[n].lng);i<this._distance&&(this._distance=i,this._nearestUserName=t.PokerFunction.GetUserInfoByUid(this._ipGpsList[n].uid).nickName)}}else this._nearestUserName=t.PokerFunction.GetUserInfoByUid(e.uid).nickName.slice(0,5),this._distance=-1},i.prototype.reset=function(t){for(var e=t,i=new eui.ArrayCollection,a=(e.list,0);a<e.list.length;a++){var r=e.list[a];this.getNearset(r),i.addItem({nearestUserName:this._nearestUserName,distance:this._distance,item:r})}this._itemList.itemRenderer=n,this._itemList.dataProvider=i},i.prototype.addEvent=function(){this._backBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBackHandler,this)},i.prototype.removeEvent=function(){this._backBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBackHandler,this)},i.prototype.onBackHandler=function(e){t.PopupManager.removePopUp(this,!0),this.destory()},i.prototype.destory=function(){this._backBtn=null},i}(eui.Component);t.DistancePanel=e,__reflect(e.prototype,"game.DistancePanel");var n=function(e){function n(){var t=e.call(this)||this;return t.skinName=GpsItem_DDZ_Skin,t.init(),t}return __extends(n,e),n.prototype.init=function(){},n.prototype.dataChanged=function(){var e=this.data.item;if(e){if(this._userName.text=t.PokerFunction.GetUserInfoByUid(e.uid).nickName.slice(0,5),this._ip.text=e.ipstr,this._otherName.text=this.data.nearestUserName,this.data.distance<=0)return void(t.DataCache.gameInfo&&5131==t.DataCache.gameInfo.gameId?this._distance.text="玩家未开启GPS":this._distance.text="未获得位置信息");
this._distance.text=(this.data.distance/1e3).toFixed(3).toString()+"km"}},n}(eui.ItemRenderer);t.DistanceItem=n,__reflect(n.prototype,"game.DistanceItem")}(game||(game={}));var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,n){function i(i){e.call(n,i,t)}if(RES.hasRes(t)){var a=RES.getRes(t);a?i(a):RES.getResAsync(t,i,this)}else RES.getResByUrl(t,i,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var game;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.skinName=new TotalResult_DDZEvent_Skin,t.init(),t}return __extends(i,e),i.prototype.init=function(){this.addEvent(),this.reasonLabel.visible=!1},i.prototype.setData=function(t){this.reset(t)},i.prototype.share=function(){var t=new uniLib.WXShareVo;t.shareWay=0;var e=new egret.Bitmap(uniLib.DisplayUtils.catchScreenToTex(this,new egret.Rectangle(0,0,this.width,this.height),.6));t.shareImageData=uniLib.DisplayUtils.catchScreen(e,new egret.Rectangle(0,0,this.width,this.height)),MJLobby.MJLobbyData.getInstance().hasXianLiao?uniLib.Global.dispatchEvent(uniLib.ZqEvent.SHARE,t,!1):uniLib.ZQGameSdk.share(t,null,this)},i.prototype.addUIListener=function(){},i.prototype.removeUIListener=function(){},i.prototype.adaptationWidth=function(){e.prototype.adaptationWidth.call(this)},i.prototype.reset=function(e){this._roomId.text="房间号："+t.RoomData.Instance.roomId,e.reason?(this.reasonLabel.visible=!0,this.reasonLabel.text=e.reason):this.reasonLabel.visible=!1;for(var i=e.gameNum,a=new eui.ArrayCollection,r=0;r<e.recordList.length;r++){var o=e.recordList[r],s=t.RoomData.Instance.ownerId==o.user.uid?!0:!1;a.addItem({gameNum:i,isLord:s,item:o})}this._itemList.itemRenderer=n,this._itemList.dataProvider=a;var h=new Date(Date.now()),d=h.getFullYear(),l=h.getMonth()+1,u=h.getDate(),c=h.getHours()>=10?h.getHours():"0"+h.getHours(),p=h.getMinutes()>=10?h.getMinutes():"0"+h.getMinutes();h.getSeconds()>=10?h.getSeconds():"0"+h.getSeconds();this._datatime.text=d+"."+l+"."+u+"   "+c+":"+p},i.prototype.oneMoreAgain=function(){t.GameInfo.topLayer.removeChild(this),t.GameView.exitGame(),uniLib.Global.dispatchEvent(uniLib.ZqEvent.EVENT_G2L,"game_request_continue")},i.prototype.addEvent=function(){this._shareBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.share,this),this.playAgainBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.oneMoreAgain,this),this._backBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBackHandler,this)},i.prototype.onBackHandler=function(){t.GameInfo.topLayer.removeChild(this),t.GameView.exitGame()},i.prototype.removeEvent=function(){this._shareBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.share,this),this.playAgainBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.oneMoreAgain,this),this._backBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBackHandler,this)},i.prototype.destory=function(){this._shareBtn=null,this._backBtn=null,this._datatime=null,this.reasonLabel&&(this.reasonLabel=null),this._itemNode.numChildren&&uniLib.DisplayUtils.removeAllChildren(this._itemNode),this._itemNode=null},i}(t.EuiPanel);t.GameOverPanel=e,__reflect(e.prototype,"game.GameOverPanel");var n=function(t){function e(){var e=t.call(this)||this;return e.skinName=new TotalItemSkin_lose_DDZ_Skin,e.init(),e}return __extends(e,t),e.prototype.init=function(){},e.prototype.dataChanged=function(){var t=this.data,e=t.item;e.profitSum>0&&(this.skinName=TotalItemSkin_win_DDZ_Skin);var n=e.user;if(n){this._uid.text=n.uid+"",this._headmc.source=n.headurl,this._headmc.width=this._headmc.height=84;var i=n.name;i.slice(0,5),this._username.text=i,this._bank.visible=t.isLord,this._maxCount.text=""+e.profitMax==null?"":(e.profitMax%1==0?e.profitMax:parseFloat(e.profitMax.toFixed(2))).toLocaleString(),this._boomCount.text=e.bombNum.toString();var a=e.winNum;this._winCount.text=a.toString()+"赢"+(t.gameNum-a)+"输",this._totalCount.text=""+t.item.profitSum==null?"":(t.item.profitSum%1==0?t.item.profitSum:parseFloat(t.item.profitSum.toFixed(2))).toLocaleString()}},e}(eui.ItemRenderer);t.TotalItemSkin=n,__reflect(n.prototype,"game.TotalItemSkin")}(game||(game={}));var game;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.tableClickTime=0,t._count=0,t.skinName=new GameView_DDZ_Event_Skin,t.initUI(),t}return __extends(n,e),Object.defineProperty(n,"Instance",{get:function(){return null==this.m_Instance&&(this.m_Instance=new n),this.m_Instance},enumerable:!0,configurable:!0}),n.clearInstance=function(){this.m_Instance=null},n.prototype.destroy=function(){this.removeHelp(),this.removeEventTimer(),egret.clearInterval(this.timer)},n.prototype.showTime=function(){egret.clearInterval(this.timer),this.updataTime(),this.timer=egret.setInterval(this.updataTime,this,1e4)},n.prototype.updataTime=function(){var t=new Date(Date.now()),e=t.getHours()>=10?t.getHours():"0"+t.getHours(),n=t.getMinutes()>=10?t.getMinutes():"0"+t.getMinutes();this.timeNowLabel.text=e+":"+n,uniLib.ZQGameSdk.getNetStateType(),uniLib.ZQGameSdk.getBatteryPer()},n.prototype.adaptationWidth=function(){e.prototype.adaptationWidth.call(this)},n.prototype.addUIListener=function(){this.readyButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.dissRoomButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.backLobbyButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.setBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.helpBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.tableclothImage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.shareButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.trusteeshipBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.inviteFBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.inviteQQFBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.inviteWeChatFBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.gameStartBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.chatButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.selectCard.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.noteCardBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),uniLib.Global.addEventListener(uniLib.ZqEvent.NATIVE_TO_EGERET,this.onNativeMessage,this),GX.PokerEvent.Instance.dealCardEnd.add(this.dealCardFinish,this),this.gpsBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),t.RoomData.Instance.roomIdChanged.add(this.roomIdChanged,this),t.RoomData.Instance.inningsChanged.add(this.ShowNumberOfGame,this),uniLib.Global.addEventListener(uniLib.ZqEvent.EVENT_L2G,this.onMoon,this),t.RoomData.Instance.startGameChanged.add(this.startGameChanged,this),t.RoomData.Instance.landlordChanged.add(this.landlordChanged,this),t.RoomData.Instance.threeCardChanged.add(this.threeCardChanged,this),t.RoomData.Instance.operateChanged.add(this.operateChanged,this),t.RoomData.Instance.robLordOperateChanged.add(this.robLordOperateChanged,this),t.RoomData.Instance.multipleChanged.add(this.multipleChanged,this),t.RoomData.Instance.roomTypeChange.add(this.roomTypeChange,this),t.RoomData.Instance.pointBaseChanged.add(this.pointBaseChanged,this),t.RoomData.Instance.kickOperateChanged.add(this.kickOperateChange,this),t.RoomData.Instance.roomLevelChanged.add(this.roomLevelChangeHandle,this),t.RoomData.Instance.bottomPointChange.add(this.bottomPointChange,this),t.RoomData.Instance.matchidChanged.add(this.matchIdChange,this),uniLib.Global.addEventListener(uniLib.ZqEvent.EVENT_L2G,this.eventInfoChangeHandle,this)},n.prototype.removeUIListener=function(){this.readyButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.dissRoomButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.backLobbyButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.setBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.helpBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.tableclothImage.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.shareButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.trusteeshipBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.inviteFBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.inviteQQFBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.inviteWeChatFBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.gameStartBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.chatButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.selectCard.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.noteCardBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),uniLib.Global.removeEventListener(uniLib.ZqEvent.NATIVE_TO_EGERET,this.onNativeMessage,this),uniLib.Global.removeEventListener(uniLib.ZqEvent.EVENT_L2G,this.onMoon,this),uniLib.Global.removeEventListener(uniLib.ZqEvent.EVENT_L2G,this.eventInfoChangeHandle,this),uniLib.Global.removeEventListener(t.UIEventConsts.EXCHANGE_DESK,this.onMoon,this),t.RoomData.Instance.bottomPointChange.remove(this.bottomPointChange,this),t.RoomData.Instance.matchidChanged.remove(this.matchIdChange,this),this.gpsBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),GX.PokerEvent.Instance.dealCardEnd.remove(this.dealCardFinish,this)},n.prototype.initUI=function(){this.addChild(t.SeatLayer.Instance),this.addChild(t.CardLayer.Instance),t.SeatLayer.Instance.initSeatSprite(),this.addChild(t.OperateLayer.Instance),this.showEnterButtons(),this.updataReadyButton(!1),this.multipleChanged(0),this.threeCardChanged(null);var e=new t.VoiceChat;e.updateBtnRes(["NDvoice_btn1","NDvoice_btn2"]),t.GameInfo.uiLayer.addChild(e),this.nativeGroup.addChild(t.Ping.instance),t.Ping.instance.setPingPos(this.wifiOrDataImage.x-50,this.wifiOrDataImage.y+28),this.showTime(),"true"==uniLib.BrowersUtils.GetRequest("debug")?this.selectCard.visible=!0:this.selectCard.visible=!1,0!=uniLib.Global.is_sandbox&&(this.gpsBtn.visible=!1,this.removeChild(this.shareButton)),this.signalLabel.visible=!1,this.showVersion(),this.showVideoPanel(),this.removeEventTimer(),MJLobby.MJLobbyData.getInstance().isInEventGame?(this.topGroup.width=0/0,this.eventGroup.visible=!0,this.roomNumber.visible=!1,this.infoBg.visible=!1,this.trusteeshipBtn.visible=this.chatButton.visible=!1,this.showEventInfo()):(this.eventGroup.visible=!1,this.topGroup.width=300*uniLib.ScreenUtils.scaleFactor,this.roomNumber.visible=!0,this.infoBg.visible=!0,this.trusteeshipBtn.visible=this.chatButton.visible=!0)},n.prototype.eventInfoChangeHandle=function(t){if(t.param&&t.param.data){var e=t.param.data;e&&(this.eventUserNum.text=e.myOrder+"杠"+e.userNumber)}},n.prototype.onNativeMessage=function(e){e.param.cmd==uniLib.ZQGameSdk.NETSTATE&&0==e.param.code?(uniLib.ZQGameSdk.lastNetState&&uniLib.ZQGameSdk.lastNetState.data[uniLib.ZQGameSdk.NETSTATE]!=e.param.data[uniLib.ZQGameSdk.NETSTATE]&&(t.PokerFunction.tcpSend(new Cmd.ClientEchoRoomCmd_SC),uniLib.NetMgr.setMsgTimeout(5,"ClientEchoRoomCmd_SC")),e.param.data[uniLib.ZQGameSdk.NETSTATE]==uniLib.NetState.NO_SIGNAL?(this.signalLabel.visible=!0,this.wifiOrDataImage.visible=!1):e.param.data[uniLib.ZQGameSdk.NETSTATE]==uniLib.NetState.WIFI?(this.signalLabel.visible=!1,this.wifiOrDataImage.visible=!0,this.wifiOrDataImage.source="wifi_DDZ"):e.param.data[uniLib.ZQGameSdk.NETSTATE]==uniLib.NetState.DATA_FLOWS?(this.signalLabel.visible=!1,this.wifiOrDataImage.visible=!0,this.wifiOrDataImage.source="data_DDZ"):e.param.data[uniLib.ZQGameSdk.NETSTATE]==uniLib.NetState.WIFI_AND_DATA&&(this.signalLabel.visible=!1,this.wifiOrDataImage.visible=!0,this.wifiOrDataImage.source="wifi_DDZ")):e.param.cmd==uniLib.ZQGameSdk.BATTERY&&0==e.param.code&&(this.betteryButton.skin.image.width=e.param.data[uniLib.ZQGameSdk.BATTERY]/100*25)},Object.defineProperty(n.prototype,"bottomPoint",{get:function(){return this._bottomPoint},enumerable:!0,configurable:!0}),n.prototype.bottomPointChange=function(e){e?(0==MJLobby.MJLobbyData.getInstance().isInEventGame&&(this.bottomLabel.visible=!0,this.bottomLabel.text="底注："+t.RoomData.Instance.bottomPoint,this._bottomPoint=e),this.backLobbyButton.visible=!1,this.dissRoomButton.visible=!1,this.shareButton.visible=!1,this.numberOfGame.visible=!1):(this.bottomLabel.text="",this.bottomLabel.visible=!1,this.numberOfGame.visible=!0)},n.prototype.dealCardFinish=function(){this.noteCardBtn.visible=t.RoomData.Instance.cardNoteVisible},n.prototype.matchIdChange=function(e){t.RoomData.Instance.matchid&&(this.roomNumber.text="包厢ID:"+t.RoomData.Instance.matchid)},n.prototype.showVersion=function(){var t=new eui.Label;t.fontFamily="Microsoft YaHei",t.size=20,t.textColor=6309149,t.text=uniLib.Global.version.toString(),t.x=uniLib.Global.screenWidth-10-t.width,t.y=uniLib.Global.screenHeight-5-t.height,this.addChild(t)},n.prototype.roomLevelChangeHandle=function(e){null!=e&&t.RoomData.Instance.roomType==Cmd.RoomType.RoomType_Quick&&(this.roomNumber.text=1==e?"初级场":2==e?"中级场":3==e?"高级场":"")},n.prototype.onClickTap=function(e){if(e.target==this.tableclothImage)return t.SoundHand.Instance.playButtonClick(),t.CardLayer.Instance.recoveryCardPosition(),void t.OperationPlay.Instance.playButtonEnabled();if(e.target==this.readyButton){var i=new Cmd.ReadyUpdateRoomCmd_CS;"up"==this.readyButton.currentState?i.yesOrNo=!0:i.yesOrNo=!1,t.PokerFunction.tcpSend(i),t.SoundHand.Instance.playButtonClick()}else if(e.target==this.dissRoomButton)this.dissRoom(),t.SoundHand.Instance.playButtonClick();else if(e.target==this.backLobbyButton){if(t.PokerData.isStandAlone)return void n.exitGame();if(t.RoomData.Instance.roomType==Cmd.RoomType.RoomType_Match)this.showMessageBox();else{var i=new Cmd.LeaveRoomCmd_CS;i.uid=uniLib.NetMgr.UID,t.PokerFunction.tcpSend(i)}t.SoundHand.Instance.playButtonClick()}else if(e.target==this.setBtn)this.showSetting(),t.SoundHand.Instance.playButtonClick();else if(e.target==this.helpBtn)this.showHelp(),t.SoundHand.Instance.playButtonClick();else if(e.target==this.chatButton){var a=new t.ChatPanel;t.PopupManager.addPopUp(a,!0,!1),t.SoundHand.Instance.playButtonClick()}else if(e.target==this.shareButton)this.showShare(),t.SoundHand.Instance.playButtonClick();else if(e.target==this.trusteeshipBtn)this.gameTrusteeshipRquest(),t.SoundHand.Instance.playButtonClick();else if(e.target==this.inviteFBtn||e.target==this.inviteQQFBtn)MJLobby.LobbyPopupManager.showMildWarnShow("此功能还未开放"),t.SoundHand.Instance.playButtonClick();else if(e.target==this.inviteWeChatFBtn)this.showShare(),t.SoundHand.Instance.playButtonClick();else if(e.target==this.gameStartBtn){if(!t.RoomData.Instance.roomId)return;var i=new Cmd.ReadyUpdateRoomCmd_CS;i.yesOrNo=!0,t.PokerFunction.tcpSend(i),this.gameStartBtn.visible=!1,t.SoundHand.Instance.playButtonClick()}else if(e.target==this.selectCard){var r=new Cmd.GmAvailableCardUpdateCmd_CS;t.PokerFunction.tcpSend(r),this.showTestPanel()}else e.target==this.noteCardBtn?this.showNoteCardPanel():e.target==this.gpsBtn&&this.showDistancePanel()},n.prototype.showDistancePanel=function(){function e(t){if(0==t.code){n.lng=t.data.longitude,n.lat=t.data.latitude;var e=new Cmd.GetGPSLocationCmd_C;e.lat=n.lat,e.lng=n.lng,uniLib.NetMgr.tcpSend(e)}}var n;n=uniLib.ZQGameSdk.getLocation(e,this);var i=new Cmd.RequestIpGPSCmd_C;t.PokerFunction.tcpSend(i),this.distancePanel||(this.distancePanel=new t.DistancePanel),t.PopupManager.addPopUp(this.distancePanel,!0,!0)},n.prototype.setDistanceDate=function(t){t&&this.distancePanel&&this.distancePanel.setDate(t)},n.prototype.showVideoPanel=function(){0!=t.RoomInfo.getInstance().video&&(this._videoPanel=new t.VideoPanel,t.GameInfo.main.addChild(this._videoPanel),t.RoomInfo.getInstance().GM_Mode=!0)},n.prototype.onMoon=function(t){switch(t.param){case"video_play_finish":this.showVideoFinish(0)}},n.prototype.showNoteCardPanel=function(){var e=t.CardNotePanel.Instatnce;t.GameInfo.topLayer.addChild(e),e.x=(uniLib.Global.screenWidth-e.width)/2,e.y=uniLib.Global.screenHeight-e.height},n.prototype.showVideoFinish=function(e){var n="";0==e?(n="录像播放完毕!",t.PublicManage.getInstance().showVideoCommonPanel(n,["是"],[this.videoExit],null,this)):(n="确定退出录像？",t.PublicManage.getInstance().showVideoCommonPanel(n,["是","否"],[this.videoExit],null,this))},n.prototype.videoExit=function(){uniLib.Global.dispatchEvent(uniLib.ZqEvent.EVENT_G2L,"video_close"),t.RoomInfo.getInstance().GM_Mode=!1,t.RoomInfo.getInstance().video=0,t.RoomInfo.getInstance().videoUid=0,n.exitGame()},n.prototype.videoReplay=function(){uniLib.Global.dispatchEvent(uniLib.ZqEvent.EVENT_G2L,"video_replay")},n.prototype.showSuspendPrompt=function(t,e){t?e?this.suspendPrompt.text=e:this.suspendPrompt.text="牌局超时暂停中！":this.suspendPrompt.text=""},n.prototype.updateTimeout=function(t){if(this.stopTimer(),t.leftsec){this.dissNickName=null,this.dissNickName=t.nickname,this.leftSec=null!=t.leftsec?t.leftsec:100;var e=new Date;this._startTime=e.getTime(),this._timerDiss=new egret.Timer(1e3),this._timerDiss.addEventListener(egret.TimerEvent.TIMER,this.timerHandle,this),this._timerDiss.start();var n=t.nickname+"("+this.leftSec+")";this.suspendPrompt.text=n}else this.suspendPrompt.text=""},n.prototype.timerHandle=function(t){var e=new Date,n=e.getTime(),i=this.leftSec-(n-this._startTime)/1e3;if(i>0){var a=this.dissNickName+"离线中！("+Math.floor(this.leftSec-(n-this._startTime)/1e3)+"秒后房间将解散)";this.suspendPrompt.text=a}else this.stopTimer()},n.prototype.stopTimer=function(){this._timerDiss&&(this._timerDiss.stop(),this._timerDiss.removeEventListener(egret.TimerEvent.TIMER,this.timerHandle,this),this._timerDiss=null)},n.prototype.ShowNumberOfGame=function(){var e=t.RoomData.Instance.roomCurrentInnings,n=t.RoomData.Instance.roomTotalInnings;if(!e||!n)return void(this.numberOfGame.text="");var i=t.RoomData.Instance.roomType;t.PokerData.isStandAlone||null!=i&&i==Cmd.RoomType.RoomType_Normal||i==Cmd.RoomType.RoomType_Match?this.numberOfGame.text="第"+e+"/"+n+"局":this.numberOfGame.text="",e&&e>1&&this.removeControlButton()},n.prototype.removeControlButton=function(){this.backLobbyButton.parent&&this.removeChild(this.backLobbyButton),this.dissRoomButton.parent&&this.removeChild(this.dissRoomButton),this.shareButton.parent&&this.removeChild(this.shareButton)},n.prototype.showTestPanel=function(){var e=t.TestPanel.Instance;e.x=(uniLib.Global.screenWidth-e.width)/2,e.y=80,t.GameInfo.topLayer.addChild(e)},n.prototype.showMyChips=function(t){t=null==t?0:t,t%1==0?this.chipsLabel.text=t+"":this.chipsLabel.text=t.toFixed(2)},n.prototype.showShare=function(){var e=new uniLib.WXShareVo;e.shareWay=0,t.DataCache.platParam&&(e.title=t.DataCache.platParam.shareInfo.title,e.description=t.DataCache.platParam.shareInfo.content,e.webpageUrl=t.DataCache.platParam.shareInfo.webPageUrl),MJLobby.MJLobbyData.getInstance().hasXianLiao?uniLib.Global.dispatchEvent(uniLib.ZqEvent.SHARE,e,!1):uniLib.ZQGameSdk.share(e,null,this)},n.prototype.gameTrusteeshipRquest=function(){var e=t.PokerFunction.GetUserInfoByUid(uniLib.NetMgr.UID);if(!e||!e.isTrust){var n=new Cmd.HostUpdateRoomCmd_CS;n.yesOrNo=!0,n.uid=uniLib.NetMgr.UID,t.PokerFunction.tcpSend(n)}},n.prototype.setTrusteeshipBtn=function(t){this.trusteeshipBtn.visible=t},n.prototype.setBtnsVisible=function(t){this.dissRoomButton.visible=t,this.backLobbyButton.visible=t},n.prototype.dissRoom=function(){this.msgBox&&(this.msgBox=null);var e=function(e){this.msgBox&&(t.PopupManager.removePopUp(this.msgBox,!1),this.msgBox=null)};if(!this.msgBox){var n="你确定请求解散房间？";this.msgBox=new t.MsgBoxPanel,this.msgBox.setData(n,["确定","取消"],[this.confirmHandler,e])}t.PopupManager.addPopUp(this.msgBox,!0,!0)},n.prototype.confirmHandler=function(e){this.msgBox&&(t.PopupManager.removePopUp(this.msgBox,!1),this.msgBox=null);var n=new Cmd.DissolveRoomRequestCmd_C;t.PokerFunction.tcpSend(n)},n.prototype.roomIdChanged=function(){t.PokerData.isStandAlone?this.roomNumber.text="练习场(不结算)":this.roomNumber.text="房间ID:"+t.RoomData.Instance.roomId},n.prototype.roomTypeChange=function(){if(t.RoomData)switch(t.RoomData.Instance.roomType){case Cmd.RoomType.RoomType_Normal:break;case Cmd.RoomType.RoomType_Quick:this.setBtnsVisible(!1),this.shareButton.visible=!1;break;default:this.setBtnsVisible(!1),this.shareButton.visible=!1}},n.prototype.pointBaseChanged=function(t){(null==t||0/0==t)&&(t=0),this.timesLabel.text=null!=this.beforeMultiple?"x"+this.beforeMultiple*(t?t:1):"x1"},n.prototype.startGameChanged=function(){t.RoomData.Instance.startGame&&(this.setBtnsVisible(!1),this.readyButton.visible=!1,this.shareButton.visible=!1),t.PokerData.isStandAlone&&(this.trusteeshipBtn.visible=!1),this.noteCardBtn.visible=t.RoomData.Instance.cardNoteVisible},n.prototype.landlordChanged=function(e){t.OperateLayer.Instance.removeLandlordRobImage(),t.OperateLayer.Instance.stopTimer(),t.OperateLayer.Instance.removeRobLandlord(),t.CardLayer.Instance.updataHandCardPosition(),this.trusteeshipBtn.visible||(this.trusteeshipBtn.visible=!0),t.PokerData.isStandAlone&&(this.trusteeshipBtn.visible=!1),this.gameStartBtn.visible&&(this.gameStartBtn.visible=!1)},n.prototype.addLandlordImage=function(e){this.removeLandlordImage(),null==this.landlordImage&&(this.landlordImage=new egret.Bitmap(RES.getRes("landlord_hat"))),this.landlordImage.scaleX=.3,this.landlordImage.scaleY=.3,this.landlordImage.anchorOffsetX=this.landlordImage.width/2,this.landlordImage.anchorOffsetY=this.landlordImage.height,this.landlordImage.x=60,this.landlordImage.y=25;var n=t.GameConstant.GetSeatSpriteByUid(e);null!=n&&n.addChild(this.landlordImage)},n.prototype.removeLandLordImage=function(){this.landlordImage&&this.landlordImage.parent.removeChild(this.landlordImage),this.landlordImage=null},n.prototype.removeLandlordImage=function(){var t=this.landlordImage;t&&t.parent&&t.parent.removeChild(t)},Object.defineProperty(n.prototype,"threeCards",{get:function(){return this.threeCard},enumerable:!0,configurable:!0}),n.prototype.threeCardChanged=function(e){if(this.addThreeCard(),null!=e){for(var n=0;n<e.length;n++)this.threeCard[n]?this.threeCard[n].texture=t.GameConstant.GetPokerTextureByCardId(e[n]):t.PublicManage.getInstance().showMildWarnShow("error threeCard.length:"+e.length);if(1==t.RoomInfo.getInstance().video){var i=t.RoomData.Instance.landlordUid,a=t.GameConstant.GetClientNoByUid(i);if(1==a||2==a){var r=t.PokerFunction.GetSeatDataByUid(i),o=r.handCards.deepcopy();r.clearHandCard();for(var s=0,h=e;s<h.length;s++){var d=h[s];o.push(d)}var l=t.PokerFunction.handCardSort;l&&(o=l(o));for(var u=0,c=o;u<c.length;u++){var d=c[u];r.addHandCard(d)}r.handCardSum+=e.length}}}else for(var n=0;3>n;n++)this.threeCard[n].texture=RES.getRes("DDZ_BackCard2")},n.prototype.addThreeCard=function(){if(null==this.threeCard){this.threeCard=new Array;for(var e=(3*t.GameConstant.BluffCardGap-(t.GameConstant.BluffCardGap-t.GameConstant.BluffCardWidth),44),n=0;3>n;n++){var i=new egret.Bitmap;i.width=t.GameConstant.BluffCardWidth,i.height=t.GameConstant.BluffCardHeight,i.anchorOffsetX=t.GameConstant.BluffCardWidth/2,i.x=e+t.GameConstant.BluffCardGap*n,i.y=10,this.threeCard[n]=i}}for(var a=0,r=this.threeCard;a<r.length;a++){var o=r[a];this.threeCardGroup.addChild(o)}this.threeCardImage.visible=!1},n.prototype.removeThreeCard=function(){if(this.threeCard){for(var t=0,e=this.threeCard;t<e.length;t++){var n=e[t];n.parent&&this.removeChild(n)}this.threeCardImage.visible=!0}},n.prototype.operateChanged=function(e){var n=t.PokerFunction.GetSeatDataByUid(e.uid);if(n){var i=t.DDZAI.Instance.getCardOperableList(n.seatId);i&&i.length&&(e.cardSetList=i)}t.OperateLayer.Instance.operateChanged(e)},n.prototype.robLordOperateChanged=function(e){t.OperateLayer.Instance.updataRobLandlord(e)},n.prototype.kickOperateChange=function(e){t.OperateLayer.Instance.kickOperateChanged(e)},n.prototype.multipleChanged=function(e){this.beforeMultiple&&0!=this.beforeMultiple&&e&&t.EffectCreate.Instance.multipleEffect(e/this.beforeMultiple),this.beforeMultiple=e,this.addMultipleLabel(),this.timesLabel.text=null!=e?"x"+e*(t.RoomData.Instance.pointBase?t.RoomData.Instance.pointBase:1):"x1"},n.prototype.addMultipleLabel=function(){null==this.multipleLabel&&(this.multipleLabel=new eui.Label,this.multipleLabel.size=25,this.multipleLabel.stroke=1,this.multipleLabel.y=110),this.addChild(this.multipleLabel)},n.prototype.removeMultipleLabel=function(){this.multipleLabel&&this.multipleLabel.parent&&this.removeChild(this.multipleLabel)},n.prototype.showEnterButtons=function(){if(this.backLobbyButton&&this.shareButton&&this.dissRoomButton){if(t.DataCache.platParam){var e=Number(t.DataCache.platParam.roomId);if(1e5>e)return}this.backLobbyButton.visible=!0,1!=uniLib.Global.is_sandbox&&(this.shareButton.visible=!0),1==uniLib.Global.is_sandbox,this.dissRoomButton.visible=!0}},n.prototype.updataReadyButton=function(e){e?this.readyButton.currentState="down":this.readyButton.currentState="up",t.RoomData.Instance.roomType==Cmd.RoomType.RoomType_Quick||t.RoomData.Instance.roomType==Cmd.RoomType.RoomType_Match?this.setBtnsVisible(!1):this.setBtnsVisible(!e)},n.prototype.setReadyBtnVisible=function(t,e){t&&(this.readyButton.visible=t,null!=e&&(this.readyButton.currentState=e)),this.readyButton.visible=t},n.prototype.restart=function(){t.OperateLayer.Instance.removeOperateMain(),t.OperateLayer.Instance.stopTimer(),t.OperateLayer.Instance.removeWarningEffect(),t.OperateLayer.Instance.removePlayCardSprites(),this.threeCardChanged(null),t.SeatLayer.Instance.resetSeat(),this.removeLandLordImage();for(var e=0;e<t.RoomData.Instance.seatList.length;e++){var n=t.RoomData.Instance.seatList[e];n&&n.clearHandCard()}t.RoomData.Instance.multiple=0,t.RoomData.Instance.landlordUid=null,this.readyButton.visible=!0,this.readyButton.currentState="down",t.CardLayer.Instance.removeupNotUp()},n.prototype.showSetting=function(){var e=new t.SettingPanel;t.PopupManager.addPopUp(e,!0,!0)},n.prototype.showHelp=function(){this._helpPanel||(this._helpPanel=new t.HelpPanel,this._helpPanel.addEventListener(t.UIEventConsts.CLOSE,this.removeHelp,this)),t.PopupManager.addPopUp(this._helpPanel,!0)},n.prototype.removeHelp=function(){this._helpPanel&&(this._helpPanel.removeEventListener(t.UIEventConsts.CLOSE,this.removeHelp,this),uniLib.DisplayUtils.removeFromParent(this._helpPanel),this._helpPanel.destory(),t.PopupManager.removePopUp(this._helpPanel),this._helpPanel=null)},n.exitGame=function(){if(MJLobby.MJLobbyData.getInstance().isInEventGame=!1,t.GameData.iskPoker=!1,t.PokerFunction.exitGame(),n.Instance.destroy(),t.CardLayer.Instance.destroy(),t.OperateLayer.Instance.destroy(),t.DDZAI.clearInstance(),t.DDZStandAlone.clearInstance(),t.Ping.clearInstance(),t.DataCache.gameInfo&&t.DataCache.gameInfo.defaultOrientation!=egret.OrientationMode.LANDSCAPE&&(uniLib.ScreenUtils.landscape=!1),uniLib.GameModuleUtils.ExitGame(!1),t.DataCache.destroyResOnExit){var e=RES.destroyRes(t.GameConstant.ResGroup_DDZ,!0);uniLib.ResUtils.clearResConfigByGroupName([t.GameConstant.ResGroup_DDZ]),console.error("销毁"+t.GameConstant.ResGroup_DDZ+":"+e)}t.GameInfo.uiLayer=null,t.GameInfo.mainUILayer=null,t.GameInfo.topLayer=null,t.GameInfo.main=null},n.prototype.showMessageBox=function(){this.msgbox||(this.msgbox=new t.MsgBoxPanel),this.msgbox.setData("不能返回大厅，你要解散游戏么",["确定","取消"],[this.confirmHandel,this.cancelHandel],this),t.PopupManager.addPopUp(this.msgbox,!0,!0)},n.prototype.confirmHandel=function(e){var n=new Cmd.DissolveRoomRequestCmd_C;t.PokerFunction.tcpSend(n)},n.prototype.cancelHandel=function(t){this.removeTips()},n.prototype.removeTips=function(){this.msgbox&&(t.PopupManager.removePopUp(this.msgbox,!0),this.msgbox=null)},n.prototype.showEventInfo=function(){var t=MJLobby.MJLobbyData.getInstance().eventData;t&&(this.eventUserNum.text=t.myOrder+"杠"+t.userNumber,this.basePoint.text="基础分:"+t.bottomPoint,this.outPoint.text="淘汰分:"+t.leavingPoint,this._count=t.time?t.time:0),this._eventTimer=new egret.Timer(1e3),this._eventTimer.addEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this._eventTimer.start()},n.prototype.onTimer=function(t){this._count++,this.eventTime.text=this.formateTime(this._count)},n.prototype.removeEventTimer=function(){null!=this._eventTimer&&(this._eventTimer.stop(),this._eventTimer.removeEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this._eventTimer=null)},n.prototype.formateTime=function(t){var e="",n=Math.round(t/3600)+"",i=parseInt(t%3600/60+"").toString().padLeft(2,"0"),a=(t%3600%60).toString().padLeft(2,"0");return e=n+":"+i+":"+a+" "},n}(t.EuiPanel);t.GameView=e,__reflect(e.prototype,"game.GameView")}(game||(game={}));var game;!function(t){var e=function(e){function n(t){var n=e.call(this)||this;return n.m_selected=!1,n.m_darken=!1,n.m_cardId=t,n.addCard(),n.selectChanged(!1),n}return __extends(n,e),Object.defineProperty(n.prototype,"cardId",{get:function(){return this.m_cardId},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selected",{get:function(){return this.m_selected},set:function(t){this.m_selected=t,this.selectChanged(t)},enumerable:!0,configurable:!0}),n.prototype.selectChanged=function(e){e?this.y=t.GameConstant.HandCardSelectY:this.y=t.GameConstant.HandCardY},Object.defineProperty(n.prototype,"darken",{get:function(){return this.m_darken},set:function(t){this.m_darken!=t&&(this.m_darken=t,this.darkenChanged(t))},enumerable:!0,configurable:!0}),n.prototype.darkenChanged=function(t){t?this.addDarken():this.removeDarken()},n.prototype.addDarken=function(){null==this.darkenImage&&(this.darkenImage=new egret.Bitmap(RES.getRes("Poker_dark"))),this.darkenImage.width=this.width,this.darkenImage.height=this.height,this.addChild(this.darkenImage)},n.prototype.addLordLogo=function(){this.lordLogo||(this.lordLogo=new egret.Bitmap(RES.getRes("lord"))),this.addChild(this.lordLogo),this.lordLogo.width=80,this.lordLogo.height=80,this.lordLogo.y=2,this.lordLogo.x=this.width-this.lordLogo.width-2},n.prototype.removeLordLogo=function(){this.lordLogo&&this.lordLogo.parent&&this.removeChild(this.lordLogo)},n.prototype.removeDarken=function(){this.darkenImage&&this.darkenImage.parent&&this.removeChild(this.darkenImage)},n.prototype.addCard=function(){this.card=new egret.Bitmap(t.GameConstant.GetPokerTextureByCardId(this.cardId)),this.card.width=t.GameConstant.CardWidth,this.card.height=t.GameConstant.CardHeight,this.addChildAt(this.card,0)},Object.defineProperty(n.prototype,"cardWidth",{set:function(t){this.card.width=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"cardHeight",{set:function(t){this.card.height=t},enumerable:!0,configurable:!0}),n.prototype.darkCard=function(){},n}(egret.DisplayObjectContainer);t.HandCardSprite=e,__reflect(e.prototype,"game.HandCardSprite")}(game||(game={}));var game;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.skinName=new Help_DDZ_Skin,t}return __extends(n,e),n.prototype.init=function(){e.prototype.init.call(this);var t=null;RES.hasRes("help_4085_txt")&&(t=RES.getRes("help_4085_txt"))},n.prototype.hide=function(){uniLib.PopUpMgr.removePopUp(this),this.dispatchEventWith(t.UIEventConsts.CLOSE),t.SoundHand.Instance.playButtonClick()},n.prototype.addEvent=function(){e.prototype.addEvent.call(this),this._close_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.hide,this)},n.prototype.removeEvent=function(){e.prototype.removeEvent.call(this),this._close_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.hide,this)},n.prototype.destory=function(){e.prototype.destroy.call(this),this._txt=null},n}(t.BaseEui);t.HelpPanel=e,__reflect(e.prototype,"game.HelpPanel")}(game||(game={}));
var game;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.skinName=new MsgBox_DDZ_Event_Skin,t.init(),t}return __extends(i,e),i.prototype.init=function(){},i.prototype.setData=function(t,e,i,a,r){this.desLabel.text=t,this.labelArray=e,this.funcArray=i,this._backObj=a,this.btnsGroup.removeChildren(),this.yesBtn=null,this.noBtn=null,1==e.length?(this.yesBtn=new n("确定"),this.btnsGroup.addChild(this.yesBtn)):2==e.length&&(this.yesBtn=new n("确定"),this.btnsGroup.addChild(this.yesBtn),this.noBtn=new n("取消"),this.btnsGroup.addChild(this.noBtn)),this.funcArray&&this.funcArray[0]&&this.yesBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.funcArray[0],this._backObj),this.funcArray&&this.funcArray[1]&&this.noBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.funcArray[1],this._backObj),this.yesBtn&&this.yesBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.noBtn&&this.noBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this)},i.prototype.onClose=function(e){t.PopupManager.removePopUp(this)},i.prototype.destroy=function(){},i}(eui.Component);t.MsgBoxPanel=e,__reflect(e.prototype,"game.MsgBoxPanel");var n=function(t){function e(e){var n=t.call(this)||this;return n.skinName=new Button_DDZ_Event_Skin,n.iconDisplay.source="取消"==e?"public_btn_cancle_ddz":"public_btn_confirm_ddz",n}return __extends(e,t),e}(eui.Button);t.GameButtonItem=n,__reflect(n.prototype,"game.GameButtonItem")}(game||(game={}));var DDZLoadingView=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this.backgroud_bmp||(this.backgroud_bmp=MJLobby.LobbyResUtil.createBitmapByName("HZ_login_bg_png"),this.backgroud_bmp.width=uniLib.Global.screenWidth,this.backgroud_bmp.height=uniLib.Global.screenHeight,this.addChild(this.backgroud_bmp)),this.bigLogo||(this.bigLogo=MJLobby.LobbyResUtil.createBitmapByName("ddz_big_logo_png_png"),this.bigLogo.x=(uniLib.Global.screenWidth-this.bigLogo.width)/2,this.bigLogo.y=106,this.addChild(this.bigLogo)),this.darkLine_bmp||(this.darkLine_bmp=MJLobby.LobbyResUtil.createBitmapByName("lb_loading_darkLine",432,uniLib.Global.screenHeight-196*uniLib.ScreenUtils.scaleFactor),this.addChild(this.darkLine_bmp)),this.lightLine_bmp||(this.lightLine_bmp=MJLobby.LobbyResUtil.createBitmapByName("lb_loading_lightLine",this.darkLine_bmp.x+2,this.darkLine_bmp.y-10),this.lightLine_bmp.scale9Grid=new egret.Rectangle(12,18,10,2),this.addChild(this.lightLine_bmp)),this.explain_txf||(this.explain_txf=MJLobby.LobbyResUtil.createTextFeild(0,egret.HorizontalAlign.CENTER,"",22,500,uniLib.Global.screenHeight-171*uniLib.ScreenUtils.scaleFactor,276),this.addChild(this.explain_txf)),this._progTxt||(this._progTxt=MJLobby.LobbyResUtil.createTextFeild(0,egret.HorizontalAlign.CENTER,"",22,520,uniLib.Global.screenHeight-220*uniLib.ScreenUtils.scaleFactor,276),this.addChild(this._progTxt)),this._infoTxt||(this._infoTxt=MJLobby.LobbyResUtil.createTextFeild(0,egret.HorizontalAlign.CENTER,"抵制不良游戏 拒绝盗版游戏 注意自我保护 谨防受骗上当 适度游戏益脑 沉迷游戏伤身 合理安排时间 享受健康生活",20,0,uniLib.Global.screenHeight-44*uniLib.ScreenUtils.scaleFactor,MJLobby.LobbyDataCache.defaultWidth),this.addChild(this._infoTxt))},e.prototype.setProgress=function(t,n,i,a,r){if(void 0===r&&(r=!1),this._versionTxt||(this._versionTxt=MJLobby.LobbyResUtil.createTextFeild(10066329,egret.HorizontalAlign.RIGHT,MJLobby.LobbyDataCache.version,22,864),this._versionTxt.x=uniLib.Global.screenWidth-this._versionTxt.width,this._versionTxt.y=uniLib.Global.screenHeight-this._versionTxt.height,this.addChild(this._versionTxt),this._versionTxt.text=MJLobby.LobbyDataCache.version),n&&0!=n){var o=Math.ceil(t/n*100);i&&""!=i?this.explain_txf.text=i:this.explain_txf.text=e.explain,0==r&&o>93&&(o=93);var s=this.darkLine_bmp.width*(o/100)+27;this.lightLine_bmp.width=s,this.lightLine_bmp.width>this.darkLine_bmp.width&&(this.lightLine_bmp.width=this.darkLine_bmp.width),this._progTxt&&(this._progTxt.text=o+"%")}else this.explain_txf.text=i;this.explain_txf.x=(MJLobby.LobbyDataCache.defaultWidth-this.explain_txf.width)/2},e}(egret.Sprite);DDZLoadingView.explain="正在加载游戏资源...",__reflect(DDZLoadingView.prototype,"DDZLoadingView");var game;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.isStartMove=!1,t.startX=0,t.selectedCard=new Array,t.fenList=new Array,t.handCardList=new Array,t.touchEnabled=!0,t.addListener(),t}return __extends(n,e),Object.defineProperty(n,"Instance",{get:function(){return null==this.m_Instance&&(this.m_Instance=new n),this.m_Instance},enumerable:!0,configurable:!0}),n.clearInstance=function(){this.m_Instance=null},n.prototype.destroy=function(){this.removeListener(),n.clearInstance()},n.prototype.addListener=function(){t.RoomData.Instance.startGameChanged.add(this.startGameChanged,this),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onCardTouch,this),this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onCardTouch,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.onCardTouch,this),this.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onCardTouch,this)},n.prototype.removeListener=function(){this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onCardTouch,this),this.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onCardTouch,this),this.removeEventListener(egret.TouchEvent.TOUCH_END,this.onCardTouch,this),this.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onCardTouch,this)},n.prototype.startGameChanged=function(){if("1"!=egret.localStorage.getItem("cardType")?t.GameConstant.PokerTextureType=0:t.GameConstant.PokerTextureType=1,1!=t.RoomInfo.getInstance().video){for(var e=0,n=t.RoomData.Instance.seatList;e<n.length;e++){var i=n[e];i.addHandCardEvent.removeAll(),i.delectHandCardEvent.removeAll(),i.outCardChanged.removeAll()}if(t.RoomData.Instance.startGame){var a=t.PokerFunction.MainSeat;if(null==a)return;uniLib.Global.dispatchEvent(uniLib.ZqEvent.EVENT_G2L,{param:{type:"close"}}),a.addHandCardEvent.add(this.addHandCard,this),a.delectHandCardEvent.add(this.delectHandCard,this),a.outCardChanged.add(this.outCardChanged,this);for(var r=0,o=t.SeatLayer.Instance.seatSprites;r<o.length;r++){var i=o[r];i.removeReadyIcon()}}}else if(t.RoomData.Instance.startGame)for(var s=0,h=t.SeatLayer.Instance.seatSprites;s<h.length;s++){var i=h[s];i.removeReadyIcon()}},n.prototype.onCardTouch=function(t){if(t.type==egret.TouchEvent.TOUCH_BEGIN)this.isStartMove=!0,this.startX=t.stageX,this.onMoveTouch(this.startX,t.stageX);else if(t.type==egret.TouchEvent.TOUCH_MOVE){if(!this.isStartMove)return;this.onMoveTouch(this.startX,t.stageX)}else if(t.type==egret.TouchEvent.TOUCH_END||t.type==egret.TouchEvent.TOUCH_RELEASE_OUTSIDE){if(!this.isStartMove)return;this.isStartMove=!1,this.onEndTouch(this.startX,t.stageX)}},n.prototype.onMoveTouch=function(e,n){for(var i=this.handCardList.length,a=this.touchIndex(e,n),r=0;i>r;r++){var o=this.handCardList[r];r>=a.min&&r<=a.max?o.darken||(o.darken=!0,t.SoundHand.Instance.playCardClick()):o.darken&&(o.darken=!1,t.SoundHand.Instance.playCardClick())}},n.prototype.onEndTouch=function(e,n){this.selectedCard.clear();for(var i=this.touchIndex(e,n),a=this.handCardList.length,r=0;a>r;r++)this.handCardList[r].darken=!1,r>=i.min&&r<=i.max&&(this.handCardList[r].selected=!this.handCardList[r].selected,this.selectedCard.push(this.handCardList[r]));this.checkLianByTouch(),t.OperationPlay.Instance.playButtonEnabled()},n.prototype.checkLianByTouch=function(){for(var e=[],n=0,i=this.selectedCard;n<i.length;n++){var a=i[n];e.push(a.cardId)}var r=[];r.clear();var o=[];o.clear();var s=!1,h=new t.CardAnalysis(e),d=h.maxLian,l=h.maxDoubleLian;if(!d||d.length<1){if(!l||l.length<1)return;s=!0,r=l[0]}else s=!1,r=d[0];for(var u=0,c=this.handCardList;u<c.length;u++){var a=c[u];a.selected=!1}for(var p=function(t){var e=m.handCardList.filter(function(e){return Math.floor(e.cardId/100)==t});s?(o.push(e[0]),o.push(e[1])):o.push(e[0])},m=this,g=0,f=r;g<f.length;g++){var a=f[g];p(a)}for(var C=0,y=o;C<y.length;C++){var v=y[C];v.selected=!0}},n.prototype.resetCardPosition=function(){for(var t=0,e=this.handCardList;t<e.length;t++){var n=e[t];n.selected=!1}},n.prototype.touchIndex=function(e,n){var i=this.handCardList.length,a=this.handCardX,r=(this.handCardWidth,Math.floor((e-a)/t.GameConstant.CardGap));r=0>r?0:r>i-1?i-1:r;var o=Math.floor((n-a)/t.GameConstant.CardGap);o=0>o?0:o>i-1?i-1:o;var s=o>r?r:o,h=r>o?r:o;return{min:s,max:h}},Object.defineProperty(n.prototype,"handCards",{get:function(){return this.handCardList},enumerable:!0,configurable:!0}),n.prototype.addHandCard=function(e){var n=this,i=function(){n.delectHandCard(e);var i=new t.HandCardSprite(e);i.touchEnabled=!0,i.touchChildren=!1,n.addChild(i),n.handCardList.push(i),n.updataHandCardPosition(),n.updataLordLogo()};t.RoomData.Instance.shuffleUid&&!t.RoomData.Instance.landlordUid?uniLib.SetUniEventTimeout(t.GameView.Instance,function(){i()},t.GameConstant.shuffleTime,1,this,null):i()},n.prototype.delectHandCard=function(t){var e=this.handCardList.first(function(e){return e.cardId==t});null!=e&&null!=e.parent&&(this.removeChild(e),this.handCardList.deletefirst(function(t){return t==e}),this.updataHandCardPosition(),this.updataLordLogo())},n.prototype.updataLordLogo=function(){for(var e=this.handCardList.length,n=0;e>n;n++)t.RoomData.Instance.landlordUid==uniLib.NetMgr.UID&&n==e-1?this.handCardList[n].addLordLogo():this.handCardList[n].removeLordLogo()},n.prototype.removeAllHandCard=function(){var t=this.handCardList;if(t&&t instanceof Array){for(var e=0,n=t;e<n.length;e++){var i=n[e];i&&i.parent&&this.removeChild(i)}t.clear()}},n.prototype.handCardsForbidOp=function(){for(var t=0,e=this.handCards;t<e.length;t++){var n=e[t];n.selected=!1,n.darken=!0}this.touchEnabled=!1,this.touchChildren=!1},n.prototype.handCardsAllowOp=function(){for(var e=t.PokerFunction.GetUserInfoByUid(uniLib.NetMgr.UID),n=0,i=this.handCards;n<i.length;n++){var a=i[n];a.selected=!1,e&&e.isTrust?(a.darken=!0,this.touchEnabled=!1,this.touchChildren=!1):(a.darken=!1,this.touchEnabled=!0,this.touchChildren=!0)}},n.prototype.notUp=function(){null==this.notUpBitmap&&(this.notUpBitmap=new egret.Bitmap(RES.getRes("tips_onlypass"))),this.notUpBitmap.x=(uniLib.Global.screenWidth-this.notUpBitmap.width)/2,this.notUpBitmap.y=t.GameConstant.HandCardY+(t.GameConstant.CardHeight-this.notUpBitmap.height)/2,this.addChild(this.notUpBitmap),this.handCardsForbidOp(),this.resetCardPosition()},n.prototype.removeupNotUp=function(){this.notUpBitmap&&this.notUpBitmap.parent&&this.removeChild(this.notUpBitmap),this.touchEnabled=!0,this.touchChildren=!0;for(var t=0,e=this.handCards;t<e.length;t++){var n=e[t];n.darken=!1}},n.prototype.trust=function(){null==this.trustButton&&(this.trustButton=new eui.Button,this.trustButton.skinName=new CancelEntrustButton_DDZ_Skin),this.trustButton.touchEnabled=!0,t.OperateLayer.Instance.addChild(this.trustButton),this.trustButton.x=(uniLib.Global.screenWidth-this.trustButton.width)/2,this.trustButton.y=550,this.handCardsForbidOp(),this.trustButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.cancelTrustHandel,this)},n.prototype.cancelTrust=function(){this.trustButton&&(this.trustButton.parent&&t.OperateLayer.Instance.removeChild(this.trustButton),this.trustButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.cancelTrustHandel,this),this.trustButton=null,this.handCardsAllowOp())},n.prototype.cancelTrustHandel=function(e){var n=new Cmd.HostUpdateRoomCmd_CS;n.yesOrNo=!1,n.uid=uniLib.NetMgr.UID,t.PokerFunction.tcpSend(n)},n.prototype.updataHandCardPosition=function(){for(var e=this.handCardList.length,n=this.handCardX,i=0;e>i;i++)this.handCardList[i].x=n+t.GameConstant.CardGap*i},Object.defineProperty(n.prototype,"handCardWidth",{get:function(){var e=this.handCardList.length;return t.GameConstant.CardWidth+e*t.GameConstant.CardGap},enumerable:!0,configurable:!0}),n.prototype.recoveryCardPosition=function(){for(var t=0,e=this.handCardList;t<e.length;t++){var n=e[t];n.selected=!1}},Object.defineProperty(n.prototype,"handCardX",{get:function(){return this.handCardList.length>17?(uniLib.Global.screenWidth-this.handCardWidth)/2+30:(uniLib.Global.screenWidth-t.GameConstant.HeadWidth-this.handCardWidth)/2+t.GameConstant.OperationOffsetRight},enumerable:!0,configurable:!0}),n.prototype.outCardChanged=function(t){},n}(egret.DisplayObjectContainer);t.CardLayer=e,__reflect(e.prototype,"game.CardLayer")}(game||(game={}));var game;!function(t){var e=function(e){function a(){var t=e.call(this)||this;return t.isActive=!1,t.skinName=new RoundResult_DDZ_Event_Skin,t._shuffle_btn.visible=!1,t}return __extends(a,e),Object.defineProperty(a,"Instance",{get:function(){return a._instance||(a._instance=new a),a._instance},enumerable:!0,configurable:!0}),a.prototype.setData=function(t){this._shuffle_btn.visible=!1,this.setBtnVisible(t),this.originzeRoundResultInfo(t),this.judgeVictoryOrFailed(t.winnerList),this.showBtns(t)},a.prototype.showBtns=function(e){var n=t.RoomData.Instance.roomCurrentInnings,i=t.RoomData.Instance.roomTotalInnings;null!=n&&null!=i&&n==i||(e.haveNextRound?this._prepare_btn.visible=!0:this._prepare_btn.visible=!1),t.PokerData.isStandAlone&&(this._prepare_btn.visible=!0),MJLobby.MJLobbyData.getInstance().isInEventGame&&(this._prepare_btn.visible=!1,this.backLobbyButton.visible=!1,this.changeTableBtn.visible=!1)},a.prototype.showShuffleBtn=function(t,e){t==uniLib.NetMgr.UID&&(this._shuffle_btn.visible=!0,this._shuffle_btn.cost.text=""+(e?e:0))},a.prototype.originzeRoundResultInfo=function(t){for(var e=t.resultList,i=new eui.ArrayCollection,a=0,r=e.length;r>a;a++){var o=e[a],s=o.user.headurl,h=o.user.name,d=o.profit,l=o.user.uid==uniLib.NetMgr.UID,u=null==t.winnerList?null:t.winnerList.first(function(t){return t==o.user.uid}),c=null!=u,p=o.multiple;if(t.landlord==o.user.uid)var m=!0;else var m=!1;i.addItem({headurl:s,nickName:h,scoreChanged:d,isKeng:m,isSelf:l,isWin:c,multiple:p})}this._data_list.itemRenderer=n,this._data_list.dataProvider=i,this.addEvent()},a.prototype.judgeVictoryOrFailed=function(e){var n=!1;if(!e||e&&e.length<1)return void(n=!1);for(var i=0;i<e.length;i++)e[i]==uniLib.NetMgr.UID&&(n=!0);n?(this._failed_image.visible=!1,this._victory_image.visible=!0,t.SoundHand.Instance.playDDZWin()):(this._failed_image.visible=!0,this._victory_image.visible=!1,t.SoundHand.Instance.playDDZLose())},a.prototype.removeEffect=function(){this.effect&&this.effect.parent&&this.effect.stop(),this.effect=null,this.winEffect&&this.winEffect.parent&&(this.winEffect.stop(),this.removeChild(this.winEffect)),this.winEffect=null},a.prototype.prepare=function(t){this.sendReadyUpdateRoomMsg(!1)},a.prototype.shuffle=function(t){this.sendReadyUpdateRoomMsg(!0)},a.prototype.sendReadyUpdateRoomMsg=function(e){if(void 0===e&&(e=!1),t.RoomData.Instance.fianlData){var n=t.RoomData.Instance.fianlData;return void this.gameFianlSettle(n)}if(t.PokerFunction.MainSeat.isReady)return t.GameInfo.topLayer.removeChild(this),void this.removeEffect();var i=new Cmd.ReadyUpdateRoomCmd_CS;i.yesOrNo=!0,1==e&&(i.shuffle=1),t.PokerFunction.tcpSend(i),t.GameView.Instance.pointBaseChanged(t.RoomData.Instance.pointBase)},a.prototype.clostPanel=function(){t.GameInfo.topLayer.removeChild(this),this.removeEffect()},a.prototype.gameFianlSettle=function(e){t.GameInfo.topLayer.removeChildren();var n=new t.GameOverPanel;t.GameInfo.topLayer.addChild(n),n.setData(e),t.RoomData.Instance.clearSeatList(),GX.MulticastEvent.EventList.removeAllEvent()},a.prototype.changeTableHandel=function(e){var n=new Cmd.ChangeRoomCmd_C;t.PokerFunction.tcpSend(n)},a.prototype.backLobbyHandel=function(e){var n=new Cmd.LeaveRoomCmd_CS;n.uid=uniLib.NetMgr.UID,t.PokerFunction.tcpSend(n)},a.prototype.setBtnVisible=function(e){Date.now();this._prepare_btn.x=700*uniLib.ScreenUtils.scaleFactor;var n=t.RoomData.Instance.roomType;t.RoomData.Instance.roomPlayProps&&-1!=t.RoomData.Instance.roomPlayProps.indexOf(95)?(this.changeTableBtn.visible=!1,this.backLobbyButton.visible=!0,this._prepare_btn.visible=!0,this.backLobbyButton.x=395*uniLib.ScreenUtils.scaleFactor,this._prepare_btn.x=711*uniLib.ScreenUtils.scaleFactor):n==Cmd.RoomType.RoomType_Quick?(this.backLobbyButton.visible=!0,this.changeTableBtn.visible=!1):(this.changeTableBtn.visible=!1,this._prepare_btn.x=553*uniLib.ScreenUtils.scaleFactor);var i=t.RoomData.Instance.roomPlayProps.first(function(t){return 88==t});0==this.backLobbyButton.visible&&0==this.changeTableBtn.visible&&1==this._prepare_btn.visible&&e.shuffleUid==uniLib.NetMgr.UID&&i&&e.haveNextRound&&(this._prepare_btn.x=400,this.showShuffleBtn(e.shuffleUid,e.shuffleCost))},a.prototype.addEvent=function(){this._prepare_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.prepare,this),this._shuffle_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.shuffle,this),this.changeTableBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.changeTableHandel,this),this.mutipleInfo.addEventListener(egret.TouchEvent.TOUCH_TAP,this.mutipleInfoHandel,this),this.backLobbyButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.backLobbyHandel,this)},a.prototype.removeEvent=function(){this._prepare_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.prepare,this),this._shuffle_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.shuffle,this),this.changeTableBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.changeTableHandel,this),this.mutipleInfo.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.mutipleInfoHandel,this),this.backLobbyButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.backLobbyHandel,this)},a.prototype.addUIListener=function(){},a.prototype.removeUIListener=function(){},a.prototype.adaptationWidth=function(){e.prototype.adaptationWidth.call(this)},a.prototype.mutipleInfoHandel=function(t){this.isActive?this.removePanel():this.showMutipleInfo(),this.isActive=!this.isActive},a.prototype.showMutipleInfo=function(){var t=this;this.infoPanel||(this.infoPanel=new i),this.addChild(this.infoPanel),this.infoPanel.x=500,this.infoPanel.y=-30,egret.setTimeout(function(){t.removePanel()},this,3e3)},a.prototype.removePanel=function(){this.infoPanel&&this.infoPanel.parent&&this.infoPanel.parent.removeChild(this.infoPanel),this.infoPanel=null},a.prototype.destory=function(){egret.Tween.removeTweens(this)},a.prototype.showWinEffect=function(){this.winEffect||(this.winEffect=t.EffectCreate.Instance.winLightEffect()),this.addChildAt(this.winEffect,1),this.winEffect.x=400,this.winEffect.y=20,this.winEffect.play()},a}(t.EuiPanel);t.RoundResultPanel=e,__reflect(e.prototype,"game.RoundResultPanel");var n=function(e){function n(){var t=e.call(this)||this;return t.skinName=new RoundResultItem_DDZ_Event_Skin,t}return __extends(n,e),n.prototype.dataChanged=function(){var e=this.data;this._player_name.text=e.nickName,this._changed_score.text=e.scoreChanged,this._player_icon.source=e.headurl,this.timesLabel.text=e.multiple+"";var n=t.RoomData.Instance.pointBase;this.endPoints.text=(null==n?0:n)+"",this._is_keng.visible=e.isKeng,e.isWin?(this.scoreLabel.font="glodBrightFont_fnt",this.scoreLabel.text="+"+(e.scoreChanged%1==0?e.scoreChanged:e.scoreChanged.toFixed(2))):(this.scoreLabel.font="goldFrayFont_fnt",this.scoreLabel.text=e.scoreChanged%1==0?e.scoreChanged:e.scoreChanged.toFixed(2))},n.prototype.setPlayerIconMask=function(){var t=RES.getRes("mask_head_png"),e=new egret.Bitmap;this.addChild(e),e.texture=t;var n=this._player_icon_frame.x,i=this._player_icon_frame.y,a=.7*this._player_icon_frame.width,r=.7*this._player_icon_frame.height,o=n+a/2,s=i+r/2;e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e.x=o,e.y=s-6,this._player_icon.mask=e},n}(eui.ItemRenderer);t.RoundResultItem=n,__reflect(n.prototype,"game.RoundResultItem");var i=function(t){function e(){var e=t.call(this)||this;return e.skinName=new MultipleInfo_DDZ_Skin,e}return __extends(e,t),e.prototype.init=function(){},e.prototype.setData=function(){},e}(eui.Component);t.MultipleInfo=i,__reflect(i.prototype,"game.MultipleInfo")}(game||(game={}));var game;!function(t){var e=function(e){function n(t){var n=e.call(this)||this;return n.handCardList=new Array,n.m_seatData=t,n.addListener(),n.clientNoChanged(),n}return __extends(n,e),Object.defineProperty(n.prototype,"seatData",{get:function(){return this.m_seatData},enumerable:!0,configurable:!0}),n.prototype.addListener=function(){this.seatData.userChanged.add(this.userChanged,this),this.seatData.readyChanged.add(this.readyChanged,this),this.seatData.handCardCountChanged.add(this.handCardCountChanged,this),this.seatData.onlineChanged.add(this.onlineChangeHandel,this),t.RoomData.Instance.MainSeatChanged.add(this.clientNoChanged,this),1==t.RoomInfo.getInstance().video&&(this.m_seatData.addHandCardEvent.add(this.addHandCard,this),this.m_seatData.delectHandCardEvent.add(this.delectHandCard,this))},n.prototype.removeListener=function(){this.seatData.userChanged.remove(this.userChanged),this.seatData.readyChanged.remove(this.readyChanged),this.seatData.handCardCountChanged.remove(this.handCardCountChanged),t.RoomData.Instance.MainSeatChanged.remove(this.clientNoChanged),this.seatData.onlineChanged.remove(this.onlineChangeHandel)},Object.defineProperty(n.prototype,"clientNo",{get:function(){return this.m_clientNo},enumerable:!0,configurable:!0}),n.prototype.clientNoChanged=function(){if(this.m_clientNo=t.GameConstant.GetClientNoBySeatId(this.seatData.seatId),!(null==this.clientNo||this.clientNo<0||this.clientNo>2)){t.SeatLayer.Instance.addChild(this);var e=t.GameConstant.seatPosArr[this.clientNo];this.x=e.x,this.y=e.y}},n.prototype.onlineChangeHandel=function(t){this.m_userSprite&&(t==Cmd.OnlineState.OnlineState_Offline?this.m_userSprite.showOffline():this.m_userSprite.removeOffline())},n.prototype.readyChanged=function(e){if(!(null==this.clientNo||this.clientNo<0||this.clientNo>2)&&(null==this.readyIcon&&(this.readyIcon=new egret.Bitmap(RES.getRes("player_ready")),this.readyIcon.x=t.GameConstant.ReadyPos[this.clientNo].x,this.readyIcon.y=t.GameConstant.ReadyPos[this.clientNo].y),e?t.SeatLayer.Instance.addChild(this.readyIcon):this.removeReadyIcon(),this.seatData.user&&this.seatData.user.uid==uniLib.NetMgr.UID)){if(e){t.CardLayer.Instance.removeAllHandCard(),t.GameView.Instance.restart();var n=t.RoundResultPanel.Instance;n&&n.parent&&n.clostPanel()}t.GameView.Instance.updataReadyButton(e)}},n.prototype.removeReadyIcon=function(){this.readyIcon&&this.readyIcon.parent&&this.readyIcon.parent.removeChild(this.readyIcon)},Object.defineProperty(n.prototype,"uid",{get:function(){return this.seatData.user?this.seatData.user.uid:null},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"user",{get:function(){return this.seatData.user?this.seatData.user:null},enumerable:!0,configurable:!0}),n.prototype.userChanged=function(t){t?this.addUser(t):this.removeUser()},n.prototype.addUser=function(e){this.removeUser(),this.m_userSprite||(this.m_userSprite=new t.UserSprite(e)),this.addChild(this.m_userSprite),e.uid==uniLib.NetMgr.UID},n.prototype.removeUser=function(){this.m_userSprite&&this.m_userSprite.parent&&(this.removeChild(this.m_userSprite),this.m_userSprite.destroy(),this.m_userSprite=null)},n.prototype.resetUserSprite=function(){this.m_userSprite&&this.m_userSprite.resetHeadIcon()},n.prototype.handCardCountChanged=function(t){this.m_userSprite&&this.m_userSprite.handCardCountChanged(t)},n.prototype.destroy=function(){this.m_userSprite&&this.m_userSprite.removeListener(),this.removeReadyIcon(),this.removeListener()},Object.defineProperty(n.prototype,"handCards",{get:function(){return this.handCardList},enumerable:!0,configurable:!0}),n.prototype.addHandCard=function(e){var i=this,a=function(){i.delectHandCard(e);var a=new t.HandCardSprite(e);a.touchEnabled=!0,a.touchChildren=!1,a.cardWidth=n.HeadCardWidth[i.clientNo].width,a.cardHeight=n.HeadCardWidth[i.clientNo].height,t.CardLayer.Instance.addChild(a),i.handCardList.push(a),i.updataHandCardPosition(),i.updataLordLogo()};t.RoomData.Instance.shuffleUid&&!t.RoomData.Instance.landlordUid?uniLib.SetUniEventTimeout(t.GameView.Instance,function(){a()},t.GameConstant.shuffleTime,1,this,null):a()},n.prototype.delectHandCard=function(e){var n=this.handCardList.first(function(t){return t.cardId==e});null!=n&&null!=n.parent&&(t.CardLayer.Instance.removeChild(n),this.handCardList.deletefirst(function(t){return t==n}),this.updataHandCardPosition(),this.updataLordLogo())},n.prototype.updataLordLogo=function(){for(var e=this.handCardList.length,n=0;e>n;n++)this.seatData.user&&t.RoomData.Instance.landlordUid==this.seatData.user.uid&&n==e-1?this.handCardList[n].addLordLogo():this.handCardList[n].removeLordLogo()},n.prototype.showKickIcon=function(){this.m_userSprite.showKickIcon()},n.prototype.updataHandCardPosition=function(){for(var e=this.handCardList.length,n=this.handCardX,i=0;e>i;i++){var a=this.handCardList[i],r=t.GameConstant.GetClientNoBySeatId(this.seatData.seatId);0==r?(a.y=t.GameConstant.HandCardY,a.x=n+t.GameConstant.CardGap*i):1==r?(a.y=100,a.x=750+30*i,i>10&&(a.y=150,a.x=750+30*(i-11))):2==r&&(a.y=100,a.x=150+30*i,i>10&&(a.y=150,a.x=150+30*(i-11)))}},Object.defineProperty(n.prototype,"handCardX",{get:function(){var e=t.GameConstant.GetClientNoBySeatId(this.seatData.seatId);return 0==e?(uniLib.Global.screenWidth-t.GameConstant.HeadWidth-this.handCardWidth)/2+t.GameConstant.OperationOffsetRight:1==e?(uniLib.Global.screenWidth-t.GameConstant.HeadWidth-this.handCardWidth)/2+200:2==e?(uniLib.Global.screenWidth-t.GameConstant.HeadWidth-this.handCardWidth)/2:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"handCardWidth",{get:function(){var e=this.handCardList.length;return t.GameConstant.CardWidth+e*t.GameConstant.CardGap},enumerable:!0,configurable:!0}),n}(egret.Sprite);e.HeadCardWidth=[{width:127,height:173},{width:90,height:130},{width:90,height:130}],t.SeatSprite=e,__reflect(e.prototype,"game.SeatSprite")}(game||(game={}));var game;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.skinName=new Setting_DDZ_Event_Skin,t.initPanel(),t}return __extends(n,e),n.prototype.initPanel=function(){this._soundCheckArr=[],this._musicCheckArr=[],this._audioControlArr=[],this._languageArr=[],this._cardCheckArr=[],this.closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this);var e=t.ResUtil.createBitmapByName("setting_music_DDZ",53,50);this.contentGroup.addChild(e);var n=t.ResUtil.createBitmapByName("setting_sound_DDZ",52,141);this.contentGroup.addChild(n);var i=t.ResUtil.createBitmapByName("setting_language_DDZ",52,234);if(this.contentGroup.addChild(i),t.DataCache.gameInfo&&5029==t.DataCache.gameInfo.gameId){var a=t.ResUtil.createBitmapByName("setting_poker_DDZ",54,221);this.contentGroup.addChild(a)}var r=t.ResUtil.createTextFeild(16777215,egret.HorizontalAlign.LEFT,"音效",36,110,55,104);this.contentGroup.addChild(r);var o=t.ResUtil.createTextFeild(16777215,egret.HorizontalAlign.LEFT,"音乐",36,110,145,104);this.contentGroup.addChild(o);var s=t.ResUtil.createTextFeild(16777215,egret.HorizontalAlign.LEFT,"语言",36,110,238,104);this.contentGroup.addChild(s),t.GameView.Instance.bottomPoint&&t.CardLayer.Instance.handCards.length<=0?this._backBtn=this.leaveButton:this._backBtn=this.backButton,this._backBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onDismiss,this),this.refrenshButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.refrenshHandel,this),t.RoomData.Instance.roomType!=Cmd.RoomType.RoomType_Quick&&(this._backBtn.visible=!0),this.setBackButton();for(var h,d=0;2>d;d++)h=new t.CheckMc,h.x=226+180*d,h.y=53,h.name="sound"+d,this.contentGroup.addChild(h),h.seTTexture("setting_checkbg_DDZ","setting_check_DDZ"),h.updateIconPos(0,0),h.touchEnabled=!0,h.addEventListener(egret.TouchEvent.TOUCH_TAP,this.soundCheckHandle,this),this._soundCheckArr.push(h),h=new t.CheckMc,h.x=226+180*d,h.y=143,this.contentGroup.addChild(h),this._musicCheckArr.push(h),h.touchEnabled=!0,h.name="music"+d,h.seTTexture("setting_checkbg_DDZ","setting_check_DDZ"),h.updateIconPos(0,0),h.addEventListener(egret.TouchEvent.TOUCH_TAP,this.musicCheckHandle,this),h=new t.CheckMc,h.x=226+180*d,h.y=240,h.name="language"+d,this.contentGroup.addChild(h),h.seTTexture("setting_checkbg_DDZ","setting_check_DDZ"),h.updateIconPos(0,0),h.touchEnabled=!0,"language1"==h.name&&(h.touchEnabled=!0),h.addEventListener(egret.TouchEvent.TOUCH_TAP,this.languageCheckHandle,this),this._languageArr.push(h);for(var d=0;3>d;d++)r=t.ResUtil.createTextFeild(4079177,egret.HorizontalAlign.LEFT,"开",32,299,60+90*d,100),this.contentGroup.addChild(r),o=t.ResUtil.createTextFeild(4079177,egret.HorizontalAlign.LEFT,"关",32,480,60+90*d,100),this.contentGroup.addChild(o),2==d&&(r.text="普通话",o.text="家乡话",1==uniLib.Global.is_sandbox&&(o.text="方言"));uniLib.SoundMgr.instance.soundOpen?this._soundIndex=0:this._soundIndex=1,this._soundCheckArr[this._soundIndex].check=!0,uniLib.SoundMgr.instance.musicOpen?(this._musicIndex=0,uniLib.SoundMgr.instance.musicVolume=.7):this._musicIndex=1,this._musicCheckArr[this._musicIndex].check=!0,1==t.GameData.getInstance().audioPlayMode?this._audioIndex=0:this._audioIndex=1,this._languageIndex=1,t.RoomInfo.getInstance().languageMode="youyou",this._languageArr[this._languageIndex].check=!0},n.prototype.addUIListener=function(){},n.prototype.removeUIListener=function(){},n.prototype.adaptationWidth=function(){e.prototype.adaptationWidth.call(this)},n.prototype.setBackButton=function(){t.RoomData.Instance.roomType==Cmd.RoomType.RoomType_Quick||null==t.RoomData.Instance.roomType?this._backBtn.visible=!1:(this._backBtn.visible=!0,this.refrenshButton.x=380,this.refrenshButton.y=340)},n.prototype.onPokerHandle=function(t){var e=Number(t.target.name.slice(5));e!=this.cardIndex&&MJLobby.LobbyPopupManager.showMildWarnShow("请刷新重进或等待下一局,以更换牌面！"),this.cardIndex=e,egret.localStorage.setItem("cardType",this.cardIndex.toString()),this.updataCardCheck()},n.prototype.updataCardCheck=function(){if(t.DataCache.gameInfo&&5029==t.DataCache.gameInfo.gameId){for(var e=0;e<this._cardCheckArr.length;e++)this._cardCheckArr[e].check=!1;this._cardCheckArr[this.cardIndex].check=!0}},n.prototype.refrenshHandel=function(t){uniLib.ZQGameSdk.getConfig("确定要更新游戏吗?","","确定","取消")},n.prototype.languageCheckHandle=function(e){var n=Number(e.currentTarget.name.slice(8));this._languageIndex=n,this.updataLanguageCheck(),0==this._languageIndex?t.RoomInfo.getInstance().languageMode="pu":t.RoomInfo.getInstance().languageMode="youyou",uniLib.Utils.setLocalStorage("languageMode",t.RoomInfo.getInstance().languageMode)},n.prototype.updataLanguageCheck=function(){for(var t=0;2>t;t++)this._languageArr[t].check=!1;this._languageArr[this._languageIndex].check=!0},n.prototype.onDismiss=function(e){if(t.PopupManager.removePopUp(this),this.destory(),t.GameView.Instance.bottomPoint&&t.CardLayer.Instance.handCards.length<=0){var n=new Cmd.LeaveRoomCmd_CS;return n.uid=uniLib.NetMgr.UID,void t.PokerFunction.tcpSend(n)}this.dissRoom()},n.prototype.dissRoom=function(){this.msgBox&&(this.msgBox=null);var e=function(e){this.msgBox&&(t.GameInfo.topLayer.removeChild(this.msgBox),this.msgBox=null)};if(!this.msgBox){var n="你确定请求解散房间？";this.msgBox=new t.MsgBoxPanel,this.msgBox.setData(n,["确定","取消"],[this.confirmHandler,e])}t.PopupManager.addPopUp(this.msgBox,!0,!0)},n.prototype.confirmHandler=function(e){this.msgBox&&(t.PopupManager.removePopUp(this.msgBox,!1),this.msgBox=null);var n=new Cmd.DissolveRoomRequestCmd_C;t.PokerFunction.tcpSend(n)},n.prototype.getSoundData=function(){var e=new Cmd.SetInfo;return e.sound=uniLib.SoundMgr.instance.soundOpen,e.music=uniLib.SoundMgr.instance.musicOpen,e.control=t.GameData.getInstance().audioPlayMode,"pu"==t.RoomInfo.getInstance().languageMode?e.dialect=1:e.dialect=2,e},n.prototype.destory=function(){if(this._backBtn&&(this._backBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onDismiss,this),this._backBtn=null),this._soundCheckArr)for(var t=0;t<this._soundCheckArr.length;t++){var e=this._soundCheckArr[t];e.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.soundCheckHandle,this),e.destory()
}if(this._musicCheckArr)for(var t=0;t<this._musicCheckArr.length;t++){var e=this._musicCheckArr[t];e.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.musicCheckHandle,this),e.destory()}if(this._audioControlArr)for(var t=0;t<this._audioControlArr.length;t++){var e=this._audioControlArr[t];e.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.audioContrlHandle,this),e.destory()}if(this._languageArr)for(var t=0;t<this._languageArr.length;t++){var e=this._languageArr[t];e.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.languageCheckHandle,this),e.destory()}this.closeButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this),this._audioControlArr=null,this._musicCheckArr=null,this._soundCheckArr=null,this._languageArr=null},n.prototype.onClose=function(e){t.PopupManager.removePopUp(this),this.destory()},n.prototype.soundCheckHandle=function(t){var e=Number(t.currentTarget.name.slice(5));this._soundIndex=e,this.updataSoundCheck(),0==this._soundIndex?(uniLib.SoundMgr.instance.soundVolume=1,uniLib.SoundMgr.instance.soundOpen=!0):(uniLib.SoundMgr.instance.soundVolume=0,uniLib.SoundMgr.instance.soundOpen=!1),uniLib.Utils.setLocalStorage("SoundVolime",uniLib.SoundMgr.instance.soundVolume)},n.prototype.updataSoundCheck=function(){for(var t=0;2>t;t++)this._soundCheckArr[t].check=!1;this._soundCheckArr[this._soundIndex].check=!0},n.prototype.musicCheckHandle=function(t){var e=Number(t.currentTarget.name.slice(5));this._musicIndex=e,this.updataMusicCheck(),0==this._musicIndex?(uniLib.SoundMgr.instance.musicVolume=.7,uniLib.SoundMgr.instance.musicOpen=!0):(uniLib.SoundMgr.instance.musicVolume=0,uniLib.SoundMgr.instance.musicOpen=!1),uniLib.Utils.setLocalStorage("MusicVolime",uniLib.SoundMgr.instance.musicVolume)},n.prototype.audioContrlHandle=function(e){var n=Number(e.currentTarget.name.slice(5));this._audioIndex=n,this.updataAudioCheck(),0==this._audioIndex?t.GameData.getInstance().audioPlayMode=!1:t.GameData.getInstance().audioPlayMode=!1},n.prototype.updataAudioCheck=function(){for(var t=0;2>t;t++)this._audioControlArr[t].check=!1;this._audioControlArr[this._audioIndex].check=!0},n.prototype.updataMusicCheck=function(){for(var t=0;2>t;t++)this._musicCheckArr[t].check=!1;this._musicCheckArr[this._musicIndex].check=!0},n.prototype.restartGame=function(t){uniLib.ZQGameSdk.getConfig("确定要更新游戏吗?","","确定","取消")},n}(t.EuiPanel);t.SettingPanel=e,__reflect(e.prototype,"game.SettingPanel")}(game||(game={}));var game;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.skinName=new SelectCard_DDZ_Panel,t.init(),t}return __extends(i,e),Object.defineProperty(i,"Instance",{get:function(){return null==this._instance&&(this._instance=new i),this._instance},enumerable:!0,configurable:!0}),i.TestPanel=function(){if(this._instance)throw new Error("Sington已经创建!")},i.prototype.init=function(){this.addListener(),this.create(),this.selectId=[]},i.prototype.create=function(){this.touchChildren=!0,this.touchEnabled=!0,uniLib.Global.debugLevel>=1&&this.setGameButton()},i.prototype.addListener=function(){this._cardList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.cardListClickHandel,this)},i.prototype.removeListener=function(){this._cardList.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.cardListClickHandel,this)},i.prototype.cardListClickHandel=function(t){if(!(this.selectId.length>=17)){for(var e=0,n=this.selectId;e<n.length;e++){var i=n[e];if(i==t.item)return}this.selectId.push(t.item),this.refrenshSelected(),this.setItemVisible(t.item,!1)}},i.prototype.setItemVisible=function(t,e){var n=t+"";this._cardList.getChildByName(n).visible=e},i.prototype.refrenshSelected=function(){this.selectedCards.itemRenderer=n,this.selectedCards.dataProvider=new eui.ArrayCollection(this.selectId)},i.prototype.initCardList=function(){this.cardList=[];for(var t=3;15>t;t++)for(var e=100*t,i=1;5>i;i++){var a=e+10*i;a+=1,this.cardList.push(a)}this.cardList.push(1611),this.cardList.push(1621),this.cardList.push(1631),this.cardList.push(1641),this.cardList.push(2051),this.cardList.push(2151),this._cardList.itemRenderer=n,this._cardList.dataProvider=new eui.ArrayCollection(this.cardList)},i.prototype.setCardList=function(t){this.cardList=new Array,this.cardList=t,this.cardList.sort(function(t,e){return t-e}),this._cardList.itemRenderer=n,this._cardList.dataProvider=new eui.ArrayCollection(this.cardList)},i.prototype.setGameButton=function(){this.cardButtonArr=["确定","取消","重选","删除","结束"],this.buttonList.itemRenderer=n,this.buttonList.dataProvider=new eui.ArrayCollection(this.cardButtonArr),this.buttonList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.buttonClickHandel,this)},i.prototype.buttonClickHandel=function(e){switch(e.itemIndex){case 0:if(this.selectId.length<1)return;var n=new Cmd.GmSelectCardCmd_C;n.cardList=this.selectId,t.PokerFunction.tcpSend(n),t.GameInfo.topLayer.removeChild(this),this.dispose();break;case 1:t.GameInfo.topLayer.removeChild(this),this.dispose();break;case 2:this.selectId.clear(),this.refrenshSelected();for(var i=0;i<this.cardList.length;i++)this._cardList.getChildByName(this.cardList[i]+"").visible||this.setItemVisible(this.cardList[i],!0);break;case 3:if(this.selectId.length<1)return;var a=this.selectId.pop();this.setItemVisible(a,!0),this.refrenshSelected();break;case 4:var r=new Cmd.GmFinishRoundCmd_C;t.PokerFunction.tcpSend(r),t.GameInfo.topLayer.removeChild(this),this.dispose()}},i.prototype.dispose=function(){this.removeListener(),this.cardList=[],this.selectId=[]},i}(eui.Component);t.TestPanel=e,__reflect(e.prototype,"game.TestPanel");var n=function(t){function e(){var e=t.call(this)||this;return e.skinName=new CardItem_DDZ_Skin,e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;isNaN(t)?(this.cardName.text=t,this.background.fillColor=16776960):this.cardName.text=table.TablePokerCard.cardName(t),this.name=t+""},e}(eui.ItemRenderer);t.CardItem=n,__reflect(n.prototype,"game.CardItem")}(game||(game={}));var game;!function(t){var e=function(e){function i(){return e.call(this)||this}return __extends(i,e),i.prototype.initUI=function(){this.bgRect=new eui.Rect(uniLib.Global.screenWidth,uniLib.Global.screenHeight),this.bgRect.alpha=.1,this.bgRect.x=-291,this.bgRect.y=-185,this.addChildAt(this.bgRect,0),this.bgRect.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseHandle,this),uniLib.Global.addEventListener(uniLib.ZqEvent.EVENT_L2G,this.diamondChange,this);var e=t.DataCache.langObj.uiTxt.PlayerInfoPanel,i=t.ResUtil.createBitmapByName("public_DDZ3");i.scale9Grid=new egret.Rectangle(71,48,448,113),i.touchEnabled=!0,i.width=697,i.x=-8,i.height=360,this.addChild(i);var a=t.ResUtil.createTextFeild(8204032,egret.HorizontalAlign.LEFT,e.nickLabel,24,182,45,300);this.addChild(a);var r=t.ResUtil.createTextFeild(8204032,egret.HorizontalAlign.LEFT,e.idLabel,24,183,90,90);this.addChild(r);var o=t.ResUtil.createTextFeild(8204032,egret.HorizontalAlign.LEFT,e.levelLabel,24,185,131,90);this.addChild(o);var s=new egret.Bitmap(RES.getRes("userinfo_fangka_DDZ"));s.x=455,s.y=125,this._nickTxt=t.ResUtil.createTextFeild(11622706,egret.HorizontalAlign.LEFT,"",24,260,45,159),this._nickTxt.height=26,this.addChild(this._nickTxt),this._idTxt=t.ResUtil.createTextFeild(11622706,egret.HorizontalAlign.LEFT,"",24,258,90,136),this.addChild(this._idTxt),this._diamondTxt=t.ResUtil.createTextFeild(11622706,egret.HorizontalAlign.LEFT,"",24,535,130,136),this.addChild(this._diamondTxt),this._ipTxt=t.ResUtil.createTextFeild(11622706,egret.HorizontalAlign.LEFT,"",24,258,131,200),this.addChild(this._ipTxt),this._distance=t.ResUtil.createTextFeild(11622706,egret.HorizontalAlign.LEFT,"",24,185,170,400),this.addChild(this._distance),this._scoreTxt=t.ResUtil.createTextFeild(11622706,egret.HorizontalAlign.LEFT,"",24,535,131,136),this._giftItemArr=[];for(var h,d=table.TableGift.instance(),l=0;l<d.length;l++)6!==l&&(h=new n,h.data=d[l],this._giftItemArr[d[l].giftId]=h,h.x=105*l,6===l&&(h.x=525),h.y=200,this.addChild(h),h.touchEnabled=!0,h.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickGift,this));this._headMc=new t.PokerHead(110,110),this._headMc.x=30,this._headMc.y=35,this.addChild(this._headMc)},i.prototype.setRect=function(t){this.bgRect.x=-t},i.prototype.onCloseHandle=function(){this.parent.removeChild(this),this.destory()},i.prototype.table=function(){var t;return t=loadTable("TableGiftND_json")},i.prototype.onClickGift=function(e){if(this._data.uid==uniLib.NetMgr.UID)return void t.PublicManage.getInstance().showMildWarnShow("不能给自己送礼物");var n=e.currentTarget,i=new Cmd.SendGiftRoomCmd_C,a=new Cmd.GiftsInfo;a.giftsId=n.data.giftId,a.toUid=this._data.uid,a.fromUid=uniLib.NetMgr.UID,a.giftsNum=1,i.gift=a,t.PokerFunction.tcpSend(i),this.onCloseHandle()},i.prototype.reset=function(){this._data=null,this._idTxt.text="",this._nickTxt.text="",this._ipTxt.text="",this._distance.text="",this._diamondTxt.text="",this._scoreTxt.text="",this._headMc.visible=!1},i.prototype.setData=function(e){this._data=e;var n="public_DDZ6";if("男"==e.gender&&(n="public_DDZ7"),this._genderIcon?this._genderIcon.texture=t.ResUtil.createTexture(n):(this._genderIcon=t.ResUtil.createBitmapByName(n,467,65),this.addChild(this._genderIcon)),this._idTxt.text=e.uid.toString(),this._nickTxt.text=e.nickName,void 0!=e.ip&&(this._ipTxt.text=e.ip),t.GameView.Instance.bottomPoint){var i=new eui.Image("Gold_chips");i.x=500,i.y=130,this.addChild(i),e.points&&(this._diamondTxt.text=Math.floor(e.points)+"")}else void 0!=e.diamond&&(this._diamondTxt.text=Math.floor(e.diamond)+"");this._scoreTxt.text=e.points.toString(),this._headMc.headUrl=e.headUrl;for(var a=0;6>a;a++)this._giftItemArr[a+1]&&this._giftItemArr[a+1].setFlowerNum(0);if(e.flower instanceof Array)for(var a=0;a<e.flower.length;a++)this._giftItemArr[e.flower[a].id].setFlowerNum(e.flower[a].num)},i.prototype.diamondChange=function(t){"diamondChange"==t.param&&Number(this._idTxt.text)===uniLib.UserInfo.uid&&(this._diamondTxt.text=Math.floor(uniLib.UserInfo.chips)+"")},i.prototype.destory=function(){uniLib.Global.removeEventListener(uniLib.ZqEvent.EVENT_L2G,this.diamondChange,this),this.bgRect.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseHandle,this),this._headMc&&(this._headMc.destory(),this._headMc=null);var t=table.TableGift.instance();if(t)for(var e=0;e<t.length;e++){var i=new n;i.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickGift,this),i.destory()}uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this),this._data=null,this._idTxt=null,this._ipTxt=null,this._nickTxt=null,this._diamondTxt=null,this._genderIcon=null},i}(t.BaseVc);t.UserInfoPanel=e,__reflect(e.prototype,"game.UserInfoPanel");var n=function(e){function n(){return e.call(this)||this}return __extends(n,e),n.prototype.initUI=function(){this._testBg=new egret.Bitmap(RES.getRes("testBg")),this._testBg.y=110,this._testBg.x=35,this._nameTxt=t.ResUtil.createTextFeild(419190,egret.HorizontalAlign.CENTER,"",20,5,110,100)},Object.defineProperty(n.prototype,"data",{get:function(){return this._data},set:function(e){this._nameTxt.text="0",this._giftIcon||(this._giftIcon=t.ResUtil.createBitmapByName("userInfo_freegift_DDZ"+e.giftId,17,0),this.addChildAt(this._giftIcon,0)),this._data=e,this.name=e.giftId.toString()},enumerable:!0,configurable:!0}),n.prototype.setFlowerNum=function(t){this._nameTxt.text=t.toString(),this._nameTxt.x=this._testBg.x+(this._testBg.width-this._nameTxt.width)/2},n.prototype.destory=function(){uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this),this._data=null,this._nameTxt=null},n}(t.BaseVc);t.GiftItem=n,__reflect(n.prototype,"game.GiftItem")}(game||(game={}));var game;!function(t){var e=function(e){function n(t){var n=e.call(this)||this;return n.m_user=t,n.addListener(),n.touchEnabled=!0,n.touchChildren=!1,n}return __extends(n,e),Object.defineProperty(n.prototype,"user",{get:function(){return this.m_user},enumerable:!0,configurable:!0}),n.prototype.destroy=function(){this.removeListener()},n.prototype.addListener=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.requestUserInfo,this),this.user.headUrlChanged.add(this.changedHead,this),this.user.nameChanged.add(this.nameChanged,this),this.user.pointChanged.add(this.pointChanged,this),this.user.trustStateChanged.add(this.trustChanged,this),this.user.diamondChanged.add(this.diamondChanged,this),t.RoomData.Instance.landlordChanged.add(this.changeHeadIcon,this)},n.prototype.removeListener=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.requestUserInfo,this),this.user.headUrlChanged.remove(this.changedHead),this.user.nameChanged.remove(this.nameChanged),this.user.pointChanged.remove(this.pointChanged),this.user.diamondChanged.remove(this.diamondChanged),this.user.trustStateChanged.remove(this.trustChanged),t.RoomData.Instance.landlordChanged.remove(this.changeHeadIcon)},n.prototype.changedHead=function(){null==this._headMc&&(this._headMc=new t.PokerHead(t.GameConstant.HeadWidth,t.GameConstant.HeadHeight),this._headMc.x=0,this._headMc.y=0,this._headMc.touchEnabled=!0,this.addChild(this._headMc)),null!=this.user.headUrl&&(this._headMc.headUrl=this.user.headUrl)},n.prototype.showRoomOwner=function(){this.roomOwner||(this.roomOwner=new egret.Bitmap(RES.getRes("room_owner")),this.roomOwner.name="roomOwner"),this.user.uid==t.RoomData.Instance.ownerId&&(this._headMc.addChild(this.roomOwner),this.roomOwner.x=0,this.roomOwner.y=0)},n.prototype.removeRoomOwner=function(){this.roomOwner&&this.roomOwner.parent&&this._headMc.removeChild(this.roomOwner)},n.prototype.showLordLogo=function(){this.lordImage||(this.lordImage=new egret.Bitmap(RES.getRes("lord")),this.lordImage.name="lord"),this.user.uid==t.RoomData.Instance.landlordUid&&(this._headMc.addChild(this.lordImage),this.lordImage.width=53,this.lordImage.height=53,this.lordImage.x=this._headMc.width-this.lordImage.width,this.lordImage.y=0)},n.prototype.removeLordLogo=function(){this.lordImage&&this.lordImage.parent&&this._headMc.removeChild(this.lordImage)},n.prototype.changeHeadIcon=function(){t.RoomData.Instance.landlordUid&&(this.changeEffect||(this.changeEffect=t.EffectCreate.Instance.changeEffect()),this.changeEffect.addEventListener(egret.Event.COMPLETE,this.onMcComplete,this),this.changeEffect.x=this._headMc.x,this.changeEffect.y=this._headMc.y,this.addChild(this.changeEffect),this.changeEffect.play())},n.prototype.onMcComplete=function(t){this.changeEffect.removeEventListener(egret.Event.COMPLETE,this.onMcComplete,this),this.changeEffect.parent&&(this.changeEffect.parent.removeChild(this.changeEffect),this.changeEffect.stop()),this.changeEffect=null,this.changeIdentity(),this.showLordLogo()},n.prototype.changeIdentity=function(){this._headMc.headUrl=null,this.identityHead||(this.identityHead=new egret.Bitmap),this.user&&"男"==this.user.gender?t.RoomData.Instance.landlordUid==this.user.uid?this.identityHead.texture=RES.getRes("male_landlord_left"):this.identityHead.texture=RES.getRes("male_farmer_left"):t.RoomData.Instance.landlordUid==this.user.uid?this.identityHead.texture=RES.getRes("female_landlord_left"):this.identityHead.texture=RES.getRes("female_farmer_left"),this.identityHead.anchorOffsetX=this.identityHead.width/2,this.identityHead.x=this._headMc.width/2,this.identityHead.y=(this._headMc.height-this.identityHead.height)/2,this._headMc.addChild(this.identityHead);var e=t.GameConstant.GetClientNoByUid(this.user.uid);1==e?this.identityHead.scaleX=1:this.identityHead.scaleX=-1},n.prototype.showOffline=function(){this.offLine||(this.offLine=new egret.Bitmap(RES.getRes("user_dropped_icon"))),this._headMc.addChild(this.offLine),this.offLine.width=t.GameConstant.HeadWidth,this.offLine.height=t.GameConstant.HeadHeight,this.offLine.x=(this._headMc.width-this.offLine.width)/2,this.offLine.y=(this._headMc.height-this.offLine.height)/2,this._headMc.setPlayerIconMask(this.offLine)},n.prototype.removeOffline=function(){this.offLine&&this.offLine.parent&&this.offLine.parent.removeChild(this.offLine),this.offLine=null},n.prototype.resetHeadIcon=function(){this.identityHead&&this.identityHead.parent&&this._headMc.removeChild(this.identityHead),this.changedHead(),this.removeLordLogo(),this.removeOffline(),this.removeKickIcon()},n.prototype.addInfoGroup=function(){this.infoGroup||(this.infoGroup=new eui.Component,this.infoGroup.skinName=new InfoGroup_DDZ_Skin,this.infoGroup.x=(t.GameConstant.HeadWidth-this.infoGroup.width)/2,this.infoGroup.y=t.GameConstant.HeadHeight+5,this.addChild(this.infoGroup))},n.prototype.nameChanged=function(){this.addInfoGroup(),this.infoGroup.skin.nameLabel.text=this.user.nickName},n.prototype.pointChanged=function(){this.addInfoGroup(),this.infoGroup.skin.scoreLabel.text=null==this.user.point?"0":(this.user.point%1==0?this.user.point:this.user.point.toFixed(2))+"",this.user.uid==uniLib.NetMgr.UID&&t.GameView.Instance.showMyChips(this.user.point)},n.prototype.diamondChanged=function(){this.goldIconCountChanged(this.user.diamond)},n.prototype.trustChanged=function(){this.user.isTrust?(this.showTrustState(),this.user.uid==uniLib.NetMgr.UID&&t.CardLayer.Instance.trust()):(this.removeTrustState(),this.user.uid==uniLib.NetMgr.UID&&t.CardLayer.Instance.cancelTrust())},n.prototype.cancelEntrust=function(e){var n=new Cmd.HostUpdateRoomCmd_CS;n.yesOrNo=!1,n.uid=uniLib.NetMgr.UID,t.PokerFunction.tcpSend(n)},n.prototype.showTrustState=function(){this.trustImage||(this.trustImage=new egret.Bitmap(RES.getRes("user_ai_icon"))),this.trustLable||(this.trustLable=new egret.Bitmap(RES.getRes("host"))),this._headMc.addChild(this.trustImage),this._headMc.addChild(this.trustLable),this.trustImage.x=(this._headMc.width-this.trustImage.width)/2,this.trustImage.y=(this._headMc.height-this.trustImage.height)/2-9,this.trustLable.x=(this._headMc.width-this.trustLable.width)/2,this.trustLable.y=-this.trustLable.height-5,this.identityHead&&this.identityHead.visible&&(this.identityHead.visible=!1),this._headMc.setPlayerIconMask(this.trustImage)},n.prototype.removeTrustState=function(){this.trustImage&&this.trustImage.parent&&(this._headMc.removeChild(this.trustImage),this.trustImage=null),this.trustLable&&this.trustLable.parent&&(this._headMc.removeChild(this.trustLable),this.trustLable=null),this.identityHead&&0==this.identityHead.visible&&(this.identityHead.visible=!0)},n.prototype.handCardCountChanged=function(e){this.user.uid!=uniLib.NetMgr.UID&&(null==this.handCardCount&&(this.handCardCount=new eui.TextInput,this.handCardCount.skinName=new HandCardCount_DDZ_Skin,1==t.GameConstant.GetClientNoByUid(this.user.uid)?this.handCardCount.x=-this.handCardCount.width-20:this.handCardCount.x=t.GameConstant.HeadWidth+20,this.handCardCount.y=this._headMc.y-this.handCardCount.height),this.addChild(this.handCardCount),this.handCardCount.skin.countLabel.text=e+"")},n.prototype.goldIconCountChanged=function(e){null!=e&&(null==this.goldIconCount&&(this.goldIconCount=new eui.TextInput,this.goldIconCount.skinName=new GoldIconCount_DDZ_Skin,this.user.uid==uniLib.NetMgr.UID?(this.goldIconCount.x=360,this.goldIconCount.y=this._headMc.y+80):1==t.GameConstant.GetClientNoByUid(this.user.uid)?(this.goldIconCount.x=-this.goldIconCount.width-24,this.goldIconCount.y=this._headMc.y+5):(this.goldIconCount.x=t.GameConstant.HeadWidth+16,this.goldIconCount.y=this._headMc.y+5)),this.goldIconCount.skin.countLabel.text=e+"")},n.prototype.showKickIcon=function(){null==this.kickIcon&&(this.kickIcon=new egret.Bitmap,this.kickIcon.texture=RES.getRes("kick_icon"),this.kickIcon.x=t.GameConstant.HeadWidth-this.kickIcon.width,1==t.GameConstant.GetClientNoByUid(this.user.uid)&&(this.kickIcon.x=0)),this.addChild(this.kickIcon)},n.prototype.removeKickIcon=function(){null!=this.kickIcon&&null!=this.kickIcon.parent&&this.kickIcon.parent.removeChild(this.kickIcon),this.kickIcon=null},n.prototype.requestUserInfo=function(e){var n=new Cmd.GetPersonalPanel_C;n.uid=this.user.uid,t.PokerFunction.tcpSend(n)},n}(egret.Sprite);t.UserSprite=e,__reflect(e.prototype,"game.UserSprite")}(game||(game={}));var game;!function(t){var e=function(e){function n(){return e.call(this)||this}return __extends(n,e),n.prototype.initUI=function(){this._mask=new egret.Sprite,this._mask.graphics.beginFill(0,.01),this._mask.graphics.drawRect(0,0,t.DataCache.defaultWidth,t.DataCache.defaultHeight),this._mask.graphics.endFill(),this._mask.touchEnabled=!0,this.addChild(this._mask);var e=uniLib.DisplayUtils.createBitmapByName("video_bg_DDZ");this.addChild(e),e.y=uniLib.Global.screenHeight/2+e.height/2,e.x=uniLib.Global.screenWidth/2-e.width/2,this._backBtn=new t.GameButton(["video_back1_DDZ","video_back2_DDZ"]),this.addChild(this._backBtn),this._backBtn.name="back",this._stopBtn=new t.GameButton(["video_stop1_DDZ","video_stop2_DDZ"]),this.addChild(this._stopBtn),this._stopBtn.name="stop",this._advanceBtn=new t.GameButton(["video_advance1_DDZ","video_advance2_DDZ"]),this.addChild(this._advanceBtn),this._advanceBtn.name="advance",this._closeBtn=new t.GameButton(["video_close1_DDZ","video_close2_DDZ"]),this.addChild(this._closeBtn),this._closeBtn.name="close",this._backBtn.x=e.x+2,this._stopBtn.x=this._backBtn.x+this._backBtn.width+5,this._advanceBtn.x=this._stopBtn.x+this._stopBtn.width+5,this._closeBtn.x=this._advanceBtn.x+this._advanceBtn.width+3,this._backBtn.y=this._stopBtn.y=this._advanceBtn.y=this._closeBtn.y=e.y+5,this._backBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),this._stopBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),this._advanceBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),this._closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this)},n.prototype.btnClick=function(e){var n=e.currentTarget.name;switch(n){case"back":uniLib.Global.dispatchEvent(uniLib.ZqEvent.EVENT_G2L,"video_back");break;case"stop":uniLib.Global.dispatchEvent(uniLib.ZqEvent.EVENT_G2L,"video_stop");break;case"advance":uniLib.Global.dispatchEvent(uniLib.ZqEvent.EVENT_G2L,"video_advance");break;case"close":t.GameView.Instance.showVideoFinish(1)}},n.prototype.destory=function(){this._backBtn&&(this._backBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),this._backBtn=null),this._stopBtn&&(this._stopBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),this._stopBtn=null),this._advanceBtn&&(this._advanceBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),this._advanceBtn=null),this._closeBtn&&(this._closeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),this._closeBtn=null),uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this)},n}(t.BaseVc);t.VideoPanel=e,__reflect(e.prototype,"game.VideoPanel")}(game||(game={}));var DDZMain=function(t){function e(e){var n=t.call(this,e)||this;return n.isThemeLoadEnd=!1,game.GameViewConfig.mainMediatorName=uniLib.getQualifiedClassName(game.DDZPokerMediator),"false"==uniLib.BrowersUtils.GetRequest("cacheres")&&(RES.web.Html5VersionController.prototype.getVirtualUrl=function(t){return t+="?v="+Math.random()}),n._gameInfo&&(game.DataCache.gameInfo=n._gameInfo),e&&e.destroyResOnExit&&(game.DataCache.destroyResOnExit=e.destroyResOnExit),n._gameInfo&&n._gameInfo.extData&&(game.DataCache.platParam=n._gameInfo.extData),n._gameInfo&&n._gameInfo.extData&&n._gameInfo.extData.video?(game.RoomInfo.getInstance().video=n._gameInfo.extData.video,game.RoomInfo.getInstance().videoUid=n._gameInfo.extData.videoUid):(game.RoomInfo.getInstance().video=0,game.RoomInfo.getInstance().videoUid=0),MJLobby.MJLobbyData.ShowGameLoading&&(uniLib.UIMgr.instance.showLoadingTimeout(DDZLoadingView),uniLib.UIMgr.instance.commonLoadUI=DDZLoadingView),console.error("是否是新的房间数据:"+game.RoomData.Instance.seatList.length),game.RoomData.Instance.clearSeatList(),GX.MulticastEvent.EventList.removeAllEvent(),game.GameData.iskPoker=!0,game.PokerFunction.handCardSort=function(t){return t.sort(function(t,e){return e-t})},"1"!=egret.localStorage.getItem("cardType")?game.GameConstant.PokerTextureType=0:game.GameConstant.PokerTextureType=1,n}return __extends(e,t),e.prototype.start=function(t){void 0===t&&(t=null);var e={};e.designWidth=1280,e.designHeight=720,e.debug=!0,e.scaleMode=egret.StageScaleMode.FIXED_HEIGHT,MJLobby.ScreenFixedUtils.instance.init(egret.StageScaleMode.FIXED_HEIGHT),uniLib.init(e),RES.setMaxLoadingThread(6);var n=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",n),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},e.prototype.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var e=new eui.Theme("resource/default.thm.json",this.stage);e.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this)},e.prototype.onThemeLoadComplete=function(){this.preLoadEnd()},e.prototype.preLoadEnd=function(){uniLib.UIMgr.instance.showProcessBar(null,2,100,"正在加载游戏资源..."),uniLib.Global.lobbyMode?uniLib.ResLoadMgr.instance.load(game.GameConstant.ResGroup_DDZ,this.startCreateScene,this.onItemLoadError,this,null):(uniLib.ResLoadMgr.instance.load(game.GameConstant.ResGroup_DDZ,this.startCreateScene,this.onItemLoadError,this,null),uniLib.ResLoadMgr.instance.load("common",this.startCreateScene,this.onItemLoadError,this,null))},e.prototype.onItemLoadError=function(t){console.warn("Url:"+t.groupName+"..."+t.itemsLoaded+"..."+t.itemsTotal+" has failed to load")},e.prototype.startCreateScene=function(){this._gameInfo&&(game.DataCache.gameInfo=this._gameInfo),this._gameInfo&&this._gameInfo.extData&&(game.DataCache.platParam=this._gameInfo.extData),game.GameData.iskPoker=!0,game.DataCache.langObj=JSON.parse(RES.getRes("ddz_GameTxt_cn_txt")),game.GameInfo.manage=game.PublicManage.getInstance(),game.DataCache.stageWidth=uniLib.Global.screenWidth,game.DataCache.stageHight=uniLib.Global.screenHeight,uniLib.UIMgr.instance.hideLoading(),uniLib.SceneMgr.instance.changeScene(game.PokerGameScene),new DDZ.EventManage,game.SoundHand.Instance.playDDZBg(),game.PokerData.isStandAlone&&(game.DDZStandAlone.Instance.initCardList(),game.DDZStandAlone.Instance.initUser())},e}(uniLib.GameDoc);__reflect(DDZMain.prototype,"DDZMain");var DDZ;!function(t){var e=function(){function t(){this.listener()}return t.prototype.listener=function(){GX.PokerEvent.Instance.tcpSendEvent.add(this.tcpSendEvent,this),GX.PokerEvent.Instance.landlordRobResult.add(this.landlordRobResult,this),GX.PokerEvent.Instance.calllordRobResult.add(this.calllordRobResult,this),GX.PokerEvent.Instance.playCard.add(this.PlayCard,this),GX.PokerEvent.Instance.dissolveRoomUpdate.add(this.dissolveRoom,this),GX.PokerEvent.Instance.systemMessage.add(this.showSystemMessage,this),GX.PokerEvent.Instance.leaveRoom.add(this.leaveRoom,this),GX.PokerEvent.Instance.roundResult.add(this.showLastHandcards,this),GX.PokerEvent.Instance.dealCardAnimation.add(game.EffectCreate.Instance.addCardAnimation,game.EffectCreate.Instance),GX.PokerEvent.Instance.threeCardAnimation.add(game.EffectCreate.Instance.brightThreeCardEffect,game.EffectCreate.Instance),GX.PokerEvent.Instance.gameFinalSettle.add(this.gameFianlSettle,this),GX.PokerEvent.Instance.gmAvailableCardUpdate.add(this.gmAvailableCardUpdate,this),GX.PokerEvent.Instance.kickPlay.add(this.kickPlay,this),GX.PokerEvent.Instance.gameStateUpdate.add(this.gameStatusUpdate,this),GX.PokerEvent.Instance.SendGiftEvent.add(this.SendGiftEvent,this),GX.PokerEvent.Instance.callCardEvent.add(this.showCallCard,this)},t.prototype.tcpSendEvent=function(t){game.PokerData.isStandAlone&&game.DDZStandAlone.Instance.tcpSend(t)},t.prototype.SendGiftEvent=function(t){t&&t.gift&&game.EffectCreate.Instance.giftEffect(t.gift.giftsId,t.gift.toUid,t.gift.fromUid)},t.prototype.landlordRobResult=function(t){game.OperateLayer.Instance.addLandlordRobResult(t)},t.prototype.calllordRobResult=function(t){game.OperateLayer.Instance.addCalllordRobResult(t)},t.prototype.kickPlay=function(t){var e=game.PokerFunction.GetUserInfoByUid(t.uid);if(e&&e.gender&&game.SoundHand.Instance.playRedouble(e.gender,t.yesOrNo),0!=t.yesOrNo){var n=game.GameConstant.GetSeatSpriteByUid(t.uid);n&&n.showKickIcon()}},t.prototype.PlayCard=function(t,e){void 0===e&&(e=!0);var n=game.PokerFunction.GetSeatDataByUid(t.uid);game.DDZAI.Instance.setPlayCard(n.seatId,t.cardList),game.OperateLayer.Instance.playCard(t,e)},t.prototype.dissolveRoom=function(t){this._dismissPanel?this._dismissPanel.setData(t):(this._dismissPanel=new game.DismissPanel,this._dismissPanel.x=uniLib.Global.screenWidth-this._dismissPanel.width>>1,this._dismissPanel.y=uniLib.Global.screenHeight-this._dismissPanel.height>>1,this._dismissPanel.setData(t),game.GameInfo.topLayer.addChild(this._dismissPanel))},t.prototype.removeDissPanel=function(){this._dismissPanel&&this._dismissPanel.parent&&this._dismissPanel.parent.removeChild(this._dismissPanel),this._dismissPanel=null},t.prototype.gameStatusUpdate=function(t){t&&(t.status==Cmd.GameStatus.GameStatus_Pause?t.desc?game.GameView.Instance.showSuspendPrompt(!0,t.desc):game.GameView.Instance.showSuspendPrompt(!0):t.status==Cmd.GameStatus.GameStatus_Playing&&game.GameView.Instance.showSuspendPrompt(!1))},t.prototype.showSystemMessage=function(t){switch(this.removeDissPanel(),t.msgType){case Cmd.SysMessageCmd_S.MsgType.Text:game.PublicManage.getInstance().showMildWarnShow(t.msg);break;case Cmd.SysMessageCmd_S.MsgType.DissolveRoom:this.showMessageBox(t);break;case Cmd.SysMessageCmd_S.MsgType.BackToLobby:var e=new MJLobby.MessageItem;e.text=t.msg,e.title="",MJLobby.MessageQueue.Instance.push(e),game.GameView.exitGame();break;case Cmd.SysMessageCmd_S.MsgType.Bounce:var n=new MJLobby.MessageItem;n.text=t.msg,n.title="",MJLobby.MessageQueue.Instance.push(n);break;case Cmd.SysMessageCmd_S.MsgType.NotEnoughMoney:this.showMessageTips(t)}},t.prototype.showCallCard=function(t){(null!=t.callCard||null!=t.callUid)&&(game.RoomData.Instance.shuffleUid?uniLib.SetUniEventTimeout(game.GameView.Instance,function(){game.OperateLayer.Instance.showCallCard(t.callCard,t.callUid)},game.GameConstant.shuffleTime,1,this,null):game.OperateLayer.Instance.showCallCard(t.callCard,t.callUid))},t.prototype.showMessageBox=function(t){this.msgTips||(this.msgTips=new game.MsgBoxPanel),this.msgTips.x=uniLib.Global.screenWidth-this.msgTips.width>>1,this.msgTips.y=uniLib.Global.screenHeight-this.msgTips.height>>1,this.msgTips.setData(t.msg,["确定"],[this.msgConfirmHandler],this),game.GameInfo.topLayer.addChild(this.msgTips)},t.prototype.removeMessageBox=function(){this.msgTips&&(game.GameInfo.topLayer.removeChild(this.msgTips),this.msgTips=null)},t.prototype.msgConfirmHandler=function(t){this.msgTips&&(game.GameInfo.topLayer.removeChild(this.msgTips),this.msgTips=null,game.GameView.exitGame())},t.prototype.showMessageTips=function(t){var e=new game.MsgBoxPanel;e.x=uniLib.Global.screenWidth-e.width>>1,e.y=uniLib.Global.screenHeight-e.height>>1,game.GameInfo.topLayer.addChild(e);var n=function(){e&&e.parent&&(e.parent.removeChild(e),e=null)};e.setData(t.msg,["确定"],[n],this)},t.prototype.leaveRoom=function(t){game.GameView.exitGame(),this.clearTimer()},t.prototype.showLastHandcards=function(t){if(game.GameView.Instance.setBtnsVisible(!1),this.roundResultData=t,this.leftTime=3e3,game.DDZAI.Instance.clearPlayCard(),1!=game.RoomInfo.getInstance().video&&!game.PokerFunction.MainSeat.isReady){t.otherCardList&&game.OperateLayer.Instance.playNineCard(t.otherCardList);for(var e=0;e<game.RoomData.Instance.seatList.length;e++){var n=game.RoomData.Instance.seatList[e],i=new Cmd.PlayCardCmd_CS;i.uid=n.user.uid;var a=this.roundResultData.resultList.first(function(t){return t.user.uid==n.user.uid}).cardList;i.cardList=null==a?n.handCards:a,i.cardListType=0,null!=i.cardList&&i.cardList.length&&game.OperateLayer.Instance.playCard(i,!1,!0)
}egret.clearInterval(this.timer),this.timer=egret.setInterval(this.updateTimer,this,100)}},t.prototype.updateTimer=function(){this.leftTime=this.leftTime-100,1e3==this.leftTime&&this.roundResultData.honor&&this.showGameHoner(this.roundResultData.honor),0==this.leftTime&&(this.showRoundResult(this.roundResultData),this.leftTime=0,egret.clearInterval(this.timer))},t.prototype.clearTimer=function(){this.timer&&(egret.clearInterval(this.timer),this.timer=null)},t.prototype.showGameHoner=function(t){if(t&&t instanceof Array){game.OperateLayer.Instance.addCardTypeEffect();for(var e=0,n=t;e<n.length;e++){var i=n[e];i==Cmd.GameHonor.GameHonor_Spring?game.EffectCreate.Instance.playChuntian():i==Cmd.GameHonor.GameHonor_SpringReverse&&game.EffectCreate.Instance.playFanChun()}}},t.prototype.showRoundResult=function(t){if(game.PokerFunction.MainSeat&&!game.PokerFunction.MainSeat.isReady){var e=game.RoundResultPanel.Instance;game.GameInfo.topLayer.addChild(e),e.setData(t)}},t.prototype.gameFianlSettle=function(t){game.GameInfo.topLayer.removeChildren();var e=new game.GameOverPanel;game.GameInfo.topLayer.addChild(e),e.x=uniLib.Global.screenWidth-e.width>>1,e.y=uniLib.Global.screenHeight-e.height>>1,e.setData(t),t.recordList=null!=t.recordList&&t.recordList instanceof Array?t.recordList:[],game.RoomData.Instance.clearSeatList(),GX.MulticastEvent.EventList.removeAllEvent()},t.prototype.gmAvailableCardUpdate=function(t){var e=t,n=game.TestPanel.Instance;n.x=(uniLib.Global.screenWidth-n.width)/2,n.y=80,game.GameInfo.topLayer.addChild(n),n.setCardList(e.cardList)},t}();t.EventManage=e,__reflect(e.prototype,"DDZ.EventManage")}(DDZ||(DDZ={}));var game;!function(t){var e=function(e){function n(i){var a=e.call(this,n.NAME,i)||this;t.GameInfo.uiLayer.addChild(t.GameView.Instance),a.initGame();var r=new t.DDZVoiceChat;return r.name="voiceVc",r.updateBtnRes(["NDvoice_btn1_ddz","NDvoice_btn2_ddz"]),t.GameInfo.uiLayer.addChild(r),a.facade.registerMediator(new t.DDZVoiceChatMediator(r)),(0!=uniLib.Global.is_sandbox||MJLobby.MJLobbyData.getInstance().isInEventGame)&&(r.visible=!1),GX.PokerEvent.Instance.systemMessage.add(a.showSystemMessage,a),a}return __extends(n,e),n.prototype.uiHandle=function(t){},n.prototype.listNotificationInterests=function(){return[t.MahjongFourFacadeConst.NOTIFY_COMMON_CHAT,t.MahjongFourFacadeConst.USERINFO_DATA,t.MahjongFourFacadeConst.SEND_GIFTS_NOTICE,t.MahjongFourFacadeConst.DISS_REQUEST_NOTICE,t.MahjongFourFacadeConst.ReturnIpAndGPS,t.MahjongFourFacadeConst.TIMEOUT_WAIT]},n.prototype.handleNotification=function(e){switch(e.getName()){case t.MahjongFourFacadeConst.TIMEOUT_WAIT:var n=e.getBody();t.GameView.Instance.updateTimeout(n);break;case t.MahjongFourFacadeConst.NOTIFY_COMMON_CHAT:var i=e.getBody();this.showChatPop(i);break;case t.MahjongFourFacadeConst.USERINFO_DATA:var a=e.getBody();this.showUserInfo(a);break;case t.MahjongFourFacadeConst.SEND_GIFTS_NOTICE:var r=e.getBody();if(!r||!r.gift)return;t.EffectCreate.Instance.giftEffect(r.gift.giftsId,r.gift.toUid,r.gift.fromUid);break;case t.MahjongFourFacadeConst.DISS_REQUEST_NOTICE:var o=t.PokerFunction.GetUserInfoByUid(uniLib.NetMgr.UID);o&&this.dissolveRoom(e.getBody());break;case t.MahjongFourFacadeConst.ReturnIpAndGPS:t.GameView.Instance.setDistanceDate(e.getBody())}},n.prototype.dissolveRoom=function(e){this._dismissPanel?this._dismissPanel.setData_Mjhong(e):(this._dismissPanel=new t.DismissPanel,this._dismissPanel.x=uniLib.Global.screenWidth-this._dismissPanel.width>>1,this._dismissPanel.y=uniLib.Global.screenHeight-this._dismissPanel.height>>1,this._dismissPanel.setData_Mjhong(e),t.GameInfo.topLayer.addChild(this._dismissPanel))},n.prototype.showSystemMessage=function(){this.removeDissPanel()},n.prototype.removeDissPanel=function(){this._dismissPanel&&this._dismissPanel.parent&&this._dismissPanel.parent.removeChild(this._dismissPanel),this._dismissPanel=null},n.prototype.showChatPop=function(e){var n=new t.ChatPop;t.GameInfo.topLayer.addChild(n),e.voiceId?n.showCommonChat(e.uid,String(e.voiceId)):e.words&&n.showCommonChat(e.uid,e.words)},n.prototype.showUserInfo=function(e){var n=new t.UserInfoPanel;n.x=uniLib.Global.screenWidth-n.width>>1,n.y=uniLib.Global.screenHeight-n.height>>1,n.setData(e),n.setRect&&n.setRect(n.x),t.GameInfo.topLayer.addChild(n)},n.prototype.ipWarnPanel=function(t){},n.prototype.initGame=function(){t.PokerData.isStandAlone||this.facade.sendNotification(t.MahjongFourFacadeConst.SEND_DATA,null,t.DataRequestCommand.CONNECT_GAME_SERVER)},n.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.facade.removeMediator(t.DDZVoiceChatMediator.NAME)},n}(puremvc.Mediator);e.NAME="DDZPokerMediator",t.DDZPokerMediator=e,__reflect(e.prototype,"game.DDZPokerMediator")}(game||(game={}));var game;!function(t){var e=function(e){function a(){var t=e.call(this)||this;return t._isCancel=!1,t}return __extends(a,e),a.StartVoicePlaying=function(t){var e=!1;for(var n in a.VoicePlaying){var i=a.VoicePlaying[n];1==i&&(e=!0)}e||(a.soundOpen=uniLib.SoundMgr.instance.soundOpen,uniLib.SoundMgr.instance.soundOpen=!1,uniLib.SoundMgr.instance.pauseBgMusic()),a.VoicePlaying[t]=!0},a.StopVoicePlaying=function(t){a.VoicePlaying[t]=!1;var e=!1;for(var n in a.VoicePlaying){var i=a.VoicePlaying[n];1==i&&(e=!0)}e||(uniLib.SoundMgr.instance.soundOpen=a.soundOpen,uniLib.SoundMgr.instance.resumeBgMusic())},a.prototype.initUI=function(){this._startBtn=new t.GameButton(["voice_btn2","voice_btn1"]),this._startBtn.y=uniLib.Global.screenHeight-320,this._startBtn.x=uniLib.Global.screenWidth-this._startBtn.width-(71-this._startBtn.width),this.addChild(this._startBtn),this._startBtn.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.startRecord,this),this._recording=new i,this.addChild(this._recording),this._recording.x=(t.DataCache.defaultWidth-this._recording.width)/2,this._recording.y=(t.DataCache.defaultHeight-this._recording.height)/2,this._recording.addEventListener(t.UIEventConsts.RECORD_TIME_OUT,this.recordEvent,this),this._voiceArr=[],t.GameInfo.topLayer.addChild(this._recording)},a.prototype.updateBtnRes=function(t){this._startBtn.iconTexture(t),this._startBtn.y=443,this._startBtn.x=uniLib.Global.screenWidth-this._startBtn.width-25},a.prototype.setVoiceVisible=function(t){this._startBtn.visible=t},a.prototype.test=function(){var t=new Cmd.VoiceChat_Brd;t.uid=uniLib.UserInfo.uid,t.time="15",t.url="",this.showVoice(t)},a.prototype.showVoice=function(e){var n=t.GameConstant.GetClientNoByUid(e.uid);if(!(n>2||0>n)){var i=this.getVoiceItem(n);t.GameInfo.topLayer.addChildAt(i,0);var a=new t.VoiceDataVo;a.time=Number(e.time),a.url=e.url,a.uid=e.uid,i.setData(a)}},a.prototype.getVoiceItem=function(e){if(this._voiceArr[e])return this._voiceArr[e];var i=t.GameConstant.seatPosArr[e];if(!this._voiceArr[e]){var a=new n;0==e||2==e?a.x=i.x+t.GameConstant.HeadWidth:1==e&&(a.scaleX=-1,a.flip(),a.x=i.x),a.y=i.y+10,this._voiceArr[e]=a}return this._voiceArr[e]},a.prototype.recordEvent=function(t){this.stopRecord()},a.prototype.startRecord=function(t){this._isCancel=!1,this._curPosY=t.localY,egret.MainContext.instance.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.stopRecord,this),egret.MainContext.instance.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.checkCancel,this),uniLib.ZQGameSdk.startRecord(),this._recording.startTimer()},a.prototype.checkCancel=function(t){t.localY>this._curPosY+20&&(this._isCancel=!0,egret.MainContext.instance.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.stopRecord,this),egret.MainContext.instance.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.checkCancel,this),uniLib.ZQGameSdk.stopRecord(),this._recording.stopTimer())},a.prototype.stopRecord=function(t){void 0===t&&(t=null),egret.MainContext.instance.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.stopRecord,this),egret.MainContext.instance.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.checkCancel,this);var e=this._recording.stopTimer();if(1e3>e){setTimeout(function(){uniLib.ZQGameSdk.stopRecord()},1e3)}else uniLib.ZQGameSdk.stopRecord(this.onRecordBack,this)},a.prototype.onRecordBack=function(e){var n=e.data,i=t.GameConstant.GetClientNoByUid(uniLib.NetMgr.UID);this.getVoiceItem(i);if(0==e.code){var a=new t.VoiceDataVo;a.url=n.voiceUrl,a.time=Math.round(n.voiceDuration/1e3),a.nickName=uniLib.NetMgr.UID.toString(),a.text=n.text,a.status=0,isNaN(a.time)?t.GameInfo.manage.showMildWarnShow("语音发送失败"):0==this._isCancel&&this.dispatchEventWith(t.UIEventConsts.SEND_RECORD,!1,a)}else t.GameInfo.manage.showMildWarnShow(e.errMsg)},a.prototype.destory=function(){this._startBtn&&(this._startBtn.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.startRecord,this),egret.MainContext.instance.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.stopRecord,this),egret.MainContext.instance.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.checkCancel,this),this._startBtn.destory()),this._startBtn=null,this._recording&&(t.ResUtil.removeFromParent(this._recording),this._recording.removeEventListener(t.UIEventConsts.RECORD_TIME_OUT,this.recordEvent,this),this._recording.destory()),this._recording=null;for(var e,n=0;n<this._voiceArr.length;n++)e=this._voiceArr[n],e&&(t.ResUtil.removeFromParent(e),e.destory(),e=null);this._voiceArr=null,uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this)},a}(t.BaseVc);e.VoicePlaying={},t.DDZVoiceChat=e,__reflect(e.prototype,"game.DDZVoiceChat");var n=function(n){function i(){var t=n.call(this)||this;return t._ifFlip=!1,t}return __extends(i,n),i.prototype.initUI=function(){this._bg=t.ResUtil.createBitmapByName("voice_paopao_ddz"),this._bg.scale9Grid=new egret.Rectangle(50,10,30,20),this.addChild(this._bg),this._soundIcon=t.ResUtil.createBitmapByName("voice_icon_ddz",24,11),this.addChild(this._soundIcon),this._timeTxt=t.ResUtil.createTextFeild(16777215,egret.HorizontalAlign.RIGHT,"",18,48,13,50),this.addChild(this._timeTxt)},i.prototype.onTimer=function(t){this._soundIcon.visible=!this._soundIcon.visible;var n=new Date,i=n.getTime(),a=Math.floor((i-this._startTime)/1e3);a>=this._soundTime&&(e.StopVoicePlaying(this.uid),this.stopTimer())},i.prototype.stopTimer=function(){this._soundIcon.visible=!0,this.visible=!1,this._timer&&(this._timer.removeEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this._timer.stop(),this._timer=null)},i.prototype.flip=function(){this._ifFlip=!0,this._timeTxt.skewY=180,this._timeTxt.textAlign=egret.HorizontalAlign.LEFT},i.prototype.setData=function(t){this.uid=t.uid,e.StartVoicePlaying(this.uid),t.uid!=uniLib.NetMgr.UID&&uniLib.ZQGameSdk.playRecord(t.url,this.playEndBack,this),t.time?this._timeTxt.text=t.time+"''":this._timeTxt.text="",this._soundTime=t.time?t.time:10,t.time<=3?this._bg.width=100:this._bg.width=100+5*(t.time-3),this._ifFlip?this._timeTxt.x=this._bg.width-12:this._timeTxt.x=this._bg.width-60,this.stopTimer(),this.visible=!0,this._timer=new egret.Timer(200),this._timer.addEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this._timer.start();var n=new Date;this._startTime=n.getTime()},i.prototype.playEndBack=function(t){this.stopTimer()},i.prototype.destory=function(){this.stopTimer(),uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this),this._bg=null,this._soundIcon=null},i}(t.BaseVc);t.DDZVoiceMc=n,__reflect(n.prototype,"game.DDZVoiceMc");var i=function(e){function n(){var t=e.call(this)||this;return t._maxTime=15,t._msTime=0,t}return __extends(n,e),n.prototype.initUI=function(){var e=t.ResUtil.createBitmapByName("voice_recording_ddz");this.addChild(e),this._moving=new egret.DisplayObjectContainer,this._moving.x=104,this._moving.y=102;var n=t.ResUtil.createBitmapByName("voiceloading_ddz");n.x=-n.width/2,n.y=-n.height/2,this._moving.addChild(n),this.addChild(this._moving),this._time=t.ResUtil.createTextFeild(13031390,egret.HorizontalAlign.CENTER,"8''",22,74,136,75),this.addChild(this._time),this.visible=!1},n.prototype.startTimer=function(){this.stopTimer(),this.visible=!0,this._startTimer=new egret.Timer(50,0);var t=new Date;this._startTime=t.getTime(),this._startTimer.addEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this._startTimer.start()},n.prototype.stopTimer=function(){return this.visible=!1,this._startTimer&&(this._startTimer.removeEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this._startTimer.stop(),this._startTimer=null),this._msTime},n.prototype.onTimer=function(e){var n=new Date,i=n.getTime(),a=Math.floor((i-this._startTime)/1e3);this._time.text=a+1+"''",this._moving.rotation+=15,a>=this._maxTime&&this.dispatchEventWith(t.UIEventConsts.RECORD_TIME_OUT),this._msTime=i-this._startTime},n.prototype.dispose=function(){this.stopTimer(),this._moving&&(uniLib.DisplayUtils.removeAllChildren(this._moving),uniLib.DisplayUtils.removeFromParent(this._moving)),uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this),this._moving=null,this._time=null},n}(t.BaseVc);t.DDZRecordingMc=i,__reflect(i.prototype,"game.DDZRecordingMc")}(game||(game={}));var game;!function(t){var e=function(e){function n(n){var i=e.call(this,t.VoiceChatMediator.NAME,n)||this;return i._voiceVc=n,i._voiceVc.addEventListener(t.UIEventConsts.SEND_RECORD,i.uiEventHandle,i),i}return __extends(n,e),n.prototype.uiEventHandle=function(e){var n=e.type;switch(n){case t.UIEventConsts.SEND_RECORD:var i=e.data,a=new Cmd.VoiceChat_C;a.url=i.url,a.time=i.time.toString(),a.words=i.text,this.sendNotification(t.MahjongFourFacadeConst.SEND_DATA,a,t.DataRequestCommand.GAME_DATA)}},n.prototype.listNotificationInterests=function(){return[t.MahjongFourFacadeConst.USER_ENTER_ROOM,t.MahjongFourFacadeConst.VOICE_NOTICE]},n.prototype.handleNotification=function(e){switch(e.getName()){case t.MahjongFourFacadeConst.VOICE_NOTICE:this._voiceVc.showVoice(e.getBody());break;case t.MahjongFourFacadeConst.USER_ENTER_ROOM:}},n.prototype.onRemove=function(){t.DDZVoiceChat.VoicePlaying={},this._voiceVc&&(this._voiceVc.removeEventListener(t.UIEventConsts.SEND_RECORD,this.uiEventHandle,this),this._voiceVc.destory(),this._voiceVc=null),e.prototype.onRemove.call(this)},n}(puremvc.Mediator);e.NAME="DDZVoiceChatMediator",t.DDZVoiceChatMediator=e,__reflect(e.prototype,"game.DDZVoiceChatMediator")}(game||(game={}));var DDZtable;!function(t){var e=function(){function t(){}return t.prototype.GetType=function(){return"table.gameList"},t}();t.gameList=e,__reflect(e.prototype,"DDZtable.gameList")}(DDZtable||(DDZtable={}));var DDZtable;!function(t){var e=function(){function t(){}return t.prototype.GetType=function(){return"table.PokerTableCard"},t}();t.PokerTableCard=e,__reflect(e.prototype,"DDZtable.PokerTableCard")}(DDZtable||(DDZtable={}));var DDZtable;!function(t){var e=function(){function t(){}return t.prototype.GetType=function(){return"DDZtable.TableCard"},t}();t.TableCard=e,__reflect(e.prototype,"DDZtable.TableCard")}(DDZtable||(DDZtable={}));var DDZtable;!function(t){var e=function(){function t(){}return t.prototype.GetType=function(){return"table.TableGift"},t}();t.TableGift=e,__reflect(e.prototype,"DDZtable.TableGift")}(DDZtable||(DDZtable={}));var DDZtable;!function(t){var e=function(){function t(){}return t.prototype.GetType=function(){return"table.TableGoodsConfig"},t}();t.TableGoodsConfig=e,__reflect(e.prototype,"DDZtable.TableGoodsConfig"),function(t){var e=function(){function t(){}return t}();t.GiftGoodsItem=e,__reflect(e.prototype,"DDZtable.TableGoodsConfig.GiftGoodsItem")}(e=t.TableGoodsConfig||(t.TableGoodsConfig={}))}(DDZtable||(DDZtable={}));var DDZtable;!function(t){var e=function(){function t(){}return t.prototype.GetType=function(){return"table.TableMahjongMulti"},t}();t.TableMahjongMulti=e,__reflect(e.prototype,"DDZtable.TableMahjongMulti")}(DDZtable||(DDZtable={}));var DDZtable;!function(t){var e=function(){function t(){}return t.prototype.GetType=function(){return"table.TablePlayTypeList"},t}();t.TablePlayTypeList=e,__reflect(e.prototype,"DDZtable.TablePlayTypeList")}(DDZtable||(DDZtable={}));var DDZtable;!function(t){var e=function(){function t(){}return t.prototype.GetType=function(){return"table.TableRoomCostConfig"},t}();t.TableRoomCostConfig=e,__reflect(e.prototype,"DDZtable.TableRoomCostConfig")}(DDZtable||(DDZtable={}));var DDZtable;!function(t){var e=function(){function t(){}return t.prototype.GetType=function(){return"table.TableServerReturnCode"},t}();t.TableServerReturnCode=e,__reflect(e.prototype,"DDZtable.TableServerReturnCode")}(DDZtable||(DDZtable={}));var DDZtable;!function(t){var e=function(){function t(){}return t.prototype.GetType=function(){return"table.TableShopConfig"},t}();t.TableShopConfig=e,__reflect(e.prototype,"DDZtable.TableShopConfig"),function(t){var e=function(){function t(){}return t}();t.ShopGoodsItem=e,__reflect(e.prototype,"DDZtable.TableShopConfig.ShopGoodsItem")}(e=t.TableShopConfig||(t.TableShopConfig={})),function(t){var e=function(){function t(){}return t}();t.FirstShopGoodsItem=e,__reflect(e.prototype,"DDZtable.TableShopConfig.FirstShopGoodsItem")}(e=t.TableShopConfig||(t.TableShopConfig={}))}(DDZtable||(DDZtable={}));var DDZtable;!function(t){var e=function(){function t(){}return t.prototype.GetType=function(){return"table.TableVoice"},t}();t.TableVoice=e,__reflect(e.prototype,"DDZtable.TableVoice")}(DDZtable||(DDZtable={}));var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,n,i){function a(t){e.call(i,t)}function r(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),n.call(i))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),RES.getResByUrl(t,a,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);