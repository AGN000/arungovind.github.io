var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},game;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.init(),this.addEvent()},e.prototype.init=function(){},e.prototype.addEvent=function(){},e.prototype.removeEvent=function(){},e.prototype.destroy=function(){this.removeEvent()},e}(eui.Component);t.BaseEui=e,__reflect(e.prototype,"game.BaseEui",["game.EuiSkinInt"])}(game||(game={}));var ShakeTool=function(){function t(){this.count=0,this.timer=new egret.Timer(1e3)}return Object.defineProperty(t,"Instance",{get:function(){return null==this.instance&&(this.instance=new t),this.instance},enumerable:!0,configurable:!0}),t.prototype.shakeObj=function(t,e,i,n){this.target=t,this.initX=t.x,this.initY=t.y,this.maxDis=n,this.count=e*i,this.rate=i,this.timer.delay=1e3/i,this.timer.repeatCount=this.count,this.timer.addEventListener(egret.TimerEvent.TIMER,this.shaking,this),this.timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.shakeComplete,this),this.timer.reset(),this.timer.start()},t.prototype.shaking=function(){egret.Tween.removeTweens(this.target),this.target.x=this.initX-this.maxDis+Math.random()*this.maxDis*2,this.target.y=this.initY-this.maxDis+Math.random()*this.maxDis*2,egret.Tween.get(this.target).to({x:this.initX,y:this.initY},999/this.rate)},t.prototype.shakeComplete=function(){this.target&&(egret.Tween.removeTweens(this.target),this.target.x=this.initX,this.target.y=this.initY),this.timer.removeEventListener(egret.TimerEvent.TIMER,this.shaking,this),this.timer.removeEventListener(egret.TimerEvent.TIMER_COMPLETE,this.shakeComplete,this)},t.prototype.stop=function(){this.shakeComplete()},t}();__reflect(ShakeTool.prototype,"ShakeTool");var TDK;!function(t){var e=function(){function t(){this.listener()}return t.prototype.listener=function(){GX.PokerEvent.Instance.tcpSendEvent.add(this.tcpSendEvent,this),GX.PokerEvent.Instance.userBetEvent.add(this.userBet,this),GX.PokerEvent.Instance.dissolveRoomUpdate.add(this.dissolveRoom,this),GX.PokerEvent.Instance.systemMessage.add(this.showSystemMessage,this),GX.PokerEvent.Instance.leaveRoom.add(this.leaveRoom,this),GX.PokerEvent.Instance.roundResult.add(this.showLastHandcards,this),GX.PokerEvent.Instance.dealCardAnimation.add(game.EffectCreate.Instance.addCardAnimation,game.EffectCreate.Instance),GX.PokerEvent.Instance.showBackCardsAnimation.add(game.EffectCreate.Instance.showBackCardsAnim,game.EffectCreate.Instance),GX.PokerEvent.Instance.gameFinalSettle.add(this.gameFianlSettle,this),GX.PokerEvent.Instance.gmAvailableCardUpdate.add(this.gmAvailableCardUpdate,this),GX.PokerEvent.Instance.gameStateUpdate.add(this.gameStatusUpdate,this),GX.PokerEvent.Instance.SendGiftEvent.add(this.SendGiftEvent,this),GX.PokerEvent.Instance.dealCardEnd.add(this.dealCardEnd,this),GX.PokerEvent.Instance.ShowActionEvent.add(game.CardSet.Instance.showEffect,game.CardSet.Instance),game.RoomData.Instance.startGameChanged.add(this.clearTimer,this)},t.prototype.tcpSendEvent=function(t){!game.PokerData.isStandAlone},t.prototype.SendGiftEvent=function(t){t&&t.gift&&game.EffectCreate.Instance.giftEffect(t.gift.giftsId,t.gift.toUid,t.gift.fromUid)},t.prototype.PlayCard=function(t,e){void 0===e&&(e=!0);game.PokerFunction.GetSeatDataByUid(t.uid)},t.prototype.userBet=function(t){game.OperateLayer.Instance.userBet(t)},t.prototype.dissolveRoom=function(t){this._dismissPanel?this._dismissPanel.setData(t):(this._dismissPanel=new game.DismissPanel,this._dismissPanel.x=uniLib.Global.screenWidth-this._dismissPanel.width>>1,this._dismissPanel.y=uniLib.Global.screenHeight-this._dismissPanel.height>>1,this._dismissPanel.setData(t),game.GameInfo.topLayer.addChild(this._dismissPanel))},t.prototype.removeDissPanel=function(){this._dismissPanel&&this._dismissPanel.parent&&this._dismissPanel.parent.removeChild(this._dismissPanel),this._dismissPanel=null},t.prototype.gameStatusUpdate=function(t){t&&(t.status==Cmd.GameStatus.GameStatus_Pause?game.GameView.Instance.showSuspendPrompt(!0,t.leftSec):t.status==Cmd.GameStatus.GameStatus_Playing&&game.GameView.Instance.showSuspendPrompt(!1))},t.prototype.showSystemMessage=function(t){switch(this.removeDissPanel(),t.msgType){case Cmd.SysMessageCmd_S.MsgType.Text:game.PublicManage.getInstance().showMildWarnShow(t.msg);break;case Cmd.SysMessageCmd_S.MsgType.DissolveRoom:this.showMessageBox(t);break;case Cmd.SysMessageCmd_S.MsgType.BackToLobby:var e=new MJLobby.MessageItem;e.text=t.msg,e.title="",MJLobby.MessageQueue.Instance.push(e),game.GameView.exitGame();break;case Cmd.SysMessageCmd_S.MsgType.Bounce:var i=new MJLobby.MessageItem;i.text=t.msg,i.title="",MJLobby.MessageQueue.Instance.push(i);break;case Cmd.SysMessageCmd_S.MsgType.NotEnoughMoney:this.showMessageTips(t)}},t.prototype.showMessageBox=function(t){this.msgTips||(this.msgTips=new game.MsgBoxPanel),this.msgTips.x=uniLib.Global.screenWidth-this.msgTips.width>>1,this.msgTips.y=uniLib.Global.screenHeight-this.msgTips.height>>1,this.msgTips.setData(t.msg,["确定"],[this.msgConfirmHandler],this,0,!1),game.GameInfo.topLayer.addChild(this.msgTips)},t.prototype.removeMessageBox=function(){this.msgTips&&(game.GameInfo.topLayer.removeChild(this.msgTips),this.msgTips=null)},t.prototype.msgConfirmHandler=function(t){this.msgTips&&(this.clearTimer(),game.GameInfo.topLayer.removeChild(this.msgTips),this.msgTips=null,game.GameView.exitGame())},t.prototype.showMessageTips=function(t){var e=new game.MsgBoxPanel;e.x=uniLib.Global.screenWidth-e.width>>1,e.y=uniLib.Global.screenHeight-e.height>>1,game.GameInfo.topLayer.addChild(e);var i=function(){e&&e.parent&&(e.parent.removeChild(e),e=null)};e.setData(t.msg,["确定"],[i],this)},t.prototype.leaveRoom=function(t){this.clearTimer(),game.GameView.exitGame()},t.prototype.showLastHandcards=function(t){if(t&&(game.SeatLayer.Instance.stopOtherCountdown(),game.GameView.Instance.setBtnsVisible(!1),game.CardSet.Instance.setTouch(!1),this.roundResultData=t,t.winnerList&&t.winnerList.length>=0?game.GameConstant.lastRoundIsNoWinner=!1:game.GameConstant.lastRoundIsNoWinner=!0,this.leftTime=3e3,!game.PokerFunction.MainSeat||!game.PokerFunction.MainSeat.isReady)){var e=t;if(e.resultList)for(var i=0;i<e.resultList.length;i++){var n=e.resultList[i];if(n.cardList){var a=game.PokerFunction.GetSeatDataByUid(n.user.uid);if(a&&a.handCards){for(var s=n.cardList.length,o=0;s>o;o++){var r=n.cardList[o];a.replaceHandCard(o,r)}game.EffectCreate.Instance.showBackCardsAnim(a.user.uid)}}}return 1==game.RoomInfo.getInstance().video?(game.EffectCreate.Instance.showResultEffect(this.roundResultData.winnerList),void(this.roundResultData.winnerList&&this.roundResultData.winnerList.length>0&&game.EffectCreate.Instance.bet2Winner(this.roundResultData.winnerList))):void(this.timer=egret.setInterval(this.updateTimer,this,100))}},t.prototype.updateTimer=function(){this.leftTime=this.leftTime-100,2500==this.leftTime&&(game.EffectCreate.Instance.showResultEffect(this.roundResultData.winnerList),game.CardSet.Instance.showResultPoint(this.roundResultData.resultList),this.roundResultData.winnerList&&this.roundResultData.winnerList.length>0&&(game.EffectCreate.Instance.bet2Winner(this.roundResultData.winnerList),this.roundResultData.winnerList&&this.roundResultData.winnerList.length>0&&(game.RoomData.Instance.tabPoints=0)),this.showRoundResult(this.roundResultData),this.leftTime=0,egret.clearInterval(this.timer))},t.prototype.clearTimer=function(){this.timer&&(egret.clearInterval(this.timer),this.timer=null)},t.prototype.showRoundResult=function(t){if(this.clearTimer(),game.PokerFunction.MainSeat&&!game.PokerFunction.MainSeat.isReady){var e=game.RoundResultPanel.Instance;e.x=uniLib.Global.screenWidth-e.width>>1,e.y=uniLib.Global.screenHeight-e.height>>1,game.DataManager.isInGame&&(e.setData(t),game.GameInfo.topLayer.addChild(e))}},t.prototype.gameFianlSettle=function(t){this.clearTimer(),game.GameInfo.topLayer.removeChildren();var e=new game.GameOverPanel;game.GameInfo.topLayer.addChild(e),e.x=uniLib.Global.screenWidth-e.width>>1,e.y=uniLib.Global.screenHeight-e.height>>1,e.setData(t)},t.prototype.gmAvailableCardUpdate=function(t){var e=t,i=game.TestPanel.Instance;i.x=(uniLib.Global.screenWidth-i.width)/2,i.y=80,game.GameInfo.topLayer.addChild(i),i.setCardList(e.cardList)},t.prototype.dealCardEnd=function(){game.CardSet.Instance.updateUserBetCount()},t}();e.startVisableChanged=new GX.MulticastEvent,t.EventManage=e,__reflect(e.prototype,"TDK.EventManage")}(TDK||(TDK={}));var game;!function(t){var e=function(e){function i(n){var a=e.call(this,i.NAME,n)||this;t.GameInfo.uiLayer.addChild(t.GameView.Instance),a.initGame();var s=new t.TDKVoiceChat;return s.name="voiceVc",s.updateBtnRes(["NDvoice_btn1_TDK","NDvoice_btn2_TDK"]),t.GameInfo.uiLayer.addChild(s),a.facade.registerMediator(new t.TDKVoiceChatMediator(s)),0!=uniLib.Global.is_sandbox&&(s.visible=!1),t.GameConstant.cardResStr=null==egret.localStorage.getItem("cardColor")?t.GameConstant.cardResStr:egret.localStorage.getItem("cardColor"),a}return __extends(i,e),i.prototype.uiHandle=function(t){},i.prototype.listNotificationInterests=function(){return[t.MahjongFourFacadeConst.NOTIFY_COMMON_CHAT,t.MahjongFourFacadeConst.USERINFO_DATA,t.MahjongFourFacadeConst.SEND_GIFTS_NOTICE,t.MahjongFourFacadeConst.CHANGE_USERNUM_NOTICE,t.MahjongFourFacadeConst.CHANGE_USERNUM_BACK,t.MahjongFourFacadeConst.ReturnIpAndGPS]},i.prototype.handleNotification=function(e){switch(e.getName()){case t.MahjongFourFacadeConst.CHANGE_USERNUM_NOTICE:this._dismissPanel||this.dissolveRoom(e.getBody());break;case t.MahjongFourFacadeConst.CHANGE_USERNUM_BACK:this._dismissPanel||this.dissolveRoom(e.getBody());break;case t.MahjongFourFacadeConst.NOTIFY_COMMON_CHAT:var i=e.getBody();this.showChatPop(i);break;case t.MahjongFourFacadeConst.USERINFO_DATA:var n=e.getBody();this.showUserInfo(n);break;case t.MahjongFourFacadeConst.ReturnIpAndGPS:var a=e.getBody(),s=new t.GpsPanel;s.addUserGpsListIcon(a),t.PopupManager.addPopUp(s,!0,!0);break;case t.MahjongFourFacadeConst.SEND_GIFTS_NOTICE:var o=e.getBody();if(!o||!o.gift)return;t.EffectCreate.Instance.giftEffect(o.gift.giftsId,o.gift.toUid,o.gift.fromUid)}},i.prototype.dissolveRoom=function(e){if(e.uid!=uniLib.NetMgr.UID){var i=new t.MsgBoxPanel,n=t.DataCache.langObj.uiTxt.DismissPanel.info,a=n.split("#"),s=t.PokerFunction.GetUserInfoByUid(e.uid),o=a[0]+s.nickName+"\n申请将房间人数设置为"+t.RoomData.Instance.seatList.length+"\n提前开局！";i.setData(o,["同意","取消"],[this.onAgreeHandler,this.onRefuse],this),t.PopupManager.addPopUp(i,!0,!0)}},i.prototype.onRefuse=function(e){var i=new Cmd.ReturnChangeUserNbrRoom_C;i.isAgree=0,t.PokerFunction.tcpSend(i)},i.prototype.onAgreeHandler=function(){var e=new Cmd.ReturnChangeUserNbrRoom_C;e.isAgree=1,t.PokerFunction.tcpSend(e)},i.prototype.showChatPop=function(e){var i=new t.ChatPop;t.GameInfo.topLayer.addChild(i),e.voiceId?i.showCommonChat(e.uid,String(e.voiceId)):e.words&&i.showCommonChat(e.uid,e.words)},i.prototype.showUserInfo=function(e){var i=new t.UserInfoPanel;i.setData(e),t.PopupManager.addPopUp(i,!0,!0)},i.prototype.ipWarnPanel=function(t){},i.prototype.initGame=function(){t.PokerData.isStandAlone||this.facade.sendNotification(t.MahjongFourFacadeConst.SEND_DATA,null,t.DataRequestCommand.CONNECT_GAME_SERVER)},i.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.facade.removeMediator(t.TDKVoiceChatMediator.NAME)},i}(puremvc.Mediator);e.NAME="TDKPokerMediator",t.TDKPokerMediator=e,__reflect(e.prototype,"game.TDKPokerMediator")}(game||(game={}));var game;!function(t){var e=function(e){function a(){var t=e.call(this)||this;return t._isCancel=!1,t}return __extends(a,e),a.StartVoicePlaying=function(t){var e=!1;for(var i in a.VoicePlaying){var n=a.VoicePlaying[i];1==n&&(e=!0)}e||(a.soundOpen=uniLib.SoundMgr.instance.soundOpen,uniLib.SoundMgr.instance.soundOpen=!1,uniLib.SoundMgr.instance.pauseBgMusic()),a.VoicePlaying[t]=!0},a.StopVoicePlaying=function(t){a.VoicePlaying[t]=!1;var e=!1;for(var i in a.VoicePlaying){var n=a.VoicePlaying[i];1==n&&(e=!0)}e||(uniLib.SoundMgr.instance.soundOpen=a.soundOpen,uniLib.SoundMgr.instance.resumeBgMusic())},a.prototype.initUI=function(){this._startBtn=new t.GameButton(["voice_btn2","voice_btn1"]),this._startBtn.y=uniLib.Global.screenHeight-320,this._startBtn.x=uniLib.Global.screenWidth-this._startBtn.width-(71-this._startBtn.width),this.addChild(this._startBtn),this._startBtn.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.startRecord,this),this._recording=new n,this.addChild(this._recording),this._recording.x=(t.DataCache.defaultWidth-this._recording.width)/2,this._recording.y=(t.DataCache.defaultHeight-this._recording.height)/2,this._recording.addEventListener(t.UIEventConsts.RECORD_TIME_OUT,this.recordEvent,this),this._voiceArr=[],t.GameInfo.topLayer.addChild(this._recording)},a.prototype.updateBtnRes=function(t){this._startBtn.iconTexture(t),this._startBtn.y=380,this._startBtn.x=uniLib.Global.screenWidth-this._startBtn.width-10},a.prototype.setVoiceVisible=function(t){this._startBtn.visible=t},a.prototype.test=function(){var t=new Cmd.VoiceChat_Brd;t.uid=uniLib.UserInfo.uid,t.time="15",t.url="",this.showVoice(t)},a.prototype.showVoice=function(e){var i=t.GameConstant.GetClientNoByUid(e.uid);if(!(i>4||0>i)){var n=this.getVoiceItem(i);t.GameInfo.topLayer.addChildAt(n,0);var a=new t.VoiceDataVo;a.time=Number(e.time),a.url=e.url,a.uid=e.uid,n.setData(a)}},a.prototype.getVoiceItem=function(e){if(this._voiceArr[e])return this._voiceArr[e];var n=t.GameConstant.seatPosArr[e];if(!this._voiceArr[e]){var a=new i;0==e||3==e||4==e?a.x=n.x+t.GameConstant.HeadWidth:(1==e||2==e)&&(a.scaleX=-1,a.flip(),a.x=n.x),a.y=n.y+10,this._voiceArr[e]=a}return this._voiceArr[e]},a.prototype.recordEvent=function(t){this.stopRecord()},a.prototype.startRecord=function(t){this._isCancel=!1,this._curPosY=t.localY,egret.MainContext.instance.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.stopRecord,this),egret.MainContext.instance.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.checkCancel,this),uniLib.ZQGameSdk.startRecord(),this._recording.startTimer()},a.prototype.checkCancel=function(t){t.localY>this._curPosY+20&&(this._isCancel=!0,egret.MainContext.instance.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.stopRecord,this),egret.MainContext.instance.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.checkCancel,this),uniLib.ZQGameSdk.stopRecord(),this._recording.stopTimer())},a.prototype.stopRecord=function(e){void 0===e&&(e=null),egret.MainContext.instance.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.stopRecord,this),egret.MainContext.instance.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.checkCancel,this);var i=this._recording.stopTimer();if(1e3>i){setTimeout(function(){uniLib.ZQGameSdk.stopRecord()},1e3)}else if(uniLib.ZQGameSdk.stopRecord(this.onRecordBack,this),uniLib.Global.isH5){var n=new t.VoiceDataVo;n.url="",n.time=5,n.nickName=uniLib.NetMgr.UID.toString(),n.text="",n.status=0,this.dispatchEventWith(t.UIEventConsts.SEND_RECORD,!1,n)}},a.prototype.onRecordBack=function(e){var i=e.data,n=t.GameConstant.GetClientNoByUid(uniLib.NetMgr.UID);this.getVoiceItem(n);if(0==e.code){var a=new t.VoiceDataVo;a.url=i.voiceUrl,a.time=Math.round(i.voiceDuration/1e3),a.nickName=uniLib.NetMgr.UID.toString(),a.text=i.text,a.status=0,isNaN(a.time)?t.GameInfo.manage.showMildWarnShow("语音发送失败"):0==this._isCancel&&this.dispatchEventWith(t.UIEventConsts.SEND_RECORD,!1,a)}else t.GameInfo.manage.showMildWarnShow(e.errMsg)},a.prototype.destory=function(){this._startBtn&&(this._startBtn.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.startRecord,this),egret.MainContext.instance.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.stopRecord,this),egret.MainContext.instance.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.checkCancel,this),this._startBtn.destory()),this._startBtn=null,this._recording&&(t.ResUtil.removeFromParent(this._recording),this._recording.removeEventListener(t.UIEventConsts.RECORD_TIME_OUT,this.recordEvent,this),this._recording.destory()),this._recording=null;for(var e,i=0;i<this._voiceArr.length;i++)e=this._voiceArr[i],e&&(t.ResUtil.removeFromParent(e),e.destory(),e=null);this._voiceArr=null,uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this)},a}(t.BaseVc);e.VoicePlaying={},t.TDKVoiceChat=e,__reflect(e.prototype,"game.TDKVoiceChat");var i=function(i){function n(){var t=i.call(this)||this;return t._ifFlip=!1,t}return __extends(n,i),n.prototype.initUI=function(){this._bg=t.ResUtil.createBitmapByName("voice_paopao_TDK"),this._bg.scale9Grid=new egret.Rectangle(50,10,30,20),this.addChild(this._bg),this._soundIcon=t.ResUtil.createBitmapByName("voice_icon_TDK",24,11),this.addChild(this._soundIcon),this._timeTxt=t.ResUtil.createTextFeild(16777215,egret.HorizontalAlign.RIGHT,"",18,48,13,50),this.addChild(this._timeTxt)},n.prototype.onTimer=function(t){this._soundIcon.visible=!this._soundIcon.visible;var i=new Date,n=i.getTime(),a=Math.floor((n-this._startTime)/1e3);a>=this._soundTime&&(e.StopVoicePlaying(this.uid),this.stopTimer())},n.prototype.stopTimer=function(){this._soundIcon.visible=!0,this.visible=!1,this._timer&&(this._timer.removeEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this._timer.stop(),this._timer=null)},n.prototype.flip=function(){this._ifFlip=!0,this._timeTxt.skewY=180,this._timeTxt.textAlign=egret.HorizontalAlign.LEFT},n.prototype.setData=function(t){this.uid=t.uid,e.StartVoicePlaying(this.uid),t.uid!=uniLib.NetMgr.UID&&uniLib.ZQGameSdk.playRecord(t.url,this.playEndBack,this),t.time?this._timeTxt.text=t.time+"''":this._timeTxt.text="",this._soundTime=t.time?t.time:10,t.time<=3?this._bg.width=100:this._bg.width=100+5*(t.time-3),this._ifFlip?this._timeTxt.x=this._bg.width-12:this._timeTxt.x=this._bg.width-60,this.stopTimer(),this.visible=!0,this._timer=new egret.Timer(200),this._timer.addEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this._timer.start();var i=new Date;this._startTime=i.getTime()},n.prototype.playEndBack=function(t){this.stopTimer()},n.prototype.destory=function(){this.stopTimer(),uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this),this._bg=null,this._soundIcon=null},n}(t.BaseVc);t.TDKVoiceMc=i,__reflect(i.prototype,"game.TDKVoiceMc");var n=function(e){function i(){var t=e.call(this)||this;return t._maxTime=15,t._msTime=0,t}return __extends(i,e),i.prototype.initUI=function(){var e=t.ResUtil.createBitmapByName("voice_recording_TDK");this.addChild(e),this._moving=new egret.DisplayObjectContainer,this._moving.x=104,this._moving.y=102;var i=t.ResUtil.createBitmapByName("voiceloading_TDK");i.x=-i.width/2,i.y=-i.height/2,this._moving.addChild(i),this.addChild(this._moving),this._time=t.ResUtil.createTextFeild(13031390,egret.HorizontalAlign.CENTER,"8''",22,74,136,75),this.addChild(this._time),this.visible=!1},i.prototype.startTimer=function(){this.stopTimer(),this.visible=!0,this._startTimer=new egret.Timer(50,0);var t=new Date;this._startTime=t.getTime(),this._startTimer.addEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this._startTimer.start()},i.prototype.stopTimer=function(){return this.visible=!1,this._startTimer&&(this._startTimer.removeEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this._startTimer.stop(),this._startTimer=null),this._msTime},i.prototype.onTimer=function(e){var i=new Date,n=i.getTime(),a=Math.floor((n-this._startTime)/1e3);this._time.text=a+1+"''",this._moving.rotation+=15,a>=this._maxTime&&this.dispatchEventWith(t.UIEventConsts.RECORD_TIME_OUT),this._msTime=n-this._startTime},i.prototype.dispose=function(){this.stopTimer(),this._moving&&(uniLib.DisplayUtils.removeAllChildren(this._moving),uniLib.DisplayUtils.removeFromParent(this._moving)),uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this),this._moving=null,this._time=null},i}(t.BaseVc);t.TDKRecordingMc=n,__reflect(n.prototype,"game.TDKRecordingMc")}(game||(game={}));var game;!function(t){var e=function(e){function i(i){var n=e.call(this,t.VoiceChatMediator.NAME,i)||this;return n._voiceVc=i,n._voiceVc.addEventListener(t.UIEventConsts.SEND_RECORD,n.uiEventHandle,n),n}return __extends(i,e),i.prototype.uiEventHandle=function(e){var i=e.type;switch(i){case t.UIEventConsts.SEND_RECORD:var n=e.data,a=new Cmd.VoiceChat_C;a.url=n.url,a.time=n.time.toString(),a.words=n.text,this.sendNotification(t.MahjongFourFacadeConst.SEND_DATA,a,t.DataRequestCommand.GAME_DATA)}},i.prototype.listNotificationInterests=function(){return[t.MahjongFourFacadeConst.USER_ENTER_ROOM,t.MahjongFourFacadeConst.VOICE_NOTICE]},i.prototype.handleNotification=function(e){switch(e.getName()){case t.MahjongFourFacadeConst.VOICE_NOTICE:this._voiceVc.showVoice(e.getBody());break;case t.MahjongFourFacadeConst.USER_ENTER_ROOM:}},i.prototype.onRemove=function(){t.TDKVoiceChat.VoicePlaying={},this._voiceVc&&(this._voiceVc.removeEventListener(t.UIEventConsts.SEND_RECORD,this.uiEventHandle,this),this._voiceVc.destory(),this._voiceVc=null),e.prototype.onRemove.call(this)},i}(puremvc.Mediator);e.NAME="TDKVoiceChatMediator",t.TDKVoiceChatMediator=e,__reflect(e.prototype,"game.TDKVoiceChatMediator")}(game||(game={}));var TDKtable;!function(t){var e=function(){function t(){}return t.prototype.GetType=function(){return"table.gameList"},t}();t.gameList=e,__reflect(e.prototype,"TDKtable.gameList")}(TDKtable||(TDKtable={}));var TDKtable;!function(t){var e=function(){function t(){}return t.prototype.GetType=function(){return"table.PokerTableCard"},t}();t.PokerTableCard=e,__reflect(e.prototype,"TDKtable.PokerTableCard")}(TDKtable||(TDKtable={}));var TDKtable;!function(t){var e=function(){function t(){}return t.prototype.GetType=function(){return"TDKtable.TableCard"},t}();t.TableCard=e,__reflect(e.prototype,"TDKtable.TableCard")}(TDKtable||(TDKtable={}));var TDKtable;!function(t){var e=function(){function t(){}return t.prototype.GetType=function(){return"table.TableGift"},t}();t.TableGift=e,__reflect(e.prototype,"TDKtable.TableGift")}(TDKtable||(TDKtable={}));var TDKtable;!function(t){var e=function(){function t(){}return t.prototype.GetType=function(){return"table.TableGoodsConfig"},t}();t.TableGoodsConfig=e,__reflect(e.prototype,"TDKtable.TableGoodsConfig"),function(t){var e=function(){function t(){}return t}();t.GiftGoodsItem=e,__reflect(e.prototype,"TDKtable.TableGoodsConfig.GiftGoodsItem")}(e=t.TableGoodsConfig||(t.TableGoodsConfig={}))}(TDKtable||(TDKtable={}));var TDKtable;!function(t){var e=function(){function t(){}return t.prototype.GetType=function(){return"table.TableMahjongMulti"},t}();t.TableMahjongMulti=e,__reflect(e.prototype,"TDKtable.TableMahjongMulti")}(TDKtable||(TDKtable={}));var TDKtable;!function(t){var e=function(){function t(){}return t.prototype.GetType=function(){return"table.TablePlayTypeList"},t}();t.TablePlayTypeList=e,__reflect(e.prototype,"TDKtable.TablePlayTypeList")}(TDKtable||(TDKtable={}));var TDKtable;!function(t){var e=function(){function t(){}return t.prototype.GetType=function(){return"table.TableRoomCostConfig"},t}();t.TableRoomCostConfig=e,__reflect(e.prototype,"TDKtable.TableRoomCostConfig")}(TDKtable||(TDKtable={}));var TDKtable;!function(t){var e=function(){function t(){}return t.prototype.GetType=function(){return"table.TableServerReturnCode"},t}();t.TableServerReturnCode=e,__reflect(e.prototype,"TDKtable.TableServerReturnCode")}(TDKtable||(TDKtable={}));var TDKtable;!function(t){var e=function(){function t(){}return t.prototype.GetType=function(){return"table.TableShopConfig"},t}();t.TableShopConfig=e,__reflect(e.prototype,"TDKtable.TableShopConfig"),function(t){var e=function(){function t(){}return t}();t.ShopGoodsItem=e,__reflect(e.prototype,"TDKtable.TableShopConfig.ShopGoodsItem")}(e=t.TableShopConfig||(t.TableShopConfig={})),function(t){var e=function(){function t(){}return t}();t.FirstShopGoodsItem=e,__reflect(e.prototype,"TDKtable.TableShopConfig.FirstShopGoodsItem")}(e=t.TableShopConfig||(t.TableShopConfig={}))}(TDKtable||(TDKtable={}));var TDKtable;!function(t){var e=function(){function t(){}return t.prototype.GetType=function(){return"table.TableVoice"},t}();t.TableVoice=e,__reflect(e.prototype,"TDKtable.TableVoice")}(TDKtable||(TDKtable={}));var game;!function(t){var e=function(e){function n(){var i=e.call(this)||this;return i.cardsSet=[],i.cardLayerArray=[],i.cardSpriteArray=[],i.catchCardSpriteArray=[],t.RoomData.Instance.startGameChanged.add(i.startGameChanged,i),i}return __extends(n,e),Object.defineProperty(n,"Instance",{get:function(){return n._instance||(n._instance=new n),n._instance},enumerable:!0,configurable:!0}),n.prototype.seekCardLayer=function(t){var e=this.cardLayerArray.first(function(e){return e.seatData.seatId==t});return e?e:null},n.prototype.startGameChanged=function(){if(t.RoomData.Instance.startGame)for(var e=0,i=t.SeatLayer.Instance.seatSprites;e<i.length;e++){var n=i[e];n.removeReadyIcon()}if(this.cardLayerList&&this.cardLayerList instanceof Array&&this.cardLayerList.length>0)for(var a=this.cardLayerList.length,s=0;a>s;s++)this.cardLayerList[s].startGameChanged()},n.prototype.deleteCardSeat=function(t){var e=this.cardLayerArray.first(function(e){return e.seatData.seatId==t});e&&(e.parent&&this.removeChild(e),this.cardLayerArray.remove(e),e.destory(),e=null)},n.prototype.addCardSeat=function(e){var n=t.GameConstant.GetClientNoBySeatId(e.seatId);if(1==t.RoomInfo.getInstance().video&&(n=e.seatId-1),t.DataManager.isInGame||null!=t.PokerFunction.MainSeat||(n=e.seatId-1),n=null!=n?n:0,!(null==n||0>n)){var a=new i(e);a.setPosition(t.GameConstant.playerOperateDisplayPos[n].x,t.GameConstant.playerOperateDisplayPos[n].y),a.name="seatLayer:"+n,console.log(a.name+"----addSeatData.seatId"+e.seatId),0==n&&0==t.RoomInfo.getInstance().video&&(this.mainCardlayer=a),a.scaleX=a.scaleY=.8,this.addChild(a),this.cardLayerArray.push(a),console.log(this.cardLayerArray)}},n.prototype.showEffect=function(e){if(e&&this.cardLayerArray)for(var i=t.GameConstant.GetClientNoByUid(e.uid),n=0,a=this.cardLayerArray;n<a.length;n++){var s=a[n];if(null!=i&&s.name.slice(10)==i.toString()){if(!s.getSeatCards||s.getSeatCards.length<1)return;if(egret.Tween.removeTweens(this),0!=i){var o=s.getSeatCards[0];egret.Tween.get(o).to({x:-20},80).to({x:-40},150).wait(100).to({x:0},200)}s.removeLookCard()}}},n.prototype.updateUserBetCount=function(){if(n.Instance.cardLayerList&&!(n.Instance.cardLayerList.length<1))for(var t=0;t<n.Instance.cardLayerList.length;t++)n.Instance.cardLayerList[t].onBetCountChange()},n.prototype.restart=function(){for(var t=0,e=this.cardLayerList;t<e.length;t++){var i=e[t];i.reset()}},Object.defineProperty(n.prototype,"cardLayerList",{get:function(){return this.cardLayerArray},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"allCardSpriteList",{get:function(){return this.cardSpriteArray},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"CatchCardList",{get:function(){return this.catchCardSpriteArray},enumerable:!0,configurable:!0}),n.prototype.setTouch=function(t){this.mainCardlayer&&this.mainCardlayer.setTouchEnable(t)},n.prototype.showKengPoint=function(t){for(var e=0,i=this.cardLayerList;e<i.length;e++){var n=i[e];n.showKengPoint(t)}},n.prototype.showEye=function(){for(var t=0,e=this.cardLayerList;t<e.length;t++){var i=e[t];i.showLookCard()}},n.prototype.removeEye=function(t){this.mainCardlayer.removeLookCard()},n.prototype.showResultPoint=function(t){if(t)for(var e=function(t){if(!t.cardList||0==t.cardList.length)return"continue";if(t.kengPoint){var e=i.cardLayerList.first(function(e){return e.thisUid==t.user.uid});e.showResultKengPoint(t.kengPoint)}},i=this,n=0,a=t;n<a.length;n++){var s=a[n];e(s)}},n.prototype.setCardColor=function(){for(var t=0;t<this.cardLayerArray.length;t++){var e=this.cardLayerArray[t];e.setCardColor()}},n.prototype.destroy=function(){t.RoomData.Instance.startGameChanged.remove(this.startGameChanged,this);for(var e=0,i=this.cardLayerList;e<i.length;e++){var a=i[e];a.destory()}this.cardsSet.clear(),this.cardLayerArray.clear(),n.Instance.removeChildren(),n._instance&&(n._instance=null)},n}(egret.DisplayObjectContainer);t.CardSet=e,__reflect(e.prototype,"game.CardSet");var i=function(i){function a(t){var e=i.call(this)||this;return e._isGiveUp=!1,e.cardSpriteList=new Array,e.isOver=!1,e.cardList=[],e.seatData=t,e.touchEnabled=!1,e.init(),e}return __extends(a,i),a.prototype.showLookCard=function(){this.lookCard||(this.lookCard=new eui.Image,this.lookCard.source="lookCardBtn",this.lookCard.x=this._betCount.x+150,this.lookCard.y=this._betCount.y-220),this.addChild(this.lookCard)},a.prototype.removeLookCard=function(){this.lookCard&&this.lookCard.parent&&this.lookCard.parent.removeChild(this.lookCard)},Object.defineProperty(a.prototype,"isGiveUp",{get:function(){return this._isGiveUp},enumerable:!0,configurable:!0}),a.prototype.giveUp=function(i){void 0===i&&(i=!1),this._isGiveUp||(0==t.RoomInfo.getInstance().video&&(this._isGiveUp=!0,this.isOver=!0,this.setTouchEnable(!1),this.backMyCards(),this._cardPoints&&(this._cardPoints.visible=!1),this._pointsGap&&(this._pointsGap.visible=!1)),i||1==t.RoomInfo.getInstance().video?this.addGiveUpLoge():this.giveUpTime=uniLib.SetUniEventTimeout(e.Instance,this.addGiveUpLoge,500,1,this),this.removeLookCard())},a.prototype.reset=function(){this._isGiveUp=!1,this.isOver=!1,this.cardList.clear(),this.cardSpriteList.clear(),this._betCount.visible=!1,this.giveUpTime&&this.giveUpTime.stop(),this.showKengPoint(!1),this.removeGiveUpLogo()},Object.defineProperty(a.prototype,"thisUid",{get:function(){return this.seatData.user.uid},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"getSeatCards",{get:function(){return this.cardSpriteList},enumerable:!0,configurable:!0}),a.prototype.setPosition=function(t,e){this.x=t-this.getCardWidth()/2+50,this.y=e},a.prototype.init=function(){this.cardSpriteList.clear(),this.removeChildren(),this.addListener(),this._betCount||(this._betCount=new eui.ItemRenderer,this._betCount.skinName=new BetCountSkin,this._betCount.x=30,this._betCount.y=t.GameConstant.CardHeight,this.addChild(this._betCount)),this._betCount.visible=!1},a.prototype.addListener=function(){t.RoomData.Instance.MainSeatChanged.add(this.clientNoChanged,this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.backMyCards,this),this.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.backMyCards,this),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.showMyBackCards,this)},a.prototype.removeListener=function(){t.RoomData.Instance.MainSeatChanged.removeAll(),this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.showMyBackCards,this),this.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.backMyCards,this),this.removeEventListener(egret.TouchEvent.TOUCH_END,this.backMyCards,this)},a.prototype.startGameChanged=function(){t.RoomData.Instance.startGame&&this.seatData&&(this.seatData.addHandCardEvent.removeAll(),this.seatData.replaceHandCardEvent.removeAll(),this.seatData.addHandCardEvent.add(this.addHandCard,this),this.seatData.replaceHandCardEvent.add(this.replaceHandCards,this),this.seatData.delectHandCardEvent.removeAll(),this.seatData.delectHandCardEvent.add(this.deleteHandCards,this),this.seatData.seatKengPoinChanged.removeAll(),this.seatData.seatKengPoinChanged.add(this.onKengPoinsChange,this),this.seatData.betCountChanged.removeAll(),this.seatData.betCountChanged.add(this.onBetCountChange,this))},a.prototype.onBetCountChange=function(e){if(null==e&&(e=this.seatData.betCount,this.seatData.curBetCount=0),this._betCount||(this._betCount=new eui.ItemRenderer,this._betCount.skinName=new BetCountSkin,this._betCount.x=30,this._betCount.y=t.GameConstant.CardHeight),this._betCount.visible=!1,this.addChild(this._betCount),this._betCount.totalNum.text=e?e:"0",this._betCount.curNum.text=null!=this.seatData.curBetCount?this.seatData.curBetCount:"0",0==e&&0==this.seatData.curBetCount)this._betCount.visible=!1;
else if(t.RoomData.Instance.shuffleUid){var i=this;uniLib.SetUniEventTimeout(t.GameView.Instance,function(){i._betCount.visible=!0},t.GameConstant.ShuffleEffectTime,1,this,null)}else this._betCount.visible=!0},a.prototype.showKengPoint=function(t){this._cardPoints&&(this._cardPoints.visible=t),this._pointsGap&&(this._pointsGap.visible=t)},a.prototype.onKengPoinsChange=function(){if(!this.isGiveUp)if(this._cardPoints||(this._cardPoints=new eui.BitmapLabel,this._cardPoints.font="betCountFont_fnt",this._cardPoints.height=30,this._cardPoints.x=50,this._cardPoints.y=-this._cardPoints.height,this._cardPoints.visible=!1),this.addChild(this._cardPoints),this._pointsGap||(this._pointsGap=new eui.BitmapLabel,this._pointsGap.font="betCountFont_fnt",this._pointsGap.height=30,this._pointsGap.x=this._cardPoints.x+this._cardPoints.width+20,this._pointsGap.y=-this._pointsGap.height,this._pointsGap.visible=!1),this.addChild(this._pointsGap),1==t.RoomInfo.getInstance().video){this.seatData.KengPoint.allCardPoint&&(this._cardPoints.text=this.seatData.KengPoint.allCardPoint+"");var e=this.seatData.KengPoint.allCardPointGap?this.seatData.KengPoint.allCardPointGap:0;this._pointsGap.text="  ["+(0==e?"+":e)+"]"}else{this._cardPoints.text=(this.seatData.KengPoint.openCardPoint?this.seatData.KengPoint.openCardPoint:0).toString();var e=this.seatData.KengPoint.openCardPointGap?this.seatData.KengPoint.openCardPointGap:0;this._pointsGap.text="  ["+(0==e?"+":e)+"]"}},a.prototype.showResultKengPoint=function(t){if(this._cardPoints&&(this._cardPoints.text=(t.allCardPoint?t.allCardPoint:0).toString()),this._pointsGap){var e=t.allCardPointGap?t.allCardPointGap:0;this._pointsGap.text="  ["+(0==e?"+":e)+"]"}},a.prototype.showMyBackCards=function(){if(!this.isGiveUp&&this.cardSpriteList&&!(this.cardSpriteList.length<1)){for(var t=0;t<this.backLen();t++)this.cardSpriteList[t].showTexture();if(this.seatData.user.uid==uniLib.NetMgr.UID){this._cardPoints.text=this.seatData.KengPoint.allCardPoint.toString();var e=null!=this.seatData.KengPoint.allCardPointGap?this.seatData.KengPoint.allCardPointGap:0;this._pointsGap.text="  ["+(0==e?"+":e)+"]"}var i=new Cmd.ShowActionRoomCmd_CS;i.uid=uniLib.NetMgr.UID,uniLib.NetMgr.tcpSend(i)}},a.prototype.backMyCards=function(){if(!this.isGiveUp&&!this.isOver&&this.cardSpriteList&&!(this.cardSpriteList.length<1)){for(var t=0;t<this.backLen();t++){this.cardSpriteList[t].setTexture()}if(this.seatData.user.uid==uniLib.NetMgr.UID){this._cardPoints.text=this.seatData.KengPoint.openCardPoint.toString();var e=this.seatData.KengPoint.openCardPointGap?this.seatData.KengPoint.openCardPointGap:0;this._pointsGap.text="  ["+(0==e?"+":e)+"]"}}},a.prototype.replaceHandCards=function(t,e){this.cardList[t]=e,this.cardSpriteList[t].cardId=e},a.prototype.backLen=function(){return-1!=t.RoomData.Instance.roomPlayProps.indexOf(10675)?1:(-1!=t.RoomData.Instance.roomPlayProps.indexOf(10676),2)},a.prototype.addHandCard=function(i){if(-1==this.cardList.indexOf(i)||-1==i){this.seatData.user.uid==uniLib.NetMgr.UID&&(t.DataManager.isInGame=!0);var a;a=this.cardSpriteList.length<this.backLen()&&0==t.RoomInfo.getInstance().video?new n(i,!0):new n(i),a.touchEnabled=!1,a.touchChildren=!1,a.visible=!1,t.RoomData.Instance.shuffleUid?uniLib.SetUniEventTimeout(t.GameView.Instance,function(){a.visible=!0},t.GameConstant.ShuffleEffectTime,1,this,null):a.visible=!0,this.addChild(a),this.cardSpriteList.push(a),this.cardList.push(i),this.updataHandCardPosition(),-1!=t.RoomData.Instance.roomPlayProps.indexOf(10675)&&-1!=t.RoomData.Instance.roomPlayProps.indexOf(10805)?this.cardSpriteList.length>2&&this.cardList.length>2?e.Instance.CatchCardList.push(a):e.Instance.allCardSpriteList.push(a):this.cardSpriteList.length>3&&this.cardList.length>3?e.Instance.CatchCardList.push(a):e.Instance.allCardSpriteList.push(a),-1==i&&this.cardList.length==this.seatData.handCardSum&&this.giveUp(!0)}},a.prototype.clientNoChanged=function(){var e=t.GameConstant.GetClientNoBySeatId(this.seatData.seatId);if(1==t.RoomInfo.getInstance().video&&(e=this.seatData.seatId-1),!(null==e||0>e||e>4)){var i=t.GameConstant.playerOperateDisplayPos[e];this.x=i.x,this.y=i.y}},a.prototype.updataHandCardPosition=function(){for(var e=this.cardSpriteList.length,i=0,n=0;e>n;n++)this.cardSpriteList[n].x=i+t.GameConstant.CardGap*n},a.prototype.getCardWidth=function(){var e=this.cardSpriteList.length;return t.GameConstant.CardWidth+e*t.GameConstant.CardGap},a.prototype.setTouchEnable=function(t){if(this.cardSpriteList&&this.cardSpriteList.length>0)for(var e=0;e<this.backLen();e++)this.cardSpriteList[e]&&(this.cardSpriteList[e].touchEnabled=t),t||this.cardSpriteList[e]&&this.cardSpriteList[e].setTexture()},a.prototype.addGiveUpLoge=function(){this.giveUpLogo||(this.giveUpLogo=new egret.Bitmap,this.giveUpLogo.texture=RES.getRes("giveUpLogo")),this.addChild(this.giveUpLogo),this.giveUpLogo.x=(this.getCardWidth()-this.giveUpLogo.width)/2},a.prototype.removeGiveUpLogo=function(){this.giveUpLogo&&this.giveUpLogo.parent&&this.giveUpLogo.parent.removeChild(this.giveUpLogo)},a.prototype.deleteHandCards=function(){this.cardList.clear(),this.cardSpriteList.clear(),this.removeChildren()},a.prototype.setCardColor=function(){for(var t=0;t<this.cardSpriteList.length;t++)this.cardSpriteList[t].setTexture(!0)},a.prototype.destory=function(){for(var t=0,e=this.cardSpriteList;t<e.length;t++){var i=e[t];i.destory()}this.removeListener(),this.cardList.clear(),this.cardSpriteList.clear(),this.giveUpLogo=null,this.seatData=null,this._cardPoints=null,this._betCount=null,this._pointsGap=null,this.giveUpTime&&(this.giveUpTime.stop(),this.giveUpTime=null),this.removeChildren()},a}(egret.DisplayObjectContainer);t.CardLayer=i,__reflect(i.prototype,"game.CardLayer");var n=function(e){function i(t,i){void 0===i&&(i=!1);var n=e.call(this)||this;return n.isBackCard=!1,n.isBacked=!1,n.cardId=t,n.isBacked=n.isBackCard=i,n.addCard(i),n}return __extends(i,e),Object.defineProperty(i.prototype,"cardId",{get:function(){return this._cardId},set:function(t){this._cardId=t},enumerable:!0,configurable:!0}),i.prototype.addCard=function(e){var i="";-1==this._cardId||e?this.cardImage=new egret.Bitmap(RES.getRes(t.GameConstant.cardResStr)):(i=table.TablePokerCard.resNormal(this._cardId),this.cardImage=new egret.Bitmap(RES.getRes(i))),this.mixCard&&e&&(this.mixCard.visible=!1),this.name=i,this.cardImage.width=t.GameConstant.CardWidth,this.cardImage.height=t.GameConstant.CardHeight,this.cardImage.anchorOffsetX=this.cardImage.width/3,this.cardImage.anchorOffsetY=this.cardImage.height/2,this.cardImage.x=this.cardImage.width/2,this.cardImage.y=this.cardImage.height/2,this.addChildAt(this.cardImage,0),this.addMixCard()},i.prototype.addMixCard=function(){241==this._cardId&&t.RoomData.Instance.roomPlayProps.first(function(t){return 10787==t})&&(this.mixCard=new egret.Bitmap(RES.getRes(t.GameConstant.MixCard)),this.mixCard.width=t.GameConstant.CardWidth,this.mixCard.height=t.GameConstant.CardHeight,this.mixCard.anchorOffsetX=this.mixCard.width/3,this.mixCard.anchorOffsetY=this.mixCard.height/2,this.mixCard.x=this.mixCard.width/2,this.mixCard.y=this.mixCard.height/2,this.addChild(this.mixCard))},Object.defineProperty(i.prototype,"card",{get:function(){return this.cardImage},enumerable:!0,configurable:!0}),i.prototype.setTexture=function(e){void 0===e&&(e=!1),e?(-1==this.cardId||this.isBackCard)&&(this.cardImage.texture=RES.getRes(t.GameConstant.cardResStr),this.mixCard&&(this.mixCard.visible=!1)):(this.cardImage.texture=RES.getRes(t.GameConstant.cardResStr),this.isBacked=!0,this.mixCard&&(this.mixCard.visible=!1))},i.prototype.showTexture=function(){var t=table.TablePokerCard.resNormal(this._cardId);this.cardImage.texture=RES.getRes(t),this.isBacked=!1,this.mixCard?this.mixCard.visible=!0:this.addMixCard()},i.prototype.changeColor=function(){this.cardImage.texture=RES.getRes(t.GameConstant.cardResStr),this.mixCard&&(this.mixCard.visible=!1)},i.prototype.destory=function(){this.cardImage=null,this.removeChildren()},i}(egret.DisplayObjectContainer);t.CardSprite=n,__reflect(n.prototype,"game.CardSprite")}(game||(game={}));var game;!function(t){var e=function(){function e(){this.isInAnim=!1,this.chips=[]}return Object.defineProperty(e,"Instance",{get:function(){return null==this.m_Instance&&(this.m_Instance=new e),this.m_Instance},enumerable:!0,configurable:!0}),e.prototype.warningEffect=function(){if(this.warnArmature)return this.warnArmature.display;var t=uniLib.DisplayUtils.createDragonBonesDisplay("doudizhu_jingbao_effect_ske_json","doudizhu_jingbao_effect_tex_json","doudizhu_jingbao_effect_tex_png","MovieClip");return dragonBones.WorldClock.clock.add(t),this.warnArmature=t,t.display},e.prototype.stopWarning=function(){null!=this.warnArmature&&this.warnArmature.animation.stop()},e.prototype.playWarning=function(){null!=this.warnArmature&&this.warnArmature.animation.play("jingbaoqi")},e.prototype.addCardAnimation=function(e){1==e?this.addCardsAnimation():t.RoomData.Instance.shuffleUid&&1!=t.RoomInfo.getInstance().video?(uniLib.SetUniEventTimeout(t.GameView.Instance,function(){t.EffectCreate.Instance.addShuffleMc(t.RoomData.Instance.shuffleUid)},500,1,this,null),uniLib.SetUniEventTimeout(t.GameView.Instance,function(){t.EffectCreate.Instance.removeShuffleMc(),this.dealCardAnimation()},t.GameConstant.ShuffleEffectTime,1,this,null)):this.dealCardAnimation()},e.prototype.dealCardAnimation=function(){var e=this;if(this.isInAnim=!0,1==t.RoomInfo.getInstance().video)return void this.afterDealCard();this.lastCards=[];for(var i=t.CardSet.Instance.allCardSpriteList,n=0;n<i.length;n++){var a=i[n];a.visible=!1;var s=t.CardSet.Instance.cardLayerList.length,o=-1!=t.RoomData.Instance.roomPlayProps.indexOf(10675)&&-1!=t.RoomData.Instance.roomPlayProps.indexOf(10805)?2:3,r=n/o,h=n%o,d=a.x,c=a.y,l=a.globalToLocal(t.GameConstant.sendCardStartPos.x,t.GameConstant.sendCardStartPos.y);egret.Tween.get(a).wait(100*r+300*h).to({x:l.x,y:l.y,visible:!0}).to({x:d,y:c},200,egret.Ease.sineInOut).call(function(){t.SoundHand.Instance.playDealCard()}).wait(400*s).call(function(){e.afterDealCard()})}},e.prototype.showBackCardsAnim=function(e){if(1!=t.RoomInfo.getInstance().video){var i=t.CardSet.Instance.cardLayerList.first(function(t){return t.thisUid==e}).getSeatCards,n=t.CardSet.Instance.cardLayerList.first(function(t){return t.thisUid==e});if(n&&(n.isOver=!0),null!=i&&null!=i[0])for(var a=i.length,s=function(){var t=i[o];return t.isBacked?(egret.Tween.removeTweens(t),void egret.Tween.get(t.card).to({scaleX:0},250).call(function(){t.showTexture()}).to({scaleX:1},250)):"continue"},o=0;a>o;o++)s()}},e.prototype.backCardAnim=function(e){var i=t.CardSet.Instance.cardLayerList.first(function(t){return t.thisUid==e}).getSeatCards,n=t.CardSet.Instance.cardLayerList.first(function(t){return t.thisUid==e});if(n.giveUp(),1!=t.RoomInfo.getInstance().video&&!(null==i||i.length<1))for(var a=function(){var t=i[s];0==t.isBacked&&(t.isBacked=!0,egret.Tween.removeTweens(t),egret.Tween.get(t.card).to({scaleX:0},125).call(function(){t.setTexture()}).to({scaleX:1},125))},s=0;s<i.length;s++)a()},e.prototype.afterDealCard=function(){this.isInAnim&&(this.isInAnim=!1,t.CardSet.Instance.setTouch(!0),t.CardSet.Instance.showKengPoint(!0),t.CardSet.Instance.showEye(),t.CardSet.Instance.allCardSpriteList.clear())},e.prototype.addCardsAnimation=function(){if(1!=t.RoomInfo.getInstance().video)for(var e=t.CardSet.Instance.CatchCardList,i=0;i<e.length;i++){var n=e[i];n.visible=!1;var a=n.x,s=n.y,o=n.globalToLocal(t.GameConstant.sendCardStartPos.x,t.GameConstant.sendCardStartPos.y);egret.Tween.get(n).wait(100*i).to({x:o.x,y:o.y,visible:!0}).to({x:a,y:s},200,egret.Ease.sineInOut).call(function(){t.SoundHand.Instance.playDealCard(),t.CardSet.Instance.CatchCardList.clear()})}},e.prototype.WinEffect=function(){var t,e=RES.getRes("frames_win_json"),i=RES.getRes("frames_win_png"),n=new egret.MovieClipDataFactory(e,i);return t=new egret.MovieClip(n.generateMovieClipData("frames_win")),t.frameRate=6,t.gotoAndPlay(1,-1),t},e.prototype.LoseEffect=function(){var t,e=RES.getRes("frames_lose_json"),i=RES.getRes("frames_lose_png"),n=new egret.MovieClipDataFactory(e,i);return t=new egret.MovieClip(n.generateMovieClipData("frames_lose")),t.frameRate=6,t.gotoAndPlay(1,-1),t},e.prototype.DengSiEffect=function(){var t,e=RES.getRes("frame_ds_json"),i=RES.getRes("frame_ds_png"),n=new egret.MovieClipDataFactory(e,i);return t=new egret.MovieClip(n.generateMovieClipData("frame_ds")),t.frameRate=6,t.gotoAndPlay(1),t},e.prototype.showResultEffect=function(e){if(t.PokerFunction.MainSeat&&!t.PokerFunction.MainSeat.isReady){if(this.effect=[],!e||null==e[0]){var i=new egret.MovieClip;return i=this.DengSiEffect(),i.x=t.GameConstant.sendCardStartPos.x,i.y=t.GameConstant.sendCardStartPos.y,this.effect.push(i),t.GameInfo.topLayer.addChild(i),i.play(),void t.SoundHand.Instance.playDengSi()}for(var n=0;n<t.RoomData.Instance.seatList.length;n++){var a=t.RoomData.Instance.seatList[n].user,s=t.GameConstant.GetClientNoByUid(a.uid),o=new egret.MovieClip,r=t.GameConstant.seatPosArr[s];-1!=e.indexOf(a.uid)?(o=this.WinEffect(),o.x=r.x-30):(o=this.LoseEffect(),o.x=r.x),o.y=r.y-25,this.effect.push(o),t.GameInfo.topLayer.addChild(o),o.play()}}},e.prototype.removeResultEffect=function(){if(this.effect&&!(this.effect.length<1)){for(var e=0;e<this.effect.length;e++){var i=this.effect[e];i&&i.parent&&(i.stop(),t.GameInfo.topLayer.removeChild(i),i=null)}this.effect=[]}},e.prototype.giftEffect=function(e,i,n){var a=new t.GiftAnItem;a.giftId=e;var s=t.GameConstant.seatPosArr[t.GameConstant.GetClientNoByUid(i)],o=t.GameConstant.seatPosArr[t.GameConstant.GetClientNoByUid(n)];s&&o&&(a.x=o.x+t.GameConstant.HeadWidth/2,a.y=o.y+t.GameConstant.HeadHeight/2,t.GameInfo.topLayer.addChild(a),egret.Tween.get(a).to({x:s.x+t.GameConstant.HeadWidth/2,y:(s.y+t.GameConstant.HeadHeight/2)*uniLib.ScreenUtils.scaleFactor},400,egret.Ease.circOut).call(function(){egret.Tween.removeTweens(a),a.play()}))},e.prototype.creatRelogChips=function(e){for(var i=e?e:t.RoomData.Instance.tabPoints,n=e%10==0?10:1,a=1==n?5:50,s=0,o=0;o<t.CardSet.Instance.cardLayerList.length;o++){var r=t.GameConstant.getChipsEndPoint();this.creatChipsSprite(n,r.x,r.y),i-=n}for(;i>0;){a>=i&&(a=i),s=Math.floor(Math.randomInteger(n,a)/n)*n;var r=t.GameConstant.getChipsEndPoint();this.creatChipsSprite(s,r.x,r.y),i-=s}},e.prototype.pushToChipsArray=function(e,i){if(e)if(this.chips.length<50)egret.Tween.get(e).to({x:i.x,y:i.y},300,egret.Ease.quadOut);else{egret.Tween.get(e).to({x:i.x,y:i.y},300,egret.Ease.quadOut).call(function(){t.SeatLayer.Instance.removeChild(e)});var n=this.chips[0];n.parent&&n.parent.removeChild(n),this.chips.remove(n),n=null}},e.prototype.creatChipsSprite=function(e,n,a){var s=t.RoomData.Instance.getPlayTypeByList();if(s&&s.length>0){var o=Number(s[0].substring(0,s[0].length-1));isNaN(o)||(e/=o)}var r=new i(e);if(r.x=n,r.y=a,t.SeatLayer.Instance.addChild(r),this.chips.push(r),this.chips.length>=50){var h=this.chips[0];h.parent&&h.parent.removeChild(h),this.chips.remove(h),h=null}return r},e.prototype.pressEffect=function(e,i){var n=t.GameConstant.GetClientNoByUid(i),a=t.GameConstant.seatPosArr[n],s=t.GameConstant.getChipsEndPoint();if(a)var o=this.creatChipsSprite(e,a.x,a.y);this.pushToChipsArray(o,s)},e.prototype.bet2Winner=function(e){if(e&&null!=e[0])for(var i=this,n=this.chips,a=t.GameConstant.EachQuantity(n.length),s=function(s){var r=s%e.length,h=e[r],d=t.GameConstant.seatPosArr[t.GameConstant.GetClientNoByUid(h)],c=n[s];egret.Tween.get(c).wait(o.GetWaitTime(s,a)).to({x:d.x,y:d.y},t.GameConstant.ResulChipsAnimationTime,egret.Ease.quadOut).call(function(){egret.Tween.removeTweens(c),c.parent&&c.parent.removeChild(c),i.chips.remove(c)})},o=this,r=0;r<n.length;r++)s(r)},e.prototype.clearChips=function(){for(var e=0,i=this.chips;e<i.length;e++){var n=i[e];egret.Tween.removeTweens(n),n.parent&&t.SeatLayer.Instance.removeChild(n)}},e.prototype.GetWaitTime=function(e,i){return t.GameConstant.ResulChipsGapTime*(e/i)},e.prototype.addShuffleMc=function(e){uniLib.SoundMgr.instance.playSound("TDK_shufflecard_mp3"),this._shuffleMc=uniLib.DisplayUtils.createMovieClicp("shuffle_mc"),t.GameView.Instance.addChild(this._shuffleMc),this._shuffleMc.scaleX=1,this._shuffleMc.scaleY=1,this._shuffleMc.x=(uniLib.Global.screenWidth-400)/2,this._shuffleMc.y=(uniLib.Global.screenHeight-this._shuffleMc.height)/2-20,this._shuffleMc.frameRate=18,this._shuffleMc.play(1),this._shuffleMc.addEventListener(egret.MovieClipEvent.COMPLETE,this.playShuffLeMcComplete,this);var i=t.GameConstant.GetSeatSpriteByUid(e);i&&(this._shuffleBg=new eui.Image("shuffle_bg"),this._shuffleBg.x=(uniLib.Global.screenWidth-this._shuffleBg.width)/2-220,this._shuffleBg.y=uniLib.Global.screenHeight/2+110,t.GameView.Instance.addChild(this._shuffleBg),this._shuffleLabel=new eui.Label,this._shuffleLabel.text=i.user.nickName+"正在洗牌中...",this._shuffleLabel.textColor=16767334,this._shuffleLabel.x=(uniLib.Global.screenWidth-this._shuffleLabel.width)/2,this._shuffleLabel.y=uniLib.Global.screenHeight/2+120,t.GameView.Instance.addChild(this._shuffleLabel))},e.prototype.playShuffLeMcComplete=function(t){console.error("playShuffLemc complete"),this._shuffleMc.removeEventListener(egret.MovieClipEvent.COMPLETE,this.playShuffLeMcComplete,this),this.removeShuffleMc()},e.prototype.removeShuffleMc=function(){this._shuffleMc&&this._shuffleMc.parent&&(this._shuffleMc.stop(),t.GameView.Instance.removeChild(this._shuffleMc),this._shuffleMc=null),this._shuffleLabel&&this._shuffleLabel.parent&&(t.GameView.Instance.removeChild(this._shuffleLabel),this._shuffleLabel=null),this._shuffleBg&&this._shuffleBg.parent&&(t.GameView.Instance.removeChild(this._shuffleBg),this._shuffleBg=null)},e}();t.EffectCreate=e,__reflect(e.prototype,"game.EffectCreate");var i=function(t){function e(e){var i=t.call(this)||this;i.m_chip=e;var n=new eui.Image("chips_"+e+"_tdk");return i.addChild(n),i}return __extends(e,t),Object.defineProperty(e.prototype,"chip",{get:function(){return this.m_chip},enumerable:!0,configurable:!0}),e}(egret.DisplayObjectContainer);t.ChipsSprite=i,__reflect(i.prototype,"game.ChipsSprite")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return Object.defineProperty(e,"seatPosArr",{get:function(){return[new egret.Point(20,600),new egret.Point(uniLib.Global.screenWidth-140,470),new egret.Point(uniLib.Global.screenWidth-140,130),new egret.Point(uniLib.Global.screenWidth/2-240,25),new egret.Point(0,125)]},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ReadyPos",{get:function(){return[new egret.Point(180,500),new egret.Point(uniLib.Global.screenWidth-360,500),new egret.Point(uniLib.Global.screenWidth-330,200),new egret.Point(uniLib.Global.screenWidth/2-90,170),new egret.Point(140,200)]},enumerable:!0,configurable:!0}),Object.defineProperty(e,"playerOperateDisplayPos",{get:function(){return[new egret.Point(240,410),new egret.Point(uniLib.Global.screenWidth-450,410),new egret.Point(uniLib.Global.screenWidth-420,180),new egret.Point(uniLib.Global.screenWidth/2-115,80),new egret.Point(120,200)]},enumerable:!0,configurable:!0}),Object.defineProperty(e,"sendCardStartPos",{get:function(){return new egret.Point(uniLib.Global.screenWidth/2,360)},enumerable:!0,configurable:!0}),e.GetClientNoBySeatId=function(e){var i=t.PokerFunction.MainSeatId;if(null==i)return e;var n=e-i;return 0>n?n+5:n},e.GetClientNoByUid=function(e){var i=t.SeatLayer.Instance.seatSprites.first(function(t){return t.uid==e});return null==i?null:i.clientNo},e.GetSeatSpriteByUid=function(e){return t.SeatLayer.Instance.seatSprites.first(function(t){return t.uid==e})},e.GetSeatSpriteBySeatId=function(e){return t.SeatLayer.Instance.seatSprites.first(function(t){return t.seatData.seatId==e})},e.getOperation=function(t){var e="";switch(t){case Cmd.Operation.GiveUp:e="弃牌";break;case Cmd.Operation.Wagering:e="下注";break;case Cmd.Operation.FollowBet:e="跟注";break;case Cmd.Operation.UpFoot:e="起脚";break;case Cmd.Operation.NoFoot:e="不踢";break;case Cmd.Operation.BackFoot:e="反踢"}return e},e.getChipsEndPoint=function(){var t=Math.randomInteger(e.BetEndRange.x.min,e.BetEndRange.x.max),i=Math.randomInteger(e.BetEndRange.y.min,e.BetEndRange.y.max);return t=e.sendCardStartPos.x-150+t,i=e.sendCardStartPos.y+i-50,{x:t,y:i}},e.EachQuantity=function(t){return Math.max(Math.ceil(t/e.BatchMax),1)},e}();e.lastRoundIsNoWinner=!1,e.cardResStr="BackCard",e.MixCard="MixCard",e.BetEndRange={x:{min:30,max:200},y:{min:30,max:150}},e.HeadWidth=114,e.HeadHeight=114,e.HandCardY=490,e.HandCardSelectY=470,e.OperationY=370,e.PlayCardMainY=340,e.CardGap=50,e.CardWidth=137,e.CardHeight=189,e.PlayCardWidth=82,e.PlayCardHeight=114,e.PlayCardGap=40,e.BluffCardWidth=50,e.BluffCardHeight=70,e.BluffCardGap=60,e.DealCardTime=150,e.CountDown=15,e.HandCardSum=5,e.LandlordHandCardSum=20,e.BrightThreeCardBack=150,e.BrightThreeCardPositive=150,e.OperationOffsetRight=114,e.RobLordOperateTimerButtonX=310,e.CallLordOperateTimerButtonX=120,e.OperateTimerButtonX=210,e.PassOnlyTimerButtonX=440,e.ResGroup_TDK="TDK_gameres",e.ShuffleEffectTime=3800,e.NormalBetNumList=[1,2,3,4,5],e.NormalFiveCardBetNumList=[2,3,4,5,10],e.ResulChipsAnimationTime=350,e.ResulChipsGapTime=50,e.BatchMax=6,t.GameConstant=e,__reflect(e.prototype,"game.GameConstant")}(game||(game={}));var game;!function(t){var e=function(e){function n(){return e.call(this)||this}return __extends(n,e),Object.defineProperty(n,"Instance",{get:function(){return null==this.m_Instance&&(this.m_Instance=new n),this.m_Instance},enumerable:!0,configurable:!0}),n.clearInstance=function(){this.m_Instance=null},n.prototype.addListener=function(){},n.prototype.destroy=function(){this.removeListener()},n.prototype.removeListener=function(){n.clearInstance()},n.prototype.operateChanged=function(e){for(var i=0,n=t.SeatLayer.Instance.seatSprites;i<n.length;i++){var a=n[i];a.removeReadyIcon()}if(null!=e.leftSec?this.endTime=t.GameTime.localNow()+1e3*e.leftSec:this.endTime=t.GameTime.localNow()+(e.endTime-t.GameTime.serverNow()),t.DataManager.isInGame){var s=e.uid;s==uniLib.NetMgr.UID?this.addOperateMain(e.operateList):this.removeOperateMain()}},n.prototype.userBet=function(e){if(e){if(this.removeOperateMain(),e.opType){var i=t.PokerFunction.GetSeatDataByUid(e.uid),n=i.user?i.user.gender:null;t.SoundHand.Instance.playOperateSound(n,e.opType)}if(e.opType!=Cmd.Operation.NoFoot){if(e.opType==Cmd.Operation.GiveUp){t.EffectCreate.Instance.backCardAnim(e.uid);var a=t.PokerFunction.GetUserInfoByUid(e.uid),i=t.PokerFunction.GetSeatDataByUid(e.uid);return void(a.point-=i.betCount)}var s=e.chip?e.chip:1,o=e.uid?e.uid:0;t.EffectCreate.Instance.pressEffect(s,o),t.SoundHand.Instance.playBetSound()}}},n.prototype.addOperateMain=function(e){if(1!=t.RoomInfo.getInstance().video){var n=t.PokerFunction.MainSeat;n&&n.user.isTrust||(null==this.operateMain&&(this.operateMain=i.Instance,this.operateMain.x=uniLib.Global.screenWidth/2-340,this.operateMain.y=607),this.addChild(this.operateMain),this.operateMain.setMainVisable(!0),this.operateMain.init(e))}},n.prototype.removeOperateMain=function(){this.operateMain&&this.operateMain.parent&&(this.operateMain.removeListener(),this.removeChild(this.operateMain))},n}(egret.DisplayObjectContainer);t.OperateLayer=e,__reflect(e.prototype,"game.OperateLayer");var i=function(e){function i(){var t=e.call(this)||this;return t.skinName=new BetSelect_TDK_Skin,t}return __extends(i,e),Object.defineProperty(i,"Instance",{get:function(){return null==this.m_Instance&&(this.m_Instance=new i),this.m_Instance},enumerable:!0,configurable:!0}),i.clearInstance=function(){i.Instance.removeListener(),this.m_Instance=null},i.prototype.setMainVisable=function(t){var e=this;if(t)this.operate_main.alpha=1,this.operate_main.y=0,this.operate_bet.visible=!t,this.operate_main.visible=t;else{this.operate_bet.alpha=0;var i=this.operate_main.y+100;egret.Tween.get(this.operate_main).to({alpha:0,y:i},150).call(function(){e.operate_main.visible=!1,e.operate_bet.visible=!0}),egret.Tween.get(this.operate_bet).to({alpha:1,scaleY:1},250)}},i.prototype.init=function(t){if(!this.btnImgArray||this.btnImgArray==[]){this.btnImgArray=[];for(var e=0;6>e;e++){var i=RES.getRes("operate_"+(e+12)+"_btn");this.btnImgArray.push(i)}}this.leftBtn.image.source=this.btnImgArray[t[1]-12],this.leftBtn.name=t[1].toString(),this.rightBtn.image.source=this.btnImgArray[t[0]-12],this.rightBtn.name=t[0].toString(),this.addListener()},i.prototype.addListener=function(){this.leftBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this),this.rightBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this)},i.prototype.removeListener=function(){this.leftBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this),this.rightBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this),this.radioButtonGroup&&this.radioButtonGroup.hasEventListener&&this.radioButtonGroup.removeEventListener(egret.Event.CHANGE,this.onSelectChange,this),this.betInBtn&&this.betInBtn.hasEventListener&&this.betInBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBenIn,this)},i.prototype.showBetPanel=function(){this.setMainVisable(!1);var e=t.PokerFunction.MainSeat;if(!e||!e.user.isTrust){var i=t.GameConstant.NormalBetNumList;if(-1!=t.RoomData.Instance.roomPlayProps.indexOf(10805)){var n=t.CardSet.Instance.cardLayerList.first(function(t){return t.thisUid==uniLib.NetMgr.UID}).getSeatCards;n&&n.length>=5&&(i=t.GameConstant.NormalFiveCardBetNumList)}for(var a=0;a<this.jetton.numChildren;a++){var s=this.jetton.getChildAt(a);s.value=i[a]*(t.RoomData.Instance.multiple?t.RoomData.Instance.multiple:1),s.chipNum.source="bet"+[a+1]+"_"+s.value}this.betRadioButton.selected=!0,this.radioButtonGroup=this.betRadioButton.group,this.curRadioButton=this.betRadioButton,this.radioButtonGroup.addEventListener(egret.Event.CHANGE,this.onSelectChange,this),this.betInBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBenIn,this)}},i.prototype.onBtnClick=function(t){var e=Number(t.target.name);if(e==Cmd.Operation.GiveUp||e==Cmd.Operation.FollowBet||e==Cmd.Operation.NoFoot){var i=new Cmd.BetRoomCmd_CS;i.opType=e,i.uid=uniLib.NetMgr.UID,uniLib.NetMgr.tcpSend(i)}else this.betType=e,this.showBetPanel()},i.prototype.onSelectChange=function(t){this.curRadioButton=this.radioButtonGroup.selection},i.prototype.onBenIn=function(t){var e=new Cmd.BetRoomCmd_CS;e.chip=this.selectChips,e.opType=this.betType,e.uid=uniLib.NetMgr.UID,uniLib.NetMgr.tcpSend(e)},Object.defineProperty(i.prototype,"selectChips",{get:function(){return Number(this.radioButtonGroup.selectedValue)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"curRadioButton",{set:function(t){this.removeEffect(),this.m_curRadioButton=t,this.addEffect()},enumerable:!0,configurable:!0}),i.prototype.addEffect=function(){if(this.m_curRadioButton){egret.Tween.removeTweens(this.m_curRadioButton),egret.Tween.get(this.m_curRadioButton).to({y:-20},200);var e=t.RoomData.Instance.multiple?t.RoomData.Instance.multiple:1;this.selectCartoon=uniLib.DisplayUtils.createMovieClicp("cartoon"+this.m_curRadioButton.value/e),this.operate_cartoon.addChild(this.selectCartoon),this.selectCartoon.x=this.m_curRadioButton.x+15,this.selectCartoon.play(-1),egret.Tween.removeTweens(this.selectCartoon),egret.Tween.get(this.selectCartoon).to({y:-20},200)}},i.prototype.removeEffect=function(){this.m_curRadioButton&&(egret.Tween.removeTweens(this.m_curRadioButton),egret.Tween.get(this.m_curRadioButton).to({y:0},200),this.selectCartoon&&(egret.Tween.removeTweens(this.selectCartoon),egret.Tween.get(this.selectCartoon).to({y:0},200),this.selectCartoon.stop(),this.operate_cartoon.removeChild(this.selectCartoon),this.selectCartoon=null))},i}(eui.Component);t.OperationPlay=i,__reflect(i.prototype,"game.OperationPlay")}(game||(game={}));var game;!function(t){var e=function(e){function i(){return e.call(this)||this}return __extends(i,e),i.prototype.start=function(){e.prototype.start.call(this),t.DataCache.gameInfo&&t.DataCache.gameInfo.defaultOrientation!=egret.OrientationMode.LANDSCAPE&&(uniLib.ScreenUtils.landscape=!0),t.GameInfo.uiLayer=this.uiLayer,t.GameInfo.mainUILayer=this.topLayer,t.GameInfo.topLayer=this.mainUILayer,t.GameInfo.main=this.tipsLayer,t.GameInfo.uiLayer.name="uiLayer",t.GameInfo.mainUILayer.name="mainUILayer",t.GameInfo.topLayer.name="topLayer",t.GameInfo.main.name="tipsLayer",this.initPositionData(),t.MahJongFourFacede.getInstance().startUp(this)},i.prototype.destroy=function(){e.prototype.destroy.call(this),t.MahJongFourFacede.getInstance().sendNotification(t.MahjongFourFacadeConst.DESTORY)},i.prototype.initPositionData=function(){this.width=t.DataCache.defaultWidth=uniLib.Global.screenWidth,this.height=t.DataCache.defaultHeight=uniLib.Global.screenHeight},i}(uniLib.GameScene);t.PokerGameScene=e,__reflect(e.prototype,"game.PokerGameScene")}(game||(game={}));var game;!function(t){var e=function(e){function i(i,n){var a=e.call(this)||this;return a.width=i,a.height=n,a._headBg=t.ResUtil.createBitmapByName("Room_HeadFrame"),a.addChild(a._headBg),a._headBg.x=(i-a._headBg.width)/2,a._headBg.y=(n-a._headBg.height)/2,a._headMc=t.ResUtil.createBitmapByName("room_default_head_icon"),a.addChild(a._headMc),a._headMc.x=(a.width-a._headMc.width)/2,a._headMc.y=(a.height-a._headMc.height)/2,a}return __extends(i,e),i.prototype.destory=function(){t.ResUtil.removeAllChildren(this),t.ResUtil.removeFromParent(this),this._headLoad&&(this._headLoad.destroy(),this._headLoad=null),this._headMc=null},Object.defineProperty(i.prototype,"headUrl",{set:function(e){return e?(this._headUrl=e,this._headLoad||(this._headLoad=new t.HeadLoader),void this._headLoad.load(this._headUrl,this.loaded,null,this)):void(this._headMc.texture=null)},enumerable:!0,configurable:!0}),i.prototype.setPlayerIconMask=function(t){var e=RES.getRes("mask_head"),i=new egret.Bitmap;this.addChild(i),i.texture=e,i.width=this._headMc.width,i.height=this._headMc.height,i.x=(this.width-i.width)/2,i.y=(this.height-i.height)/2,t.mask=i},i.prototype.loaded=function(t){this._headMc?this._headMc.bitmapData=t:(this._headMc=new egret.Bitmap(t),this.addChild(this._headMc)),this._headMc.width=this._headMc.height=110,this._headMc.x=(this.width-this._headMc.width)/2,this._headMc.y=(this.height-this._headMc.height)/2,this.setPlayerIconMask(this._headMc)},i}(egret.Sprite);t.PokerHead=e,__reflect(e.prototype,"game.PokerHead")}(game||(game={}));var game;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.m_seatSprites=new Array,t.addListen(),t}return __extends(i,e),Object.defineProperty(i,"Instance",{get:function(){return null==this.m_Instance&&(this.m_Instance=new i),this.m_Instance},enumerable:!0,configurable:!0}),i.prototype.addListen=function(){t.RoomData.Instance.addSeatChanged.removeAll(),t.RoomData.Instance.delectSeatChanged.removeAll(),t.RoomData.Instance.addSeatChanged.add(this.addSeatSprite,this),t.RoomData.Instance.delectSeatChanged.add(this.delectSeatSprite,this),GX.PokerEvent.Instance.userSeatdown.add(this.userSeatdown,this)},i.prototype.removeListen=function(){},i.prototype.addSeatSprite=function(e){var i=new t.SeatSprite(e);t.CardSet.Instance.addCardSeat(e),this.m_seatSprites.push(i)},i.prototype.delectSeatSprite=function(e){var i=this.m_seatSprites.first(function(t){return t.seatData.seatId==e});t.CardSet.Instance.deleteCardSeat(e),i&&i.parent&&i.parent.removeChild(i),i.destroy(),this.m_seatSprites.removeFirst(function(t){return t.seatData.seatId==e}),t.PlayerListPanel.instance.updataSeatInfo()},i.prototype.initSeatSprite=function(){var e=t.RoomData.Instance.seatList;if(e=null!=e&&e instanceof Array?e:null,null!=e)for(var i=0;i<e.length;i++){var n=e[i];if(null!=n){var a=new t.SeatSprite(n);this.m_seatSprites.push(a),this.addChild(a);var s=t.GameConstant.seatPosArr[i];null!=s&&(a.x=s.x,a.y=s.y)}}},i.prototype.resetSeat=function(){for(var t=0;t<this.m_seatSprites.length;t++)this.m_seatSprites[t].resetUserSprite()},Object.defineProperty(i.prototype,"seatSprites",{get:function(){return this.m_seatSprites
},enumerable:!0,configurable:!0}),i.prototype.operateChanged=function(t){if(t){this.stopOtherCountdown();var e=this.seatSprites.first(function(e){return e.uid==t.uid});e.showCountdownCircle(t.leftSec)}},i.prototype.userSeatdown=function(e){e.uid==uniLib.NetMgr.UID&&(t.DataManager.isSitDown=!0,t.GameView.Instance.removeSeatDownBtn(),t.GameView.Instance.setReadyBtnVisible(!0));for(var i=0,n=this.m_seatSprites;i<n.length;i++){var a=n[i];a.seatData.user.uid==e.uid&&(a.visible=!0,a.seatData.isSit=!0)}},i.prototype.resetIsInGame=function(){for(var e=0,i=this.m_seatSprites;e<i.length;e++){var n=i[e];n.seatData.isInGame=!1}t.DataManager.isInGame=!1},i.prototype.stopOtherCountdown=function(){for(var t=i.Instance.seatSprites,e=0;e<t.length;e++)t[e].removCountdownCircle()},i}(egret.DisplayObjectContainer);t.SeatLayer=e,__reflect(e.prototype,"game.SeatLayer")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return Object.defineProperty(e,"isInGame",{get:function(){return this._isInGame},set:function(t){this._isInGame=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"isSitDown",{get:function(){return this._isSitDown},set:function(e){this._isSitDown=e,e?(t.GameView.Instance.removeSeatDownBtn(),t.GameView.Instance.setReadyBtnVisible(!0)):-1!=t.RoomData.Instance.roomPlayProps.indexOf(90)&&t.GameView.Instance.setReadyBtnVisible(!1)},enumerable:!0,configurable:!0}),e}();t.DataManager=e,__reflect(e.prototype,"game.DataManager")}(game||(game={}));var game;!function(t){var e=function(){function t(){}return Object.defineProperty(t,"Instance",{get:function(){return null==this.m_Instance&&(this.m_Instance=new t),this.m_Instance},enumerable:!0,configurable:!0}),t.prototype.playOperateSound=function(t,e){var i=1;switch(e){case Cmd.Operation.GiveUp:case Cmd.Operation.FollowBet:case Cmd.Operation.NoFoot:i=Math.randomInteger(1,3);break;case Cmd.Operation.UpFoot:case Cmd.Operation.BackFoot:i=Math.randomInteger(1,2)}var n=this.getNameForGender(t)+"_operation_"+Number(e)+"_"+i+"_mp3";uniLib.SoundMgr.instance.playSound(n)},t.prototype.playBetSound=function(){uniLib.SoundMgr.instance.playSound("Bet_mp3")},t.prototype.playDealCard=function(){uniLib.SoundMgr.instance.playSound("card_mp3")},t.prototype.playTDKBg=function(){uniLib.SoundMgr.instance.playBgMusic(["TDKBGM_mp3"])},t.prototype.playTDKWin=function(){uniLib.SoundMgr.instance.playSound("You_Win_mp3")},t.prototype.playTDKLose=function(){uniLib.SoundMgr.instance.playSound("You_Lose_mp3")},t.prototype.playReminded=function(){uniLib.SoundMgr.instance.playSound("clock_mp3")},t.prototype.playButtonClick=function(){uniLib.SoundMgr.instance.playSound("ButtonClick_mp3")},t.prototype.playCardClick=function(){uniLib.SoundMgr.instance.playSound("Card_Click_mp3")},t.prototype.playDengSi=function(){uniLib.SoundMgr.instance.playSound("dengsi_mp3")},t.prototype.playChat=function(t,e){var i="Chat_String"+e+"_"+this.getNameForGender(t)+"_mp3";uniLib.SoundMgr.instance.playSound(i)},t.prototype.getNameForGender=function(t){return"男"==t?"0":"1"},t}();t.SoundHand=e,__reflect(e.prototype,"game.SoundHand")}(game||(game={}));var game;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t._isClick=!0,t.skinName=new Chat_TDK_Skin,t.width=uniLib.Global.screenWidth,t.initUI(),t}return __extends(i,e),i.prototype.initUI=function(){for(var e=1;31>=e;e++){var i=new eui.RadioButton;i.skinName=new FaceButton_TDK_Skin,i.iconDisplay.texture=RES.getRes("face_DDZ"+e),i.groupName="face",i.value=e,this.faceGroup.addChild(i)}for(var e=0;6>e;e++){var n=new eui.RadioButton;n.skinName=new ChatRadioButton_TDK_Skin,n.groupName="chat",n.value=e,n.label=e+1+"."+t.ChatPanel.ShortTalkArr[e],n.y=50*e,this.chatGroup.addChild(n)}this.touchEnabled=!1,this.chatRadioButton.selected=!0,this.faceScroller.visible=!0,this.chatScroller.visible=!0,this.chatRadioButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRaduiButtonTap,this),this.faceRadioButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRaduiButtonTap,this),this.bgRect.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.faceGroup.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onFaceGroupTap,this),this.chatGroup.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChatGroupTap,this),this.textField.name="short_input",this.textField.size=28,this.textField.type=egret.TextFieldType.INPUT,this.textField.text="请输入聊天内容",this.touchEnabled=!0,this.textField.addEventListener(egret.FocusEvent.FOCUS_IN,this.onTextFieldFocusIn,this),this.textField.addEventListener(egret.FocusEvent.FOCUS_OUT,this.onTextFieldFocusOut,this),this.sendBtn.name="short_send",this.sendBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sendClickHandler,this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this)},i.prototype.onChatGroupTap=function(e){t.SoundHand.Instance.playButtonClick();var i=this;if(!this._isClick)return void t.PublicManage.getInstance().showMildWarnShow("您的操作太频繁了！请休息一下吧");var n=e.target;if(n instanceof eui.RadioButton){var a="2"+n.value,s=new Cmd.CommonChat_C;s.words=a,t.PokerFunction.tcpSend(s),t.PopupManager.removePopUp(this),this._isClick=!1,setTimeout(function(){i._isClick=!0},3e3)}},i.prototype.onFaceGroupTap=function(e){t.SoundHand.Instance.playButtonClick();var i=this;if(!this._isClick)return void t.PublicManage.getInstance().showMildWarnShow("您的操作太频繁了！请休息一下吧");var n=e.target;if(n instanceof eui.RadioButton){var a=new Cmd.CommonChat_C,s="1"+n.value;a.words=s,t.PokerFunction.tcpSend(a),t.PopupManager.removePopUp(this),this._isClick=!1,setTimeout(function(){i._isClick=!0},3e3)}},i.prototype.onRaduiButtonTap=function(e){t.SoundHand.Instance.playButtonClick(),e.target==this.chatRadioButton?(this.faceScroller.visible=!1,this.chatScroller.visible=!0):e.target==this.faceRadioButton&&(this.faceScroller.visible=!0,this.chatScroller.visible=!1)},i.prototype.onTouchTap=function(e){t.SoundHand.Instance.playButtonClick(),e.target==this.textField&&e.target.setFocus()},i.prototype.sendClickHandler=function(e){t.SoundHand.Instance.playButtonClick();var i=this.textField.text;if(-1!=i.indexOf("请输入聊天内容"))return this.textField.text="",void(this._isClick=!0);if(""==i)return this._isClick=!0,void t.PublicManage.getInstance().showMildWarnShow("聊天内容不能为空");var n=new Cmd.CommonChat_C;n.words=this.textField.text,t.PokerFunction.tcpSend(n),this.textField.text="",t.PopupManager.removePopUp(this)},i.prototype.onTextFieldFocusIn=function(t){t.target.setFocus(),-1!=this.textField.text.indexOf("请输入聊天内容")&&(this.textField.text="")},i.prototype.onTextFieldFocusOut=function(t){""==this.textField.text&&(this.textField.text="请输入聊天内容")},i.prototype.createRecordYetOpen=function(){this._yetOpen||(this._yetOpen=t.ResUtil.createTextFeild(1456961,egret.HorizontalAlign.CENTER,"此功能暂未开放",30),this.addChild(this._yetOpen),this._yetOpen.x=540,this._yetOpen.y=280),this._yetOpen.visible=!0},i.prototype.destory=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this.chatRadioButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRaduiButtonTap,this),this.faceRadioButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRaduiButtonTap,this),this.bgRect.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.closeButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.faceGroup.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onFaceGroupTap,this),this.chatGroup.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChatGroupTap,this),this.textField.removeEventListener(egret.FocusEvent.FOCUS_IN,this.onTextFieldFocusIn,this),this.textField.removeEventListener(egret.FocusEvent.FOCUS_OUT,this.onTextFieldFocusOut,this),this.sendBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.sendClickHandler,this),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this.sendBtn=null,uniLib.DisplayUtils.removeAllChildren(this._content),uniLib.DisplayUtils.removeFromParent(this._content),uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this)},i.prototype.setRecordData=function(t){},i.prototype.onClose=function(e){t.SoundHand.Instance.playButtonClick(),t.PopupManager.removePopUp(this),this.destory()},i}(eui.Component);e.ShortTalkArr=["你是哪个单位的？出牌这么慢","你这牌打的可真精彩！","你这牌打得太让人无语了。","哈哈，你没了吧！","小树不修不直溜，人不修理哏赳赳","小样，你给我等着"],t.ChatPanel=e,__reflect(e.prototype,"game.ChatPanel")}(game||(game={}));var game;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.init(),t}return __extends(i,e),i.prototype.init=function(){this._facePanel=[];for(var t=0;5>t;t++){var e=new egret.Sprite;this._facePanel.push(e),this.addChild(e)}this._quickTalkPanel=[];for(var t=0;5>t;t++){var e=new egret.Sprite;this._quickTalkPanel.push(e),this.addChild(e)}this._talkPanel=[];for(var t=0;5>t;t++){var e=new egret.Sprite;this._talkPanel.push(e),this.addChild(e)}},i.prototype.showCommonChat=function(e,i){var n=t.GameConstant.GetSeatSpriteByUid(e);if(n&&n.uid){var a=n.clientNo,s=n.seatData.user?n.seatData.user.gender:null;switch(a){case 0:case 4:this._quickTalkPanel[a].x=t.GameConstant.seatPosArr[a].x+115,this._quickTalkPanel[a].y=t.GameConstant.seatPosArr[a].y,this._facePanel[a].x=t.GameConstant.seatPosArr[a].x+120,this._facePanel[a].y=t.GameConstant.seatPosArr[a].y;break;case 2:case 1:this._quickTalkPanel[a].x=t.GameConstant.seatPosArr[a].x-190,this._quickTalkPanel[a].y=t.GameConstant.seatPosArr[a].y,this._facePanel[a].x=t.GameConstant.seatPosArr[a].x-150,this._facePanel[a].y=t.GameConstant.seatPosArr[a].y;break;case 3:this._quickTalkPanel[a].x=t.GameConstant.seatPosArr[a].x+115,this._quickTalkPanel[a].y=t.GameConstant.seatPosArr[a].y-20,this._facePanel[a].x=t.GameConstant.seatPosArr[a].x+120,this._facePanel[a].y=t.GameConstant.seatPosArr[a].y-20}var o;if("1"==i.charAt(0)){o=i.substr(1,i.length-1);var r=uniLib.DisplayUtils.createMovieClicp("face_"+o+"_new");this._facePanel[a].addChild(r),r.scaleX=1,r.scaleY=1,r.play(-1),GX.GameLayerManager.addUIToEffect(r),t.Timer.setTimeout(function(){r.stop(),GX.GameLayerManager.removeUI(r)},this,2e3)}else if("2"==i.charAt(0)){o=i.substr(1,i.length-1),t.SoundHand.Instance.playChat(s,o);var h=this._quickTalkPanel[a];if(!h)return;this.creatChatPop(a,t.ChatPanel.ShortTalkArr[o],h),egret.Tween.get(h).wait(3e3).call(this.quickTalkCompelete,this,[h])}else{var h=this._quickTalkPanel[a];if(!h)return;this.showCommonTalk(e,i),egret.Tween.get(this._quickTalkPanel[a]).wait(3e3).call(this.quickTalkCompelete,this,[h])}}},i.prototype.showCommonTalk=function(e,i){var n=t.GameConstant.GetClientNoByUid(e);if(!(0>n||n>2)){var a=this._talkPanel[n],s=t.GameConstant.seatPosArr[n];if(a){switch(n){case 0:a.x=s.x+115,a.y=s.y;break;case 1:case 2:a.x=s.x-190,a.y=s.y;break;case 3:a.x=s.x+115,a.y=s.y+20;break;case 4:a.x=s.x+115,a.y=s.y}this.creatChatPop(n,i,a),egret.Tween.get(a).wait(3e3).call(this.talkCompelete,this,[a,n])}}},i.prototype.creatChatPop=function(e,i,n){if(n){var a=t.ResUtil.createBitmapByName("chat_pop_TDK");a.scale9Grid=new egret.Rectangle(28,33,13,5),a.width=245,n.addChild(a);var s=t.ResUtil.createTextFeild(1456961,egret.HorizontalAlign.LEFT,"",28,35,10,210,!1,4);s.text=i,n.addChild(s),a.height=10+s.height+20,1==e||2==e?(a.scaleX=-1,a.x=180,s.x=-45):3==e?(a.y+=40,a.x=10,s.x=30,s.y+=40):s.x-=10}},i.prototype.talkCompelete=function(t,e){t&&egret.Tween.removeTweens(t),uniLib.DisplayUtils.removeAllChildren(this._talkPanel[e]),this.parent&&this.parent.removeChild(this)},i.prototype.showCompelete=function(e,i){e&&egret.Tween.removeTweens(e),uniLib.DisplayUtils.removeAllChildren(this._facePanel[i]),t.GameInfo.topLayer.removeChild(this)},i.prototype.quickTalkCompelete=function(e,i){e&&egret.Tween.removeTweens(e),uniLib.DisplayUtils.removeAllChildren(e),t.GameInfo.topLayer.removeChild(this)},i}(eui.Component);e.ShortTalkArr=["你是哪个单位的？出牌这么慢","你这牌打的可真精彩！","你这牌打得太让人无语了。","哈哈，你没了吧！","小树不修不直溜，人不修理哏赳赳","小样，你给我等着"],t.ChatPop=e,__reflect(e.prototype,"game.ChatPop")}(game||(game={}));var CircleProgressBar=function(t){function e(e,i,n,a){void 0===n&&(n=5),void 0===a&&(a=65280);var s=t.call(this)||this;return s.remainTimer=0,s.colorSpeed=327680,s.aimColor=16776960,s.touchEnabled=!1,s.touchChildren=!1,s.r=e,s.thickness=n,s.color=a,s.shere=new egret.Shape,s.addChild(s.shere),s.maskCircle=new egret.Shape,s.addChild(s.maskCircle),s.shere.mask=s.maskCircle,s.maskCircle.x=s.maskCircle.y=s.r,s}return __extends(e,t),e.prototype.startCountdown=function(t){this.color=65280,this.totalTime=t,this.constant=2*Math.PI/this.totalTime,this.startTime=Date.now(),this.shere&&this.maskCircle&&(this.shere.mask=this.maskCircle),this.addEventListener(egret.Event.ENTER_FRAME,this.onFrame,this)},e.prototype.stopCountdown=function(){this.removeEventListener(egret.Event.ENTER_FRAME,this.onFrame,this)},e.prototype.onFrame=function(){var t=Date.now()-this.startTime;if(this.totalTime-t<500)return this.maskCircle.graphics.clear(),this.drawTimeRect(),this.shere.mask=null,egret.Tween.get(this.shere,{loop:!0}).to({alpha:.5},500).to({alpha:1},500),void this.removeEventListener(egret.Event.ENTER_FRAME,this.onFrame,this);this.totalTime-t<=this.totalTime/7?this.color=16711680:this.totalTime-t<=this.totalTime/4&&(this.color=16776960);var e=this.constant*(this.totalTime+t)+-Math.PI/2;this.drawTimeRect(),this.addTimeMask(e)},e.prototype.drawTimeRect=function(){this.shere&&(this.shere.graphics.clear(),this.shere.graphics.lineStyle(this.thickness,this.color),this.shere.graphics.drawRoundRect(0,0,2*this.r,2*this.r,this.r),this.shere.graphics.endFill())},e.prototype.addTimeMask=function(t){this.maskCircle&&(this.maskCircle.graphics.clear(),this.maskCircle.graphics.beginFill(65535,1),this.maskCircle.graphics.lineTo(this.r,0),this.maskCircle.graphics.drawArc(0,0,this.r+20,-Math.PI/2,t,!0),this.maskCircle.graphics.lineTo(0,0),this.maskCircle.graphics.endFill())},e.prototype.destroy=function(){egret.Tween.removeTweens(this.shere),this.removeChildren(),this.removeEventListener(egret.Event.ENTER_FRAME,this.onFrame,this),this.shere&&(this.shere.graphics.clear(),this.shere.mask=null,this.shere=null),this.maskCircle&&(this.maskCircle.graphics.clear(),this.maskCircle=null)},e}(egret.Sprite);__reflect(CircleProgressBar.prototype,"CircleProgressBar");var game;!function(t){var e=function(e){function i(){var t=e.call(this,2)||this;return t._colorArr=[16740864,1151744,16714752],t.protocolType=1,t}return __extends(i,e),i.prototype.initPanel=function(){this.touchEnabled=!0,this.setSize(635,600),this.hideClose(),this.yesBtn=new t.GameButton(["dlm_agree","dlm_agree_dk"]),this.yesBtn.x=100,this.yesBtn.y=490,this.addChild(this.yesBtn),this.noBtn=new t.GameButton(["dlm_disagree","dlm_disagree_dk"]),this.noBtn.x=420,this.noBtn.y=490,this.addChild(this.noBtn),this.infoIcon1||(this.infoIcon1=t.ResUtil.createBitmapByName("word_agree"),this.infoIcon1.x=Math.round(this.yesBtn.x+(this.yesBtn.width-this.infoIcon1.width)/2),this.infoIcon1.y=this.yesBtn.y+10),this.infoIcon2||(this.infoIcon2=t.ResUtil.createBitmapByName("word_refuse"),this.infoIcon2.x=Math.round(this.noBtn.x+(this.noBtn.width-this.infoIcon2.width)/2),this.infoIcon2.y=this.noBtn.y+10),this.yesBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onAgreeHandler,this),this.noBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRefuse,this),this.info=t.ResUtil.createTextFeild(4079177,egret.HorizontalAlign.LEFT,"",32,50,30,500),this.info.lineSpacing=10,this.addChild(this.info);for(var e=0;e<t.SeatLayer.Instance.seatSprites.length;e++)this["_userName"+e]=t.ResUtil.createTextFeild(4079177,egret.HorizontalAlign.LEFT,"",32,137,173+53*e,222),this.addChild(this["_userName"+e]),this["_status"+e]=t.ResUtil.createTextFeild(4079177,egret.HorizontalAlign.CENTER,"",32,328,173+53*e,150),this.addChild(this["_status"+e]);this._timeTxt=t.ResUtil.createTextFeild(14370056,egret.HorizontalAlign.RIGHT,"",25,540,15,50),this.addChild(this._timeTxt)},i.prototype.stopTimer=function(){this._timer&&(this._timer.removeEventListener(egret.TimerEvent.TIMER,this.timerHandle,this),this._timer.stop(),this._timer=null)},i.prototype.timerHandle=function(t){var e=new Date,i=e.getTime(),n=this._totalTime-(i-this._startTime)/1e3;n>0?this._timeTxt.text=Math.floor(this._totalTime-(i-this._startTime)/1e3).toString():this.parent&&this.parent.removeChild(this)},i.prototype.setData=function(e){if(this.protocolType=1,null!=e.leftSec?this.endTime=t.GameTime.localNow()+1e3*e.leftSec:this.endTime=t.GameTime.localNow()+(e.endTime-t.GameTime.serverNow()),this.time=Math.floor(this.endTime/1e3-t.GameTime.localNow()/1e3),e.sponsor){var i="玩家"+e.sponsor+"\n申请解散房间请问是否同意(超过"+this.time+"秒未做出选择，则默认同意)？";this.info.text=i}var n=e.voterList;this._userList=[];for(var a=0;a<n.length;a++){var s=n[a].name.slice(0,5);this["_userName"+a].text=s,this["_status"+a].text=1==n[a].yesOrWait?"同意":"等待选择",this["_status"+a].textColor=this._colorArr[0],n[a].uid==uniLib.NetMgr.UID&&1==n[a].yesOrWait&&this.setButtonState(!1)}this.updataTimer(),egret.clearInterval(this.timer),this.timer=egret.setInterval(this.updataTimer,this,1e3)},i.prototype.setData_Mjhong=function(e){this.protocolType=2;var i=t.RoomInfo.getInstance().getUserVoByUid(e.uid);if(i){var n=t.DataCache.langObj.uiTxt.DismissPanel.info,a=n.split("#");if(e.waitTime)var s=a[0]+i.nickName+a[1];else var s=a[0]+i.nickName+"\n申请将房间人数设置为"+t.RoomData.Instance.seatList.length;this.info.text=s}e.uid==uniLib.UserInfo.uid&&this.enableBtns()},i.prototype.updataTimer=function(){this.time=Math.floor(this.endTime/1e3-t.GameTime.localNow()/1e3),this.time<0&&(this.time=0,egret.clearInterval(this.timer)),this._timeTxt.text=this.time+""},i.prototype.setButtonState=function(t){this.yesBtn.visible=t,this.noBtn.visible=t,this.infoIcon1.visible=t,this.infoIcon2.visible=t},i.prototype.refrenshData=function(t){var e=t.voterList;if(!e||e&&e.length<1)this.parent&&this.parent.removeChild(this);else{var i=e.first(function(t){return 0==t.yesOrWait});!i&&this.parent&&this.parent.removeChild(this)}},i.prototype.enableBtns=function(){this.yesBtn&&(this.yesBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onAgreeHandler,this),this.yesBtn.visible=!1,this.infoIcon1.visible=!1),this.noBtn&&(this.noBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRefuse,this),this.noBtn.visible=!1,this.infoIcon2.visible=!1)},i.prototype.updateStatus=function(e,i){0==e&&(e=2);var n=this._userList.indexOf(i);n>=0&&(this["_status"+n].text=t.DataCache.langObj.uiTxt.DismissPanel["status"+e],this["_status"+n].textColor=this._colorArr[e])},i.prototype.onAgreeHandler=function(e){if(2==this.protocolType){var i=new Cmd.ReturnChangeUserNbrRoom_C;return i.isAgree=1,t.PokerFunction.tcpSend(i),void this.dispatchEventWith(t.UIEventConsts.CLOSE)}var n=new Cmd.DissolveRoomReturnCmd_C;n.yesOrNo=!0,t.PokerFunction.tcpSend(n)},i.prototype.onRefuse=function(e){if(2==this.protocolType){var i=new Cmd.ReturnChangeUserNbrRoom_C;return i.isAgree=0,t.PokerFunction.tcpSend(i),void this.dispatchEventWith(t.UIEventConsts.CLOSE)}var n=new Cmd.DissolveRoomReturnCmd_C;n.yesOrNo=!1,t.PokerFunction.tcpSend(n)},i.prototype.destory=function(){this.enableBtns(),this.yesBtn&&this.yesBtn.destory(),this.yesBtn=null,this.noBtn&&this.noBtn.destory(),this.noBtn=null,this._timer&&(this._timer.removeEventListener(egret.TimerEvent.TIMER,this.timerHandle,this),this._timer.stop()),this._timer=null,this.info=null,this._timeTxt=null,this._userList=null,e.prototype.destory.call(this)},i}(t.BasePanel);t.DismissPanel=e,__reflect(e.prototype,"game.DismissPanel")}(game||(game={}));var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,i){function n(n){e.call(i,n,t)}if(RES.hasRes(t)){var a=RES.getRes(t);a?n(a):RES.getResAsync(t,n,this)}else RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var game;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.skinName=new TotalResult_TDK_Skin,t.width=uniLib.Global.screenWidth,t.init(),t}return __extends(n,e),n.prototype.init=function(){this.addEvent()},n.prototype.setData=function(t){this.reset(t)},n.prototype.share=function(){var t=new uniLib.WXShareVo;t.shareWay=0;var e=new egret.Bitmap(uniLib.DisplayUtils.catchScreenToTex(this,new egret.Rectangle(0,0,this.width,this.height),.6));t.shareImageData=uniLib.DisplayUtils.catchScreen(e,new egret.Rectangle(0,0,this.width,this.height)),MJLobby.MJLobbyData.getInstance().hasXianLiao?uniLib.Global.dispatchEvent(uniLib.ZqEvent.SHARE,t,!1):uniLib.ZQGameSdk.share(t,null,this)},n.prototype.reset=function(e){this._roomId.text="房间号："+t.RoomData.Instance.roomId;var n=e.gameNum?e.gameNum:0;this._happyPoints.text="喜分："+(e.happyPoint?e.happyPoint:0);for(var a=new eui.ArrayCollection,s=0;s<e.recordList.length;s++){var o=e.recordList[s],r=t.RoomData.Instance.ownerId==o.user.uid?!0:!1;a.addItem({gameNum:n,isLord:r,item:o})}this._itemList.itemRenderer=i,this._itemList.dataProvider=a;var h=new Date(Date.now()),d=h.getUTCFullYear(),c=h.getUTCMonth()+1,l=h.getUTCDate(),u=h.getHours()>=10?h.getHours():"0"+h.getHours(),p=h.getMinutes()>=10?h.getMinutes():"0"+h.getMinutes();h.getSeconds()>=10?h.getSeconds():"0"+h.getSeconds();this._datatime.text=d+"."+c+"."+l+"   "+u+":"+p},n.prototype.oneMoreAgain=function(){t.GameInfo.topLayer.removeChild(this),t.GameView.exitGame(),uniLib.Global.dispatchEvent(uniLib.ZqEvent.EVENT_G2L,"game_request_continue")},n.prototype.addEvent=function(){this._shareBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.share,this),this.playAgainBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.oneMoreAgain,this),this._backBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBackHandler,this)},n.prototype.onBackHandler=function(){t.GameInfo.topLayer.removeChild(this),t.GameView.exitGame()},n.prototype.removeEvent=function(){this._shareBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.share,this),this.playAgainBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.oneMoreAgain,this),this._backBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBackHandler,this)},n.prototype.destory=function(){this.playAgainBtn=null,this._shareBtn=null,this._backBtn=null,this._datatime=null,this._itemNode.numChildren&&uniLib.DisplayUtils.removeAllChildren(this._itemNode),this._itemNode=null},n}(eui.Component);t.GameOverPanel=e,__reflect(e.prototype,"game.GameOverPanel");var i=function(t){function e(){var e=t.call(this)||this;return e.skinName=new TotalItemSkin_lose_TDK_Skin,e.init(),e}return __extends(e,t),e.prototype.init=function(){},e.prototype.dataChanged=function(){var t=this.data,e=t.item;e.profitSum>0&&(this.skinName=TotalItemSkin_win_TDK_Skin);var i=e.user;if(i){this._uid.text=i.uid+"",this._headmc.source=i.headurl,this._headmc.width=this._headmc.height=84;var n=i.name.slice(0,7);this._username.text=n,this._bank.visible=t.isLord;var a=e.winNum;this._winCount.text=(a?a:0)+"胜";var s=t.gameNum-a;this._loseCount.text=(s?s:0)+"负",this._totalCount.text=""+t.item.profitSum==null?"":(t.item.profitSum%1==0?t.item.profitSum:parseFloat(t.item.profitSum.toFixed(2))).toLocaleString()}},e}(eui.ItemRenderer);t.TotalItemSkin=i,__reflect(i.prototype,"game.TotalItemSkin")}(game||(game={}));var game;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.tmpHappyPoint=0,t.skinName=new GameView_TDK_Skin,t.width=uniLib.Global.screenWidth,t.initUI(),t.addListener(),t}return __extends(i,e),Object.defineProperty(i,"Instance",{get:function(){return null==this.m_Instance&&(this.m_Instance=new i),this.m_Instance},enumerable:!0,configurable:!0}),i.clearInstance=function(){this.m_Instance=null},i.prototype.addListener=function(){this.seatDownBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.playerListBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.startGameButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.selectCard.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.readyBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.dissRoomBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.backLobbyBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.changeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.setBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.helpBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.shareBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.cancelTrustBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.trusteeshipBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.chatBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.quitGzButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),uniLib.Global.addEventListener(uniLib.ZqEvent.NATIVE_TO_EGERET,this.onNativeMessage,this),this.gpsBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),t.RoomData.Instance.inningsChanged.add(this.ShowNumberOfGame,this),uniLib.Global.addEventListener(uniLib.ZqEvent.EVENT_L2G,this.onMoon,this),t.RoomData.Instance.startGameChanged.add(this.startGameChanged,this),t.RoomData.Instance.roomIdChanged.add(this.roomIdChanged,this),t.RoomData.Instance.roomTypeChange.add(this.roomTypeChange,this),t.RoomData.Instance.operateChanged.add(this.operateChanged,this),t.RoomData.Instance.tabPointChange.add(this.onTabPointChange,this),t.RoomData.Instance.relogTabPointsEvent.add(this.relogTabPoints,this),t.RoomData.Instance.happyPointChange.add(this.onHappyPointChange,this),t.RoomData.Instance.startGameOpIdChange.add(this.changeStartVisable,this),t.RoomData.Instance.propsEvent.add(this.propsEvent,this),TDK.EventManage.startVisableChanged.add(this.changeStartVisable,this),GX.PokerEvent.Instance.roomDataUpdateEvent.add(this.changeLookStatue,this)},i.prototype.removeListener=function(){this.seatDownBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.playerListBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.startGameButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.selectCard.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.readyBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.dissRoomBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.setBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.changeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.helpBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.shareBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.cancelTrustBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.trusteeshipBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.backLobbyBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.chatBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),uniLib.Global.removeEventListener(uniLib.ZqEvent.NATIVE_TO_EGERET,this.onNativeMessage,this),this.gpsBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.quitGzButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),uniLib.Global.removeEventListener(uniLib.ZqEvent.EVENT_L2G,this.onMoon,this),t.RoomData.Instance.startGameOpIdChange.remove(this.changeStartVisable,this),t.RoomData.Instance.propsEvent.remove(this.propsEvent,this),TDK.EventManage.startVisableChanged.remove(this.changeStartVisable,this)},i.prototype.initUI=function(){this.addChild(t.SeatLayer.Instance),this.addChild(this.suspendPrompt),this.addChild(t.CardSet.Instance),this.addChild(t.OperateLayer.Instance),t.SeatLayer.Instance.initSeatSprite(),this.showEnterButtons(),this.updataReadyButton(!1);var e=new t.VoiceChat;e.updateBtnRes(["NDvoice_btn1","NDvoice_btn2"]),t.GameInfo.uiLayer.addChild(e),this.showTime(),uniLib.Global.debugLevel>=1?this.selectCard.visible=!0:this.selectCard.visible=!1,0!=uniLib.Global.is_sandbox&&this.removeChild(this.shareBtn),this.startGameButton.visible=!1,this.signalLabel.visible=!1,this.showVersion(),this.showVideoPanel(),this.setChildIndex(this.seatDownBtn,100),this.setChildIndex(this.backLobbyBtn,100),1003==MJLobby.MJLobbyData.getInstance().lobbyId&&(this.gpsBtn.visible=!1)},i.prototype.relogTabPoints=function(e){1!=t.RoomInfo.getInstance().video&&(t.CardSet.Instance.setTouch(!0),t.CardSet.Instance.showKengPoint(!0),this.onTabPointChange(e),t.EffectCreate.Instance.creatRelogChips(e))},i.prototype.onTabPointChange=function(e){void 0===e&&(e=0/0),this.tabPointLable&&(0/0!=e?this.tabPointLable.text=""+e:this.tabPointLable.text=""+(t.RoomData.Instance.tabPoints?t.RoomData.Instance.tabPoints:0))},i.prototype.changeLookStatue=function(e){if(e&&e.roomData&&e.roomData.seatList)for(var i=0,n=e.roomData.seatList;i<n.length;i++){var a=n[i],s=a.seatId,o=t.CardSet.Instance.seekCardLayer(s);a.stateList&&a.stateList instanceof Array&&a.stateList.first(function(t){return t==Cmd.GameState.State_Check})?o&&o.removeLookCard():o&&o.getSeatCards.length>=1&&o.showLookCard()}var r=t.RoomData.Instance.seatList,h=t.RoomData.Instance.maxuserNbr;null==t.PokerFunction.MainSeat&&r.length==h?(this.setReadyBtnVisible(!1),this.removeSeatDownBtn(),t.DataManager.isInGame=!1,t.DataManager.isSitDown=!1,this.backLobbyBtn.visible=!1,this.gzvisble=!0):this.gzvisble=!1},i.prototype.onHappyPointChange=function(e){this.happyPointLable&&(0/0!=e&&5>=e&&(this.tmpHappyPoint=e),this.happyPointLable.text=""+(t.RoomData.Instance.happyPoint?t.RoomData.Instance.happyPoint:0))},i.prototype.showEnterButtons=function(){if(this.backLobbyBtn&&this.shareBtn&&this.dissRoomBtn){if(t.DataCache.platParam){var e=Number(t.DataCache.platParam.roomId);if(1e5>e)return}this.backLobbyBtn.visible=!0,1!=uniLib.Global.is_sandbox&&(this.shareBtn.visible=!0),1==uniLib.Global.is_sandbox,this.dissRoomBtn.visible=!0}},i.prototype.destroy=function(){this.removeListener(),this.removeHelp(),egret.clearInterval(this.timer)},i.prototype.showTime=function(){egret.clearInterval(this.timer),this.updataTime(),this.timer=egret.setInterval(this.updataTime,this,1e4)},i.prototype.updataTime=function(){var t=new Date(Date.now()),e=t.getMonth()>=9?t.getMonth()+1:"0"+(t.getMonth()+1),i=t.getDate()>=10?t.getDate():"0"+t.getDate(),n=t.getHours()>=10?t.getHours():"0"+t.getHours(),a=t.getMinutes()>=10?t.getMinutes():"0"+t.getMinutes();this.timeNowLabel.text=e+"-"+i+" "+n+":"+a,uniLib.ZQGameSdk.getNetStateType(),uniLib.ZQGameSdk.getBatteryPer()},i.prototype.onClickTap=function(e){if(e.target==this.readyBtn){var n=new Cmd.ReadyUpdateRoomCmd_CS;"up"==this.readyBtn.currentState?n.yesOrNo=!0:n.yesOrNo=!1,t.PokerFunction.tcpSend(n),t.SoundHand.Instance.playButtonClick()}else if(e.target==this.selectCard){var a=new Cmd.GmAvailableCardUpdateCmd_CS;t.PokerFunction.tcpSend(a),this.showTestPanel()}else if(e.target==this.trusteeshipBtn||e.target==this.cancelTrustBtn)this.gameTrusteeshipRquest(),t.SoundHand.Instance.playButtonClick();else if(e.target==this.dissRoomBtn)this.dissRoom(),t.SoundHand.Instance.playButtonClick();else if(e.target==this.backLobbyBtn){if(t.PokerData.isStandAlone)return void i.exitGame();var s=new Cmd.LeaveRoomCmd_CS;s.uid=uniLib.NetMgr.UID,t.PokerFunction.tcpSend(s),t.SoundHand.Instance.playButtonClick()}else if(e.target==this.setBtn)this.showSetting(),t.SoundHand.Instance.playButtonClick();else if(e.target==this.helpBtn)this.showHelp(),t.SoundHand.Instance.playButtonClick();else if(e.target==this.chatBtn){var o=new t.ChatPanel;t.PopupManager.addPopUp(o,!1,!1),t.SoundHand.Instance.playButtonClick()}else if(e.target==this.shareBtn)this.showShare(),t.SoundHand.Instance.playButtonClick();else if(e.target==this.gpsBtn)this.showDistancePanel();
else if(e.target==this.changeBtn)this.showChangeUserNumConfirm();else if(e.target==this.seatDownBtn){var r=new Cmd.SitDownCmd_CS;r.uid=uniLib.NetMgr.UID,uniLib.NetMgr.tcpSend(r)}else if(e.target==this.startGameButton){var h=new Cmd.StartGameCmd_CS;uniLib.NetMgr.tcpSend(h)}else if(e.target==this.playerListBtn)t.PlayerListPanel.instance.OnOpen();else if(e.target==this.quitGzButton){var d=new Cmd.LeaveRoomCmd_CS;d.uid=uniLib.NetMgr.UID,t.PokerFunction.tcpSend(d)}},i.prototype.removeSeatDownBtn=function(){this.seatDownBtn&&this.seatDownBtn.parent&&this.seatDownBtn.parent.removeChild(this.seatDownBtn),t.DataManager.isInGame||null==t.PokerFunction.MainSeat||(this.gzvisble=!1)},i.prototype.showChangeUserNumConfirm=function(){if(t.RoomData.Instance.seatList){if(1==t.RoomData.Instance.seatList.length)return void t.PublicManage.getInstance().showMildWarnShow("当前房间只有您自己，不可提前开局");var e=new t.MsgBoxPanel,i="是否将房间改为"+t.RoomData.Instance.seatList.length+"人模式，提前开局？";e.setData(i,["确定","取消"],[this.onChangeTouchHandler],this),t.PopupManager.addPopUp(e,!0,!0)}},i.prototype.onChangeTouchHandler=function(e){var i=new Cmd.RequestChangeUserNbrRoom_C;t.PokerFunction.tcpSend(i)},i.prototype.operateChanged=function(e){e&&(t.OperateLayer.Instance.operateChanged(e),t.SeatLayer.Instance.operateChanged(e),this.showSuspendPrompt(!1))},i.prototype.showSuspendPrompt=function(t,e){void 0===e&&(e=0),t?(this.suspendPrompt.visible=!0,this.suspendSec=e,this.suspendSec||(this.suspendSec=0),this.timerSuspend||(this.timerSuspend=new uniLib.UniTimer(this,this.timerSuspendHandle,1e3,!0,this),this.suspendLabel||(this.suspendLabel=new eui.Label,this.suspendLabel.x=this.suspendPrompt.x+this.suspendPrompt.width-63,this.suspendLabel.y=this.suspendPrompt.y+13,this.suspendLabel.size=26,this.suspendLabel.textColor=16777215,this.suspendLabel.fontFamily="微软雅黑"),this.addChild(this.suspendLabel))):(this.suspendPrompt.visible=!1,this.timerSuspend&&(this.timerSuspend.stop(),this.timerSuspend=null),this.suspendSec=0,this.suspendLabel&&this.suspendLabel.parent&&this.suspendLabel.parent.removeChild(this.suspendLabel))},i.prototype.timerSuspendHandle=function(){this.suspendSec=this.suspendSec+1,this.suspendLabel.text=""+this.suspendSec},i.prototype.updataReadyButton=function(e){e?(this.readyBtn.currentState="down",t.RoomData.Instance.startGame&&(this.readyBtn.visible=!1)):this.readyBtn.currentState="up",t.RoomData.Instance.roomType==Cmd.RoomType.RoomType_Quick||this.setBtnsVisible(!e)},i.prototype.showDistancePanel=function(){function e(t){if(0==t.code){i.lng=t.data.longitude,i.lat=t.data.latitude;var e=new Cmd.GetGPSLocationCmd_C;e.lat=i.lat,e.lng=i.lng,uniLib.NetMgr.tcpSend(e)}}var i;i=uniLib.ZQGameSdk.getLocation(e,this);var n=new Cmd.RequestIpGPSCmd_C;t.PokerFunction.tcpSend(n)},i.prototype.gameTrusteeshipRquest=function(){var e=t.PokerFunction.GetUserInfoByUid(uniLib.NetMgr.UID);if(e){var i=new Cmd.HostUpdateRoomCmd_CS;i.yesOrNo=!e.isTrust,i.uid=uniLib.NetMgr.UID,t.PokerFunction.tcpSend(i)}},i.prototype.setcancelTrustBtn=function(e){this.cancelTrustBtn.parent&&(uniLib.DisplayUtils.removeFromParent(this.cancelTrustBtn),t.GameInfo.topLayer.addChild(this.cancelTrustBtn)),this.cancelTrustBtn.visible=e},i.prototype.setBtnsVisible=function(e){this.dissRoomBtn.visible=e,this.seatDownBtn&&this.seatDownBtn.parent&&1==this.seatDownBtn.visible?this.backLobbyBtn.visible=!0:this.backLobbyBtn.visible=e,t.RoomData.Instance.roomPlayProps.first(function(t){return 90==t})?this.changeBtn.visible=!1:this.changeBtn.visible=e},i.prototype.showShare=function(){var e=new uniLib.WXShareVo;if(e.shareWay=0,t.DataCache.platParam){var i=t.RoomData.Instance.seatList.length,n=t.RoomData.Instance.playerNumber,a=i+"缺"+(n-i);e.title=t.DataCache.platParam.shareInfo.title+a,e.description=t.DataCache.platParam.shareInfo.content,e.webpageUrl=t.DataCache.platParam.shareInfo.webPageUrl}MJLobby.MJLobbyData.getInstance().hasXianLiao?uniLib.Global.dispatchEvent(uniLib.ZqEvent.SHARE,e,!1):uniLib.ZQGameSdk.share(e,null,this)},i.prototype.showHelp=function(){this._helpPanel||(this._helpPanel=new t.HelpPanel,this._helpPanel.addEventListener(t.UIEventConsts.CLOSE,this.removeHelp,this)),t.PopupManager.addPopUp(this._helpPanel,!0)},i.prototype.removeHelp=function(){this._helpPanel&&(this._helpPanel.removeEventListener(t.UIEventConsts.CLOSE,this.removeHelp,this),uniLib.DisplayUtils.removeFromParent(this._helpPanel),this._helpPanel.destory(),t.PopupManager.removePopUp(this._helpPanel),this._helpPanel=null)},i.prototype.dissRoom=function(){this.msgBox&&(this.msgBox=null);var e=function(e){this.msgBox&&(t.GameInfo.topLayer.removeChild(this.msgBox),this.msgBox=null)};if(!this.msgBox){var i="你确定请求解散房间？";this.msgBox=new t.MsgBoxPanel,this.msgBox.x=uniLib.Global.screenWidth-this.msgBox.width>>1,this.msgBox.y=uniLib.Global.screenHeight-this.msgBox.height>>1,this.msgBox.setData(i,["确定","取消"],[this.confirmHandler,e])}t.GameInfo.topLayer.addChild(this.msgBox)},i.prototype.propsEvent=function(){t.RoomData.Instance.roomPlayProps.first(function(t){return 90==t})?this.changeBtn.visible=!1:this.changeBtn.visible=!0},i.prototype.confirmHandler=function(e){this.msgBox&&(t.GameInfo.topLayer.removeChild(this.msgBox),this.msgBox=null);var i=new Cmd.DissolveRoomRequestCmd_C;t.PokerFunction.tcpSend(i)},i.prototype.onNativeMessage=function(e){e.param.cmd==uniLib.ZQGameSdk.NETSTATE&&0==e.param.code?(uniLib.ZQGameSdk.lastNetState&&uniLib.ZQGameSdk.lastNetState.data[uniLib.ZQGameSdk.NETSTATE]!=e.param.data[uniLib.ZQGameSdk.NETSTATE]&&(t.PokerFunction.tcpSend(new Cmd.ClientEchoRoomCmd_SC),uniLib.NetMgr.setMsgTimeout(5,"ClientEchoRoomCmd_SC")),e.param.data[uniLib.ZQGameSdk.NETSTATE]==uniLib.NetState.NO_SIGNAL?(this.signalLabel.visible=!0,this.wifiOrDataImage.visible=!1):e.param.data[uniLib.ZQGameSdk.NETSTATE]==uniLib.NetState.WIFI?(this.signalLabel.visible=!1,this.wifiOrDataImage.visible=!0,this.wifiOrDataImage.source="wifi_TDK"):e.param.data[uniLib.ZQGameSdk.NETSTATE]==uniLib.NetState.DATA_FLOWS?(this.signalLabel.visible=!1,this.wifiOrDataImage.visible=!0,this.wifiOrDataImage.source="data_TDK"):e.param.data[uniLib.ZQGameSdk.NETSTATE]==uniLib.NetState.WIFI_AND_DATA&&(this.signalLabel.visible=!1,this.wifiOrDataImage.visible=!0,this.wifiOrDataImage.source="wifi_TDK")):e.param.cmd==uniLib.ZQGameSdk.BATTERY&&0==e.param.code&&(this.betteryButton.skin.image.width=e.param.data[uniLib.ZQGameSdk.BATTERY]/100*25)},i.prototype.ShowNumberOfGame=function(){var e=t.RoomData.Instance.roomCurrentInnings,i=t.RoomData.Instance.roomTotalInnings;if(!e||!i)return void(this.roomRound.text="");var n=t.RoomData.Instance.roomType;t.PokerData.isStandAlone||null!=n&&n==Cmd.RoomType.RoomType_Normal||n==Cmd.RoomType.RoomType_Match?this.roomRound.text="第"+e+"/"+i+"局":this.roomRound.text="",e&&e>1&&this.removeControlButton(),this.changeStartVisable()},i.prototype.removeControlButton=function(){!this.backLobbyBtn.parent||this.seatDownBtn&&this.seatDownBtn.parent&&0!=this.seatDownBtn.visible||this.removeChild(this.backLobbyBtn),this.dissRoomBtn.parent&&this.removeChild(this.dissRoomBtn),this.shareBtn.parent&&this.removeChild(this.shareBtn),this.changeBtn.parent&&this.removeChild(this.changeBtn)},i.prototype.showVersion=function(){var t=new eui.Label;t.fontFamily="黑体",t.size=20,t.textColor=7186632,t.text=uniLib.Global.version.toString(),t.x=uniLib.Global.screenWidth-t.width,t.y=uniLib.Global.screenHeight-t.height,this.addChild(t)},i.prototype.roomTypeChangeHandel=function(){t.RoomData.Instance.roomType;this.roomNumber.text="房号:"+t.RoomData.Instance.roomId},i.prototype.roomIdChanged=function(){t.PokerData.isStandAlone?this.roomNumber.text="练习场(不结算)":this.roomNumber.text="房号:"+t.RoomData.Instance.roomId;var e=t.RoomData.Instance.getPlayTypeByList();if(this.playTypeGroup.removeChildren(),e&&e.length>0)for(var i=0;i<e.length;i++)if("可踢"!=e[i]){var n=new eui.Label;n.text=e[i],n.textColor=7688976,n.fontFamily="微软雅黑",this.playTypeGroup.addChild(n)}-1!=t.RoomData.Instance.roomPlayProps.indexOf(90)?(this.seatDownBtn.visible=!0,this.gzvisble=!0):(this.seatDownBtn.visible=!1,this.gzvisble=!1)},i.prototype.roomTypeChange=function(){if(t.RoomData)switch(t.RoomData.Instance.roomType){case Cmd.RoomType.RoomType_Normal:break;case Cmd.RoomType.RoomType_Quick:this.setBtnsVisible(!1),this.shareBtn.visible=!1;break;default:this.setBtnsVisible(!1)}},i.prototype.startGameChanged=function(){t.RoomData.Instance.startGame&&(this.setBtnsVisible(!1),this.readyBtn.visible=!1,this.shareBtn.visible=!1,this.startGameButton.visible=!1,t.EffectCreate.Instance.removeResultEffect())},i.prototype.setReadyBtnVisible=function(t,e){t&&(this.readyBtn.visible=t,null!=e&&(this.readyBtn.currentState=e)),this.readyBtn.visible=t},i.prototype.restart=function(){for(var e=0;e<t.RoomData.Instance.seatList.length;e++){var i=t.RoomData.Instance.seatList[e];i&&(i.clearHandCard(),i.betCount=0)}0!=this.tmpHappyPoint&&(t.RoomData.Instance.tabPoints-=this.tmpHappyPoint,this.onTabPointChange(t.RoomData.Instance.tabPoints),this.tmpHappyPoint=0),0==t.GameConstant.lastRoundIsNoWinner&&(t.RoomData.Instance.tabPoints=0,t.EffectCreate.Instance.clearChips())},i.prototype.inviteHandel=function(){var e=new uniLib.WXShareVo;e.shareWay=0,t.DataCache.platParam&&(e.title=t.DataCache.platParam.shareInfo.title,e.description=t.DataCache.platParam.shareInfo.content,e.webpageUrl=t.DataCache.platParam.shareInfo.webPageUrl),uniLib.ZQGameSdk.share(e,null,this)},i.prototype.showSetting=function(){var e=new t.SettingPanel;t.PopupManager.addPopUp(e,!0,!1)},i.prototype.showTestPanel=function(){var e=t.TestPanel.Instance;e.init(),e.x=(uniLib.Global.screenWidth-e.width)/2,e.y=80,t.GameInfo.topLayer.addChild(e)},Object.defineProperty(i.prototype,"gzvisble",{set:function(t){this.guanzhanGroup.visible=t},enumerable:!0,configurable:!0}),i.prototype.showMyChips=function(t){t=null==t?0:t,t%1==0?this.chipsLabel.text=t+"":this.chipsLabel.text=t.toFixed(2)},i.prototype.showVideoPanel=function(){0!=t.RoomInfo.getInstance().video&&(this._videoPanel=new t.VideoPanel,t.GameInfo.main.addChild(this._videoPanel),t.RoomInfo.getInstance().GM_Mode=!0)},i.prototype.onMoon=function(t){switch(t.param){case"video_play_finish":this.showVideoFinish(0)}},i.prototype.showVideoFinish=function(e){var i="";0==e?(i="录像播放完毕!",t.PublicManage.getInstance().showVideoCommonPanel(i,["是"],[this.videoExit],null,this)):(i="确定退出录像？",t.PublicManage.getInstance().showVideoCommonPanel(i,["是","否"],[this.videoExit],null,this))},i.prototype.videoExit=function(){uniLib.Global.dispatchEvent(uniLib.ZqEvent.EVENT_G2L,"video_close"),t.RoomInfo.getInstance().GM_Mode=!1,t.RoomInfo.getInstance().video=0,t.RoomInfo.getInstance().videoUid=0,GX.PokerEvent.Instance.leaveRoom.call()},i.prototype.videoReplay=function(){uniLib.Global.dispatchEvent(uniLib.ZqEvent.EVENT_G2L,"video_replay")},i.exitGame=function(){if(t.GameData.iskPoker=!1,t.PokerFunction.exitGame(),i.Instance.destroy(),t.CardSet.Instance.destroy(),t.OperateLayer.Instance.destroy(),t.PlayerListPanel.clearInstance(),t.DataCache.gameInfo&&t.DataCache.gameInfo.defaultOrientation!=egret.OrientationMode.LANDSCAPE&&(uniLib.ScreenUtils.landscape=!1),uniLib.GameModuleUtils.ExitGame(!0),t.DataCache.destroyResOnExit){var e=RES.destroyRes(t.GameConstant.ResGroup_TDK,!0);uniLib.ResUtils.clearResConfigByGroupName([t.GameConstant.ResGroup_TDK]),console.error("销毁"+t.GameConstant.ResGroup_TDK+":"+e)}t.GameInfo.uiLayer=null,t.GameInfo.mainUILayer=null,t.GameInfo.topLayer=null,t.GameInfo.main=null},i.prototype.showMessageBox=function(){this.msgbox||(this.msgbox=new t.MsgBoxPanel),this.msgbox.setData("不能返回大厅，你要解散游戏么",["确定","取消"],[this.confirmHandel,this.cancelHandel],this),this.msgbox.x=uniLib.Global.screenWidth-this.msgbox.width>>1,this.msgbox.y=uniLib.Global.screenHeight-this.msgbox.height>>1,t.PopupManager.addPopUp(this.msgbox)},i.prototype.confirmHandel=function(e){var i=new Cmd.DissolveRoomRequestCmd_C;t.PokerFunction.tcpSend(i)},i.prototype.cancelHandel=function(t){this.removeTips()},i.prototype.removeTips=function(){this.msgbox&&(t.PopupManager.removePopUp(this.msgbox),this.msgbox=null)},i.prototype.changeStartVisable=function(){if(-1!=t.RoomData.Instance.roomPlayProps.indexOf(90)){if(t.RoomData.Instance.roomCurrentInnings>0)return void(this.startGameButton.visible=!1);if(uniLib.NetMgr.UID!=t.RoomData.Instance.startGameOpId)return void(this.startGameButton.visible=!1);for(var e=0,i=0,n=t.RoomData.Instance.seatList;i<n.length;i++){var a=n[i];if(a.user&&a.user.uid==t.RoomData.Instance.ownerId&&0==a.isReady)return void(this.startGameButton.visible=!1);1==a.isReady&&e++}e>=2?this.startGameButton.visible=!0:this.startGameButton.visible=!1}},i}(eui.Component);t.GameView=e,__reflect(e.prototype,"game.GameView")}(game||(game={}));var game;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.gspBgList=[],t.skinName=new GpsPanel_TDK_Skin,t.width=uniLib.Global.screenWidth,t.initUI(),t}return __extends(i,e),i.prototype.initUI=function(){this.updateGpsAdd(),this.closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeHandle,this);var e="",i=t.RoomData.Instance.getPlayTypeByList();if(i.length<=0)return void(this.ruleTxt.text="房主什么都没选择,你们随意");for(var n=0;n<i.length;n++)e=e+i[n]+"  ";this.ruleTxt.text=e},i.prototype.updataGroupVisible=function(t){this.ruleGroup.visible=t},i.prototype.updateGpsAdd=function(){var e=t.RoomData.Instance.playerNumber;this.gpsTips.visible=2==e?!0:!1,this.gpsGroup.visible=!1,this.gpsListGroup.visible=2==e?!1:!0},i.prototype.destory=function(){this.closeButton&&this.closeButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.closeHandle,this),uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this)},i.prototype.closeHandle=function(e){t.PopupManager.removePopUp(this)},i.prototype.addUserGpsListIcon=function(e){this.distanceGroup.width=142*(e.list.length-1),this.usernameColumnGroup.removeChildren(),this.usernameRowGroup.removeChildren(),this.distanceGroup.removeChildren();for(var i=0,n=this.gspBgList;i<n.length;i++){var a=n[i];a&&a.parent&&a.parent.removeChild(a)}for(var s=-1,o=0;o<e.list.length;o++){var r=t.PokerFunction.GetUserByUid(e.list[o].uid);if(r.uid!=uniLib.NetMgr.UID){s++;var h=new eui.Label(r.nickName);h.textColor=9395756,h.size=20,h.width=142,h.height=50,h.horizontalCenter=0,h.verticalCenter=0,h.verticalAlign="middle",h.textAlign="center",this.usernameColumnGroup.addChild(h);var d=new eui.Label(r.nickName);if(d.textColor=9395756,d.size=20,d.width=142,d.height=50,d.horizontalCenter=0,d.verticalCenter=0,d.verticalAlign="middle",d.textAlign="center",this.usernameRowGroup.addChild(d),s%2==0){var c=new eui.Image("room_TDK_bg2_png");c.height=50,c.left=0,c.right=0,this.gspBgList.push(c),0==s&&(c.top=72),2==s&&(c.top=172),4==s&&(c.top=272)}for(var l=0;l<e.list.length;l++){var u=t.PokerFunction.GetUserByUid(e.list[l].uid);if(u.uid!=uniLib.NetMgr.UID)if(u.uid!=r.uid){var p=new eui.Label("");p.size=20,p.width=142,p.height=50,p.horizontalCenter=0,p.verticalCenter=0,p.textAlign="center",p.textColor=9075052,p.verticalAlign="middle",this.distanceGroup.addChild(p);var m=-1;e.list[o].lat&&e.list[o].lng&&e.list[l].lat&&e.list[l].lng&&(m=Math.floor(uniLib.Utils.getDistance(e.list[o].lat,e.list[o].lng,e.list[l].lat,e.list[l].lng))),-1!=m?p.text=m>1e3?Math.floor(m/1e3)+"km":m.toString()+"m":p.text="!"}else{var c=new eui.Image("room_TDK_icon1");this.distanceGroup.addChild(c)}}}}},i}(eui.Component);t.GpsPanel=e,__reflect(e.prototype,"game.GpsPanel")}(game||(game={}));var game;!function(t){var e=function(e){function i(t){var i=e.call(this)||this;return i.m_selected=!1,i.m_darken=!1,i.m_cardId=t,i.addCard(),i.selectChanged(!1),i}return __extends(i,e),Object.defineProperty(i.prototype,"cardId",{get:function(){return this.m_cardId},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"selected",{get:function(){return this.m_selected},set:function(t){this.m_selected=t,this.selectChanged(t)},enumerable:!0,configurable:!0}),i.prototype.selectChanged=function(e){e?this.y=t.GameConstant.HandCardSelectY:this.y=t.GameConstant.HandCardY},Object.defineProperty(i.prototype,"darken",{get:function(){return this.m_darken},set:function(t){this.m_darken!=t&&(this.m_darken=t,this.darkenChanged(t))},enumerable:!0,configurable:!0}),i.prototype.darkenChanged=function(t){t?this.addDarken():this.removeDarken()},i.prototype.addDarken=function(){null==this.darkenImage&&(this.darkenImage=new egret.Bitmap(RES.getRes("Poker_dark"))),this.addChild(this.darkenImage)},i.prototype.addLordLogo=function(){this.lordLogo||(this.lordLogo=new egret.Bitmap(RES.getRes("lord"))),this.addChild(this.lordLogo),this.lordLogo.width=80,this.lordLogo.height=80,this.lordLogo.y=2,this.lordLogo.x=this.width-this.lordLogo.width-2},i.prototype.removeLordLogo=function(){this.lordLogo&&this.lordLogo.parent&&this.removeChild(this.lordLogo)},i.prototype.removeDarken=function(){this.darkenImage&&this.darkenImage.parent&&this.removeChild(this.darkenImage)},i.prototype.addCard=function(){var t=table.TablePokerCard.resNormal(this.cardId);this.card=new egret.Bitmap(RES.getRes(t)),this.addChildAt(this.card,0)},Object.defineProperty(i.prototype,"cardWidth",{set:function(t){this.card.width=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"cardHeight",{set:function(t){this.card.height=t},enumerable:!0,configurable:!0}),i.prototype.darkCard=function(){},i}(egret.DisplayObjectContainer);t.HandCardSprite=e,__reflect(e.prototype,"game.HandCardSprite")}(game||(game={}));var game;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.skinName=new Help_TDK_Skin,i.width=uniLib.Global.screenWidth,t.DataCache.gameInfo&&5105!=t.DataCache.gameInfo.gameId?(i.tdk_ld.visible=!0,i.tdk_lr.visible=!1):(i.tdk_ld.visible=!1,i.tdk_lr.visible=!0),i.specialCardLabel.visible=!1,-1!=t.RoomData.Instance.roomPlayProps.indexOf(10805)&&(i.bigKingLabel.text="大王=19",i.smallKingLabel.text="小王=17",i.specialCardLabel.visible=!0),i}return __extends(i,e),i.prototype.init=function(){e.prototype.init.call(this);var t=null;RES.hasRes("help_5050_txt")&&(t=RES.getRes("help_5050_txt"))},i.prototype.hide=function(){uniLib.PopUpMgr.removePopUp(this),this.dispatchEventWith(t.UIEventConsts.CLOSE),t.SoundHand.Instance.playButtonClick()},i.prototype.addEvent=function(){e.prototype.addEvent.call(this),this._close_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.hide,this)},i.prototype.removeEvent=function(){e.prototype.removeEvent.call(this),this._close_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.hide,this)},i.prototype.destory=function(){e.prototype.destroy.call(this),this._txt=null},i}(t.BaseEui);t.HelpPanel=e,__reflect(e.prototype,"game.HelpPanel")}(game||(game={}));var game;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.skinName=new MsgBox_TDK_Skin,t.init(),t}return __extends(n,e),n.prototype.init=function(){this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this)},n.prototype.setData=function(t,e,n,a,s,o){void 0===o&&(o=!0),this.desLabel.text=t,this.labelArray=e,this.funcArray=n,this._backObj=a,this.btnsGroup.removeChildren(),this.yesBtn=null,this.noBtn=null,1==e.length?(this.yesBtn=new i("","tdk_an_queding"),this.btnsGroup.addChild(this.yesBtn)):2==e.length&&(this.yesBtn=new i("","tdk_an_queding"),this.btnsGroup.addChild(this.yesBtn),this.noBtn=new i("","tdk_an_quxiao"),this.btnsGroup.addChild(this.noBtn)),this.funcArray&&this.funcArray[0]&&this.yesBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.funcArray[0],this._backObj),this.funcArray&&this.funcArray[1]&&this.noBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.funcArray[1],this._backObj),this.yesBtn&&this.yesBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.noBtn&&this.noBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.closeBtn.visible=o},n.prototype.onClose=function(e){t.PopupManager.removePopUp(this)},n.prototype.destroy=function(){this.closeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this)},n}(eui.Component);t.MsgBoxPanel=e,__reflect(e.prototype,"game.MsgBoxPanel");var i=function(t){function e(e,i){var n=t.call(this)||this;return n.skinName=new Button_TDK_Skin,n.labelDisplay.text=e,n.iconDisplay.source=i,n}return __extends(e,t),e}(eui.Button);t.GameButtonItem=i,__reflect(i.prototype,"game.GameButtonItem")}(game||(game={}));var game;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.skinName=new WaitingListPanel_TDK_Skin,t.width=uniLib.Global.screenWidth,t.userList.itemRenderer=i,t.addListener(),t}return __extends(n,e),Object.defineProperty(n,"instance",{get:function(){return null==this.m_instance&&(this.m_instance=new n),this.m_instance},enumerable:!0,configurable:!0}),n.clearInstance=function(){n.instance.removeListener(),this.m_instance=null},n.prototype.addListener=function(){this._close_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.OnClose,this)},n.prototype.removeListener=function(){this._close_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.OnClose,this)},n.prototype.OnClose=function(){egret.Tween.get(this.setGroup).to({x:-393},200).call(function(){return t.PopupManager.removePopUp(n.instance)}),this.removeListener()},n.prototype.OnOpen=function(){this.addListener(),this.setGroup.x=-393,t.PopupManager.addPopUp(n.instance,!1),egret.Tween.get(this.setGroup).to({x:0},200),this.updataSeatInfo()},n.prototype.updataSeatInfo=function(){this.userList.dataProvider=new eui.ArrayCollection(t.SeatLayer.Instance.seatSprites)},n}(eui.Component);t.PlayerListPanel=e,__reflect(e.prototype,"game.PlayerListPanel");var i=function(e){function i(){var t=e.call(this)||this;return t.skinName=new WaitingListItemPanel_TDK_Skin,t._kickBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,t.kickPerson,t),t}return __extends(i,e),i.prototype.dataChanged=function(){var t=this.data;this._nameLabel.text=t.seatData.user.nickName,this._sorceLabel.text=""+t.seatData.user.point,this._headImage.mask=this._headMask,this._headImage.source=t.seatData.user.headUrl,this.sendUid=t.seatData.user.uid,uniLib.NetMgr.UID==t.seatData.user.uid?this._kickBtn.visible=!1:this._kickBtn.visible=!0},i.prototype.kickPerson=function(){t.SoundHand.Instance.playButtonClick();var e=new Cmd.KickLeaveRoomCmd_C;e.uid=this.data.uid,uniLib.NetMgr.tcpSend(e)},i}(eui.ItemRenderer);__reflect(i.prototype,"PlayerListPanelItem")}(game||(game={}));var TDKLoadingView=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this.backgroud_bmp||(this.backgroud_bmp=MJLobby.LobbyResUtil.createBitmapByName("HZ_login_bg_png"),this.backgroud_bmp.width=uniLib.Global.screenWidth,this.backgroud_bmp.height=uniLib.Global.screenHeight,this.addChild(this.backgroud_bmp)),this.bigLogo||(this.bigLogo=MJLobby.LobbyResUtil.createBitmapByName("TDK_big_logo_png"),this.bigLogo.x=(uniLib.Global.screenWidth-this.bigLogo.width)/2,this.bigLogo.y=106,this.addChild(this.bigLogo)),this.darkLine_bmp||(this.darkLine_bmp=MJLobby.LobbyResUtil.createBitmapByName("lb_loading_darkLine",432,uniLib.Global.screenHeight-196*uniLib.ScreenUtils.scaleFactor),this.addChild(this.darkLine_bmp)),this.lightLine_bmp||(this.lightLine_bmp=MJLobby.LobbyResUtil.createBitmapByName("lb_loading_lightLine",this.darkLine_bmp.x+2,this.darkLine_bmp.y-10),this.lightLine_bmp.scale9Grid=new egret.Rectangle(12,18,10,2),this.addChild(this.lightLine_bmp)),this.explain_txf||(this.explain_txf=MJLobby.LobbyResUtil.createTextFeild(0,egret.HorizontalAlign.CENTER,"",22,500,uniLib.Global.screenHeight-171*uniLib.ScreenUtils.scaleFactor,276),this.addChild(this.explain_txf)),this._progTxt||(this._progTxt=MJLobby.LobbyResUtil.createTextFeild(0,egret.HorizontalAlign.CENTER,"",22,520,uniLib.Global.screenHeight-220*uniLib.ScreenUtils.scaleFactor,276),this.addChild(this._progTxt)),this._infoTxt||(this._infoTxt=MJLobby.LobbyResUtil.createTextFeild(0,egret.HorizontalAlign.CENTER,"抵制不良游戏 拒绝盗版游戏 注意自我保护 谨防受骗上当 适度游戏益脑 沉迷游戏伤身 合理安排时间 享受健康生活",20,0,uniLib.Global.screenHeight-44*uniLib.ScreenUtils.scaleFactor,MJLobby.LobbyDataCache.defaultWidth),this.addChild(this._infoTxt))},e.prototype.setProgress=function(t,i,n,a,s){if(void 0===s&&(s=!1),this._versionTxt||(this._versionTxt=MJLobby.LobbyResUtil.createTextFeild(10066329,egret.HorizontalAlign.RIGHT,MJLobby.LobbyDataCache.version,22,864),this._versionTxt.x=uniLib.Global.screenWidth-this._versionTxt.width,this._versionTxt.y=uniLib.Global.screenHeight-this._versionTxt.height,this.addChild(this._versionTxt),this._versionTxt.text=MJLobby.LobbyDataCache.version),i&&0!=i){var o=Math.ceil(t/i*100);n&&""!=n?this.explain_txf.text=n:this.explain_txf.text=e.explain,0==s&&o>93&&(o=93);var r=this.darkLine_bmp.width*(o/100)+27;this.lightLine_bmp.width=r,this.lightLine_bmp.width>this.darkLine_bmp.width&&(this.lightLine_bmp.width=this.darkLine_bmp.width),this._progTxt&&(this._progTxt.text=o+"%")}else this.explain_txf.text=n;this.explain_txf.x=(MJLobby.LobbyDataCache.defaultWidth-this.explain_txf.width)/2},e}(egret.Sprite);TDKLoadingView.explain="正在加载游戏资源...",__reflect(TDKLoadingView.prototype,"TDKLoadingView");var game;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.skinName=new RoundResult_TDK_Skin,t._shuffle_btn.visible=!1,t}return __extends(i,e),Object.defineProperty(i,"Instance",{get:function(){return i._instance||(i._instance=new i),i._instance},enumerable:!0,configurable:!0}),i.prototype.setData=function(t){this._shuffle_btn.visible=!1,this.showBtns(t),this.addEvent()},i.prototype.showBtns=function(e){var i=e.haveNextRound,n=t.RoomData.Instance.roomCurrentInnings,a=t.RoomData.Instance.roomTotalInnings;null!=n&&null!=a&&n==a||(i?(this._prepare_btn.visible=!0,this.showShuffleBtn(e.shuffleUid,e.shuffleCost)):this._prepare_btn.visible=!1),t.PokerData.isStandAlone&&(this._prepare_btn.visible=!0,this.showShuffleBtn(e.shuffleUid,e.shuffleCost)),t.DataManager.isInGame?(this._prepare_btn.visible=!0,this.showShuffleBtn(e.shuffleUid,e.shuffleCost)):this._prepare_btn.visible=!1},i.prototype.showShuffleBtn=function(t,e){t==uniLib.NetMgr.UID&&(this._shuffle_btn.visible=!0,this._shuffle_btn.cost.text=""+(e?e.toFixed(2):0))},i.prototype.gameFianlSettle=function(e){var i=new t.GameOverPanel;t.GameInfo.topLayer.addChild(i),i.x=uniLib.Global.screenWidth-i.width>>1,i.y=uniLib.Global.screenHeight-i.height>>1,i.setData(e)},i.prototype.prepare=function(t){this.sendReadyUpdateRoomMsg(!1)},i.prototype.shuffle=function(t){this.sendReadyUpdateRoomMsg(!0)},i.prototype.sendReadyUpdateRoomMsg=function(e){if(void 0===e&&(e=!1),null!=t.RoomData.Instance.fianlData)return this.gameFianlSettle(t.RoomData.Instance.fianlData),t.RoomData.Instance.fianlData=null,void this.clostPanel();var i=new Cmd.ReadyUpdateRoomCmd_CS;i.yesOrNo=!0,1==e&&(i.shuffle=1),t.PokerFunction.tcpSend(i)},i.prototype.clostPanel=function(){this.removeEvent(),t.GameInfo.topLayer.removeChild(this),t.GameView.Instance.restart(),t.CardSet.Instance.restart(),t.EffectCreate.Instance.removeResultEffect()},i.prototype.addEvent=function(){this._prepare_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.prepare,this),this._shuffle_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.shuffle,this)},i.prototype.removeEvent=function(){this._prepare_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.prepare,this),this._shuffle_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.shuffle,this)},i.prototype.destory=function(){egret.Tween.removeTweens(this)},i.prototype.showWinEffect=function(){!this.winEffect,this.addChildAt(this.winEffect,1),this.winEffect.x=400,this.winEffect.y=20,this.winEffect.play()},i}(eui.Component);t.RoundResultPanel=e,__reflect(e.prototype,"game.RoundResultPanel")}(game||(game={}));var game;!function(t){var e=function(e){function i(t){var i=e.call(this)||this;return i.m_seatData=t,i.addListener(),i.clientNoChanged(),i}return __extends(i,e),Object.defineProperty(i.prototype,"isInGame",{get:function(){return this.m_isInGame},set:function(t){this.m_isInGame=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"seatData",{get:function(){return this.m_seatData},enumerable:!0,configurable:!0}),i.prototype.addListener=function(){this.seatData.isInGameChanged.add(this.isInGameChanged,this),this.seatData.isSitChanged.add(this.isSitChanged,this),this.seatData.userChanged.add(this.userChanged,this),this.seatData.readyChanged.add(this.readyChanged,this),this.seatData.onlineChanged.add(this.onlineChangeHandel,this),t.RoomData.Instance.MainSeatChanged.add(this.clientNoChanged,this),1==t.RoomInfo.getInstance().video},i.prototype.removeListener=function(){this.seatData.isInGameChanged.remove(this.isInGameChanged),this.seatData.isSitChanged.remove(this.isSitChanged),this.seatData.userChanged.remove(this.userChanged),this.seatData.readyChanged.remove(this.readyChanged),t.RoomData.Instance.MainSeatChanged.remove(this.clientNoChanged),this.seatData.onlineChanged.remove(this.onlineChangeHandel)},Object.defineProperty(i.prototype,"clientNo",{get:function(){return this.m_clientNo},enumerable:!0,configurable:!0}),i.prototype.clientNoChanged=function(){if(this.m_clientNo=t.GameConstant.GetClientNoBySeatId(this.seatData.seatId),1==t.RoomInfo.getInstance().video&&(this.m_clientNo=this.seatData.seatId-1),t.DataManager.isInGame||null!=t.PokerFunction.MainSeat||(this.m_clientNo=this.seatData.seatId-1),!(null==this.clientNo||this.clientNo<0)){t.SeatLayer.Instance.addChild(this);var e=t.GameConstant.seatPosArr[this.clientNo];null!=e&&(this.x=e.x,this.y=e.y)}},i.prototype.onlineChangeHandel=function(e){1!=t.RoomInfo.getInstance().video&&(e==Cmd.OnlineState.OnlineState_Offline?this.m_userSprite.showOffline():this.m_userSprite.removeOffline())},i.prototype.onBetCountChange=function(e){null==this.betCountLable&&(this.betCountLable=new eui.Label,this.betCountLable.height=30,this.betCountLable.x=50,this.betCountLable.y=t.GameConstant.CardHeight),this.addChild(this.betCountLable),this.betCountLable.text="总投注数:"+(e?e:0)},i.prototype.readyChanged=function(e){if(!(null==this.clientNo||this.clientNo<0)){if(null==this.readyIcon){this.readyIcon=new egret.Bitmap(RES.getRes("player_ready"));var i=t.GameConstant.ReadyPos[this.clientNo];null!=i&&(this.readyIcon.x=i.x,this.readyIcon.y=i.y)}if(e?t.GameInfo.topLayer.addChild(this.readyIcon):this.readyIcon.parent&&t.GameInfo.topLayer.removeChild(this.readyIcon),this.seatData.user&&this.seatData.user.uid==uniLib.NetMgr.UID||1==t.RoomInfo.getInstance().video&&this.seatData.user.uid==t.RoomInfo.getInstance().videoUid){if(e){t.GameView.Instance.restart(),t.CardSet.Instance.restart();var n=t.RoundResultPanel.Instance;n&&n.parent&&n.clostPanel()}t.GameView.Instance.updataReadyButton(e)}TDK.EventManage.startVisableChanged.call()}},Object.defineProperty(i.prototype,"uid",{get:function(){return this.seatData.user?this.seatData.user.uid:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"user",{get:function(){return this.seatData.user?this.seatData.user:null},enumerable:!0,configurable:!0}),i.prototype.removeReadyIcon=function(){this.readyIcon&&this.readyIcon.parent&&this.readyIcon.parent.removeChild(this.readyIcon)},i.prototype.isInGameChanged=function(e){this.m_isInGame=e,this.seatData.user&&this.seatData.user.uid==uniLib.NetMgr.UID&&(t.DataManager.isInGame=e)},i.prototype.isSitChanged=function(e){this.visible=e,this.seatData.user&&this.seatData.user.uid==uniLib.NetMgr.UID&&(t.DataManager.isSitDown=e)},i.prototype.userChanged=function(t){t?this.addUser(t):this.removeUser()},i.prototype.addUser=function(e){this.removeUser(),this.m_userSprite||(this.m_userSprite=new t.UserSprite(e)),this.addChild(this.m_userSprite),this.countdownClrclr||(this.countdownClrclr=new CircleProgressBar(t.GameConstant.HeadWidth/2,3e4)),this.addChild(this.countdownClrclr)},i.prototype.removeUser=function(){this.m_userSprite&&this.m_userSprite.parent&&(this.removeChild(this.m_userSprite),this.m_userSprite.destroy(),this.m_userSprite=null),this.countdownClrclr&&this.countdownClrclr.parent&&(this.removeChild(this.countdownClrclr),this.countdownClrclr.destroy(),this.countdownClrclr=null)
},i.prototype.showCountdownCircle=function(t){this.countdownClrclr&&(this.countdownClrclr.visible=!0,this.countdownClrclr.startCountdown(1e3*t))},i.prototype.removCountdownCircle=function(){this.countdownClrclr&&(this.countdownClrclr.stopCountdown(),this.countdownClrclr.visible=!1)},i.prototype.resetUserSprite=function(){this.m_userSprite&&this.m_userSprite.resetHeadIcon()},i.prototype.destroy=function(){this.removeReadyIcon(),this.m_userSprite&&this.m_userSprite.removeListener(),this.removeListener()},i}(egret.Sprite);t.SeatSprite=e,__reflect(e.prototype,"game.SeatSprite")}(game||(game={}));var game;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.skinName=new Setting_TDK_Skin,t.width=uniLib.Global.screenWidth,t.addEvent(),t.init(),t}return __extends(i,e),Object.defineProperty(i,"instance",{get:function(){return null==this.m_instance&&(this.m_instance=new i),this.m_instance},enumerable:!0,configurable:!0}),i.clearInstance=function(){i.instance.removeEvent(),this.m_instance=null},i.prototype.addEvent=function(){this.musicSwitch.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickHandle,this),this.soundSwitch.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickHandle,this),this.musicSlider.addEventListener(eui.UIEvent.CHANGE,this.ChangeVolume,this),this.soundSlider.addEventListener(eui.UIEvent.CHANGE,this.ChangeVolume,this),this.closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.OnClick,this),this.refrenshButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.OnClick,this),this._backBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onDismiss,this),this.card1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.OnTableAndCardClick,this),this.card2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.OnTableAndCardClick,this)},i.prototype.removeEvent=function(){this.musicSwitch.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickHandle,this),this.soundSwitch.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickHandle,this),this.musicSlider.removeEventListener(eui.UIEvent.CHANGE,this.ChangeVolume,this),this.soundSlider.removeEventListener(eui.UIEvent.CHANGE,this.ChangeVolume,this),this.closeButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.OnClick,this),this.refrenshButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.OnClick,this),this._backBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onDismiss,this),this.card1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.OnTableAndCardClick,this),this.card2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.OnTableAndCardClick,this)},i.prototype.init=function(){this.width=uniLib.Global.screenWidth,this.soundSlider.maximum=10,this.musicSlider.maximum=10,uniLib.Utils.getLocalStorage("MusicVolime")&&(uniLib.SoundMgr.instance.musicVolume=uniLib.Utils.getLocalStorage("MusicVolime")),uniLib.Utils.getLocalStorage("SoundVolime")&&(uniLib.SoundMgr.instance.soundVolume=uniLib.Utils.getLocalStorage("SoundVolime")),this.soundSlider.value=10*uniLib.SoundMgr.instance.soundVolume,this.musicSlider.value=10*uniLib.SoundMgr.instance.musicVolume,this.updataSoundVolime(),this.updataMusicVolime(),this.updateCardCheck(),t.RoomData.Instance.roomType!=Cmd.RoomType.RoomType_Quick&&(this._backBtn.visible=!0,this.refrenshButton.horizontalCenter="162.5")},i.prototype.updataSoundVolime=function(){uniLib.SoundMgr.instance.soundOpen?this.soundSwitch.selected=!0:this.soundSwitch.selected=!1},i.prototype.updataMusicVolime=function(){uniLib.SoundMgr.instance.musicOpen?this.musicSwitch.selected=!0:this.musicSwitch.selected=!1},i.prototype.clickHandle=function(t){t.target==this.soundSwitch?this.soundSwitch.selected?(uniLib.SoundMgr.instance.soundVolume=1,uniLib.SoundMgr.instance.soundOpen=!0):(uniLib.SoundMgr.instance.soundVolume=0,uniLib.SoundMgr.instance.soundOpen=!1):t.target==this.musicSwitch&&(this.musicSwitch.selected?(uniLib.SoundMgr.instance.musicVolume=.7,uniLib.SoundMgr.instance.musicOpen=!0):(uniLib.SoundMgr.instance.musicVolume=0,uniLib.SoundMgr.instance.musicOpen=!1))},i.prototype.OnTableAndCardClick=function(t){(t.target==this.card1||t.target==this.card2)&&this.onCheckCard(t)},i.prototype.onCheckCard=function(e){RES.hasRes("buttonClick_mp3")&&uniLib.SoundMgr.instance.playSound("buttonClick_mp3"),e.target==this.card1?t.GameConstant.cardResStr="BackCard":e.target==this.card2&&(t.GameConstant.cardResStr="BackCard_red"),egret.localStorage.setItem("cardColor",t.GameConstant.cardResStr),t.CardSet.Instance.setCardColor()},i.prototype.updateCardCheck=function(){t.GameConstant.cardResStr=null==egret.localStorage.getItem("cardColor")?t.GameConstant.cardResStr:egret.localStorage.getItem("cardColor"),"BackCard"==t.GameConstant.cardResStr?this.card1.selected=!0:this.card2.selected=!0},i.prototype.OnClick=function(e){t.SoundHand.Instance.playButtonClick(),e.target==this.closeButton?(t.PopupManager.removePopUp(this),uniLib.Utils.setLocalStorage("SoundVolime",uniLib.SoundMgr.instance.soundVolume),uniLib.Utils.setLocalStorage("MusicVolime",uniLib.SoundMgr.instance.musicVolume)):e.target==this.refrenshButton&&uniLib.ZQGameSdk.getConfig("确定要更新游戏吗?","","确定","取消")},i.prototype.ChangeVolume=function(t){t.target==this.soundSlider?(uniLib.SoundMgr.instance.soundVolume=this.soundSlider.value/10,this.updataSoundVolime()):t.target==this.musicSlider&&(uniLib.SoundMgr.instance.musicVolume=this.musicSlider.value/10,this.updataMusicVolime())},i.prototype.onDismiss=function(e){t.PopupManager.removePopUp(this),this.dissRoom()},i.prototype.dissRoom=function(){this.msgBox&&(this.msgBox=null);var e=function(e){this.msgBox&&(t.GameInfo.topLayer.removeChild(this.msgBox),this.msgBox=null)};if(!this.msgBox){var i="你确定请求解散房间？";this.msgBox=new t.MsgBoxPanel,this.msgBox.x=uniLib.Global.screenWidth-this.msgBox.width>>1,this.msgBox.y=uniLib.Global.screenHeight-this.msgBox.height>>1,this.msgBox.setData(i,["确定","取消"],[this.confirmHandler,e])}t.GameInfo.topLayer.addChild(this.msgBox)},i.prototype.confirmHandler=function(e){this.msgBox&&(t.GameInfo.topLayer.removeChild(this.msgBox),this.msgBox=null);var i=new Cmd.DissolveRoomRequestCmd_C;t.PokerFunction.tcpSend(i)},i.prototype.getSoundData=function(){var e=new Cmd.SetInfo;return e.sound=uniLib.SoundMgr.instance.soundOpen,e.music=uniLib.SoundMgr.instance.musicOpen,e.control=t.GameData.getInstance().audioPlayMode,e},i.prototype.restartGame=function(t){uniLib.ZQGameSdk.getConfig("确定要更新游戏吗?","","确定","取消")},i}(eui.Component);t.SettingPanel=e,__reflect(e.prototype,"game.SettingPanel")}(game||(game={}));var game;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.skinName=new SelectCard_TDK_Panel,t.init(),t}return __extends(n,e),Object.defineProperty(n,"Instance",{get:function(){return null==this._instance&&(this._instance=new n),this._instance},enumerable:!0,configurable:!0}),n.TestPanel=function(){if(this._instance)throw new Error("Sington已经创建!")},n.prototype.init=function(){this.addListener(),this.create(),this.selectId=[]},n.prototype.create=function(){this.touchChildren=!0,this.touchEnabled=!0,uniLib.Global.debugLevel>=1&&this.setGameButton()},n.prototype.addListener=function(){this._cardList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.cardListClickHandel,this)},n.prototype.removeListener=function(){this._cardList.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.cardListClickHandel,this)},n.prototype.cardListClickHandel=function(t){if(!(this.selectId.length>=5)){for(var e=0,i=this.selectId;e<i.length;e++){var n=i[e];if(n==t.item)return}this.selectId.push(t.item),this.refrenshSelected(),this.setItemVisible(t.item,!1)}},n.prototype.setItemVisible=function(t,e){var i=t+"";this._cardList.getChildByName(i).visible=e},n.prototype.refrenshSelected=function(){this.selectedCards.itemRenderer=i,this.selectedCards.dataProvider=new eui.ArrayCollection(this.selectId)},n.prototype.initCardList=function(){this.cardList=[];for(var t=3;15>t;t++)for(var e=100*t,n=1;5>n;n++){var a=e+10*n;a+=1,this.cardList.push(a)}this.cardList.push(1611),this.cardList.push(1621),this.cardList.push(1631),this.cardList.push(1641),this.cardList.push(2051),this.cardList.push(2151),this._cardList.itemRenderer=i,this._cardList.dataProvider=new eui.ArrayCollection(this.cardList)},n.prototype.setCardList=function(t){this.cardList=new Array,this.cardList=t,this.cardList.sort(function(t,e){return t-e}),this._cardList.itemRenderer=i,this._cardList.dataProvider=new eui.ArrayCollection(this.cardList)},n.prototype.setGameButton=function(){this.cardButtonArr=["确定","取消","重选","删除","结束"],this.buttonList.itemRenderer=i,this.buttonList.dataProvider=new eui.ArrayCollection(this.cardButtonArr),this.buttonList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.buttonClickHandel,this)},n.prototype.buttonClickHandel=function(e){switch(e.itemIndex){case 0:if(this.selectId.length<1)return;var i=new Cmd.GmSelectCardCmd_C;i.cardList=this.selectId,t.PokerFunction.tcpSend(i),t.GameInfo.topLayer.removeChild(this),this.selectId.clear(),this.refrenshSelected(),this.dispose();break;case 1:t.GameInfo.topLayer.removeChild(this),this.dispose();break;case 2:this.selectId.clear(),this.refrenshSelected();for(var n=0;n<this.cardList.length;n++)this._cardList.getChildByName(this.cardList[n]+"").visible||this.setItemVisible(this.cardList[n],!0);break;case 3:if(this.selectId.length<1)return;var a=this.selectId.pop();this.setItemVisible(a,!0),this.refrenshSelected();break;case 4:var s=new Cmd.GmFinishRoundCmd_C;t.PokerFunction.tcpSend(s),t.GameInfo.topLayer.removeChild(this),this.dispose()}},n.prototype.dispose=function(){this.removeListener(),this.cardList=[],this.selectId=[]},n}(eui.Component);t.TestPanel=e,__reflect(e.prototype,"game.TestPanel");var i=function(t){function e(){var e=t.call(this)||this;return e.skinName=new CardItem_TDK_Skin,e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;isNaN(t)?(this.cardName.text=t,this.background.fillColor=16776960):this.cardName.text=table.TablePokerCard.cardName(t),this.name=t+""},e}(eui.ItemRenderer);t.CardItem=i,__reflect(i.prototype,"game.CardItem")}(game||(game={}));var game;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.skinName=new UserInfoPanel_TDK_Skin,t.init(),t}return __extends(n,e),n.prototype.init=function(){1065==MJLobby.MJLobbyData.getInstance().lobbyId&&(this._diamondTxt.visible=!1),this._giftItemArr=[];for(var t,e=this.table(),n=e.filter(function(t){return"砖头"!=t.giftName&&"炸弹"!=t.giftName}),a=0;a<n.length;a++)6!==a&&(t=new i,t.data=n[a],this._giftItemArr[n[a].giftId]=t,t.x=390+120*a,6===a&&(t.x=525),t.y=395,this.addChild(t),t.touchEnabled=!0,t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickGift,this));this.addListener()},n.prototype.table=function(){var t;return t=loadTable("TDKTableGift_json")},n.prototype.kickPerson=function(){t.SoundHand.Instance.playButtonClick();var e=new Cmd.KickLeaveRoomCmd_C;e.uid=this._data.uid,uniLib.NetMgr.tcpSend(e),this.onCloseHandle()},n.prototype.onCloseHandle=function(){t.PopupManager.removePopUp(this),this.destory()},n.prototype.onClickGift=function(e){if(!t.DataManager.isSitDown)return void t.PublicManage.getInstance().showMildWarnShow("未坐下不能送礼");if(t.SoundHand.Instance.playButtonClick(),this._data.uid==uniLib.NetMgr.UID)return void t.PublicManage.getInstance().showMildWarnShow("不能给自己送礼物");var i=e.currentTarget,n=new Cmd.SendGiftRoomCmd_C,a=new Cmd.GiftsInfo;a.giftsId=i.data.giftId,a.toUid=this._data.uid,a.fromUid=uniLib.NetMgr.UID,a.giftsNum=1,n.gift=a,t.PokerFunction.tcpSend(n),this.onCloseHandle()},n.prototype.addListener=function(){uniLib.NetMgr.UID==t.RoomData.Instance.ownerId,uniLib.Global.addEventListener(uniLib.ZqEvent.EVENT_L2G,this.diamondChange,this),this.closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseHandle,this)},n.prototype.removeListener=function(){uniLib.Global.removeEventListener(uniLib.ZqEvent.EVENT_L2G,this.diamondChange,this),this.closeButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseHandle,this),uniLib.NetMgr.UID==t.RoomData.Instance.ownerId;var e=table.TableGift.instance();if(e)for(var n=0;n<e.length;n++){var a=new i;a.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickGift,this),a.destory()}},n.prototype.setData=function(e){this._data=e;var i="dlm_g_nv";"男"==e.gender&&(i="dlm_g_nan"),this._genderIcon.source=i,this._idTxt.text=e.uid.toString(),this._nickTxt.text=e.nickName,void 0!=e.ip&&(this._ipTxt.text=e.ip),void 0!=e.diamond&&(this._diamondTxt.text=Math.floor(e.diamond)+"");for(var n=0;6>n;n++)this._giftItemArr[n+1]&&this._giftItemArr[n+1].setFlowerNum(0);if(e.flower instanceof Array)for(var n=0;n<e.flower.length;n++)this._giftItemArr[e.flower[n].id].setFlowerNum(e.flower[n].num);this._headMc.mask=this._headMask,this._headMc.source=e.headUrl;var a=t.PokerFunction.GetUserInfoByUid(uniLib.NetMgr.UID);if(e.lat&&e.lng&&a.latitude&&a.longitude){var s=Math.floor(uniLib.Utils.getDistance(e.lat,e.lng,a.latitude,a.longitude));if(s){var o="";o=s>1e3?"距离："+Math.floor(s/1e3)+"km":"距离："+s.toString()+"m",this._disTxt.text=o}}else this._disTxt.text="距离：距离未知";e.address?this._posTxt.text="位置："+e.address:this._posTxt.text="位置：未获取到位置"},n.prototype.diamondChange=function(t){"diamondChange"==t.param&&Number(this._idTxt.text)===uniLib.UserInfo.uid&&(this._diamondTxt.text=Math.floor(uniLib.UserInfo.chips)+"")},n.prototype.destory=function(){this.removeListener(),this._data=null},n}(eui.Component);t.UserInfoPanel=e,__reflect(e.prototype,"game.UserInfoPanel");var i=function(e){function i(){return e.call(this)||this}return __extends(i,e),i.prototype.initUI=function(){this._testBg=new egret.Bitmap(RES.getRes("testBg")),this._testBg.y=110,this._testBg.x=35,this._nameTxt=t.ResUtil.createTextFeild(419190,egret.HorizontalAlign.CENTER,"",20,5,110,100)},Object.defineProperty(i.prototype,"data",{get:function(){return this._data},set:function(e){this._nameTxt.text="0",this._giftIcon||(this._giftIcon=t.ResUtil.createBitmapByName("userInfo_freegift_TDK"+e.giftId,2,0),this.addChildAt(this._giftIcon,0)),this._data=e,this.name=e.giftId.toString()},enumerable:!0,configurable:!0}),i.prototype.setFlowerNum=function(t){this._nameTxt.text=t.toString(),this._nameTxt.x=this._testBg.x+(this._testBg.width-this._nameTxt.width)/2},i.prototype.destory=function(){uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this),this._data=null,this._nameTxt=null},i}(t.BaseVc);t.GiftItem=i,__reflect(i.prototype,"game.GiftItem")}(game||(game={}));var game;!function(t){var e=function(e){function i(t){var i=e.call(this)||this;return i.m_user=t,i.addListener(),i.touchEnabled=!0,i.touchChildren=!1,i}return __extends(i,e),Object.defineProperty(i.prototype,"user",{get:function(){return this.m_user},enumerable:!0,configurable:!0}),i.prototype.destroy=function(){this.removeListener()},i.prototype.addListener=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.requestUserInfo,this),this.user.headUrlChanged.add(this.changedHead,this),this.user.nameChanged.add(this.nameChanged,this),this.user.pointChanged.add(this.pointChanged,this),this.user.trustStateChanged.add(this.trustChanged,this)},i.prototype.removeListener=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.requestUserInfo,this),this.user.headUrlChanged.remove(this.changedHead,this),this.user.nameChanged.remove(this.nameChanged,this),this.user.pointChanged.remove(this.pointChanged,this),this.user.trustStateChanged.remove(this.trustChanged,this)},i.prototype.changedHead=function(){null==this._headMc&&(this._headMc=new t.PokerHead(t.GameConstant.HeadWidth,t.GameConstant.HeadHeight),this._headMc.x=0,this._headMc.y=0,this._headMc.touchEnabled=!0,this.addChild(this._headMc)),null!=this.user.headUrl&&(this._headMc.headUrl=this.user.headUrl)},i.prototype.showRoomOwner=function(){this.roomOwner||(this.roomOwner=new egret.Bitmap(RES.getRes("room_owner")),this.roomOwner.name="roomOwner"),this.user.uid==t.RoomData.Instance.ownerId&&(this._headMc.addChild(this.roomOwner),this.roomOwner.x=0,this.roomOwner.y=0)},i.prototype.removeRoomOwner=function(){this.roomOwner&&this.roomOwner.parent&&this._headMc.removeChild(this.roomOwner)},i.prototype.showOffline=function(){this.offLine||(this.offLine=new egret.Bitmap(RES.getRes("user_dropped_icon"))),this._headMc.addChild(this.offLine),this.offLine.width=t.GameConstant.HeadWidth,this.offLine.height=t.GameConstant.HeadHeight,this.offLine.x=(this._headMc.width-this.offLine.width)/2,this.offLine.y=(this._headMc.height-this.offLine.height)/2,this._headMc.setPlayerIconMask(this.offLine)},i.prototype.removeOffline=function(){this.offLine&&this.offLine.parent&&this.offLine.parent.removeChild(this.offLine),this.offLine=null},i.prototype.resetHeadIcon=function(){this.changedHead(),this.removeOffline()},i.prototype.addInfoGroup=function(){this.infoGroup||(this.infoGroup=new eui.Component,this.infoGroup.skinName=new InfoGroup_TDK_Skin,this.infoGroup.x=(t.GameConstant.HeadWidth-this.infoGroup.width)/2,this.infoGroup.y=t.GameConstant.HeadHeight+5,this.addChild(this.infoGroup))},i.prototype.nameChanged=function(){this.addInfoGroup(),this.infoGroup.skin.nameLabel.text=this.user.nickName},i.prototype.pointChanged=function(){return this.addInfoGroup(),this.infoGroup.skin.scoreLabel.text=null==this.user.point?"0":(this.user.point%1==0?this.user.point:this.user.point.toFixed(2))+"",1==t.RoomInfo.getInstance().video?void(this.user.uid==t.RoomInfo.getInstance().videoUid&&t.GameView.Instance.showMyChips(this.user.point)):void(this.user.uid==uniLib.NetMgr.UID&&t.GameView.Instance.showMyChips(this.user.point))},i.prototype.trustChanged=function(){this.user.isTrust?this.showTrustState():this.removeTrustState(),(1==t.RoomInfo.getInstance().video&&this.user.uid==t.RoomInfo.getInstance().videoUid||this.user.uid==uniLib.NetMgr.UID)&&t.GameView.Instance.setcancelTrustBtn(this.user.isTrust)},i.prototype.showTrustState=function(){this.trustImage||(this.trustImage=new egret.Bitmap(RES.getRes("user_ai_icon"))),this._headMc.addChild(this.trustImage),this.trustImage.x=(this._headMc.width-this.trustImage.width)/2,this.trustImage.y=(this._headMc.height-this.trustImage.height)/2-9},i.prototype.removeTrustState=function(){this.trustImage&&this.trustImage.parent&&(this._headMc.removeChild(this.trustImage),this.trustImage=null)},i.prototype.requestUserInfo=function(e){var i=new Cmd.GetPersonalPanel_C;i.uid=this.user.uid,t.PokerFunction.tcpSend(i)},i}(egret.Sprite);t.UserSprite=e,__reflect(e.prototype,"game.UserSprite")}(game||(game={}));var game;!function(t){var e=function(e){function i(){return e.call(this)||this}return __extends(i,e),i.prototype.initUI=function(){this._mask=new egret.Sprite,this._mask.graphics.beginFill(0,.01),this._mask.graphics.drawRect(0,0,t.DataCache.defaultWidth,t.DataCache.defaultHeight),this._mask.graphics.endFill(),this._mask.touchEnabled=!0,this.addChild(this._mask);var e=uniLib.DisplayUtils.createBitmapByName("video_bg_TDK");this.addChild(e),e.y=uniLib.Global.screenHeight/2+e.height/2,e.x=uniLib.Global.screenWidth/2-e.width/2,this._backBtn=new t.GameButton(["video_back1_TDK","video_back2_TDK"]),this.addChild(this._backBtn),this._backBtn.name="back",this._stopBtn=new t.GameButton(["video_stop1_TDK","video_stop2_TDK"]),this.addChild(this._stopBtn),this._stopBtn.name="stop",this._advanceBtn=new t.GameButton(["video_advance1_TDK","video_advance2_TDK"]),this.addChild(this._advanceBtn),this._advanceBtn.name="advance",this._closeBtn=new t.GameButton(["video_close1_TDK","video_close2_TDK"]),this.addChild(this._closeBtn),this._closeBtn.name="close",this._backBtn.x=e.x+2,this._stopBtn.x=this._backBtn.x+this._backBtn.width+5,this._advanceBtn.x=this._stopBtn.x+this._stopBtn.width+5,this._closeBtn.x=this._advanceBtn.x+this._advanceBtn.width+3,this._backBtn.y=this._stopBtn.y=this._advanceBtn.y=this._closeBtn.y=e.y+5,this._backBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),this._stopBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),this._advanceBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),this._closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this)},i.prototype.btnClick=function(e){var i=e.currentTarget.name;switch(i){case"back":uniLib.Global.dispatchEvent(uniLib.ZqEvent.EVENT_G2L,"video_back");break;case"stop":uniLib.Global.dispatchEvent(uniLib.ZqEvent.EVENT_G2L,"video_stop");break;case"advance":uniLib.Global.dispatchEvent(uniLib.ZqEvent.EVENT_G2L,"video_advance");break;case"close":t.GameView.Instance.showVideoFinish(1)}},i.prototype.destory=function(){this._backBtn&&(this._backBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),this._backBtn=null),this._stopBtn&&(this._stopBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),this._stopBtn=null),this._advanceBtn&&(this._advanceBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),this._advanceBtn=null),this._closeBtn&&(this._closeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),this._closeBtn=null),uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this)},i}(t.BaseVc);t.VideoPanel=e,__reflect(e.prototype,"game.VideoPanel")}(game||(game={}));var TDKMain=function(t){function e(e){var i=t.call(this,e)||this;return i.isThemeLoadEnd=!1,game.GameViewConfig.mainMediatorName=uniLib.getQualifiedClassName(game.TDKPokerMediator),"false"==uniLib.BrowersUtils.GetRequest("cacheres")&&(RES.web.Html5VersionController.prototype.getVirtualUrl=function(t){return t+="?v="+Math.random()}),uniLib.Global.lobbyMode||(game.DataCache.platParam={}),i._gameInfo&&(game.DataCache.gameInfo=i._gameInfo),e&&e.destroyResOnExit&&(game.DataCache.destroyResOnExit=e.destroyResOnExit),i._gameInfo&&i._gameInfo.extData&&(game.DataCache.platParam=i._gameInfo.extData),console.error("是否是新的房间数据:"+game.RoomData.Instance.seatList.length),i._gameInfo&&i._gameInfo.extData&&i._gameInfo.extData.video?(game.RoomInfo.getInstance().video=i._gameInfo.extData.video,game.RoomInfo.getInstance().videoUid=i._gameInfo.extData.videoUid):(game.RoomInfo.getInstance().video=0,game.RoomInfo.getInstance().videoUid=0),MJLobby.MJLobbyData.ShowGameLoading&&(uniLib.UIMgr.instance.showLoadingTimeout(TDKLoadingView),uniLib.UIMgr.instance.commonLoadUI=TDKLoadingView),game.GameData.iskPoker=!0,game.PokerFunction.handCardSort=function(t){return t},i}return __extends(e,t),e.prototype.start=function(t){void 0===t&&(t=null);var e={};e.designWidth=1280,e.designHeight=720,e.debug=!0,uniLib.init(e),MJLobby.ScreenFixedUtils.instance.init(egret.StageScaleMode.FIXED_HEIGHT),RES.setMaxLoadingThread(6);var i=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",i),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/TDK.res.json","resource/")},e.prototype.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var e=new eui.Theme("resource/default.thm.json",this.stage);e.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this)},e.prototype.onThemeLoadComplete=function(){this.preLoadEnd()},e.prototype.preLoadEnd=function(){uniLib.UIMgr.instance.showProcessBar(null,2,100,"正在加载游戏资源..."),uniLib.Global.lobbyMode?uniLib.ResLoadMgr.instance.load(game.GameConstant.ResGroup_TDK,this.startCreateScene,this.onItemLoadError,this,null):uniLib.ResLoadMgr.instance.load("gameCommon",this.loadGameRes,null,this,null)},e.prototype.loadGameRes=function(){uniLib.UIMgr.instance.showProcessBar(null,2,100,"正在加载游戏资源..."),uniLib.ResLoadMgr.instance.load(game.GameConstant.ResGroup_TDK,this.startCreateScene,this.onItemLoadError,this,null)},e.prototype.onItemLoadError=function(t){console.warn("Url:"+t.groupName+"..."+t.itemsLoaded+"..."+t.itemsTotal+" has failed to load")},e.prototype.startCreateScene=function(){game.DataCache.langObj=JSON.parse(RES.getRes("TDK_GameTxt_cn_txt")),game.GameInfo.manage=game.PublicManage.getInstance(),game.DataCache.stageWidth=uniLib.Global.screenWidth,game.DataCache.stageHight=uniLib.Global.screenHeight,uniLib.UIMgr.instance.hideLoading(),uniLib.SceneMgr.instance.changeScene(game.PokerGameScene),new TDK.EventManage,game.SoundHand.Instance.playTDKBg()},e}(uniLib.GameDoc);__reflect(TDKMain.prototype,"TDKMain");var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,i,n){function a(t){e.call(n,t)}function s(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),i.call(n))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),RES.getResByUrl(t,a,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);