var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},game;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.skinName=new Setting_ZJH_Skin,e.addEvent(),e.init(),e}return __extends(n,t),Object.defineProperty(n,"instance",{get:function(){return null==this.m_instance&&(this.m_instance=new n),this.m_instance},enumerable:!0,configurable:!0}),n.clearInstance=function(){n.instance.removeEvent(),this.m_instance=null},n.prototype.addEvent=function(){this.musicSwitch.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickHandle,this),this.soundSwitch.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickHandle,this),this.musicSlider.addEventListener(eui.UIEvent.CHANGE,this.ChangeVolume,this),this.soundSlider.addEventListener(eui.UIEvent.CHANGE,this.ChangeVolume,this),this.closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.OnClick,this),this.refrenshButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.OnClick,this)},n.prototype.removeEvent=function(){this.musicSwitch.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickHandle,this),this.soundSwitch.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickHandle,this),this.musicSlider.removeEventListener(eui.UIEvent.CHANGE,this.ChangeVolume,this),this.soundSlider.removeEventListener(eui.UIEvent.CHANGE,this.ChangeVolume,this),this.closeButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.OnClick,this),this.refrenshButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.OnClick,this)},n.prototype.init=function(){this.width=uniLib.Global.screenWidth,this.soundSlider.maximum=10,this.musicSlider.maximum=10,uniLib.Utils.getLocalStorage("MusicVolime")&&(uniLib.SoundMgr.instance.musicVolume=uniLib.Utils.getLocalStorage("MusicVolime")),uniLib.Utils.getLocalStorage("SoundVolime")&&(uniLib.SoundMgr.instance.soundVolume=uniLib.Utils.getLocalStorage("SoundVolime")),this.soundSlider.value=10*uniLib.SoundMgr.instance.soundVolume,this.musicSlider.value=10*uniLib.SoundMgr.instance.musicVolume,this.updataSoundVolime(),this.updataMusicVolime()},n.prototype.updataSoundVolime=function(){uniLib.SoundMgr.instance.soundOpen?this.soundSwitch.selected=!0:this.soundSwitch.selected=!1},n.prototype.updataMusicVolime=function(){uniLib.SoundMgr.instance.musicOpen?this.musicSwitch.selected=!0:this.musicSwitch.selected=!1},n.prototype.clickHandle=function(e){e.target==this.soundSwitch?this.soundSwitch.selected?uniLib.SoundMgr.instance.soundOpen=!0:uniLib.SoundMgr.instance.soundOpen=!1:e.target==this.musicSwitch&&(this.musicSwitch.selected?uniLib.SoundMgr.instance.musicOpen=!0:uniLib.SoundMgr.instance.musicOpen=!1)},n.prototype.OnClick=function(t){e.SoundHand.Instance.playButtonClick(),t.target==this.closeButton?(GX.PopUpManager.removePopUp(this,GX.PopUpEffect.CENTER),uniLib.Utils.setLocalStorage("SoundVolime",uniLib.SoundMgr.instance.soundVolume),uniLib.Utils.setLocalStorage("MusicVolime",uniLib.SoundMgr.instance.musicVolume)):t.target==this.refrenshButton&&(window.location.href=window.location.href.replace("code",""))},n.prototype.ChangeVolume=function(e){e.target==this.soundSlider?(uniLib.SoundMgr.instance.soundVolume=this.soundSlider.value/10,this.updataSoundVolime()):e.target==this.musicSlider&&(uniLib.SoundMgr.instance.musicVolume=this.musicSlider.value/10,this.updataMusicVolime())},n.prototype.dissRoom=function(){this.msgBox&&(this.msgBox=null);var t=function(t){this.msgBox&&(e.GameInfo.topLayer.removeChild(this.msgBox),this.msgBox=null)};if(!this.msgBox){var n="你确定请求解散房间？";this.msgBox=new e.MsgBoxPanel,this.msgBox.x=uniLib.Global.screenWidth-this.msgBox.width>>1,this.msgBox.y=uniLib.Global.screenHeight-this.msgBox.height>>1,this.msgBox.setData(n,["确定","取消"],[this.confirmHandler,t])}e.GameInfo.topLayer.addChild(this.msgBox)},n.prototype.confirmHandler=function(t){this.msgBox&&(e.GameInfo.topLayer.removeChild(this.msgBox),this.msgBox=null);var n=new Cmd.DissolveRoomRequestCmd_C;e.PokerFunction.tcpSend(n)},n.prototype.getSoundData=function(){var t=new Cmd.SetInfo;return t.sound=uniLib.SoundMgr.instance.soundOpen,t.music=uniLib.SoundMgr.instance.musicOpen,t.control=e.GameData.getInstance().audioPlayMode,t},n.prototype.restartGame=function(e){uniLib.ZQGameSdk.getConfig("确定要更新游戏吗?","","确定","取消")},n}(eui.Component);e.SettingPanel=t,__reflect(t.prototype,"game.SettingPanel")}(game||(game={}));var AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,n){function i(i){t.call(n,i,e)}if(RES.hasRes(e)){var a=RES.getRes(e);a?i(a):RES.getResAsync(e,i,this)}else RES.getResByUrl(e,i,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var game;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.isStartMove=!1,e.startX=0,e.selectedCard=new Array,e.fenList=new Array,e.handCardList=new Array,e.catchHandCardList=new Array,e.commonCardList=new Array,e.touchEnabled=!0,e.addListener(),e}return __extends(n,t),Object.defineProperty(n,"Instance",{get:function(){return null==this.m_Instance&&(this.m_Instance=new n),this.m_Instance},enumerable:!0,configurable:!0}),n.clearInstance=function(){this.m_Instance=null},n.prototype.destroy=function(){this.removeListener(),n.clearInstance()},n.prototype.addListener=function(){e.RoomData.Instance.startGameChanged.add(this.startGameChanged,this),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onCardTouch,this),this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onCardTouch,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.onCardTouch,this),this.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onCardTouch,this),GX.PokerEvent.Instance.bottomCardUpdate.add(this.addCommonCard,this)},n.prototype.removeListener=function(){e.RoomData.Instance.startGameChanged.remove(this.startGameChanged),this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onCardTouch,this),this.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onCardTouch,this),this.removeEventListener(egret.TouchEvent.TOUCH_END,this.onCardTouch,this),this.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onCardTouch,this)},n.prototype.startGameChanged=function(){if(1!=e.RoomInfo.getInstance().video){for(var t=0,n=e.RoomData.Instance.seatList;t<n.length;t++){var i=n[t];i.addHandCardEvent.removeAll(),i.delectHandCardEvent.removeAll(),i.outCardChanged.removeAll()}if(e.RoomData.Instance.startGame){var a=e.PokerFunction.MainSeat;if(null==a)return;a.addHandCardEvent.add(this.addHandCard,this),a.outCardChanged.add(this.outCardChanged,this);for(var o=0,s=e.SeatLayer.Instance.seatSprites;o<s.length;o++){var i=s[o];i.removeReadyIcon()}}}else if(e.RoomData.Instance.startGame)for(var r=0,h=e.SeatLayer.Instance.seatSprites;r<h.length;r++){var i=h[r];i.removeReadyIcon()}},n.prototype.onCardTouch=function(e){if(e.type==egret.TouchEvent.TOUCH_BEGIN)this.isStartMove=!0,this.startX=e.stageX,this.onMoveTouch(this.startX,e.stageX);else if(e.type==egret.TouchEvent.TOUCH_MOVE){if(!this.isStartMove)return;this.onMoveTouch(this.startX,e.stageX)}else if(e.type==egret.TouchEvent.TOUCH_END||e.type==egret.TouchEvent.TOUCH_RELEASE_OUTSIDE){if(!this.isStartMove)return;this.isStartMove=!1,this.onEndTouch(this.startX,e.stageX)}},n.prototype.onMoveTouch=function(t,n){for(var i=this.handCardList.length,a=this.touchIndex(t,n),o=0;i>o;o++){var s=this.handCardList[o];o>=a.min&&o<=a.max?s.darken||(s.darken=!0,e.SoundHand.Instance.playCardClick()):s.darken&&(s.darken=!1,e.SoundHand.Instance.playCardClick())}},n.prototype.onEndTouch=function(e,t){this.selectedCard.clear();for(var n=this.touchIndex(e,t),i=this.handCardList.length,a=[],o=0;i>o;o++)this.handCardList[o].darken=!1,o>=n.min&&o<=n.max&&(this.handCardList[o].selected=!this.handCardList[o].selected,this.selectedCard.push(this.handCardList[o])),this.handCardList[o].selected&&a.push(this.handCardList[o])},n.prototype.resetCardPosition=function(){for(var e=0,t=this.handCardList;e<t.length;e++){t[e]}},n.prototype.touchIndex=function(t,n){var i=this.handCardList.length,a=this.handCardX,o=(this.handCardWidth,Math.floor((t-a)/e.GameConstant.CardGap));o=0>o?0:o>i-1?i-1:o;var s=Math.floor((n-a)/e.GameConstant.CardGap);s=0>s?0:s>i-1?i-1:s;var r=s>o?o:s,h=o>s?o:s;return{min:r,max:h}},Object.defineProperty(n.prototype,"handCards",{get:function(){return this.handCardList},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"catchHandCards",{get:function(){return this.catchHandCardList},enumerable:!0,configurable:!0}),n.prototype.addHandCard=function(t,n){if(!this.handCards.seek(function(e){return e.cardId==t}))if(n==e.CardActionType.INIT){e.DataManager.isInGame=!0;var i=new e.HandCardSprite(t);i.touchEnabled=!0,i.touchChildren=!1,this.handCardList.push(i)}else if(n==e.CardActionType.ADD){var a=new e.HandCardSprite(t);a.touchEnabled=!0,a.touchChildren=!1,this.addChild(a),this.handCardList.push(a),this.catchHandCardList.push(a),a.visible=!1,e.RoomData.Instance.shuffleUid?uniLib.SetUniEventTimeout(e.GameView.Instance,function(){a.visible=!0},e.GameConstant.ShuffleEffectTime,1,this,null):a.visible=!0}else if(n==e.CardActionType.RECONNEC){this.delectHandCard(t),e.DataManager.isInGame=!0;var i=new e.HandCardSprite(t);i.touchEnabled=!0,i.touchChildren=!1,this.addChild(i),this.handCardList.push(i),this.updataHandCardPosition()}},n.prototype.delectHandCard=function(e){var t=this.handCardList.first(function(t){return t.cardId==e});null!=t&&null!=t.parent&&(this.removeChild(t),this.handCardList.deletefirst(function(e){return e==t}))},n.prototype.clearHandCard=function(){for(var e=0;e<this.handCardList.length;e++)this.handCardList[e].parent&&this.handCardList[e].parent.removeChild(this.handCardList[e]);for(var e=0;e<this.catchHandCardList.length;e++)this.catchHandCardList[e].parent&&this.catchHandCardList[e].parent.removeChild(this.catchHandCardList[e]);this.catchHandCardList.clear(),this.handCardList.clear()},Object.defineProperty(n.prototype,"commonCards",{get:function(){return this.commonCardList},enumerable:!0,configurable:!0}),n.prototype.addCommonCard=function(t){if(t&&t)for(var n=0;n<t.length;n++){var i=table.TablePokerCard.resNormal(t[n]),a=new egret.Bitmap(RES.getRes(i));a.height=a.height/10*6,a.width=a.width/10*6,e.DataManager.isDeZhou?a.x=(1280-a.width)/2+100:a.x=(1280-a.width)/2,a.y=265,this.addChild(a),this.commonCardList.push(a)}},n.prototype.deleteCommonCards=function(){for(var e=this,t=0;t<this.commonCards.length;t++)this.commonCards[t].parent&&(this.commonCards[t].parent.removeChild(this.commonCards[t]),this.handCardList.deletefirst(function(n){return n==e.commonCards[t]}))},n.prototype.handCardsForbidOp=function(){for(var e=0,t=this.handCards;e<t.length;e++){var n=t[e];n.darken=!0}this.touchEnabled=!1,this.touchChildren=!1},n.prototype.handCardsAllowOp=function(){for(var t=e.PokerFunction.GetUserInfoByUid(uniLib.NetMgr.UID),n=0,i=this.handCards;n<i.length;n++){var a=i[n];t&&t.isTrust?(a.darken=!0,this.touchEnabled=!1,this.touchChildren=!1):(a.darken=!1,this.touchEnabled=!0,this.touchChildren=!0)}},n.prototype.updataHandCardPosition=function(){for(var t=this.handCardList.length,n=this.handCardX,i=0;t>i;i++)this.handCardList[i].x=n+e.GameConstant.CardGap*i},Object.defineProperty(n.prototype,"handCardWidth",{get:function(){var t=this.handCardList.length;return e.GameConstant.CardWidth+t*e.GameConstant.CardGap},enumerable:!0,configurable:!0}),n.prototype.recoveryCardPosition=function(){for(var e=0,t=this.handCardList;e<t.length;e++){t[e]}},Object.defineProperty(n.prototype,"handCardX",{get:function(){return e.GameView.Instance.maxNum>6?uniLib.Global.screenWidth/2-110:uniLib.Global.screenWidth/2-110},enumerable:!0,configurable:!0}),n.prototype.outCardChanged=function(e){},n}(egret.DisplayObjectContainer);e.CardLayer=t,__reflect(t.prototype,"game.CardLayer")}(game||(game={}));var game;!function(e){var t=function(){function t(){this.dealTimers=[],this.otherCardImage={},this.dealCardImage=[],this.chips=[],this.chipsSpriteList=[],this.$zhuangEffect=null}return Object.defineProperty(t,"Instance",{get:function(){return null==this.m_Instance&&(this.m_Instance=new t),this.m_Instance},enumerable:!0,configurable:!0}),t.prototype.callCardAnimation=function(t,n,i){e.OperateLayer.Instance.sCard;if(null!=t&&null!=n&&null!=i){var a=e.GameConstant.GetClientNoByUid(i),o=e.GameConstant.seatPosArr[a];switch(e.GameView.Instance.maxNum){case 6:o=e.GameConstant.seatPosArr[a];break;case 12:o=e.GameConstant.seatMaxPosArr[a]}if(o&&null!=o){var s=e.PokerFunction.MainSeat.handCards.first(function(e){return e==n});i==uniLib.NetMgr.UID&&null!=s?egret.Tween.get(t).wait(800).to({scaleX:1.5,scaleY:1.5,y:e.GameConstant.HandCardY},800,egret.Ease.sineOut).call(function(){e.OperateLayer.Instance.removeCallCard()}):egret.Tween.get(t).wait(800).to({scaleX:0,scaleY:0,x:o.x,y:o.y},800,egret.Ease.sineOut).call(function(){e.OperateLayer.Instance.removeCallCard()})}}},t.prototype.clearDealTimer=function(){for(var t=0,n=this.dealTimers;t<n.length;t++){var i=n[t];e.Timer.clearTimeout(i)}this.clearAllOtherCard();for(var a=0,o=this.dealCardImage;a<o.length;a++){var i=o[a];i&&(egret.Tween.removeTweens(i),i.parent&&i.parent.removeChild(i))}this.clearHandCard()},t.prototype.dealCardAnimation=function(t){1!=e.RoomInfo.getInstance().video&&1==t&&this.catchAnimation()},Object.defineProperty(t.prototype,"cardImage",{get:function(){return this.otherCardImage},enumerable:!0,configurable:!0}),t.prototype.clearAllOtherCard=function(){for(var e in this.otherCardImage)if(this.otherCardImage[e])for(var t=0,n=this.otherCardImage[e];t<n.length;t++){var i=n[t];i&&(egret.Tween.removeTweens(i),i.parent&&i.parent.removeChild(i))}this.otherCardImage={}},t.prototype.clearOtherCard=function(e){var t=this.otherCardImage[e];if(t){for(var n=0,i=t;n<i.length;n++){var a=i[n];a&&(egret.Tween.removeTweens(a),a.parent&&a.parent.removeChild(a))}this.otherCardImage[e]=null}},t.prototype.dealPlayerOne=function(t){var n=t&&t.user?t.user.uid:null;if(null!=n){e.EffectCreate.Instance.removeShuffleMc();var i=e.GameConstant.GetPlayCardPosition(n);n==uniLib.NetMgr.UID&&(i=new egret.Point(e.CardLayer.Instance.handCardX,e.GameConstant.HandCardY));var a=new eui.Image("BackCard");a.width=e.GameConstant.PlayCardWidth,a.height=e.GameConstant.PlayCardHeight,a.x=(uniLib.Global.screenWidth-a.width)/2,a.y=(uniLib.Global.screenHeight-e.GameConstant.PlayCardHeight)/2+50,e.CardLayer.Instance.addChild(a),i&&(egret.Tween.get(a).to({x:i.x,y:i.y},300,egret.Ease.circOut).call(this.openCardAnimation,this,[t,a]),this.dealCardImage.push(a))}},t.prototype.openCardAnimation=function(t,n){var i=t&&t.user?t.user.uid:null;if(null!=i){if(n.parent&&n.parent.removeChild(n),i==uniLib.NetMgr.UID&&e.CardLayer.Instance.handCards.length>0)return void this.OpenMainHandCard();if(!(t.handCardSum<1)){null==this.otherCardImage[i]&&(this.otherCardImage[i]=[]);var a=e.GameConstant.GetPlayCardPosition(i),o=e.GameConstant.GetSeatSpriteByUid(i);if(a)for(var s=0;s<t.handCardSum;s++){var r=new e.HandCardSprite(null),h=a.x+e.GameConstant.PlayCardGap*s;if(i==uniLib.NetMgr.UID)r.width=e.GameConstant.CardWidth,r.height=e.GameConstant.CardHeight,h=a.x+e.GameConstant.CardGap*s,o&&o.userSprite.alpha<=.5&&(r.darken=!0);else{if(o&&o.userSprite.alpha<=.5)continue;r.width=e.GameConstant.PlayCardWidth,r.height=e.GameConstant.PlayCardHeight,h=a.x+e.GameConstant.PlayCardGap*s}r.y=a.y,r.x=a.x,e.CardLayer.Instance.addChild(r),r?egret.Tween.get(r).to({x:h},e.GameConstant.DealCardTime+100*s):console.error("展开手牌特效牌不存在"),this.otherCardImage[i]?this.otherCardImage[i].push(r):console.error(this.otherCardImage,"展开手牌不存在",i)}}}},t.prototype.OpenMainHandCard=function(){this.clearHandCard();var t=e.CardLayer.Instance.handCards;if(!e.PokerFunction.MainSeat)return void console.error("主角座位没有数据");var n=e.PokerFunction.MainSeat.handCards;if(n&&n.length)for(var i=e.GameConstant.HandCardY,a=e.CardLayer.Instance.handCardX,o=e.GameConstant.GetSeatSpriteByUid(uniLib.NetMgr.UID),s=function(s){var r=n[s];if(null==r||e.CardLayer.Instance.handCards.seek(function(e){return e.cardId==r}))return{value:void 0};var h=new e.HandCardSprite(r);h.setTexture("BackCard"),h.touchEnabled=!0,h.touchChildren=!1,h.x=a,h.y=i,o&&!o.canSelectState&&(h.darken=!0),e.CardLayer.Instance.addChild(h),t.push(h),egret.Tween.get(h).to({x:a+e.GameConstant.CardGap*s},e.GameConstant.DealCardTime+100*s).wait(100*(n.length-1-s)+150).call(function(){h&&h.changeImage()})},r=0;r<n.length;r++){var h=s(r);if("object"==typeof h)return h.value}},t.prototype.clearHandCard=function(){for(var t=e.CardLayer.Instance.handCards,n=0,i=t;n<i.length;n++){var a=i[n];egret.Tween.removeTweens(a),a.parent&&e.CardLayer.Instance.removeChild(a)}t.clear()},t.prototype.catchPlayerOne=function(t){var n=t&&t.user?t.user.uid:null;if(null!=n){var i=uniLib.Global.screenWidth/2-e.GameConstant.CardWidth/2,a=(uniLib.Global.screenHeight-e.GameConstant.PlayCardHeight)/2+50;if(n==uniLib.NetMgr.UID){e.OperateBet.instance.onClose();for(var o=e.CardLayer.Instance.catchHandCards,s=function(t){var n=o[t];n&&egret.Tween.removeTweens(n),n.setTexture("BackCard"),n.x=i,n.y=a;var s=e.CardLayer.Instance.handCardX+e.GameConstant.CardGap*(e.CardLayer.Instance.handCards.length-o.length+t);egret.Tween.get(n).to({x:s,y:e.GameConstant.HandCardY},300,egret.Ease.circOut).call(function(){n&&n.changeImage()})},r=0;r<o.length;r++)s(r)}else{null==this.otherCardImage&&(this.otherCardImage={},this.otherCardImage[n]=[]),null!=this.otherCardImage&&null==this.otherCardImage[n]&&(this.otherCardImage[n]=[]);var h=e.GameConstant.GetPlayCardPosition(n);if(!h)return;for(var r=0;r<t.catchCardNum;r++){var l=new e.HandCardSprite(null);l.width=e.GameConstant.PlayCardWidth,l.height=e.GameConstant.PlayCardHeight,l.x=i,l.y=a;var d=h.x+e.GameConstant.PlayCardGap*(t.handCardSum-1);e.CardLayer.Instance.addChild(l),egret.Tween.get(l).wait(100).to({x:d,y:h.y},e.GameConstant.DealCardTime,egret.Ease.circOut),this.otherCardImage[n].push(l)}}}},t.prototype.catchAnimation=function(){var t=e.PokerFunction.MainSeatId,n=e.RoomData.Instance.seatList.filter(function(e){return e.catchCardNum>0});n.sort(function(e,n){return e.seatId-t});for(var i=0;i<n.length;i++)uniLib.SetUniEventTimeout(e.GameView.Instance,this.catchPlayerOne,100*i,1,this,n[i])},t.prototype.playCardAnimation=function(n){var i=n.uid;if(i&&n.cardList&&n.cardList instanceof Array){var a=n.cardList;this.clearOtherCard(i),null==this.otherCardImage[i]&&(this.otherCardImage[i]=[]);var o=e.GameConstant.GetPlayCardPosition(i);if(o){var s=0,r=e.GameConstant.PlayCardWidth,h=e.GameConstant.PlayCardHeight,l=e.GameConstant.PlayCardGap;i==uniLib.NetMgr.UID&&(o=new egret.Point(e.CardLayer.Instance.handCardX,e.GameConstant.HandCardY),s=100,r=e.GameConstant.CardWidth,h=e.GameConstant.CardHeight,l=e.GameConstant.CardGap);for(var d=function(t){var n=new e.HandCardSprite(null);n.y=o.y,n.setTexture("BackCard"),e.CardLayer.Instance.addChild(n),n.x=o.x+l*t,n.width=r,n.height=h;var d=table.TablePokerCard.resNormal(a[t]);c.otherCardImage[i].push(n),n.cardId=a[t],egret.Tween.get(n).wait(s).to({scaleX:0},200).call(function(){return n.setTexture(d)}).to({scaleX:1},200)},c=this,u=0;u<a.length;u++)d(u);t.Instance.addNnLogo(n.cardListType,n.multiple,i)}}},t.prototype.addNnLogo=function(t,n,i){var a=e.GameConstant.GetPlayCardPosition(i);if(uniLib.NetMgr.UID==i&&(a=new egret.Point(e.CardLayer.Instance.handCardX,e.GameConstant.HandCardY+30)),a){var o=e.GameConstant.GetSeatSpriteByUid(i);o&&(o.cardType=t,o.cardMultiple=n);var s="cow_"+t,r=new egret.Bitmap(RES.getRes(s));e.CardLayer.Instance.addChild(r);var h=new eui.BitmapLabel;h.font="wrnn_grabNumber_fnt";var l=n;l?h.text="乘"+l:h.text="",e.CardLayer.Instance.addChild(h);var d=i==uniLib.NetMgr.UID?2*r.width:r.width/5+r.width,c=i==uniLib.NetMgr.UID?2*r.height:r.height/5+r.height,u=i==uniLib.NetMgr.UID?e.GameConstant.CardHeight:e.GameConstant.PlayCardHeight;r.width=d,r.height=c,r.x=i==uniLib.NetMgr.UID?(uniLib.Global.screenWidth-r.width)/2+r.width/2:a.x+r.width/3,r.y=a.y+u-r.height,h.x=r.x+r.width/2+50,h.y=r.y+r.height/2-h.height+20,r.anchorOffsetX=r.width/2,r.anchorOffsetY=r.height/2,r.y+=r.height/2,r.scaleX=.3,r.scaleY=.3,r.visible=!1,h.visible=!1,egret.Tween.get(r).wait(400).call(function(){r.visible=!0,h.visible=!0;var n=e.PokerFunction.GetSeatDataByUid(i);null!=n&&e.SoundHand.Instance.playNameForCardType(t,n.user.gender)}).to({scaleX:.8,scaleY:.8},300,egret.Ease.circOut).to({scaleX:.4,scaleY:.4},300)}},t.prototype.playCommonCard=function(t){for(var n=0;n<t.length;n++){var i=t[n],a=new e.HandCardSprite(i);e.CardLayer.Instance.addChild(a)}},t.prototype.threeCardGoHandEffect=function(){var t=e.RoomData.Instance.threeCard,n=e.CardLayer.Instance.handCards.filter(function(e){return t.seek(function(t){return t==e.cardId})});if(n)for(var i=0,a=n;i<a.length;i++){var o=a[i];o.y=e.GameConstant.HandCardY-e.GameConstant.CardHeight,o.selected?egret.Tween.get(o).wait(200).to({y:e.GameConstant.HandCardSelectY},300,egret.Ease.circOut):egret.Tween.get(o).wait(200).to({y:e.GameConstant.HandCardY},300,egret.Ease.circOut)}},t.prototype.multipleEffect=function(t){var n=this,i="x"+(t%1==0?t:Math.ceil(t));null==this.label&&(this.label=new eui.BitmapLabel(i),this.label.font="glodBrightFont_fnt",this.label.y=e.GameConstant.OperationY-200,e.GameView.Instance.addChild(this.label),this.label.x=(uniLib.Global.screenWidth-this.label.width)/2,uniLib.SetUniEventTimeout(e.GameView.Instance,function(){e.GameView.Instance.removeChild(n.label),n.label=null},1e3,1,this)),null!=this.label&&(this.label.text=i),this.lastValue=t},t.prototype.farmerLoseEffect=function(){var e,t=RES.getRes("farmer_cry_json"),n=RES.getRes("farmer_cry_png"),i=new egret.MovieClipDataFactory(t,n);return e=new egret.MovieClip(i.generateMovieClipData("farmer_cry")),e.frameRate=6,e.gotoAndPlay(1,-1),e},t.prototype.lordWinEffect=function(){var e,t=RES.getRes("lord_laugh_json"),n=RES.getRes("lord_laugh_png"),i=new egret.MovieClipDataFactory(t,n);return e=new egret.MovieClip(i.generateMovieClipData("lord_laugh")),e.frameRate=6,e.gotoAndPlay(1,-1),e},t.prototype.lordLoseEffect=function(){var e,t=RES.getRes("lord_cry_json"),n=RES.getRes("lord_cry_png"),i=new egret.MovieClipDataFactory(t,n);return e=new egret.MovieClip(i.generateMovieClipData("lord_cry")),e.frameRate=6,e.gotoAndPlay(1,-1),e},t.prototype.gameLoseEffect=function(){var e,t=RES.getRes("gameLose_json"),n=RES.getRes("gameLose_png"),i=new egret.MovieClipDataFactory(t,n);return e=new egret.MovieClip(i.generateMovieClipData("lose")),e.frameRate=24,e.gotoAndPlay(1,1),e},t.prototype.giftEffect=function(t,n,i){var a=new e.GiftAnItem;a.giftId=t;var o=e.GameConstant.seatPosArr[e.GameConstant.GetClientNoByUid(n)],s=e.GameConstant.seatPosArr[e.GameConstant.GetClientNoByUid(i)];e.GameView.Instance.maxNum>6?(s=e.GameConstant.seatMaxPosArr[e.GameConstant.GetClientNoByUid(i)],o=e.GameConstant.seatMaxPosArr[e.GameConstant.GetClientNoByUid(n)]):(s=e.GameConstant.seatPosArr[e.GameConstant.GetClientNoByUid(i)],o=e.GameConstant.seatPosArr[e.GameConstant.GetClientNoByUid(n)]),o&&s&&(a.x=s.x+e.GameConstant.HeadWidth/2,a.y=s.y+e.GameConstant.HeadHeight/2,e.GameInfo.topLayer.addChild(a),egret.Tween.get(a).to({x:o.x+e.GameConstant.HeadWidth/2,y:o.y+e.GameConstant.HeadHeight/2},400,egret.Ease.circOut).call(function(){a?(egret.Tween.removeTweens(a),a.play()):console.error("礼物不存在",a)}))},t.prototype.goldFlyEffect=function(t,n){var i=e.GameConstant.GetHeadPointByUid(t),a=e.GameConstant.GetHeadPointByUid(n);if(i&&a)for(var o=i.x+e.GameConstant.HeadWidth/2,s=i.y+e.GameConstant.HeadHeight/2,r=a.x+e.GameConstant.HeadWidth/2,h=a.y+e.GameConstant.HeadHeight/2,l=function(){this.parent&&this.parent.removeChild(this)},d=0;7>d;d++){var c=new egret.Bitmap(RES.getRes("flyCoin"));e.GameInfo.topLayer.addChild(c),c.width=40,c.height=40,c.anchorOffsetX=c.width/2,c.anchorOffsetY=c.height/2,c.x=o,c.y=s,egret.Tween.get(c).wait(30*d).to({x:r,y:h},500).call(l)}},t.prototype.pointNotic=function(t,n){var i=e.GameConstant.GetHeadPointByUid(t);if(null!=i){var a=i.x+e.GameConstant.HeadWidth/2-20,o=i.y+e.GameConstant.HeadHeight/2,s=new eui.BitmapLabel;n>0?(s.font="wrnn_winScoreNumber_fnt",s.text="+"+n):(s.font="wrnn_loseScoreNumber_fnt",s.text=""+n),e.GameInfo.topLayer.addChild(s),s.anchorOffsetX=s.width/2,s.anchorOffsetY=s.height/2;var r=e.GameConstant.GetClientNoByUid(t);switch(r){case 3:o+=e.GameConstant.HeadHeight/2;break;case 4:o+=e.GameConstant.HeadHeight/2}s.x=a,s.y=o,s.scaleX=.5,s.scaleY=.5;var h=function(){this.parent&&this.parent.removeChild(this)};egret.Tween.get(s).to({y:o-70},1e3).to({scaleX:1,scaleY:1},1500).to({alpha:0},100).call(h)}},t.prototype.clearChips=function(){for(var e=0,t=this.chips;e<t.length;e++){var n=t[e];egret.Tween.removeTweens(n),n.parent&&n.parent.removeChild(n)}},t.prototype.chipsfly=function(t){var n=e.GameConstant.GetSeatSpriteByUid(t);if(n)for(var i=function(e){egret.Tween.get(e).to({x:n.x,y:n.y},400).call(function(){e&&e.parent&&(egret.Tween.removeTweens(e),e.parent.removeChild(e),e=null)})},a=0,o=this.chipsSpriteList;a<o.length;a++){var s=o[a];i(s)}},t.prototype.playLoseEffect=function(){this.lose&&this.lose.display&&this.lose.display.parent&&(this.lose.display.parent.removeChild(this.lose.display),this.lose.removeEventListener(dragonBones.EventObject.COMPLETE,this.endPlayAnimation,this),this.lose=null),this.lose=uniLib.DisplayUtils.createDragonBonesDisplay("lose_ske_json","lose_tex_json","lose_tex_png","Armature"),dragonBones.WorldClock.clock.add(this.lose),this.lose.display.x=uniLib.Global.screenWidth/2,this.lose.display.y=(uniLib.Global.screenHeight-this.lose.display.height)/2,this.lose&&(this.lose.animation.play("loseEffect",1),e.GameInfo.topLayer.addChild(this.lose.display),this.lose.addEventListener(dragonBones.EventObject.COMPLETE,this.endPlayAnimation,this))},t.prototype.endPlayAnimation=function(e){this.lose&&this.lose.display&&this.lose.display.parent&&(this.lose.animation.stop(),this.lose.display.parent.removeChild(this.lose.display),this.lose.removeEventListener(dragonBones.EventObject.COMPLETE,this.endPlayAnimation,this),this.lose=null,dragonBones.WorldClock.clock.remove(this.lose))},t.prototype.playWinEffect=function(){this.winEffect&&this.winEffect.display&&this.winEffect.display.parent&&(this.winEffect.removeEventListener(dragonBones.EventObject.COMPLETE,this.endPlayWinAnimation,this),this.winEffect.display.parent.removeChild(this.winEffect.display),this.winEffect=null),this.winEffect=uniLib.DisplayUtils.createDragonBonesDisplay("WinEffect_ske_json","WinEffect_tex_json","WinEffect_tex_png","Armature"),dragonBones.WorldClock.clock.add(this.winEffect),this.winEffect.display.x=uniLib.Global.screenWidth/2,this.winEffect.display.y=(uniLib.Global.screenHeight-this.winEffect.display.height)/2+300,this.winEffect&&(this.winEffect.animation.play("winEffect",1),e.GameInfo.topLayer.addChild(this.winEffect.display),this.winEffect.addEventListener(dragonBones.EventObject.COMPLETE,this.endPlayWinAnimation,this))},t.prototype.endPlayWinAnimation=function(e){this.winEffect&&this.winEffect.display.parent&&(this.winEffect.animation.stop(),this.winEffect.display.parent.removeChild(this.winEffect.display),this.winEffect.removeEventListener(dragonBones.EventObject.COMPLETE,this.endPlayWinAnimation,this),this.winEffect=null,dragonBones.WorldClock.clock.remove(this.winEffect))},Object.defineProperty(t.prototype,"zhuangEffect",{get:function(){return this.$zhuangEffect},set:function(e){this.$zhuangEffect=e},enumerable:!0,configurable:!0}),t.prototype.playzhuangEffect=function(){return this.$zhuangEffect=uniLib.DisplayUtils.createDragonBonesDisplay("zhuangEffect_ske_json","zhuangEffect_tex_json","zhuangEffect_tex_png","Armature"),this.$zhuangEffect.display.x=30,this.$zhuangEffect.display.y=20,this.$zhuangEffect},t.prototype.playRoundEffect=function(){var e=uniLib.DisplayUtils.createDragonBonesDisplay("lightEffect_ske_json","lightEffect_tex_json","lightEffect_tex_png","Armature");return e.display.x=0,e.display.y=70,e},t.prototype.randomEffect=function(){var e=uniLib.DisplayUtils.createDragonBonesDisplay("randomEffect_ske_json","randomEffect_tex_json","randomEffect_tex_png","Armature");return e.display.x=0,e.display.y=70,e},t.prototype.ChipsEffect=function(t,n,i){void 0===i&&(i=!0);var a=e.GameConstant.GetSeatSpriteByUid(n).x,o=e.GameConstant.GetSeatSpriteByUid(n).y,s=new e.ChipsSprite(t);i&&(s.scaleX=1.4,s.scaleY=1.4),s.x=a,s.y=o,this.chipsSpriteList.push(s),e.CardLayer.Instance.addChild(s);var r=Math.randomInteger(e.GameConstant.BetEndRange.x.min,e.GameConstant.BetEndRange.x.max),h=Math.randomInteger(e.GameConstant.BetEndRange.y.min,e.GameConstant.BetEndRange.y.max);egret.Tween.get(s).to({x:r,y:h},400)},t.prototype.compareCard=function(n,i){function a(n){return r.x+=.01*u,s.x-=.01*u,r.x<640?u+=.01*m:(g.flickerAnimation(),g.isplaying=!0,u+=.01*p),0>=u&&(egret.clearInterval(g.wintimer),egret.Tween.get(r).wait(1e3).to({x:h,y:l},300).call(function(){return r?(egret.Tween.removeTweens(r),void(r&&r.userSprite&&(r.userSprite.allvisable=!0,r.addState("bipaiying")))):void console.error("比牌输的人不存在了",r)}),egret.Tween.get(s).wait(1e3).to({x:d,y:c},300).wait(1e3).call(function(){if(e.GameView.Instance.vsPanelVisible(!1),g.isplaying=!1,g.isCompared=!1,!s)return void console.error("比牌输的人不存在",s);if(egret.Tween.removeTweens(s),s&&s.userSprite)if(s.userSprite.allvisable=!0,s.userSprite.alpha=.5,s.addState("bipaishu"),s.uid==uniLib.NetMgr.UID){var n=e.EffectCreate.Instance.cardImage[uniLib.NetMgr.UID];if(!n)return void console.error("没有找到",uniLib.NetMgr.UID,"的",e.EffectCreate.Instance.cardImage);for(var i=0,a=n;i<a.length;i++){var o=a[i];o.darken=!0}e.BetSelectPanel.Instance.offPanel()}else t.Instance.cardLeave(s.uid);e.BetSelectPanel.Instance.addEvent()})),!1}var o=this;e.RoomData.Instance.roomCurrentInnings;this.isCompared=!0;var s=e.GameConstant.GetSeatSpriteByUid(n.uid),r=e.GameConstant.GetSeatSpriteByUid(i.uid);if(e.BetSelectPanel.Instance.removeEvent(),!(r&&r.seatData&&s&&s.seatData))return void console.error("赢家",r,"比牌输",s);r.uid==uniLib.NetMgr.UID&&e.BetSelectPanel.Instance.offPanel(),s.seatData.seatStateList&&s.seatData.seatStateList.length&&!s.seatData.seatStateList.seek(function(e){return e==Cmd.GameState.State_CompareLose})&&s.seatData.seatStateList.push(Cmd.GameState.State_CompareLose),e.GameView.Instance.vsPanelVisible(!0,n,i);var h=r.x,l=r.y,d=s.x,c=s.y;r.userSprite.allvisable=!1,s.userSprite.allvisable=!1;var u=1e3,m=14e4,p=-17e4;egret.Tween.get(r).to({x:110,y:300},200).wait(800).call(function(){r?(egret.Tween.removeTweens(r),o.wintimer=egret.setInterval(a,o,10)):console.error("比牌赢的人不存在",r)}),egret.Tween.get(s).to({x:uniLib.Global.screenWidth-230,y:300},200).wait(800).call(function(){s?egret.Tween.removeTweens(s):console.error("比牌输的人不存在了",s)});var g=this},t.prototype.flickerAnimation=function(){if(1!=this.isplaying){var t=RES.getRes("blink_json"),n=RES.getRes("blink_png"),i=new egret.MovieClipDataFactory(t,n);this.flicker=new egret.MovieClip(i.generateMovieClipData("blink")),this.flicker&&(this.flicker.x=350,this.flicker.y=30,e.SeatLayer.Instance.addChild(this.flicker),this.flicker.addEventListener(egret.Event.COMPLETE,this.flickerCOMPLETE,this),this.flicker.gotoAndPlay(1,1)),e.SoundHand.Instance.playCarshSound()}},t.prototype.flickerCOMPLETE=function(){this.flicker&&this.flicker.parent?(this.flicker.stop(),this.flicker.parent.removeChild(this.flicker),this.flicker.removeEventListener(egret.Event.COMPLETE,this.flickerCOMPLETE,this),this.flicker=null):console.error("动画已经被移除",this.flicker)},t.prototype.cardLeave=function(e,n){var i=t.Instance.cardImage[e];if(i)if(e!=uniLib.NetMgr.UID)for(var a=function(n){egret.Tween.get(n).to({x:uniLib.Global.screenWidth/2,y:100,scaleX:.2,scaleY:.2,rotation:90+60*Math.random()-30},400).call(function(){n?(egret.Tween.removeTweens(n),t.Instance.clearOtherCard(e)):console.error("牌不存在",n)
})},o=0,s=i;o<s.length;o++){var r=s[o];a(r)}else for(var h=0,l=i;h<l.length;h++){var r=l[h];r.x,r.y;r.darken=!0}},t.prototype.addShuffleMc=function(t){uniLib.SoundMgr.instance.playSound("ZJH_shufflecard_mp3"),this._shuffleMc=uniLib.DisplayUtils.createMovieClicp("shuffle_mc"),e.GameView.Instance.addChild(this._shuffleMc),this._shuffleMc.scaleX=1,this._shuffleMc.scaleY=1,this._shuffleMc.x=(uniLib.Global.screenWidth-400)/2,this._shuffleMc.y=(uniLib.Global.screenHeight-this._shuffleMc.height)/2-20,this._shuffleMc.frameRate=18,this._shuffleMc.play(1);var n=e.GameConstant.GetSeatSpriteByUid(t);n&&(this._shuffleBg=new eui.Image("shuffle_bg"),this._shuffleBg.x=(uniLib.Global.screenWidth-this._shuffleBg.width)/2-220,this._shuffleBg.y=uniLib.Global.screenHeight/2+110,e.GameView.Instance.addChild(this._shuffleBg),this._shuffleLabel=new eui.Label,this._shuffleLabel.text=n.user.nickName+"正在洗牌中...",this._shuffleLabel.textColor=16767334,this._shuffleLabel.x=(uniLib.Global.screenWidth-this._shuffleLabel.width)/2,this._shuffleLabel.y=uniLib.Global.screenHeight/2+120,e.GameView.Instance.addChild(this._shuffleLabel))},t.prototype.removeShuffleMc=function(){this._shuffleMc&&this._shuffleMc.parent&&(this._shuffleMc.stop(),e.GameView.Instance.removeChild(this._shuffleMc),this._shuffleMc=null),this._shuffleLabel&&this._shuffleLabel.parent&&(e.GameView.Instance.removeChild(this._shuffleLabel),this._shuffleLabel=null),this._shuffleBg&&this._shuffleBg.parent&&(e.GameView.Instance.removeChild(this._shuffleBg),this._shuffleBg=null)},t}();e.EffectCreate=t,__reflect(t.prototype,"game.EffectCreate")}(game||(game={}));var game;!function(e){var t;!function(e){e[e.DoorId_Tian=1]="DoorId_Tian",e[e.DoorId_Xuan=2]="DoorId_Xuan",e[e.DoorId_Di=3]="DoorId_Di",e[e.DoorId_Huan=4]="DoorId_Huan",e[e.DoorId_Wu=5]="DoorId_Wu",e[e.DoorId_Liu=6]="DoorId_Liu"}(t=e.DoorId||(e.DoorId={}));var n=function(){function t(){}return Object.defineProperty(t,"seatPosArr",{get:function(){return[new egret.Point(0,561),new egret.Point(uniLib.Global.screenWidth-120,387),new egret.Point(uniLib.Global.screenWidth-120,180),new egret.Point(uniLib.Global.screenWidth-356,0),new egret.Point(240,0),new egret.Point(0,280)]},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ReadyPos",{get:function(){return[new egret.Point(140,600),new egret.Point(uniLib.Global.screenWidth-120-55,400),new egret.Point(uniLib.Global.screenWidth-120-55,183),new egret.Point(uniLib.Global.screenWidth-356-55,13),new egret.Point(380,13),new egret.Point(140,293)]},enumerable:!0,configurable:!0}),Object.defineProperty(t,"playCardPos",{get:function(){return[new egret.Point(uniLib.Global.screenWidth/2-110,550),new egret.Point(uniLib.Global.screenWidth-120-114-42,464),new egret.Point(uniLib.Global.screenWidth-120-114-42,245),new egret.Point(uniLib.Global.screenWidth-356-114-42,64),new egret.Point(380,64),new egret.Point(140,344)]},enumerable:!0,configurable:!0}),Object.defineProperty(t,"robSorcePosArr",{get:function(){return[new egret.Point(110,564),new egret.Point(uniLib.Global.screenWidth-120-80,390),new egret.Point(uniLib.Global.screenWidth-120-80,183),new egret.Point(uniLib.Global.screenWidth-356-80,3),new egret.Point(350,3),new egret.Point(110,283)]},enumerable:!0,configurable:!0}),Object.defineProperty(t,"seatMaxPosArr",{get:function(){return[new egret.Point(0,590),new egret.Point(uniLib.Global.screenWidth-230,630),new egret.Point(uniLib.Global.screenWidth-230,420),new egret.Point(uniLib.Global.screenWidth-230,310),new egret.Point(uniLib.Global.screenWidth-230,120),new egret.Point(uniLib.Global.screenWidth-450,0),new egret.Point(630,0),new egret.Point(430,0),new egret.Point(230,0),new egret.Point(0,200),new egret.Point(0,310),new egret.Point(0,420)]},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ReadyMaxPos",{get:function(){return[new egret.Point(220,600),new egret.Point(uniLib.Global.screenWidth-100,540),new egret.Point(uniLib.Global.screenWidth-100,430),new egret.Point(uniLib.Global.screenWidth-100,320),new egret.Point(uniLib.Global.screenWidth-100,210),new egret.Point(uniLib.Global.screenWidth-320,10),new egret.Point(760,10),new egret.Point(560,10),new egret.Point(360,10),new egret.Point(130,210),new egret.Point(130,320),new egret.Point(130,430)]},enumerable:!0,configurable:!0}),Object.defineProperty(t,"playCardMaxPos",{get:function(){return[new egret.Point(uniLib.Global.screenWidth/2-120,540),new egret.Point(uniLib.Global.screenWidth-390,530),new egret.Point(uniLib.Global.screenWidth-390,420),new egret.Point(uniLib.Global.screenWidth-390,310),new egret.Point(uniLib.Global.screenWidth-390,200),new egret.Point(uniLib.Global.screenWidth-450,100),new egret.Point(630,100),new egret.Point(430,100),new egret.Point(230,100),new egret.Point(180,200),new egret.Point(180,310),new egret.Point(180,420)]},enumerable:!0,configurable:!0}),Object.defineProperty(t,"robSorceMaxPosArr",{get:function(){return[new egret.Point(220,600),new egret.Point(uniLib.Global.screenWidth-100,540),new egret.Point(uniLib.Global.screenWidth-100,430),new egret.Point(uniLib.Global.screenWidth-100,320),new egret.Point(uniLib.Global.screenWidth-100,210),new egret.Point(uniLib.Global.screenWidth-450+130,10),new egret.Point(760,10),new egret.Point(560,10),new egret.Point(360,10),new egret.Point(130,210),new egret.Point(130,320),new egret.Point(130,430)]},enumerable:!0,configurable:!0}),Object.defineProperty(t,"CardGap",{get:function(){return e.GameView.Instance.maxNum>6?this._CardGap=60:this._CardGap=60,this._CardGap},enumerable:!0,configurable:!0}),Object.defineProperty(t,"BetEndRange",{get:function(){return{x:{min:uniLib.Global.screenWidth/2-140,max:uniLib.Global.screenWidth/2+160},y:{min:250,max:400}}},enumerable:!0,configurable:!0}),t.GetWidthForCardNumber=function(e){return t.PlayCardWidth+(e-1)*t.PlayCardGap},t.GetClientNoBySeatId=function(t){var n=e.PokerFunction.MainSeatId;if(null==n)return t-1;var i=t-n,a=0;if(a=0>i?i+e.RoomData.Instance.playerNumber:Math.abs(i),9==e.GameView.Instance.maxNum)switch(a){case 1:a=2;break;case 2:a=3;break;case 3:a=4;break;case 4:a=6;break;case 5:a=7;break;case 6:a=9;break;case 7:a=10;break;case 8:a=11}return a},t.GetClientNoByUid=function(t){var n=e.SeatLayer.Instance.seatSprites.first(function(e){return e.uid==t});return null==n?null:n.clientNo},t.GetSeatSpriteByUid=function(t){return e.SeatLayer.Instance.seatSprites.first(function(e){return e.uid==t})},t.GetHeadPointByUid=function(t){var n=e.SeatLayer.Instance.seatSprites.first(function(e){return e.uid==t});if(null!=n){var i=n.headPoint;if(i)return{x:n.x+i.x,y:n.y+i.y}}},t.GetSeatSpriteBySeatId=function(t){return e.SeatLayer.Instance.seatSprites.first(function(e){return e.seatData.seatId==t})},t.GetPlayCardPosition=function(e){var n=t.GetClientNoByUid(e),i=t.playCardPos[n];return i},t.loadResMp3=function(){RES.loadGroup(t.ResGroup_Mp3)},t}();n.HeadWidth=159,n.HeadHeight=116,n.HandCardY=550,n.HandCardSelectY=550,n.OperationY=329,n.PlayCardMainY=340,n.CountY=600,n._CardGap=60,n.CardWidth=133,n.CardHeight=178,n.PlayCardWidth=98,n.PlayCardHeight=132,n.PlayCardGap=30,n.BluffCardWidth=50,n.BluffCardHeight=70,n.BluffCardGap=60,n.DealCardTime=200,n.CountDown=15,n.HandCardSum=5,n.LandlordHandCardSum=5,n.BrightThreeCardBack=150,n.BrightThreeCardPositive=150,n.OperationOffsetRight=130,n.RobLordOperateTimerButtonX=556,n.CallLordOperateTimerButtonX=556,n.OperateTimerButtonX=556,n.PassOnlyTimerButtonX=556,n.MaxCardNumLine=10,n.anitime=200,n.ShuffleEffectTime=3800,n.ResGroup_DDZ="DDZ_main",n.ResGroup_Mp3="DDZ_mp3",e.GameConstant=n,__reflect(n.prototype,"game.GameConstant")}(game||(game={}));var callPoint=function(){function e(){}return e}();__reflect(callPoint.prototype,"callPoint");var userType;!function(e){e[e.across=0]="across",e[e.vertical=1]="vertical"}(userType||(userType={}));var game;!function(e){var t=function(t){function s(){var e=t.call(this)||this;return e.landlordRobImage=new Array,e.curMaxPoint=0,e._callPointArr=[],e.lordRobArr=[],e.times=0,e.round=1,e.playCardSprites=new Array,e}return __extends(s,t),Object.defineProperty(s,"Instance",{get:function(){return null==this.m_Instance&&(this.m_Instance=new s),this.m_Instance},enumerable:!0,configurable:!0}),s.clearInstance=function(){this.m_Instance=null},s.prototype.addListener=function(){},s.prototype.destroy=function(){this.removeListener()},s.prototype.removeListener=function(){this.removeRobLandlord(),this.removeOperateMain(),this.stopTimer(),s.clearInstance(),i.clearInstance(),n.clearInstance()},s.prototype.operateChanged=function(t){for(var n=0,i=e.SeatLayer.Instance.seatSprites;n<i.length;n++){var a=i[n];a.removeReadyIcon()}if(null!=t.leftSec?this.endTime=t.leftSec:this.endTime=e.GameTime.localNow()+(t.endTime-e.GameTime.serverNow()),this.stopTimer(),e.DataManager.isInGame&&0!=e.PokerFunction.MainSeat.isReady){var o=t.uid;if(e.RoomData.Instance.roomPlayProps.seek(function(e){return 10463==e})){var s=e.GameConstant.GetSeatSpriteByUid(o);if(s&&s.userSprite.addHeadTimer(this.endTime),o==uniLib.NetMgr.UID){if(1==t.continueCompare)e.BetSelectPanel.Instance.addCanSelectBg(),e.BetSelectPanel.Instance.changeRoundAnimation(!1,!1);else if(t.operateList&&t.operateList.seek(function(e){return e==Cmd.Operation.AutoCall}))return void(e.BetSelectPanel.openState&&e.BetSelectPanel.openState==openType.opensingle||(e.BetSelectPanel.Instance.removeEvent(),e.BetSelectPanel.Instance.OnOpen(openType.opensingle),e.BetSelectPanel.Instance.changeRoundAnimation(!0)));e.BetSelectPanel.Instance.removeEvent(),e.BetSelectPanel.Instance.OnOpen(openType.openall),e.BetSelectPanel.Instance.updateBtnEnable(t.operateList)}else{var r=e.GameConstant.GetSeatSpriteByUid(uniLib.NetMgr.UID),h=r.seatData.seatStateList.seek(function(e){return e==Cmd.GameState.State_ShowCard||e==Cmd.GameState.State_CompareLose||e==Cmd.GameState.State_Fold});if(h)return void console.error("已弃牌",r.seatData.seatStateList);e.BetSelectPanel.openState&&e.BetSelectPanel.openState==openType.opensingle||(e.BetSelectPanel.Instance.removeEvent(),e.BetSelectPanel.Instance.OnOpen(openType.opensingle))}}else this.addTimeButton(),o==uniLib.NetMgr.UID?e.GameView.Instance.playBtnVisable=!0:this.removeOperateMain();this.removePlayCard(o),this.removeRobLandlord()}},s.prototype.kickOperateChanged=function(t){if(null!=t.leftSec?this.endTime=t.leftSec:this.endTime=e.GameTime.localNow()+(t.endTime-e.GameTime.serverNow()),this.stopTimer(),e.RoomData.Instance.roomPlayProps.seek(function(e){return 10463==e})||this.addTimeButton(),e.DataManager.isInGame){t.uid,e.PokerFunction.GetUserInfoByUid(t.uid);this.addRobLandlord(),this.robLandlord.kickPlayOperate(!0),this.timeButton.x=e.GameConstant.RobLordOperateTimerButtonX}},s.prototype.addOperateMain=function(e){},s.prototype.addCountPanel=function(t,n){e.DataManager.isInGame&&(e.OperateBet.instance.onClose(),o.instance.y=e.GameConstant.CountY,o.instance.updata(t,n),this.addChild(o.instance))},s.prototype.removeOperateMain=function(){n.Instance&&n.Instance.parent&&(n.Instance.removeListener(),n.Instance.parent.removeChild(n.Instance))},s.prototype.removeLandlordRobImage=function(t){if(this.lordRobArr=[],this.landlordRobImage)if(t){for(var n=0,i=this.landlordRobImage;n<i.length;n++){var a=i[n];a&&a.parent&&this.removeChild(a)}this.landlordRobImage.clear(),this.curMaxPoint=0}else for(var o=0,s=this.landlordRobImage;o<s.length;o++){var a=s[o];a.uid!=e.RoomData.Instance.landlordUid&&a&&a.parent&&this.removeChild(a)}},Object.defineProperty(s.prototype,"callPointArr",{get:function(){return this._callPointArr},enumerable:!0,configurable:!0}),s.prototype.addCalllordRobResult=function(t){var n,i=e.GameConstant.GetClientNoByUid(t.uid),a=e.PokerFunction.GetUserInfoByUid(t.uid);if("男"==a.gender?n="0":"女"==a.gender&&(n="1"),-1==this.lordRobArr.indexOf(t.uid)){var o=void 0;o=1==t.point||2==t.point||3==t.point||4==t.point||5==t.point?"grabwoqiang_"+n+"_mp3":"grabbuqiang_"+n+"_mp3",uniLib.SoundMgr.instance.playSound(o),this.lordRobArr.push(t.uid)}var s=new eui.BitmapLabel;s.font="wrnn_grabNumber_fnt",0!=t.point&&(this.curMaxPoint=t.point);var r=new callPoint;t.point&&(s.text="抢乘"+t.point,this.addChild(s),this.landlordRobImage.push(s)),t.uid&&(r.point=t.point,r.uid=t.uid,r.clientNo=e.GameConstant.GetClientNoByUid(t.uid),this._callPointArr.push(r));var h=e.GameConstant.robSorcePosArr[i];switch(e.GameView.Instance.maxNum){case 6:h=e.GameConstant.robSorcePosArr[i];break;case 12:h=e.GameConstant.robSorceMaxPosArr[i]}h&&(s.x=h.x,s.y=h.y,s.uid=t.uid,t.uid==uniLib.NetMgr.UID&&this.removeRobLandlord())},s.prototype.playRandomRoundEffect=function(){for(var t=0,n=0,i=this._callPointArr;n<i.length;n++){var a=i[n];t<a.point&&(t=a.point)}if(this._callPointArr=this._callPointArr.filter(function(e){return e.point==t}),this._callPointArr.length<1)for(var o=0,s=e.SeatLayer.Instance.seatSprites;o<s.length;o++){var r=s[o],h=new callPoint;h.point=r.userSprite.user.point,h.uid=r.userSprite.user.uid,h.clientNo=e.GameConstant.GetClientNoByUid(r.userSprite.user.uid),this._callPointArr.push(h)}this._callPointArr.sort(function(e,t){return e.clientNo-t.clientNo}),this.round=1,this.playtimer&&this.playtimer.stop(),this.playtimer=new uniLib.UniTimer(this,this.timerFunc,100*this._callPointArr.length,!0,this),this.playtimer.start()},s.prototype.timerFunc=function(){if(this._callPointArr&&this._callPointArr[this.times]&&1==this.round){var t=e.GameConstant.GetSeatSpriteByUid(this._callPointArr[this.times].uid);if(!t)return;t.userSprite.randomRoundEffect(),this.times<this._callPointArr.length-1?this.times++:(this.round=2,this.times=0)}else if(this._callPointArr&&this._callPointArr[0]&&2==this.round)if(this._callPointArr[0].uid==e.RoomData.Instance.landlordUid){this.playtimer&&(this.playtimer.stop(),this.playtimer=null);var n=e.GameConstant.GetSeatSpriteByUid(e.RoomData.Instance.landlordUid);n&&(e.DataManager.isPlayRandom=!1,uniLib.SetUniEventTimeout(this,function(){n.userSprite.showLordLogo()},200,1,this)),this._callPointArr.clear()}else{var t=e.GameConstant.GetSeatSpriteByUid(this._callPointArr[0].uid);t&&(t.userSprite.randomRoundEffect(),this._callPointArr.remove(this._callPointArr[0]))}else if(this.playtimer){this.playtimer.stop(),this.playtimer=null;var i=e.GameConstant.GetSeatSpriteByUid(e.RoomData.Instance.landlordUid);i&&(e.DataManager.isPlayRandom=!1,uniLib.SetUniEventTimeout(this,function(){i.userSprite.showLordLogo()},200,1,this))}},s.prototype.updataRobLandlord=function(t){this.removeCallCard(),null!=t.leftSec?this.endTime=t.leftSec:this.endTime=e.GameTime.localNow()+(t.endTime-e.GameTime.serverNow()),this.stopTimer(),e.RoomData.Instance.roomPlayProps.seek(function(e){return 10463==e})||this.addTimeButton(),e.DataManager.isInGame&&(this.addRobLandlord(t.operateList),this.robLandlord&&this.robLandlord.kickPlayOperate(!1))},s.prototype.autoLandLord=function(){var t=new Cmd.LandlordRobCmd_CS;t.yesOrNo=!1,e.PokerFunction.tcpSend(t)},s.prototype.addTimeButton=function(){null==this.timeButton&&(this.timeButton=new a),this.timeButton.y=250,e.DataManager.isDeZhou?this.timeButton.x=(uniLib.Global.screenWidth-this.timeButton.width)/2-100:this.timeButton.x=(uniLib.Global.screenWidth-this.timeButton.width)/2,this.addChild(this.timeButton),this.updataTimer(),egret.clearInterval(this.timer),this.timer=egret.setInterval(this.updataTimer,this,1e3)},s.prototype.stopTimer=function(){for(var t=0,n=e.SeatLayer.Instance.seatSprites;t<n.length;t++){var i=n[t];i&&i.userSprite&&i.userSprite.stopHeadTimer()}this.timeButton&&this.timeButton.parent&&(this.removeChild(this.timeButton),this.timeButton&&egret.Tween.removeTweens(this.timeButton),this.timeButton=null),egret.clearInterval(this.timer)},Object.defineProperty(s.prototype,"thisendTime",{set:function(e){this.endTime=e},enumerable:!0,configurable:!0}),s.prototype.updataTimer=function(){this.time=this.endTime--,e.SoundHand.Instance.playClock(),this.time<0&&(this.time=0,this.stopTimer()),this.timeButton&&(this.timeButton.label=this.time+"")},s.prototype.addRobLandlord=function(t){e.DataManager.isInGame&&(null==this.robLandlord&&(this.robLandlord=i.Instance,this.robLandlord.x=(uniLib.Global.screenWidth-this.robLandlord.width)/2,this.robLandlord.y=e.GameConstant.OperationY),this.robLandlord.setBtnsVisible(!0),this.robLandlord.updata(),this.robLandlord.addListener(),e.SoundHand.Instance.playLandlord(),this.addChild(this.robLandlord),this.robLandlord.showBtns(t))},s.prototype.removeRobLandlord=function(){this.robLandlord&&this.robLandlord.parent&&(this.robLandlord.removeListener(),this.removeChild(this.robLandlord))},s.prototype.playCard=function(t){e.EffectCreate.Instance.playCardAnimation(t)},s.prototype.removePlayCardSprites=function(){for(var e=0,t=this.playCardSprites;e<t.length;e++){var n=t[e];n&&egret.Tween.removeTweens(n),n&&n.parent&&this.removeChild(n)}this.playCardSprites.clear()},s.prototype.showCallCard=function(t,n){if(!this.sCard){this.callCardId=t;var i=table.TablePokerCard.resNormal(t);this.sCard=new egret.Bitmap,this.sCard.width=e.GameConstant.PlayCardWidth,this.sCard.height=e.GameConstant.PlayCardHeight,this.sCard.texture=RES.getRes(i),e.GameInfo.topLayer.addChild(this.sCard),this.sCard.x=(uniLib.Global.screenWidth-this.sCard.width)/2,this.sCard.y=(uniLib.Global.screenHeight-this.sCard.height)/2,e.EffectCreate.Instance.callCardAnimation(this.sCard,t,n)}},s.prototype.removeCallCard=function(){this.sCard&&this.sCard.parent&&(e.GameInfo.topLayer.removeChild(this.sCard),this.sCard=null)},s.prototype.getPlayCardSprite=function(t,n){var i=new egret.Sprite;if(t&&t.length){for(var a,o=0;o<t.length;o++){var s=table.TablePokerCard.resNormal(t[o]),r=new egret.Bitmap;r.width=e.GameConstant.PlayCardWidth,r.height=e.GameConstant.PlayCardHeight,r.texture=RES.getRes(s),r.x=e.GameConstant.PlayCardGap*o,i.addChild(r),o>=e.GameConstant.MaxCardNumLine&&n!=uniLib.NetMgr.UID&&(r.x=(e.GameConstant.GetWidthForCardNumber(e.GameConstant.MaxCardNumLine)-e.GameConstant.GetWidthForCardNumber(t.length-e.GameConstant.MaxCardNumLine))/2+e.GameConstant.PlayCardGap*(o-e.GameConstant.MaxCardNumLine),r.y=50),o==t.length-1&&(a=r)}return i.width=e.GameConstant.GetWidthForCardNumber(t.length),i.height=e.GameConstant.PlayCardHeight,i}},s.prototype.removePlayCard=function(t){var n=e.GameConstant.GetClientNoByUid(t);this.playCardSprites[n]&&this.playCardSprites[n].parent&&this.removeChild(this.playCardSprites[n])},s}(egret.DisplayObjectContainer);e.OperateLayer=t,__reflect(t.prototype,"game.OperateLayer");var n=function(t){function n(){var n=t.call(this)||this;return n.tipNumber=0,n.skinName=new OperationPlay_ZJH_Skin,n.x=(uniLib.Global.screenWidth-n.width)/2,n.y=e.GameConstant.OperationY+180,n.addListener(),n}return __extends(n,t),Object.defineProperty(n,"Instance",{get:function(){return null==this.m_Instance&&(this.m_Instance=new n),this.m_Instance},enumerable:!0,configurable:!0}),n.clearInstance=function(){this.m_Instance=null},n.prototype.addListener=function(){this.playButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this)},n.prototype.removeListener=function(){this.playButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this)},n.prototype.updata=function(e){this.tipNumber=0,this.tipCardList=e,this.selectTip()},n.prototype.selectTip=function(){if(this.playButton.visible=!0,null!=this.tipCardList){this.tipNumber>this.tipCardList.length-1&&(this.tipNumber=0);var t=e.CardLayer.Instance.handCards,n=this.tipCardList[this.tipNumber],i=null==n?null:n;i&&i.length>0?this.playButton.enabled=!0:this.playButton.enabled=!1;for(var a=function(n){for(var a=0,s=i;a<s.length;a++){var r=s[a];t[n].cardId!=r||uniLib.SetUniEventTimeout(o,function(){t[n]&&(t[n].selected=!0,t[n].darken=!1)},e.GameConstant.DealCardTime+600,1,o)}},o=this,s=0;s<t.length;s++)a(s);uniLib.SetUniEventTimeout(this,this.changeDark,e.GameConstant.DealCardTime+450,1,this),this.tipNumber++}},n.prototype.changeDark=function(){for(var t=e.CardLayer.Instance.handCards,n=0;n<t.length;n++)t[n].selected||(t[n].darken=!0)},n.prototype.onClickTap=function(t){e.SoundHand.Instance.playButtonClick(),t.target==this.playButton&&this.changeState()},n.prototype.changeState=function(){for(var t=new Cmd.PlayCardCmd_CS,n=e.CardLayer.Instance.handCards,i=new Array,a=0,o=n;a<o.length;a++){var s=o[a];s.selected&&i.push(s.cardId)}t.cardList=i,e.PokerFunction.tcpSend(t),this.playButton.visible=!1},n}(eui.Component);e.OperationPlay=n,__reflect(n.prototype,"game.OperationPlay");var i=function(n){function i(){var e=n.call(this)||this;return e.skinName=new OperateRobLandlord_ZJH_Skin,e.addListener(),e.width=e.callLordGroup.width,e.passCallButton.name="0",e.callScoreButton1.name="1",e.callScoreButton2.name="2",e.callScoreButton3.name="3",e.callScoreButton4.name="4",e.callScoreButton5.name="5",e}return __extends(i,n),Object.defineProperty(i,"Instance",{get:function(){return null==this.m_Instance&&(this.m_Instance=new i),this.m_Instance},enumerable:!0,configurable:!0}),i.clearInstance=function(){i.Instance.removeListener(),this.m_Instance=null},i.prototype.showBtns=function(e){null!=e&&e instanceof Array&&!(e.length<1)&&(2==e.length?(this.robLordGroup.visible=!0,this.callLordGroup.visible=!1):(this.robLordGroup.visible=!1,this.callLordGroup.visible=!0),this.passCallButton.parent&&this.callLordGroup.removeChild(this.passCallButton),this.callScoreButton1.parent&&this.callLordGroup.removeChild(this.callScoreButton1),this.callScoreButton2.parent&&this.callLordGroup.removeChild(this.callScoreButton2),this.callScoreButton3.parent&&this.callLordGroup.removeChild(this.callScoreButton3),this.callScoreButton4.parent&&this.callLordGroup.removeChild(this.callScoreButton4),this.callScoreButton5.parent&&this.callLordGroup.removeChild(this.callScoreButton5),this.passCallButton.enabled=e.seek(function(e){return e==Cmd.Operation.LordCall0}),this.callScoreButton1.enabled=e.seek(function(e){return e==Cmd.Operation.LordCall1}),this.callScoreButton2.enabled=e.seek(function(e){return e==Cmd.Operation.LordCall2}),this.callScoreButton3.enabled=e.seek(function(e){return e==Cmd.Operation.LordCall3}),this.callScoreButton4.enabled=e.seek(function(e){return 5==e}),this.callScoreButton5.enabled=e.seek(function(e){return 6==e}),this.passCallButton.enabled&&this.callLordGroup.addChild(this.passCallButton),this.callScoreButton1.enabled&&this.callLordGroup.addChild(this.callScoreButton1),this.callScoreButton2.enabled&&this.callLordGroup.addChild(this.callScoreButton2),this.callScoreButton3.enabled&&this.callLordGroup.addChild(this.callScoreButton3),this.callScoreButton4.enabled&&this.callLordGroup.addChild(this.callScoreButton4),this.callScoreButton5.enabled&&this.callLordGroup.addChild(this.callScoreButton5),this.resetBtnPos())},i.prototype.resetBtnPos=function(){},i.prototype.setBtnsVisible=function(e){this.passButton.visible=e,this.landlordButton.visible=e},i.prototype.updata=function(){e.RoomData.Instance.callOrRob?(this.callLordGroup.visible=!0,this.robLordGroup.visible=!1):(this.callLordGroup.visible=!1,this.robLordGroup.visible=!0);for(var n=t.Instance.curMaxPoint,i=1;4>i;i++){var a=this.skin["callScoreButton"+i];n>=i?a.enabled=!1:a.enabled=!0}},i.prototype.kickPlayOperate=function(e){this.kickPlayGroup.visible=e,this.kickPlayGroup.visible&&(this.callLordGroup.visible=!1,this.robLordGroup.visible=!1)},i.prototype.addListener=function(){this.passButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.landlordButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.callScoreButton1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.callScoreButton2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.callScoreButton3.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.callScoreButton4.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.callScoreButton5.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.passCallButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.kickPlayButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.noKickButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this)},i.prototype.removeListener=function(){this.passButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.landlordButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.callScoreButton1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.callScoreButton2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.callScoreButton3.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.callScoreButton4.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.callScoreButton5.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.passCallButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.kickPlayButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.noKickButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this)},i.prototype.onClickTap=function(t){if(e.SoundHand.Instance.playButtonClick(),t.target==this.passButton){var n=new Cmd.LandlordCallCmd_CS;n.point=0,e.PokerFunction.tcpSend(n)}else if(t.target==this.landlordButton){var n=new Cmd.LandlordCallCmd_CS;n.point=1,e.PokerFunction.tcpSend(n)}else if(t.target==this.callScoreButton1||t.target==this.callScoreButton2||t.target==this.callScoreButton3||t.target==this.passCallButton||t.target==this.callScoreButton4||t.target==this.callScoreButton5){var n=new Cmd.LandlordCallCmd_CS;n.point=Number(t.target.name),e.PokerFunction.tcpSend(n)}else if(t.target==this.kickPlayButton){var n=new Cmd.KickPlayCmd_CS;n.uid=uniLib.NetMgr.UID,n.yesOrNo=!0,e.PokerFunction.tcpSend(n)}else if(t.target==this.noKickButton){var n=new Cmd.KickPlayCmd_CS;n.uid=uniLib.NetMgr.UID,n.yesOrNo=!1,e.PokerFunction.tcpSend(n)}e.SoundHand.Instance.playButtonClick()},i}(eui.Component);e.OperateRobLandlord=i,__reflect(i.prototype,"game.OperateRobLandlord");var a=function(e){function t(){var t=e.call(this)||this;return t.skinName=new TimeButton_ZJH_Skin,egret.Tween.get(t.rotateImage,{loop:!0}).to({rotation:360},2e3),t}return __extends(t,e),Object.defineProperty(t.prototype,"label",{set:function(e){null!=e&&"NaN"!=e&&(this.labelDisplay.text=e)},enumerable:!0,configurable:!0}),t}(eui.Component);e.TimerButton=a,__reflect(a.prototype,"game.TimerButton");var o=function(e){function t(){return e.call(this)||this}return __extends(t,e),Object.defineProperty(t,"instance",{get:function(){return null==this.m_instance&&(this.m_instance=new t),this.m_instance},enumerable:!0,configurable:!0}),t.prototype.updata=function(e,t){this.tipCardList=e,this.cardListType=t,this.changeSlected()},t.prototype.changeSlected=function(){this.typeImage&&(this.removeChild(this.typeImage),this.typeImage=null),this.typeImage=new egret.Bitmap,this.addChild(this.typeImage);var e="cow_"+this.cardListType;this.typeImage.texture=RES.getRes(e),this.typeImage.width=this.typeImage.width/1.5,this.typeImage.height=this.typeImage.height/1.5,this.typeImage.x=(1280-this.typeImage.width)/2},t}(eui.Component);e.CountPanel=o,__reflect(o.prototype,"game.CountPanel");var s=function(n){function i(){var e=n.call(this)||this;return e.skinName=new OperateBet_ZJH_Skin,e.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onClick,e),e}return __extends(i,n),Object.defineProperty(i,"instance",{get:function(){return null==this.m_instance&&(this.m_instance=new i),this.m_instance},enumerable:!0,configurable:!0}),i.prototype.onClick=function(t){e.SoundHand.Instance.playButtonClick(),t.target==this.oneScoreButton?(this.onBet(1),this.onClose()):t.target==this.twoScoreButton?(this.onBet(2),this.onClose()):t.target==this.threeScoreButton?(this.onBet(3),this.onClose()):t.target==this.fourScoreButton&&(this.onBet(4),this.onClose())},i.prototype.onBet=function(t){var n=new Cmd.BetRoomCmd_CS;n.bet=new Cmd.DoorChips,n.uid=uniLib.NetMgr.UID;var i=e.PokerFunction.GetSeatDataByUid(uniLib.NetMgr.UID);n.bet.doorId=Number(i.seatId),n.bet.chips=Number(t),e.PokerFunction.tcpSend(n)},i.prototype.onOpen=function(){t.Instance.removeLandlordRobImage(!1),e.DataManager.isInGame&&(i.instance.x=(uniLib.Global.screenWidth-i.instance.width)/2,i.instance.y=e.GameConstant.OperationY,t.Instance.addChild(i.instance),uniLib.NetMgr.UID==e.RoomData.Instance.landlordUid?(this.noticLabel.text="等待其他玩家下注",this.betGroup.visible=!1):(e.SoundHand.Instance.playBet(),this.noticLabel.text="请下注",this.betGroup.visible=!0))},i.prototype.onClose=function(){i.instance&&i.instance.parent&&i.instance.parent.removeChild(i.instance)},i}(eui.Component);e.OperateBet=s,__reflect(s.prototype,"game.OperateBet")}(game||(game={}));var game;!function(e){var t=function(t){function n(){return t.call(this)||this}return __extends(n,t),n.prototype.start=function(){t.prototype.start.call(this),e.DataCache.gameInfo&&e.DataCache.gameInfo.defaultOrientation!=egret.OrientationMode.LANDSCAPE&&(uniLib.ScreenUtils.landscape=!0),e.GameInfo.uiLayer=this.uiLayer,e.GameInfo.mainUILayer=this.topLayer,e.GameInfo.topLayer=this.mainUILayer,e.GameInfo.main=this.tipsLayer,GX.GameLayerManager.popLayer=this.mainUILayer,e.GameInfo.uiLayer.name="uiLayer",e.GameInfo.mainUILayer.name="mainUILayer",e.GameInfo.topLayer.name="topLayer",e.GameInfo.main.name="tipsLayer",this.initPositionData(),e.GameViewConfig.mainMediatorName=uniLib.getQualifiedClassName(e.DDZPokerMediator),e.MahJongFourFacede.getInstance().startUp(this)},n.prototype.destroy=function(){t.prototype.destroy.call(this),e.MahJongFourFacede.getInstance().sendNotification(e.MahjongFourFacadeConst.DESTORY)},n.prototype.initPositionData=function(){this.width=e.DataCache.defaultWidth=uniLib.Global.screenWidth,this.height=e.DataCache.defaultHeight=uniLib.Global.screenHeight},n}(uniLib.GameScene);e.PokerGameScene=t,__reflect(t.prototype,"game.PokerGameScene")}(game||(game={}));var game;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.m_seatSprites=new Array,e.empSeatList=new Array,e.addListen(),e}return __extends(n,t),Object.defineProperty(n,"Instance",{get:function(){return null==this.m_Instance&&(this.m_Instance=new n),this.m_Instance},enumerable:!0,configurable:!0}),n.clearInstance=function(){n.Instance.removeListen()},n.prototype.addListen=function(){e.RoomData.Instance.addSeatChanged.removeAll(),e.RoomData.Instance.delectSeatChanged.removeAll(),e.RoomData.Instance.addSeatChanged.add(this.addSeatSprite,this),e.RoomData.Instance.delectSeatChanged.add(this.delectSeatSprite,this),GX.PokerEvent.Instance.userSeatdown.add(this.userSeatdown,this)},n.prototype.removeListen=function(){e.RoomData.Instance.addSeatChanged.remove(this.addSeatSprite,this),e.RoomData.Instance.delectSeatChanged.remove(this.delectSeatSprite,this),GX.PokerEvent.Instance.userSeatdown.remove(this.userSeatdown,this)},n.prototype.addSeatSprite=function(t){var n=new e.SeatSprite(t);this.m_seatSprites.push(n)},n.prototype.delectSeatSprite=function(t){var n=this.m_seatSprites.first(function(e){return e.seatData.seatId==t});if(n){n&&n.parent&&n.parent.removeChild(n),n.destroy(),this.m_seatSprites.removeFirst(function(e){return e==n});var i=e.GameConstant.GetClientNoBySeatId(t),a=this.empSeatList.first(function(e){return e.id==i});if(null==a){var o=new eui.Image("setdown_png");o.name=i+"",o.id=i;var s=e.GameConstant.seatPosArr[i];s&&(1==i||2==i||3==i?(o.x=s.x-15,o.y=s.y):(o.x=s.x,o.y=s.y-10)),this.addChild(o),this.empSeatList&&this.empSeatList.length||(this.empSeatList=[]),this.empSeatList.push(o)}}},n.prototype.initSeatSprite=function(){for(var t=e.RoomData.Instance.seatList,n=0;n<t.length;n++)if(null!=t[n]){var i=new e.SeatSprite(t[n]);this.m_seatSprites.push(i),this.addChild(i),t[n].isSit?i.visible=!1:i.visible=!0;var a=e.GameConstant.seatPosArr[n];switch(e.GameView.Instance.maxNum){case 6:a=e.GameConstant.seatPosArr[n];break;case 12:a=e.GameConstant.seatMaxPosArr[n]}if(!a)return;i.x=a.x,i.y=a.y}},n.prototype.intEmptySeat=function(){this.empSeatList=null!=this.empSeatList&&this.empSeatList instanceof Array?this.empSeatList:[];
for(var t=0,n=this.empSeatList;t<n.length;t++){var i=n[t];null!=i&&null!=i.parent&&uniLib.DisplayUtils.removeFromParent(i)}this.empSeatList=[];for(var a=function(t){var n=o.empSeatList.first(function(e){return e.id==t});if(null!=n)return"continue";var i=new eui.Image("setdown_png");i.name="init_"+t,o.addChild(i);var a=e.GameConstant.seatPosArr[t];a&&(1==t||2==t||3==t?(i.x=a.x-15,i.y=a.y):(i.x=a.x,i.y=a.y-10)),i.id=t,o.empSeatList.push(i)},o=this,s=0;s<e.GameView.Instance.maxNum;s++)a(s)},n.prototype.resetSeat=function(){for(var e=0;e<this.m_seatSprites.length;e++)this.m_seatSprites[e].resetUserSprite()},Object.defineProperty(n.prototype,"seatSprites",{get:function(){return this.m_seatSprites},enumerable:!0,configurable:!0}),n.prototype.userSeatdown=function(t){t.uid==uniLib.NetMgr.UID&&(e.DataManager.isSitDown=!0,e.GameView.Instance.removeSeatDownBtn());for(var n=0,i=this.m_seatSprites;n<i.length;n++){var a=i[n];a.seatData.user.uid==t.uid&&(a.visible=!0,a.seatData.isSit=!0)}},n.prototype.resetIsInGame=function(){for(var t=0,n=this.m_seatSprites;t<n.length;t++){var i=n[t];i.seatData.isInGame=!1}e.DataManager.isInGame=!1},n}(egret.DisplayObjectContainer);e.SeatLayer=t,__reflect(t.prototype,"game.SeatLayer")}(game||(game={}));var game;!function(e){var t=function(){function e(){}return Object.defineProperty(e,"Instance",{get:function(){return null==this.m_Instance&&(this.m_Instance=new e),this.m_Instance},enumerable:!0,configurable:!0}),e.clearInstance=function(){this.m_Instance=null},e.prototype.playDDZBg=function(){uniLib.Utils.getLocalStorage("MusicVolime")?uniLib.SoundMgr.instance.musicVolume=uniLib.Utils.getLocalStorage("MusicVolime"):uniLib.SoundMgr.instance.musicVolume=.7,uniLib.SoundMgr.instance.playBgMusic(["bgm_game_mp3"])},e.prototype.playDDZWin=function(){uniLib.SoundMgr.instance.playSound("win_animi_mp3")},e.prototype.playDDZLose=function(){uniLib.SoundMgr.instance.playSound("lose_animi_mp3")},e.prototype.playUser=function(){uniLib.SoundMgr.instance.playSound("User_AI_mp3")},e.prototype.playButtonClick=function(){uniLib.SoundMgr.instance.playSound("btn_click_mp3")},e.prototype.playCardClick=function(){uniLib.SoundMgr.instance.playSound("Card_Click_mp3")},e.prototype.playChat=function(e,t){var n="Chat_String_ZJH"+t+"_"+this.getNameForGender(e)+"_mp3";uniLib.SoundMgr.instance.playSound(n)},e.prototype.playOutCard=function(){uniLib.SoundMgr.instance.playSound("Out_Card_Table_mp3")},e.prototype.playFlyIcon=function(){uniLib.SoundMgr.instance.playSound("coins_fly_in_long_mp3")},e.prototype.randomSound=function(){uniLib.SoundMgr.instance.playSound("frameFlicker_mp3")},e.prototype.playClock=function(){uniLib.SoundMgr.instance.playSound("clock_mp3")},e.prototype.getNameForGender=function(e){return"男"==e?"M":"W"},e.prototype.playNameForCardType=function(e,t){},e.prototype.PlayBetNum=function(e,t){uniLib.SoundMgr.instance.playSound("HB_Jetton_mp3")},e.prototype.playBet=function(){uniLib.SoundMgr.instance.playSound("ksxz_mp3")},e.prototype.playLandlord=function(){uniLib.SoundMgr.instance.playSound("qqz_mp3")},e.prototype.PlayActSound=function(e,t){var n=this.getNameForGender(t);uniLib.SoundMgr.instance.playSound("Act_"+e+"_"+n+"_mp3")},e.prototype.playCarshSound=function(){uniLib.SoundMgr.instance.playSound("Carsh_mp3")},e}();e.SoundHand=t,__reflect(t.prototype,"game.SoundHand")}(game||(game={}));var game;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.skinName=new Bet_ZJH_Skin,e.x=(uniLib.Global.screenWidth-e.width)/2,e.y=400,e._autoaddBtn.skin.roundImage&&(e._autoaddBtn.skin.roundImage.visible=!1),e._allInBtn.visible=!1,e}return __extends(n,t),Object.defineProperty(n.prototype,"slectUID",{set:function(e){this._selectUID=e},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Instance",{get:function(){return null==this.m_instance&&(this.m_instance=new n),this.m_instance},enumerable:!0,configurable:!0}),n.prototype.addEvent=function(){this._compareBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandel,this),this._followBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandel,this),this._abandonCardBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandel,this),this._addBetBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandel,this),this._autoaddBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandel,this),this._returnBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandel,this),this._betRadioButton0.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandel,this),this._betRadioButton1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandel,this),this._betRadioButton2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandel,this),this._betRadioButton3.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandel,this),this._allInBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandel,this),GX.PokerEvent.Instance.userBetEvent.add(this.actChange,this)},n.prototype.removeEvent=function(){this._compareBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandel,this),this._followBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandel,this),this._abandonCardBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandel,this),this._addBetBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandel,this),this._returnBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandel,this),this._autoaddBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandel,this),this._betRadioButton0.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandel,this),this._betRadioButton1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandel,this),this._betRadioButton2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandel,this),this._betRadioButton3.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandel,this),this._allInBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandel,this),GX.PokerEvent.Instance.userBetEvent.remove(this.actChange,this)},n.prototype.onClickHandel=function(t){e.DataManager.isChose=!1,this._noticeLabel.visible=!1,t.target==this._compareBtn?this.addCanSelectBg():t.target==this._followBtn?this.operateAct(Cmd.Operation.Call):t.target==this._addBetBtn?this.showPanel(openType.switchTobet):t.target==this._abandonCardBtn?(this.operateAct(Cmd.Operation.Fold),e.GameView.Instance.lookBtnVisable=!1,e.GameView.Instance.playBtnVisable=!1):t.target==this._autoaddBtn?e.DataManager.isAuto?this.changeRoundAnimation(!1):this.changeRoundAnimation(!0):t.target==this._returnBtn?this.showPanel(openType.switchbetToAll):t.target==this._betRadioButton0?this.operateAct(Cmd.Operation.Raise,Number(this._betRadioButton0.value)):t.target==this._betRadioButton1?this.operateAct(Cmd.Operation.Raise,Number(this._betRadioButton1.value)):t.target==this._betRadioButton2?this.operateAct(Cmd.Operation.Raise,Number(this._betRadioButton2.value)):t.target==this._betRadioButton3?this.operateAct(Cmd.Operation.Raise,Number(this._betRadioButton3.value)):t.target==this._allInBtn&&(this.operateAct(Cmd.Operation.Allin),this.addCanSelectBg())},n.prototype.changeRoundAnimation=function(t,n){void 0===n&&(n=!0),t?(this._autoaddBtn.label="取消自动",n&&this.operateAct(Cmd.Operation.AutoCall),this._autoaddBtn.skin.roundImage&&(this._autoaddBtn.skin.roundImage.visible=!0,egret.Tween.get(this._autoaddBtn.skin.roundImage,{loop:!0}).to({rotation:360},2e3)),e.DataManager.isAuto=!0):(n&&this.operateAct(Cmd.Operation.AutoCallCancel),this._autoaddBtn.label="自动跟注",this._autoaddBtn.skin.roundImage&&(this._autoaddBtn.skin.roundImage.visible=!1,egret.Tween.removeTweens(this._autoaddBtn.skin.roundImage)),e.DataManager.isAuto=!1)},n.prototype.operateAct=function(t,n){var i=new Cmd.BetRoomCmd_CS;switch(i.bet=new Cmd.DoorChips,this.removeCanSelectBg(),t){case Cmd.Operation.Raise:i.bet.chips=n,i.opType=Cmd.Operation.Raise;break;case Cmd.Operation.Call:i.opType=Cmd.Operation.Call;break;case Cmd.Operation.Fold:i.opType=Cmd.Operation.Fold;break;case Cmd.Operation.Compare:i.bet.potId=this._selectUID,i.opType=Cmd.Operation.Compare,e.DataManager.isChose=!1,this._noticeLabel.visible=!1;var a=e.GameConstant.GetSeatSpriteByUid(uniLib.NetMgr.UID);e.SoundHand.Instance.PlayActSound(Cmd.Operation.Compare,a.seatData.user.gender);break;case Cmd.Operation.AutoCall:i.opType=Cmd.Operation.AutoCall;break;case Cmd.Operation.AutoCallCancel:i.opType=Cmd.Operation.AutoCallCancel;break;case Cmd.Operation.Check:i.opType=Cmd.Operation.Check;break;case Cmd.Operation.Allin:i.opType=Cmd.Operation.Allin}i.opType&&uniLib.NetMgr.tcpSend(i)},n.prototype.showPanel=function(t){var i=this;n.openState=t,this.y=400,t==openType.openall?(console.error("打开界面"),this._autoaddBtn.visible=!1,this._betRadioButton0.visible=!1,this._betRadioButton1.visible=!1,this._betRadioButton2.visible=!1,this._betRadioButton3.visible=!1,this._returnBtn.visible=!1,this._abandonCardBtn.visible=!0,this._addBetBtn.visible=!0,this._compareBtn.visible=!0,this._followBtn.visible=!0,egret.Tween.get(this._addBetBtn).to({x:236,y:50},e.GameConstant.anitime).call(function(){egret.Tween.removeTweens(i._addBetBtn)}),egret.Tween.get(this._compareBtn).to({x:396,y:50},e.GameConstant.anitime).call(function(){egret.Tween.removeTweens(i._compareBtn)}),egret.Tween.get(this._followBtn).to({x:524,y:155},e.GameConstant.anitime).call(function(){egret.Tween.removeTweens(i._followBtn)}),egret.Tween.get(this._abandonCardBtn).to({x:108,y:155},e.GameConstant.anitime).call(function(){egret.Tween.removeTweens(i._abandonCardBtn)})):t==openType.opensingle?(this._betRadioButton0.visible=!1,this._betRadioButton1.visible=!1,this._betRadioButton2.visible=!1,this._betRadioButton3.visible=!1,this._returnBtn.visible=!1,this._autoaddBtn.visible=!0,this._abandonCardBtn.visible=!1,this._addBetBtn.visible=!1,this._compareBtn.visible=!1,this._followBtn.visible=!1,this._abandonCardBtn.visible=!0,egret.Tween.get(this._abandonCardBtn).to({x:108,y:155},e.GameConstant.anitime).call(function(){egret.Tween.removeTweens(i._abandonCardBtn)}),egret.Tween.get(this._autoaddBtn).to({x:524,y:155},e.GameConstant.anitime).call(function(){egret.Tween.removeTweens(i._autoaddBtn)})):t==openType.openbet?(this._betRadioButton0.visible=!0,this._betRadioButton1.visible=!0,this._betRadioButton2.visible=!0,this._betRadioButton3.visible=!0,this._returnBtn.visible=!0,this._autoaddBtn.visible=!1,this._abandonCardBtn.visible=!1,this._addBetBtn.visible=!1,this._compareBtn.visible=!1,this._followBtn.visible=!1,this._abandonCardBtn.visible=!1,egret.Tween.get(this._betRadioButton0).to({x:108,y:155},e.GameConstant.anitime).call(function(){egret.Tween.removeTweens(i._betRadioButton0)}),egret.Tween.get(this._betRadioButton1).to({x:236,y:50},e.GameConstant.anitime).call(function(){egret.Tween.removeTweens(i._betRadioButton1)}),egret.Tween.get(this._betRadioButton2).to({x:396,y:50},e.GameConstant.anitime).call(function(){egret.Tween.removeTweens(i._betRadioButton2)}),egret.Tween.get(this._betRadioButton3).to({x:524,y:155},e.GameConstant.anitime).call(function(){egret.Tween.removeTweens(i._betRadioButton3)})):t==openType.switchToAll?(egret.Tween.get(this._addBetBtn).to({x:316,y:155},e.GameConstant.anitime).call(function(){i._addBetBtn.visible=!1,egret.Tween.removeTweens(i._addBetBtn)}),egret.Tween.get(this._compareBtn).to({x:316,y:155},e.GameConstant.anitime).call(function(){i._compareBtn.visible=!1,egret.Tween.removeTweens(i._compareBtn)}),egret.Tween.get(this._followBtn).to({x:316,y:155},e.GameConstant.anitime).call(function(){i._followBtn.visible=!1,egret.Tween.removeTweens(i._followBtn)}),egret.Tween.get(this._abandonCardBtn).to({x:316,y:155},e.GameConstant.anitime).call(function(){i._abandonCardBtn.visible=!1,egret.Tween.removeTweens(i._abandonCardBtn)}),egret.Tween.get(this._autoaddBtn).to({x:316,y:155},e.GameConstant.anitime).call(function(){i._autoaddBtn.visible=!1,egret.Tween.removeTweens(i._autoaddBtn),i.showPanel(openType.openall)})):t==openType.switchToSingle?(egret.Tween.get(this._addBetBtn).to({x:316,y:155},e.GameConstant.anitime).call(function(){i._addBetBtn.visible=!1,egret.Tween.removeTweens(i._addBetBtn)}),egret.Tween.get(this._compareBtn).to({x:316,y:155},e.GameConstant.anitime).call(function(){i._compareBtn.visible=!1,egret.Tween.removeTweens(i._compareBtn)}),egret.Tween.get(this._followBtn).to({x:316,y:155},e.GameConstant.anitime).call(function(){i._followBtn.visible=!1,egret.Tween.removeTweens(i._followBtn)}),egret.Tween.get(this._abandonCardBtn).to({x:316,y:155},e.GameConstant.anitime).call(function(){i._abandonCardBtn.visible=!1,egret.Tween.removeTweens(i._abandonCardBtn)}),egret.Tween.get(this._autoaddBtn).to({x:316,y:155},e.GameConstant.anitime).call(function(){i._autoaddBtn.visible=!1,egret.Tween.removeTweens(i._autoaddBtn),i.showPanel(openType.opensingle)})):t==openType.switchTobet?(egret.Tween.get(this._addBetBtn).to({x:316,y:155},e.GameConstant.anitime).call(function(){i._addBetBtn.visible=!1,egret.Tween.removeTweens(i._addBetBtn)}),egret.Tween.get(this._compareBtn).to({x:316,y:155},e.GameConstant.anitime).call(function(){i._compareBtn.visible=!1,egret.Tween.removeTweens(i._compareBtn)}),egret.Tween.get(this._followBtn).to({x:316,y:155},e.GameConstant.anitime).call(function(){i._followBtn.visible=!1,egret.Tween.removeTweens(i._followBtn)}),egret.Tween.get(this._abandonCardBtn).to({x:316,y:155},e.GameConstant.anitime).call(function(){i._abandonCardBtn.visible=!1,egret.Tween.removeTweens(i._abandonCardBtn)}),egret.Tween.get(this._autoaddBtn).to({x:316,y:155},e.GameConstant.anitime).call(function(){i._autoaddBtn.visible=!1,egret.Tween.removeTweens(i._autoaddBtn),i.showPanel(openType.openbet)})):t==openType.switchbetToAll&&(egret.Tween.get(this._betRadioButton0).to({x:316,y:155},e.GameConstant.anitime).call(function(){i._betRadioButton0.visible=!1,egret.Tween.removeTweens(i._betRadioButton0)}),egret.Tween.get(this._betRadioButton1).to({x:316,y:155},e.GameConstant.anitime).call(function(){i._betRadioButton1.visible=!1,egret.Tween.removeTweens(i._betRadioButton1)}),egret.Tween.get(this._betRadioButton2).to({x:316,y:155},e.GameConstant.anitime).call(function(){i._betRadioButton2.visible=!1,egret.Tween.removeTweens(i._betRadioButton2)}),egret.Tween.get(this._betRadioButton3).to({x:316,y:155},e.GameConstant.anitime).call(function(){i._betRadioButton3.visible=!1,egret.Tween.removeTweens(i._betRadioButton3),i.showPanel(openType.openall)}))},n.prototype.addCanSelectBg=function(){for(var t=0,i=0,a=e.SeatLayer.Instance.seatSprites;i<a.length;i++){var o=a[i];o.seatData.isReady&&o.canSelectState&&o.userSprite&&(t++,o.addHeadSelectBg())}if(t>1)e.DataManager.isChose=!0,this._noticeLabel.visible=!0;else{var s=e.SeatLayer.Instance.seatSprites.first(function(e){return 1==e.canSelectState&&e.seatData.isReady}),r=e.GameConstant.GetSeatSpriteByUid(uniLib.NetMgr.UID);s&&(n.Instance.slectUID=s.uid,n.Instance.operateAct(Cmd.Operation.Compare),r&&r.seatData&&r.seatData.user&&e.SoundHand.Instance.PlayActSound(Cmd.Operation.Compare,r.seatData.user.gender)),this.removeCanSelectBg()}},n.prototype.removeCanSelectBg=function(){for(var t=0,n=e.SeatLayer.Instance.seatSprites;t<n.length;t++){var i=n[t];i.canSelectState&&i.userSprite&&i.removeHeadSelectBg()}this._noticeLabel.visible=!1},n.prototype.resetOffTween=function(){egret.Tween.removeTweens(this._addBetBtn),egret.Tween.removeTweens(this._compareBtn),egret.Tween.removeTweens(this._followBtn),egret.Tween.removeTweens(this._abandonCardBtn),egret.Tween.removeTweens(this._betRadioButton0),egret.Tween.removeTweens(this._betRadioButton1),egret.Tween.removeTweens(this._betRadioButton2),egret.Tween.removeTweens(this._betRadioButton3),egret.Tween.removeTweens(this._autoaddBtn)},n.prototype.offPanel=function(){var t=this;console.error("关闭界面"),this.removeCanSelectBg(),n.openState=null,this._returnBtn.visible=!1,this._autoaddBtn.selected=!1,egret.Tween.get(this._addBetBtn).to({x:297,y:155},e.GameConstant.anitime).call(function(){t._addBetBtn.visible=!1,egret.Tween.removeTweens(t._addBetBtn)}),egret.Tween.get(this._compareBtn).to({x:297,y:155},e.GameConstant.anitime).call(function(){t._compareBtn.visible=!1,egret.Tween.removeTweens(t._compareBtn)}),egret.Tween.get(this._followBtn).to({x:297,y:155},e.GameConstant.anitime).call(function(){t._followBtn.visible=!1,egret.Tween.removeTweens(t._followBtn)}),egret.Tween.get(this._abandonCardBtn).to({x:297,y:155},e.GameConstant.anitime).call(function(){t._abandonCardBtn.visible=!1,egret.Tween.removeTweens(t._abandonCardBtn)}),egret.Tween.get(this._betRadioButton0).to({x:297,y:155},e.GameConstant.anitime).call(function(){t._betRadioButton0.visible=!1,egret.Tween.removeTweens(t._betRadioButton0)}),egret.Tween.get(this._betRadioButton1).to({x:297,y:155},e.GameConstant.anitime).call(function(){t._betRadioButton1.visible=!1,egret.Tween.removeTweens(t._betRadioButton1)}),egret.Tween.get(this._betRadioButton2).to({x:297,y:155},e.GameConstant.anitime).call(function(){t._betRadioButton2.visible=!1,egret.Tween.removeTweens(t._betRadioButton2)}),egret.Tween.get(this._betRadioButton3).to({x:297,y:155},e.GameConstant.anitime).call(function(){t._betRadioButton3.visible=!1,egret.Tween.removeTweens(t._betRadioButton3)}),egret.Tween.get(this._autoaddBtn).to({x:297,y:155},e.GameConstant.anitime).call(function(){egret.Tween.removeTweens(t._autoaddBtn.skin.roundImage),t._autoaddBtn.visible=!1,t._autoaddBtn.label="自动跟注",t._autoaddBtn.skin.roundImage.visible=!1,e.DataManager.isAuto=!1,egret.Tween.removeTweens(t._autoaddBtn),e.PopupManager.removePopUp(n.Instance)}),this.removeEvent()},n.prototype.OnOpen=function(t){this.resetOffTween(),this._abandonCardBtn.x=297,this._abandonCardBtn.y=155,this._followBtn.x=297,this._followBtn.y=155,this._compareBtn.x=297,this._compareBtn.y=155,this._addBetBtn.x=297,this._addBetBtn.y=155,e.PopupManager.addPopUp(n.Instance),this.showPanel(t),this.addEvent()},n.prototype.updateChipsNum=function(e){if(e)for(var t=1,n=0,i=e;n<i.length;n++){var a=i[n];switch(a.op){case Cmd.Operation.Raise:this.setData(t,a.chips),t++;break;case Cmd.Operation.Call:this._followBtn.skin.btnNum.text=""+a.chips;break;case Cmd.Operation.Compare:this._compareBtn.skin.btnNum.text=""+a.chips;break;case Cmd.Operation.AutoCall:this._autoaddBtn.skin.btnNum.text=""+a.chips}}},n.prototype.setData=function(e,t){switch(e){case 1:this._betRadioButton0.value=t,this._betRadioButton0.label=""+t;break;case 2:this._betRadioButton1.value=t,this._betRadioButton1.label=""+t;break;case 3:this._betRadioButton2.value=t,this._betRadioButton2.label=""+t;break;case 4:this._betRadioButton3.value=t,this._betRadioButton3.label=""+t}},n.prototype.updateBtnEnable=function(e){if(e){this._followBtn.enabled=!1,this._addBetBtn.enabled=!1,this._abandonCardBtn.enabled=!1,this._compareBtn.enabled=!1,this._allInBtn.visible=!1;for(var t=0,n=e;t<n.length;t++){var i=n[t];switch(i){case Cmd.Operation.Check:break;case Cmd.Operation.Call:this._followBtn.enabled=!0;break;case Cmd.Operation.Raise:this._addBetBtn.enabled=!0;break;case Cmd.Operation.Fold:this._abandonCardBtn.enabled=!0;break;case Cmd.Operation.Compare:this._compareBtn.enabled=!0;break;case Cmd.Operation.Allin:this._allInBtn.visible=!0,this._followBtn.visible=!1,this._allInBtn.x=this._allInBtn.x,this._allInBtn.y=this._allInBtn.y}}}},n.prototype.actChange=function(t){if(t.circle&&(e.GameView.Instance.betTimesLabel=t.circle),(t.opType==Cmd.Operation.Fold||t.opType==Cmd.Operation.GiveUp)&&(this.removeCanSelectBg(),this.offPanel(),t.uid==uniLib.NetMgr.UID&&e.EffectCreate.Instance.cardLeave(t.uid,t.opType)),t.opType==Cmd.Operation.Call||t.opType==Cmd.Operation.Raise||t.opType==Cmd.Operation.Compare||t.opType==Cmd.Operation.Check||t.opType==Cmd.Operation.Fold){var n=e.GameConstant.GetSeatSpriteByUid(t.uid);n||console.error("没有找到对应人物",t.uid),e.SoundHand.Instance.PlayActSound(t.opType,n.seatData.user.gender)}},n.prototype.getColorByValue=function(e){switch(e){case Number(this._betRadioButton0.value):return"hb_1q_white";case Number(this._betRadioButton1.value):return"hb_1shw_white";case Number(this._betRadioButton2.value):return"hb_5bw_white";case Number(this._betRadioButton3.value):return"hb_1bw_white";default:return"hb_1q_white"}},n}(eui.Component);e.BetSelectPanel=t,__reflect(t.prototype,"game.BetSelectPanel");var n=function(e){function n(n,i){var a=e.call(this)||this;a.m_chip=n,a.main=i;var o=new eui.Image(t.Instance.getColorByValue(n)),s=new egret.TextField;return s.text=n+"",o.width=40,o.height=41,a.addChild(o),s.fontFamily="黑体",s.stroke=1,s.size=20,s.x=(40-s.width)/2,s.y=(41-s.height)/2,a.addChild(s),a}return __extends(n,e),Object.defineProperty(n.prototype,"chip",{get:function(){return this.m_chip},enumerable:!0,configurable:!0}),n}(egret.DisplayObjectContainer);e.ChipsSprite=n,__reflect(n.prototype,"game.ChipsSprite")}(game||(game={}));var openType;!function(e){e[e.close=1]="close",e[e.openall=2]="openall",e[e.opensingle=3]="opensingle",e[e.openbet=4]="openbet",e[e.switchToAll=5]="switchToAll",e[e.switchToSingle=6]="switchToSingle",e[e.switchTobet=7]="switchTobet",e[e.switchbetToAll=8]="switchbetToAll"}(openType||(openType={}));var game;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e._isClick=!0,e.skinName=new Chat_ZJH_Skin,e.initUI(),e}return __extends(n,t),Object.defineProperty(n,"Instance",{get:function(){return null==this.m_instance&&(this.m_instance=new n),this.m_instance},enumerable:!0,configurable:!0}),n.prototype.initUI=function(){for(var t=1;31>=t;t++){var n=new eui.RadioButton;n.skinName=new FaceButton_ZJH_Skin,n.iconDisplay.texture=RES.getRes("face_DDZ"+t),n.groupName="face",n.value=t,this.faceGroup.addChild(n)}for(var t=0;12>t;t++){var i=new eui.RadioButton;i.skinName=new ChatRadioButton_ZJH_Skin,i.groupName="chat",i.value=t,i.label=t+1+"."+e.GameData.getInstance().ShortTalkArr[t],i.y=56*t,this.chatGroup.addChild(i)}this.touchEnabled=!1,this.chatRadioButton.selected=!0,this.faceScroller.visible=!1,this.chatScroller.visible=!0,this.textField.name="short_input",this.textField.size=28,this.textField.type=egret.TextFieldType.INPUT,this.textField.text="请输入聊天内容",this.touchEnabled=!0,this.sendBtn.name="short_send"},n.prototype.addListener=function(){this.chatRadioButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRaduiButtonTap,this),this.faceRadioButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRaduiButtonTap,this),this.closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.faceGroup.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onFaceGroupTap,this),this.chatGroup.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChatGroupTap,this),this.textField.addEventListener(egret.FocusEvent.FOCUS_IN,this.onTextFieldFocusIn,this),this.textField.addEventListener(egret.FocusEvent.FOCUS_OUT,this.onTextFieldFocusOut,this),this.sendBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sendClickHandler,this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this)},n.prototype.onChatGroupTap=function(t){e.SoundHand.Instance.playButtonClick();var n=this,i=t.target;if(i instanceof eui.RadioButton){var a="2"+i.value,o=new Cmd.CommonChat_C;o.words=a,e.PokerFunction.tcpSend(o),GX.PopUpManager.removePopUp(this,GX.PopUpEffect.CENTER),this._isClick=!1,uniLib.SetUniEventTimeout(this,function(){n._isClick=!0},3e3,1,this)}},n.prototype.onFaceGroupTap=function(t){e.SoundHand.Instance.playButtonClick();var n=this,i=t.target;if(i instanceof eui.RadioButton){var a=new Cmd.CommonChat_C,o="1"+i.value;a.words=o,e.PokerFunction.tcpSend(a),GX.PopUpManager.removePopUp(this,GX.PopUpEffect.CENTER),this._isClick=!1,uniLib.SetUniEventTimeout(this,function(){n._isClick=!0},3e3,1,this)}},n.prototype.onRaduiButtonTap=function(t){e.SoundHand.Instance.playButtonClick(),t.target==this.chatRadioButton?(this.faceScroller.visible=!1,this.chatScroller.visible=!0):t.target==this.faceRadioButton&&(this.faceScroller.visible=!0,this.chatScroller.visible=!1)},n.prototype.onTouchTap=function(t){e.SoundHand.Instance.playButtonClick(),t.target==this.textField&&t.target.setFocus()},n.prototype.sendClickHandler=function(t){e.SoundHand.Instance.playButtonClick();var n=this.textField.text;if(-1!=n.indexOf("请输入聊天内容"))return this.textField.text="",void(this._isClick=!0);if(""==n)return this._isClick=!0,void e.PublicManage.getInstance().showMildWarnShow("聊天内容不能为空");var i=new Cmd.CommonChat_C;i.words=this.textField.text,e.PokerFunction.tcpSend(i),this.textField.text="",GX.PopUpManager.removePopUp(this,GX.PopUpEffect.CENTER)},n.prototype.onTextFieldFocusIn=function(e){e.target.setFocus(),-1!=this.textField.text.indexOf("请输入聊天内容")&&(this.textField.text="")},n.prototype.onTextFieldFocusOut=function(e){""==this.textField.text&&(this.textField.text="请输入聊天内容")},n.prototype.createRecordYetOpen=function(){this._yetOpen||(this._yetOpen=e.ResUtil.createTextFeild(1456961,egret.HorizontalAlign.CENTER,"此功能暂未开放",30),this.addChild(this._yetOpen),this._yetOpen.x=540,this._yetOpen.y=280),this._yetOpen.visible=!0},n.prototype.destory=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this.chatRadioButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRaduiButtonTap,this),this.faceRadioButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRaduiButtonTap,this),this.closeButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.faceGroup.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onFaceGroupTap,this),this.chatGroup.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChatGroupTap,this),this.textField.removeEventListener(egret.FocusEvent.FOCUS_IN,this.onTextFieldFocusIn,this),this.textField.removeEventListener(egret.FocusEvent.FOCUS_OUT,this.onTextFieldFocusOut,this),this.sendBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.sendClickHandler,this),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this)},n.prototype.setRecordData=function(e){},n.prototype.onClose=function(t){e.SoundHand.Instance.playButtonClick(),GX.PopUpManager.removePopUp(this,GX.PopUpEffect.CENTER),this.destory()},n}(eui.Component);e.ChatPanel=t,__reflect(t.prototype,"game.ChatPanel")}(game||(game={}));var game;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.init(),e}return __extends(n,t),n.prototype.init=function(){this._facePanel=[];for(var t=0;t<e.GameView.Instance.maxNum;t++){var n=new egret.Sprite;this._facePanel.push(n),this.addChild(n)}this._quickTalkPanel=[];for(var t=0;t<e.GameView.Instance.maxNum;t++){var n=new egret.Sprite;this._quickTalkPanel.push(n),this.addChild(n)}this._talkPanel=[];for(var t=0;t<e.GameView.Instance.maxNum;t++){var n=new egret.Sprite;this._talkPanel.push(n),this.addChild(n)}},n.prototype.showCommonChat=function(t,n){var i=e.GameConstant.GetSeatSpriteByUid(t);if(i&&i.uid){var a=e.GameConstant.GetClientNoByUid(t),o=i.seatData.user?i.seatData.user.gender:null,s=e.GameConstant.seatPosArr[a];switch(e.GameView.Instance.maxNum){case 6:s=e.GameConstant.seatPosArr[a];break;case 12:s=e.GameConstant.seatMaxPosArr[a]}if(s){switch(a){case 0:this._quickTalkPanel[a].x=s.x+100,this._quickTalkPanel[a].y=s.y,this._facePanel[a].x=s.x+100,this._facePanel[a].y=s.y;break;case 1:this._quickTalkPanel[a].x=s.x-180,this._quickTalkPanel[a].y=s.y,this._facePanel[a].x=s.x-100,this._facePanel[a].y=s.y;break;case 2:this._quickTalkPanel[a].x=s.x-180,this._quickTalkPanel[a].y=s.y,this._facePanel[a].x=s.x-100,this._facePanel[a].y=s.y;break;case 3:this._quickTalkPanel[a].x=s.x-180,this._quickTalkPanel[a].y=s.y,this._facePanel[a].x=s.x-100,this._facePanel[a].y=s.y;break;case 4:this._quickTalkPanel[a].x=s.x+100,this._quickTalkPanel[a].y=s.y,this._facePanel[a].x=s.x+100,this._facePanel[a].y=s.y;break;case 5:this._quickTalkPanel[a].x=s.x+100,this._quickTalkPanel[a].y=s.y,this._facePanel[a].x=s.x+100,this._facePanel[a].y=s.y;break;default:this._quickTalkPanel[a].x=s.x,this._quickTalkPanel[a].y=s.y,this._facePanel[a].x=s.x,this._facePanel[a].y=s.y}var r;if("1"==n.charAt(0)){r=n.substr(1,n.length-1);var h=uniLib.DisplayUtils.createMovieClicp("face_"+r+"_new");this._facePanel[a].addChild(h),h.scaleX=1,h.scaleY=1,h.play(-1),GX.GameLayerManager.addUIToEffect(h),e.Timer.setTimeout(function(){h.stop(),GX.GameLayerManager.removeUI(h)},this,2e3)}else if("2"==n.charAt(0)){r=n.substr(1,n.length-1),e.SoundHand.Instance.playChat(o,r);var l=this._quickTalkPanel[a];if(!l)return;this.creatChatPop(a,e.GameData.getInstance().ShortTalkArr[r],l),egret.Tween.get(l).wait(3e3).call(this.quickTalkCompelete,this,[l])}else{var l=this._quickTalkPanel[a];if(!l)return;this.creatChatPop(a,n,l),egret.Tween.get(l).wait(3e3).call(this.quickTalkCompelete,this,[l])}}}},n.prototype.creatChatPop=function(t,n,i){if(i){var a=e.ResUtil.createBitmapByName("chat_pop_DDZ");a.scale9Grid=new egret.Rectangle(28,33,13,5),a.width=245,i.addChild(a);var o=e.ResUtil.createTextFeild(1456961,egret.HorizontalAlign.LEFT,"",28,35,10,210,!1,4);o.text=n,i.addChild(o),a.height=10+o.height+20,t>0&&4>t?(a.scaleX=-1,a.x=180,o.x=-45):o.x-=10}},n.prototype.talkCompelete=function(e,t){e&&egret.Tween.removeTweens(e),uniLib.DisplayUtils.removeAllChildren(this._talkPanel[t]),this.parent&&this.parent.removeChild(this)},n.prototype.showCompelete=function(t,n){t&&egret.Tween.removeTweens(t),uniLib.DisplayUtils.removeAllChildren(this._facePanel[n]),e.GameInfo.topLayer.removeChild(this)},n.prototype.quickTalkCompelete=function(t,n){t&&egret.Tween.removeTweens(t),uniLib.DisplayUtils.removeAllChildren(t),e.GameInfo.topLayer.removeChild(this)},n}(eui.Component);e.ChatPop=t,__reflect(t.prototype,"game.ChatPop")}(game||(game={}));var game;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e._colorArr=[16740864,1151744,16714752],e.protocolType=1,e.status={status1:"同意",status0:"等待选择",status2:"拒绝"},e.skinName=new DismissPanel_ZJH_Skin,e.initPanel(),e}return __extends(n,t),n.prototype.initPanel=function(){this.touchEnabled=!0,this.yesBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onAgreeHandler,this),this.noBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRefuse,this)},n.prototype.stopTimer=function(){this._timer&&(this._timer.stop(),this._timer=null)},n.prototype.timerHandle=function(e){var t=new Date,n=t.getTime(),i=this._totalTime-(n-this._startTime)/1e3;i>0?this._timeTxt.text=Math.floor(this._totalTime-(n-this._startTime)/1e3).toString():this.parent&&this.parent.removeChild(this)},n.prototype.setData=function(t){if(this.protocolType=1,null!=t.leftSec?this.endTime=e.GameTime.localNow()+1e3*t.leftSec:this.endTime=e.GameTime.localNow()+(t.endTime-e.GameTime.serverNow()),this.time=Math.floor(this.endTime/1e3-e.GameTime.localNow()/1e3),t.sponsor){var n=t.sponsor+"申请解散房间，(超过"+this.time+"秒未做出选择，则默认同意)？";this.info.text=n}t.voterList;this._userList=[];this.updataTimer(),egret.clearInterval(this.timer),this.timer=egret.setInterval(this.updataTimer,this,1e3)},n.prototype.setData_Mjhong=function(t){this.protocolType=2,this.endTime=e.GameTime.localNow()+1e3*t.waitTime;var n=Math.floor(this.endTime/1e3-e.GameTime.localNow()/1e3);if(t.uid){var i="玩家"+t.uid+"\n申请解散房间请问是否同意(超过"+n+"秒未做出选择，则默认同意)？";this.info.text=i}this.updataTimer(),egret.clearInterval(this.timer),this.timer=egret.setInterval(this.updataTimer,this,1e3)},n.prototype.updataTimer=function(){this.time=Math.floor(this.endTime/1e3-e.GameTime.localNow()/1e3),this.time<0&&(this.time=0,egret.clearInterval(this.timer)),this._timeTxt.text=this.time+""},n.prototype.setButtonState=function(e){this.yesBtn.visible=e,this.noBtn.visible=e},n.prototype.refrenshData=function(e){var t=e.voterList;if(!t||t&&t.length<1)this.parent&&this.parent.removeChild(this);else{var n=t.first(function(e){return 0==e.yesOrWait});!n&&this.parent&&this.parent.removeChild(this)}},n.prototype.enableBtns=function(){this.yesBtn&&this.yesBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onAgreeHandler,this),this.noBtn&&this.noBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRefuse,this)},n.prototype.updateStatus=function(e,t){0==e&&(e=2);
var n=this._userList.indexOf(t);n>=0&&(this["_status"+n].text=this.status["status"+e],this["_status"+n].textColor=this._colorArr[e])},n.prototype.onAgreeHandler=function(t){if(2==this.protocolType){var n=new Cmd.ReplyDissolveRoom_C;return n.isAgree=1,void e.PokerFunction.tcpSend(n)}this.yesBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onAgreeHandler,this),this.noBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRefuse,this);var i=new Cmd.DissolveRoomReturnCmd_C;i.yesOrNo=!0,e.PokerFunction.tcpSend(i),this.parent&&this.parent.removeChild(this)},n.prototype.onRefuse=function(t){if(2==this.protocolType){var n=new Cmd.ReplyDissolveRoom_C;return n.isAgree=0,void e.PokerFunction.tcpSend(n)}var i=new Cmd.DissolveRoomReturnCmd_C;i.yesOrNo=!1,e.PokerFunction.tcpSend(i),this.parent&&this.parent.removeChild(this)},n.prototype.destory=function(){this.enableBtns(),this.yesBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onAgreeHandler,this),this.noBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRefuse,this),this.yesBtn=null,this.noBtn=null,this.info=null,this._userList=null},n}(eui.Component);e.DismissPanel=t,__reflect(t.prototype,"game.DismissPanel")}(game||(game={}));var game;!function(e){var t=function(t){function i(){var e=t.call(this)||this;return e.skinName=new GpsPanel_ZJH_Skin,e.init(),e}return __extends(i,t),i.prototype.init=function(){this.addEvent()},i.prototype.setDate=function(e){e.list&&(this._ipGpsList=e.list),this.reset(e)},i.prototype.getNearset=function(t){if(this._nearestUserName="",this._distance=Number.MAX_VALUE,t.lat&&t.lng){for(var n=0;n<this._ipGpsList.length;n++)if(t.uid!=this._ipGpsList[n].uid){var i=uniLib.Utils.getDistance(t.lat,t.lng,this._ipGpsList[n].lat,this._ipGpsList[n].lng);i<this._distance&&(this._distance=i,this._nearestUserName=e.PokerFunction.GetUserInfoByUid(this._ipGpsList[n].uid).nickName)}}else this._nearestUserName=e.PokerFunction.GetUserInfoByUid(t.uid).nickName.slice(0,5),this._distance=-1},i.prototype.reset=function(e){for(var t=e,i=new eui.ArrayCollection,a=(t.list,0);a<t.list.length;a++){var o=t.list[a];this.getNearset(o),i.addItem({nearestUserName:this._nearestUserName,distance:this._distance,item:o})}this._itemList.itemRenderer=n,this._itemList.dataProvider=i},i.prototype.addEvent=function(){this._backBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBackHandler,this)},i.prototype.removeEvent=function(){this._backBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBackHandler,this)},i.prototype.onBackHandler=function(e){GX.PopUpManager.removePopUp(this,GX.PopUpEffect.CENTER),this.destory(),this.removeEvent()},i.prototype.destory=function(){this._backBtn=null},i}(eui.Component);e.DistancePanel=t,__reflect(t.prototype,"game.DistancePanel");var n=function(t){function n(){var e=t.call(this)||this;return e.skinName=GpsItem_ZJH_Skin,e.init(),e}return __extends(n,t),n.prototype.init=function(){},n.prototype.dataChanged=function(){var t=this.data.item;if(t){if(this._userName.text=e.PokerFunction.GetUserInfoByUid(t.uid).nickName.slice(0,5),this._ip.text=t.ipstr,this._otherName.text=this.data.nearestUserName,this.data.distance<=0)return void(this._distance.text="未获得位置信息");this._distance.text=(this.data.distance/1e3).toFixed(3).toString()+"km"}},n}(eui.ItemRenderer);e.DistanceItem=n,__reflect(n.prototype,"game.DistanceItem")}(game||(game={}));var game;!function(e){var t=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.init(),this.addEvent()},t.prototype.init=function(){},t.prototype.addEvent=function(){},t.prototype.removeEvent=function(){},t.prototype.destroy=function(){this.removeEvent()},t}(eui.Component);e.BaseEui=t,__reflect(t.prototype,"game.BaseEui",["game.EuiSkinInt"])}(game||(game={}));var game;!function(e){var t=function(t){function a(){var n=t.call(this)||this;return e.GameView.Instance.maxNum>6?n.skinName=new TotalResult_ZJH_12_Skin:n.skinName=new TotalResult_ZJH_Skin,e.GameView.Instance.matchId?n.oneMoreBtn.visible=!0:n.oneMoreBtn.visible=!1,n.init(),n}return __extends(a,t),a.prototype.init=function(){},a.prototype.setData=function(e){this.reset(e)},a.prototype.share=function(){var t=new uniLib.WXShareVo;t.shareWay=0;var n=1;uniLib.Utils.isIOS()&&(n=.6);var i=new egret.Bitmap(uniLib.DisplayUtils.catchScreenToTex(e.GameInfo.uiLayer,new egret.Rectangle(0,0,uniLib.Global.screenWidth,uniLib.Global.screenHeight),n));t.shareImageData=uniLib.DisplayUtils.catchScreen(i),MJLobby.MJLobbyData.getInstance().hasXianLiao?uniLib.Global.dispatchEvent(uniLib.ZqEvent.SHARE,t,!1):uniLib.ZQGameSdk.share(t,null,this)},a.prototype.reset=function(t){this._roomId.text="房间号："+e.RoomData.Instance.roomId;var a=t.gameNum;this._gameNum.text="局数："+a;for(var o=[],s=0;s<t.recordList.length;s++){var r=t.recordList[s],h=e.RoomData.Instance.ownerId==r.user.uid?!0:!1,l=i.other;o.push({gameNum:a,isLord:h,item:r,wintype:l})}t.matchId?this._matchId.text="匹配号："+t.matchId:this._matchId.text="";for(var d,c,u=null,m=null,s=0;s<o.length;s++)u||m||(u=o[s].item.profitSum,m=o[s].item.profitSum,d=s,c=s),u>o[s].item.profitSum&&(u=o[s].item.profitSum,c=s),m<o[s].item.profitSum&&(m=o[s].item.profitSum,d=s);null!=c&&(o[c].wintype=i.lose),null!=d&&(o[d].wintype=i.win);var p=new eui.ArrayCollection(o);this._itemList.itemRenderer=n,this._itemList.dataProvider=p;var g=new Date(Date.now()),f=g.getUTCFullYear(),C=g.getUTCMonth()+1,v=g.getUTCDate(),y=g.getHours()>=10?g.getHours():"0"+g.getHours(),b=g.getMinutes()>=10?g.getMinutes():"0"+g.getMinutes();g.getSeconds()>=10?g.getSeconds():"0"+g.getSeconds();this._datatime.text=f+"."+C+"."+v+"   "+y+":"+b,t.happyPoint&&(this.happyPoint.text="喜分:"+t.happyPoint)},a.prototype.oneMoreAgain=function(){e.ResUtil.removeFromParent(this),e.GameView.exitGame(),uniLib.Global.dispatchEvent(uniLib.ZqEvent.EVENT_G2L,"game_request_continue")},a.prototype.addUIListener=function(){this._shareBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.share,this),this.exitBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBackHandler,this),this.oneMoreBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.oneMoreAgain,this)},a.prototype.adaptationWidth=function(){t.prototype.adaptationWidth.call(this)},a.prototype.onBackHandler=function(){e.SoundHand.Instance.playButtonClick(),e.GameInfo.uiLayer.removeChild(this),e.GameView.exitGame()},a.prototype.removeUIListener=function(){this._shareBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.share,this),this.exitBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBackHandler,this),this.oneMoreBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.oneMoreAgain,this)},a.prototype.destory=function(){this._shareBtn=null,this._datatime=null,this._itemNode.numChildren&&uniLib.DisplayUtils.removeAllChildren(this._itemNode),this._itemNode=null},a}(e.EuiPanel);e.GameOverPanel=t,__reflect(t.prototype,"game.GameOverPanel");var n=function(t){function n(){var n=t.call(this)||this;return e.GameView.Instance.maxNum>6?n.skinName=new TotalItemSkin_lose_ZJH12_Skin:n.skinName=new TotalItemSkin_lose_ZJH_Skin,n.WinLoseImage.visible=!1,n}return __extends(n,t),n.prototype.dataChanged=function(){var e=this.data,t=e.item,n=t.user;if(n){this._uid.text=n.uid+"",this._headmc.source=n.headurl;var a=n.name;switch(a.slice(0,5),this._username.text=a,this._bank.visible=e.isLord,t.profitSum>=0?(this._totalCount.font="OverWinFnt_fnt",this._totalCount.text="+"+t.profitSum):(this._totalCount.font="OverLoseFnt_fnt",this._totalCount.text=""+t.profitSum),e.wintype){case i.other:this.WinLoseImage.visible=!1;break;case i.lose:this.WinLoseImage.visible=!0,this.WinLoseImage.texture=RES.getRes("label_lose");break;case i.win:this.WinLoseImage.visible=!0,this.WinLoseImage.texture=RES.getRes("label_winner")}}},n}(eui.ItemRenderer);e.TotalItemSkin=n,__reflect(n.prototype,"game.TotalItemSkin");var i;!function(e){e[e.other=1]="other",e[e.win=2]="win",e[e.lose=3]="lose"}(i||(i={}))}(game||(game={}));var game;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e._maxNum=0,e.tableClickTime=0,e.skinName=new GameView_ZJH_Skin,e.initUI(),e}return __extends(n,t),Object.defineProperty(n.prototype,"lookBtnVisable",{set:function(t){this._lookBtn&&this._lookBtn.parent&&this._lookBtn.parent.removeChild(this._lookBtn),t?(e.OperateLayer.Instance.addChild(this._lookBtn),this._lookBtn.visible=!0):this._lookBtn.visible=!1},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"playBtnVisable",{set:function(t){this.playButton&&this.playButton.parent&&this.playButton.parent.removeChild(this.playButton),t&&(e.OperateLayer.Instance.addChild(this.playButton),this.playButton.visible=!0,this.lookBtnVisable=!1)},enumerable:!0,configurable:!0}),n.prototype.vsPanelVisible=function(t,n,i){t?(e.VsCardPanel.Instance.loadData(n,i),e.SeatLayer.Instance.addChildAt(e.VsCardPanel.Instance,0)):e.VsCardPanel.Instance&&e.VsCardPanel.Instance.parent&&(e.VsCardPanel.Instance.parent.removeChild(e.VsCardPanel.Instance),e.VsCardPanel.clearInstance())},Object.defineProperty(n.prototype,"gzStatus",{set:function(e){this.guanzhanImage.visible=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"maxNum",{get:function(){return this._maxNum},enumerable:!0,configurable:!0}),n.prototype.maxnumchanged=function(t){this._maxNum=t,this._maxNum>6&&(this.copyButton.visible=!1),e.SeatLayer.Instance.intEmptySeat()},Object.defineProperty(n,"Instance",{get:function(){return null==this.m_Instance&&(this.m_Instance=new n),this.m_Instance},enumerable:!0,configurable:!0}),n.clearInstance=function(){this.m_Instance=null},n.prototype.destroy=function(){egret.clearInterval(this.timer)},n.prototype.showTime=function(){egret.clearInterval(this.timer),this.updataTime(),this.timer=egret.setInterval(this.updataTime,this,1e4)},n.prototype.updataTime=function(){var e=new Date(Date.now()),t=e.getHours()>=10?e.getHours():"0"+e.getHours(),n=e.getMinutes()>=10?e.getMinutes():"0"+e.getMinutes();this.timeNowLabel.text=t+":"+n,uniLib.ZQGameSdk.getNetStateType(),uniLib.ZQGameSdk.getBatteryPer()},n.prototype.addUIListener=function(){e.RoomData.Instance.maxuserNbrChanged.add(this.maxnumchanged,this),this.readyButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.shuffleButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.copyButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.setBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.tableclothImage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.shareButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.chatButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.selectCard.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.seatDownBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),uniLib.Global.addEventListener(uniLib.ZqEvent.NATIVE_TO_EGERET,this.onNativeMessage,this),this.startGameButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this._lookBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.playButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),e.RoomData.Instance.roomIdChanged.add(this.roomIdChanged,this),e.RoomData.Instance.inningsChanged.add(this.ShowNumberOfGame,this),e.RoomData.Instance.startGameChanged.add(this.startGameChanged,this),e.RoomData.Instance.landlordChanged.add(this.landlordChanged,this),e.RoomData.Instance.operateChanged.add(this.operateChanged,this),e.RoomData.Instance.robLordOperateChanged.add(this.robLordOperateChanged,this),e.RoomData.Instance.multipleChanged.add(this.multipleChanged,this),e.RoomData.Instance.roomTypeChange.add(this.roomTypeChange,this),e.RoomData.Instance.pointBaseChanged.add(this.pointBaseChanged,this),e.RoomData.Instance.kickOperateChanged.add(this.kickOperateChange,this),e.RoomData.Instance.roomLevelChanged.add(this.roomLevelChangeHandle,this),e.RoomData.Instance.startGameOpIdChange.add(this.changeStartVisable,this),e.RoomData.Instance.matchidChanged.add(this.changeMatchID,this),DDZ.EventManage.startVisableChanged.add(this.changeStartVisable,this),e.RoomData.Instance.betDataChange.add(this.betDataChange,this);var t=e.RoomData.Instance.doorDatas.first(function(e){return 1==e.doorId});t&&t.playAllAnimation.add(this.changeAllSum,this),GX.PokerEvent.Instance.roomDataUpdateEvent.add(this.roomDataUpdate,this)},n.prototype.removeUIListener=function(){this.readyButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.shuffleButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.setBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.tableclothImage.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.shareButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.copyButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.chatButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.selectCard.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),uniLib.Global.removeEventListener(uniLib.ZqEvent.NATIVE_TO_EGERET,this.onNativeMessage,this),this.startGameButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this._lookBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),this.playButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickTap,this),e.RoomData.Instance.roomIdChanged.remove(this.roomIdChanged,this),e.RoomData.Instance.inningsChanged.remove(this.ShowNumberOfGame,this),e.RoomData.Instance.startGameChanged.remove(this.startGameChanged,this),e.RoomData.Instance.landlordChanged.remove(this.landlordChanged,this),e.RoomData.Instance.operateChanged.remove(this.operateChanged,this),e.RoomData.Instance.robLordOperateChanged.remove(this.robLordOperateChanged,this),e.RoomData.Instance.multipleChanged.remove(this.multipleChanged,this),e.RoomData.Instance.roomTypeChange.remove(this.roomTypeChange,this),e.RoomData.Instance.pointBaseChanged.remove(this.pointBaseChanged,this),e.RoomData.Instance.kickOperateChanged.remove(this.kickOperateChange,this),e.RoomData.Instance.roomLevelChanged.remove(this.roomLevelChangeHandle,this),e.RoomData.Instance.startGameOpIdChange.remove(this.changeStartVisable,this),e.RoomData.Instance.matchidChanged.remove(this.changeMatchID,this),DDZ.EventManage.startVisableChanged.remove(this.changeStartVisable,this),e.RoomData.Instance.maxuserNbrChanged.remove(this.maxnumchanged,this),e.RoomData.Instance.betDataChange.remove(this.betDataChange,this),GX.PokerEvent.Instance.roomDataUpdateEvent.remove(this.roomDataUpdate,this)},n.prototype.adaptationWidth=function(){t.prototype.adaptationWidth.call(this)},n.prototype.initUI=function(){this._betTimesLabel.text="",this._betTimesLabel_lun.text="",this.addChild(e.CardLayer.Instance),e.SeatLayer.Instance.initSeatSprite(),this.addChild(e.OperateLayer.Instance),this.addChild(e.SeatLayer.Instance),this.showEnterButtons(),this.multipleChanged(0);var t=new e.VoiceChat;t.updateBtnRes(["NDvoice_btn1","NDvoice_btn2"]),e.GameInfo.uiLayer.addChild(t),e.GameInfo.topLayer.addChild(e.Ping.instance);var n=uniLib.Global.screenWidth-250,i=70;e.Ping.instance.setPingPos(n,i),this.showTime(),this.startGameButton.visible=!1,"true"==uniLib.BrowersUtils.GetRequest("debug")?this.selectCard.visible=!0:this.selectCard.visible=!1,1036==MJLobby.MJLobbyData.getInstance().lobbyId&&(this.copyButton.visible=!0),0!=uniLib.Global.is_sandbox&&(this.removeChild(this.shareButton),this.copyButton.visible=!1),this._maxNum>6&&(this.copyButton.visible=!1),this.signalLabel.visible=!1,this.bottomPoint.text="",this._allchips.visible=!1,this.showVersion(),this.readyButton.visible=!1,this.shuffleButton.visible=!1,this.showVideoPanel()},n.prototype.bottomPointChange=function(){null!=e.RoomData.Instance.bottomPoint&&this.bottomPoint?this.bottomPoint.text="底注:"+e.RoomData.Instance.bottomPoint:this.bottomPoint.text=""},n.prototype.onNativeMessage=function(t){t.param.cmd==uniLib.ZQGameSdk.NETSTATE&&0==t.param.code?(uniLib.ZQGameSdk.lastNetState&&uniLib.ZQGameSdk.lastNetState.data[uniLib.ZQGameSdk.NETSTATE]!=t.param.data[uniLib.ZQGameSdk.NETSTATE]&&(e.PokerFunction.tcpSend(new Cmd.ClientEchoRoomCmd_SC),uniLib.NetMgr.setMsgTimeout(5,"ClientEchoRoomCmd_SC")),t.param.data[uniLib.ZQGameSdk.NETSTATE]==uniLib.NetState.NO_SIGNAL?(this.signalLabel.visible=!0,this.wifiOrDataImage.visible=!1):t.param.data[uniLib.ZQGameSdk.NETSTATE]==uniLib.NetState.WIFI?(this.signalLabel.visible=!1,this.wifiOrDataImage.visible=!0,this.wifiOrDataImage.source="wifi_DDZ"):t.param.data[uniLib.ZQGameSdk.NETSTATE]==uniLib.NetState.DATA_FLOWS?(this.signalLabel.visible=!1,this.wifiOrDataImage.visible=!0,this.wifiOrDataImage.source="data_DDZ"):t.param.data[uniLib.ZQGameSdk.NETSTATE]==uniLib.NetState.WIFI_AND_DATA&&(this.signalLabel.visible=!1,this.wifiOrDataImage.visible=!0,this.wifiOrDataImage.source="wifi_DDZ")):t.param.cmd==uniLib.ZQGameSdk.BATTERY&&0==t.param.code&&(this.betteryButton.skin.image.width=t.param.data[uniLib.ZQGameSdk.BATTERY]/100*30)},n.prototype.showVideoPanel=function(){0!=e.RoomInfo.getInstance().video&&(e.RoomInfo.getInstance().GM_Mode=!0,this._videoPanel=new e.VideoPanel,this.addChild(this._videoPanel))},n.prototype.showVideoFinish=function(t){var n="";0==t?(n="录像播放完毕!",e.PublicManage.getInstance().showVideoCommonPanel(n,["是"],[this.videoExit],null,this)):(n="确定退出录像？",e.PublicManage.getInstance().showVideoCommonPanel(n,["是","否"],[this.videoExit],null,this))},n.prototype.videoExit=function(){uniLib.Global.dispatchEvent(uniLib.ZqEvent.EVENT_G2L,"video_close"),e.RoomInfo.getInstance().GM_Mode=!1,e.RoomInfo.getInstance().video=0,e.RoomInfo.getInstance().videoUid=0,n.exitGame()},n.prototype.onMoon=function(e){switch(e.param){case"video_play_finish":this.showVideoFinish(0)}},n.prototype.showVersion=function(){var e=new eui.Label;e.fontFamily="黑体",e.size=20,e.textColor=7186632,e.text=uniLib.Global.version.toString(),e.x=uniLib.Global.screenWidth-e.width,e.y=uniLib.Global.screenHeight-e.height,this.addChild(e)},n.prototype.roomLevelChangeHandle=function(e){},n.prototype.onClickTap=function(t){if(e.SoundHand.Instance.playButtonClick(),t.target==this.tableclothImage)return void e.CardLayer.Instance.recoveryCardPosition();if(t.target==this.readyButton||t.target==this.shuffleButton){var n=new Cmd.ReadyUpdateRoomCmd_CS;n.yesOrNo=!0,t.target==this.shuffleButton&&(n.shuffle=1),e.PokerFunction.tcpSend(n)}else if(t.target==this.setBtn)this.showSetting();else if(t.target==this.chatButton)e.ChatPanel.Instance.addListener(),GX.PopUpManager.addPopUp(e.ChatPanel.Instance,!1,GX.PopUpEffect.CENTER);else if(t.target==this.shareButton)this.showShare();else if(t.target==this.selectCard){var i=new Cmd.GmAvailableCardUpdateCmd_CS;e.PokerFunction.tcpSend(i),this.showTestPanel()}else if(t.target==this.seatDownBtn){var a=new Cmd.SitDownCmd_CS;a.uid=uniLib.NetMgr.UID,uniLib.NetMgr.tcpSend(a)}else if(t.target==this.startGameButton){var o=new Cmd.StartGameCmd_CS;uniLib.NetMgr.tcpSend(o)}else if(t.target==this._lookBtn){var s=new Cmd.BetRoomCmd_CS;s.opType=Cmd.Operation.Check,uniLib.NetMgr.tcpSend(s)}else if(t.target==this.copyButton)1022==MJLobby.MJLobbyData.getInstance().lobbyId?e.RoomData.Instance.roomId&&(uniLib.ZQGameSdk.nativeCopyStr(e.RoomData.Instance.roomId.toString()),MJLobby.LobbyPopupManager.showMildWarnShow("房间号复制成功")):this.share();else if(t.target==this.playButton){for(var r=new Cmd.PlayCardCmd_CS,h=e.CardLayer.Instance.handCards,l=new Array,d=0,c=h;d<c.length;d++){var u=c[d];u.selected&&l.push(u.cardId)}r.cardList=l,e.PokerFunction.tcpSend(r)}},n.prototype.share=function(){var t=new uniLib.WXShareVo;t.shareWay=0,e.DataCache.platParam&&(t.title=e.DataCache.platParam.shareInfo.title,t.description=e.DataCache.platParam.shareInfo.content+e.RoomInfo.getInstance().getAllNames(),t.webpageUrl=e.DataCache.platParam.shareInfo.webPageUrl),uniLib.ZQGameSdk.share(t,null,this)},n.prototype.showDistancePanel=function(){function t(e){if(0==e.code){n.lng=e.data.longitude,n.lat=e.data.latitude;var t=new Cmd.GetGPSLocationCmd_C;t.lat=n.lat,t.lng=n.lng,uniLib.NetMgr.tcpSend(t)}}var n;n=uniLib.ZQGameSdk.getLocation(t,this);var i=new Cmd.RequestIpGPSCmd_C;e.PokerFunction.tcpSend(i),this.distancePanel||(this.distancePanel=new e.DistancePanel),GX.PopUpManager.addPopUp(this.distancePanel,!1,GX.PopUpEffect.CENTER)},n.prototype.setDistanceDate=function(e){e&&this.distancePanel&&this.distancePanel.setDate(e)},n.prototype.ShowNumberOfGame=function(){var t=e.RoomData.Instance.roomCurrentInnings,n=e.RoomData.Instance.roomTotalInnings;this.timesLabel.text=t+"/"+n,LocalStorage.Instance.hideSelct||(GX.PopUpManager.addPopUp(e.PlayTypePanel.instance,!1,GX.PopUpEffect.CENTER),LocalStorage.Instance.hideSelct=!0)},n.prototype.showTestPanel=function(){var t=e.TestPanel.Instance;t.x=(uniLib.Global.screenWidth-t.width)/2,t.y=80,t.addListener(),e.GameInfo.topLayer.addChild(t)},n.prototype.showShare=function(){var t=new uniLib.WXShareVo;t.shareWay=0,e.DataCache.platParam&&(t.title=e.DataCache.platParam.shareInfo.title,t.description=e.DataCache.platParam.shareInfo.content,t.webpageUrl=e.DataCache.platParam.shareInfo.webPageUrl),MJLobby.MJLobbyData.getInstance().hasXianLiao?uniLib.Global.dispatchEvent(uniLib.ZqEvent.SHARE,t,!1):uniLib.ZQGameSdk.share(t,null,this)},n.prototype.setBtnsVisible=function(e){this.shareButton.visible=e},n.prototype.setStartBtnVisible=function(e){this.startGameButton.visible=e},n.prototype.dissRoom=function(){this.msgBox&&(this.msgBox=null);var t=function(t){this.msgBox&&(e.GameInfo.topLayer.removeChild(this.msgBox),this.msgBox=null)};if(!this.msgBox){var n="你确定请求解散房间？";this.msgBox=new e.MsgBoxPanel,this.msgBox.x=uniLib.Global.screenWidth-this.msgBox.width>>1,this.msgBox.y=uniLib.Global.screenHeight-this.msgBox.height>>1,this.msgBox.setData(n,["确定","取消"],[this.confirmHandler,t])}e.GameInfo.topLayer.addChild(this.msgBox)},n.prototype.confirmHandler=function(t){this.msgBox&&(e.GameInfo.topLayer.removeChild(this.msgBox),this.msgBox=null);var n=new Cmd.DissolveRoomRequestCmd_C;e.PokerFunction.tcpSend(n)},n.prototype.roomIdChanged=function(){e.PokerData.isStandAlone?this.roomNumber.text="练习场(不结算)":this.roomNumber.text="桌号:"+e.RoomData.Instance.roomId,e.RoomInfo.getInstance().matchId?this.roomNumber0.text="匹配号"+e.RoomInfo.getInstance().matchId:this.roomNumber0.text="",e.DataManager.isDeZhou=!1},Object.defineProperty(n.prototype,"matchId",{get:function(){return this._matchid},enumerable:!0,configurable:!0}),n.prototype.changeMatchID=function(e){e?(this.roomNumber0.text="匹配号"+e,this._matchid=e):(this.roomNumber0.text="",this._matchid=null)},n.prototype.roomTypeChange=function(){if(e.RoomData)switch(e.RoomData.Instance.roomType){case Cmd.RoomType.RoomType_Normal:break;case Cmd.RoomType.RoomType_Quick:}},n.prototype.pointBaseChanged=function(e){(null==e||0/0==e)&&(e=0)},n.prototype.startGameChanged=function(){if(e.RoomData.Instance.startGame){for(var t=0,n=e.SeatLayer.Instance.seatSprites;t<n.length;t++){var i=n[t];i.userSprite&&i.userSprite.removeStart()}this.setBtnsVisible(!1),this.readyButton.visible=!1,this.shuffleButton.visible=!1,this.shareButton.visible=!1,this.startGameButton.visible=!1,this.restart()}},n.prototype.landlordChanged=function(t){e.OperateLayer.Instance.stopTimer(),e.OperateLayer.Instance.removeRobLandlord()},n.prototype.operateChanged=function(t){e.PokerFunction.GetSeatDataByUid(t.uid);e.OperateLayer.Instance.operateChanged(t)},n.prototype.robLordOperateChanged=function(t){e.OperateLayer.Instance.updataRobLandlord(t)},n.prototype.kickOperateChange=function(t){e.OperateLayer.Instance.kickOperateChanged(t)},n.prototype.multipleChanged=function(t){this.beforeMultiple&&0!=this.beforeMultiple&&t&&e.EffectCreate.Instance.multipleEffect(t/this.beforeMultiple),this.beforeMultiple=t,this.addMultipleLabel()},n.prototype.addMultipleLabel=function(){null==this.multipleLabel&&(this.multipleLabel=new eui.Label,this.multipleLabel.size=25,this.multipleLabel.stroke=1,this.multipleLabel.y=110),this.addChild(this.multipleLabel)},n.prototype.removeMultipleLabel=function(){this.multipleLabel&&this.multipleLabel.parent&&this.removeChild(this.multipleLabel)},n.prototype.showEnterButtons=function(){if(this.shareButton){if(e.DataCache.platParam){var t=Number(e.DataCache.platParam.roomId);if(1e5>t)return}1!=uniLib.Global.is_sandbox&&(this.shareButton.visible=!0)}},n.prototype.setReadyBtnVisible=function(e,t){e&&null!=t&&this.readyButton&&(this.readyButton.currentState=t),this.readyButton&&(this.readyButton.visible=e)},n.prototype.showShuffleBtn=function(e,t){e==uniLib.NetMgr.UID&&(this.shuffleButton.visible=!0,this.shuffleButton.cost.text=""+(t?t:0))},n.prototype.restart=function(){e.OperateLayer.Instance.removeOperateMain(),e.OperateLayer.Instance.stopTimer(),e.OperateLayer.Instance.removePlayCardSprites(),e.CardLayer.Instance.removeChildren(),e.EffectCreate.Instance.clearDealTimer();for(var t=0;t<e.RoomData.Instance.seatList.length;t++){var n=e.RoomData.Instance.seatList[t];n&&n.clearHandCard()}e.RoomData.Instance.multiple=0,e.RoomData.Instance.landlordUid=null,this.readyButton.visible=!1,this.shuffleButton.visible=!1},n.prototype.showSetting=function(){e.SetOpreatePanel.instance.OnOpen()},n.exitGame=function(){if(e.GameData.iskPoker=!1,egret.Tween.removeAllTweens(),n.Instance.destroy(),e.CardLayer.Instance.destroy(),e.OperateLayer.Instance.destroy(),e.SetOpreatePanel.clearInstance(),e.SettingPanel.clearInstance(),e.SoundHand.clearInstance(),DDZ.EventManage.clearResultTimer(),e.DataCache.gameInfo&&e.DataCache.gameInfo.defaultOrientation!=egret.OrientationMode.LANDSCAPE&&(uniLib.ScreenUtils.landscape=!1),uniLib.GameModuleUtils.ExitGame(!1),e.DataCache.destroyResOnExit){var t=RES.destroyRes(e.GameConstant.ResGroup_DDZ,!0);RES.destroyRes(e.GameConstant.ResGroup_Mp3,!0),uniLib.ResUtils.clearResConfigByGroupName([e.GameConstant.ResGroup_DDZ]),uniLib.ResUtils.clearResConfigByGroupName([e.GameConstant.ResGroup_Mp3]),console.error("销毁"+e.GameConstant.ResGroup_DDZ+":"+t)}e.GameInfo.uiLayer=null,e.GameInfo.mainUILayer=null,e.GameInfo.topLayer=null,e.GameInfo.main=null,e.PokerFunction.exitGame()},n.prototype.showMessageBox=function(){this.msgbox||(this.msgbox=new e.MsgBoxPanel),this.msgbox.setData("不能返回大厅，你要解散游戏么",["确定","取消"],[this.confirmHandel,this.cancelHandel],this),this.msgbox.x=uniLib.Global.screenWidth-this.msgbox.width>>1,this.msgbox.y=uniLib.Global.screenHeight-this.msgbox.height>>1,GX.PopUpManager.addPopUp(this.msgbox,!1,GX.PopUpEffect.CENTER)},n.prototype.confirmHandel=function(t){var n=new Cmd.DissolveRoomRequestCmd_C;e.PokerFunction.tcpSend(n)},n.prototype.cancelHandel=function(e){this.removeTips()},n.prototype.removeTips=function(){this.msgbox&&(GX.PopUpManager.removePopUp(this.msgbox,GX.PopUpEffect.CENTER),this.msgbox=null)},n.prototype.removeSeatDownBtn=function(){this.seatDownBtn&&this.seatDownBtn.parent&&(this.SeatDownBtn=!1),this.gzStatus=!1},Object.defineProperty(n.prototype,"SeatDownBtn",{set:function(e){this.seatDownBtn.visible=e},enumerable:!0,configurable:!0}),n.prototype.roomDataUpdate=function(){var t=e.RoomData.Instance.seatList,n=e.RoomData.Instance.maxuserNbr;null==e.PokerFunction.MainSeat&&t.length==n&&(e.DataManager.isInGame=!1,e.DataManager.isSitDown=!1,this.setReadyBtnVisible(!1),this.removeSeatDownBtn(),this.gzStatus=!0)},n.prototype.showPlayCards=function(t){if(null!=t){this.playCards=null!=t.list&&t.list instanceof Array?t.list:[];for(var n=0,i=this.playCards;n<i.length;n++){var a=i[n];if(a){var o=e.PokerFunction.GetSeatDataByUid(a.uid);o&&(o.handCards=a.cardList,o.setCardtype(a.cardListType))}}}},n.prototype.changeStartVisable=function(){if(!uniLib.Global.lobbyMode)return void(this.startGameButton.visible=!0);if(e.RoomData.Instance.roomCurrentInnings>0)return void(this.startGameButton.visible=!1);if(uniLib.NetMgr.UID!=e.RoomData.Instance.startGameOpId)return void(this.startGameButton.visible=!1);for(var t=0,n=0,i=e.RoomData.Instance.seatList;n<i.length;n++){var a=i[n];1==a.isReady&&t++}t>=2&&uniLib.NetMgr.UID==e.RoomData.Instance.startGameOpId?this.startGameButton.visible=!0:this.startGameButton.visible=!1},Object.defineProperty(n.prototype,"betTimesLabel",{set:function(t){var n=15;e.RoomData.Instance.roomPlayProps.first(function(e){return 10508==e})?n=10:e.RoomData.Instance.roomPlayProps.first(function(e){return 10509==e})?n=15:e.RoomData.Instance.roomPlayProps.first(function(e){return 10510==e})&&(n=20),t?(this._betTimesLabel_lun.text="轮",this._betTimesLabel.text=t+"/"+n):(this._betTimesLabel.text="",this._betTimesLabel_lun.text="")},enumerable:!0,configurable:!0}),n.prototype.changeAllSum=function(t){void 0===t&&(t=!1);var n=e.RoomData.Instance.doorDatas.first(function(e){return 1==e.doorId});1==t&&(n.chipSum=0),this._allchips.visible=!0,n.chipSum?this._allchips.text=""+n.chipSum:this._allchips.text="0"},n.prototype.betDataChange=function(t){if(t.betSum&&t.betSum.length>0)for(var n=0,i=t.betSum;n<i.length;n++){var a=i[n],o=e.GameConstant.GetSeatSpriteByUid(a.uid);if(o){var s=new Cmd.BetRoomCmd_CS;s.bet=a,s.uid=a.uid,o.userSprite.addPoint(s)}}},n}(e.EuiPanel);e.GameView=t,__reflect(t.prototype,"game.GameView")}(game||(game={}));var game;!function(e){var t=function(t){function n(e){var n=t.call(this)||this;return n.m_selected=!1,n.m_darken=!1,n.m_cardId=e,n.selectChanged(!1),n.addCard(),n}return __extends(n,t),Object.defineProperty(n.prototype,"cardId",{get:function(){return this.m_cardId},set:function(e){this.m_cardId=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"cardPoint",{get:function(){var e=this,t=table.TableNYSCard.instance().first(function(t){return t.thisId==e.cardId});return t.value},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selected",{get:function(){return this.m_selected},set:function(e){this.m_selected=e,this.selectChanged(e)},enumerable:!0,configurable:!0}),n.prototype.selectChanged=function(t){t?this.y=e.GameConstant.HandCardSelectY:this.y=e.GameConstant.HandCardY},n.prototype.setTexture=function(e){this.card.texture=RES.getRes(e)},Object.defineProperty(n.prototype,"darken",{get:function(){return this.m_darken},set:function(e){this.m_darken!=e&&(this.m_darken=e,this.darkenChanged(e))},enumerable:!0,configurable:!0}),n.prototype.darkenChanged=function(e){e?this.addDarken():this.removeDarken()},n.prototype.addDarken=function(){null==this.darkenImage&&(this.darkenImage=new egret.Bitmap(RES.getRes("Poker_dark")),this.darkenImage.scale9Grid=new egret.Rectangle(12,14,105,147),this.darkenImage.width=e.GameConstant.CardWidth+7,this.darkenImage.x=-1,this.darkenImage.y=-1,this.darkenImage.height=e.GameConstant.CardHeight+7,this.darkenImage.alpha=.6),this.addChild(this.darkenImage)},n.prototype.removeDarken=function(){this.darkenImage&&this.darkenImage.parent&&this.removeChild(this.darkenImage)},n.prototype.addCard=function(){var t=table.TablePokerCard.resNormal(this.cardId);t?this.card=new egret.Bitmap(RES.getRes(t)):this.card=new egret.Bitmap(RES.getRes("BackCard")),this.card.width=e.GameConstant.CardWidth,this.card.height=e.GameConstant.CardHeight,this.addChildAt(this.card,0)},n.prototype.changeImage=function(){var e=this,t=table.TablePokerCard.resNormal(this.cardId);this.card.anchorOffsetX=this.card.width/2,this.card.x=this.card.x+this.card.anchorOffsetX,egret.Tween.get(this.card).to({scaleX:0},200).call(function(){e.card&&(e.card.texture=RES.getRes(t))}).to({scaleX:1},200)},Object.defineProperty(n.prototype,"cardWidth",{set:function(e){this.card.width=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"cardHeight",{set:function(e){this.card.height=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"width",{set:function(e){this.card.width=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"height",{set:function(e){this.card.height=e
},enumerable:!0,configurable:!0}),n}(egret.DisplayObjectContainer);e.HandCardSprite=t,__reflect(t.prototype,"game.HandCardSprite")}(game||(game={}));var game;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.selectIndex=0,e.skinName=new Help_ZJH_Skin,e.addEvent(),e}return __extends(n,t),n.prototype.hide=function(){uniLib.PopUpMgr.removePopUp(this),this.dispatchEventWith(e.UIEventConsts.CLOSE),e.SoundHand.Instance.playButtonClick()},n.prototype.addEvent=function(){this._close_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.hide,this)},n.prototype.OnClick=function(e){1==this.selectIndex?this.selectIndex=0:2==this.selectIndex?this.selectIndex=1:this.selectIndex=2,this.changeRule(this.selectIndex)},n.prototype.changeRule=function(e){},n.prototype.destory=function(){this._close_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.hide,this)},n}(eui.Component);e.HelpPanel=t,__reflect(t.prototype,"game.HelpPanel")}(game||(game={}));var game;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.skinName=new MsgBox_ZJH_Skin,t.init(),t}return __extends(t,e),t.prototype.init=function(){this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this)},t.prototype.setData=function(e,t,i,a,o){this.desLabel.text=e,this.labelArray=t,this.funcArray=i,this._backObj=a,this.btnsGroup.removeChildren(),this.yesBtn=null,this.noBtn=null,1==t.length?(this.yesBtn=new n("确定","bt_green_bg"),this.btnsGroup.addChild(this.yesBtn),this.closeBtn.visible=!1):2==t.length&&(this.yesBtn=new n("确定","bt_green_bg"),this.btnsGroup.addChild(this.yesBtn),this.noBtn=new n("取消","bt_orange_bg"),this.btnsGroup.addChild(this.noBtn)),this.funcArray&&this.funcArray[0]&&this.yesBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.funcArray[0],this._backObj),this.funcArray&&this.funcArray[1]&&this.noBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.funcArray[1],this._backObj),this.yesBtn&&this.yesBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.noBtn&&this.noBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this)},t.prototype.onClose=function(e){GX.PopUpManager.removePopUp(this),this.destroy()},t.prototype.destroy=function(){this.noBtn&&(this.noBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.funcArray[1],this._backObj),this.noBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this)),this.yesBtn&&(this.yesBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.funcArray[0],this._backObj),this.yesBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this)),this.closeBtn&&this.closeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this)},t}(eui.Component);e.MsgBoxPanel=t,__reflect(t.prototype,"game.MsgBoxPanel");var n=function(e){function t(t,n){var i=e.call(this)||this;return i.skinName=new Button_ZJH_Skin,i.labelDisplay.text=t,i.iconDisplay.source=n,i}return __extends(t,e),t}(eui.Button);e.GameButtonItem=n,__reflect(n.prototype,"game.GameButtonItem")}(game||(game={}));var game;!function(e){var t=function(t){function n(){var n=t.call(this)||this;return n.skinName=new PlayType_ZJH_Skin,n.setData(e.RoomData.Instance.roomPlayProps),n.closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,n.OnClose,n),n}return __extends(n,t),Object.defineProperty(n,"instance",{get:function(){return null==this.m_instance&&(this.m_instance=new n),this.m_instance},enumerable:!0,configurable:!0}),n.prototype.setData=function(t){e.DataManager.isDeZhou=!1,this.numType.text="局数："+e.RoomData.Instance.roomTotalInnings+"局",this.playType.text=e.GameView.Instance.maxNum+"人场";for(var n=0;n<t.length;n++)switch(t[n]){case 10457:this.zhuangType.text="玩法：明牌抢庄";break;case 10463:this.zhuangType.text="玩法：经典锅底"}},n.prototype.OnClose=function(t){e.SoundHand.Instance.playButtonClick(),t.target==this.closeButton&&GX.PopUpManager.removePopUp(this,GX.PopUpEffect.CENTER)},n}(eui.Component);e.PlayTypePanel=t,__reflect(t.prototype,"game.PlayTypePanel")}(game||(game={}));var DDZLoadingView=function(e){function t(){var t=e.call(this)||this;return t.init(),t}return __extends(t,e),t.prototype.init=function(){this.backgroud_bmp||(this.backgroud_bmp=MJLobby.LobbyResUtil.createBitmapByName("HZ_login_bg_png"),this.backgroud_bmp.width=uniLib.Global.screenWidth,this.backgroud_bmp.height=uniLib.Global.screenHeight,this.addChild(this.backgroud_bmp)),this.bigLogo||(this.bigLogo=MJLobby.LobbyResUtil.createBitmapByName("ZJH_big_logo_png"),this.bigLogo.x=(uniLib.Global.screenWidth-this.bigLogo.width)/2,this.bigLogo.y=106,this.addChild(this.bigLogo)),this.darkLine_bmp||(this.darkLine_bmp=MJLobby.LobbyResUtil.createBitmapByName("lb_loading_darkLine",432,uniLib.Global.screenHeight-196*uniLib.ScreenUtils.scaleFactor),this.addChild(this.darkLine_bmp)),this.lightLine_bmp||(this.lightLine_bmp=MJLobby.LobbyResUtil.createBitmapByName("lb_loading_lightLine",this.darkLine_bmp.x+2,this.darkLine_bmp.y-10),this.lightLine_bmp.scale9Grid=new egret.Rectangle(12,18,10,2),this.addChild(this.lightLine_bmp)),this.explain_txf||(this.explain_txf=MJLobby.LobbyResUtil.createTextFeild(0,egret.HorizontalAlign.CENTER,"",22,500,uniLib.Global.screenHeight-171*uniLib.ScreenUtils.scaleFactor,276),this.addChild(this.explain_txf)),this._progTxt||(this._progTxt=MJLobby.LobbyResUtil.createTextFeild(0,egret.HorizontalAlign.CENTER,"",22,520,uniLib.Global.screenHeight-220*uniLib.ScreenUtils.scaleFactor,276),this.addChild(this._progTxt)),this._infoTxt||(this._infoTxt=MJLobby.LobbyResUtil.createTextFeild(0,egret.HorizontalAlign.CENTER,"抵制不良游戏 拒绝盗版游戏 注意自我保护 谨防受骗上当 适度游戏益脑 沉迷游戏伤身 合理安排时间 享受健康生活",20,0,uniLib.Global.screenHeight-44*uniLib.ScreenUtils.scaleFactor,MJLobby.LobbyDataCache.defaultWidth),this.addChild(this._infoTxt))},t.prototype.setProgress=function(e,n,i,a,o){if(void 0===o&&(o=!1),this._versionTxt||(this._versionTxt=MJLobby.LobbyResUtil.createTextFeild(10066329,egret.HorizontalAlign.RIGHT,MJLobby.LobbyDataCache.version,22,864),this._versionTxt.x=uniLib.Global.screenWidth-this._versionTxt.width,this._versionTxt.y=uniLib.Global.screenHeight-this._versionTxt.height,this.addChild(this._versionTxt),this._versionTxt.text=MJLobby.LobbyDataCache.version),n&&0!=n){var s=Math.ceil(e/n*100);i&&""!=i?this.explain_txf.text=i:this.explain_txf.text=t.explain,0==o&&s>93&&(s=93);var r=this.darkLine_bmp.width*(s/100)+27;this.lightLine_bmp.width=r,this.lightLine_bmp.width>this.darkLine_bmp.width&&(this.lightLine_bmp.width=this.darkLine_bmp.width),this._progTxt&&(this._progTxt.text=s+"%")}else this.explain_txf.text=i;this.explain_txf.x=(MJLobby.LobbyDataCache.defaultWidth-this.explain_txf.width)/2},t}(egret.Sprite);DDZLoadingView.explain="正在加载游戏资源...",__reflect(DDZLoadingView.prototype,"DDZLoadingView");var game;!function(e){var t=function(t){function n(e){var n=t.call(this)||this;return n.handCardList=new Array,n.m_seatData=e,n.addListener(),n.clientNoChanged(),n}return __extends(n,t),Object.defineProperty(n.prototype,"isInGame",{get:function(){return this.m_isInGame},set:function(e){this.m_isInGame=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"seatData",{get:function(){return this.m_seatData},enumerable:!0,configurable:!0}),n.prototype.addListener=function(){this.seatData.userChanged.add(this.userChanged,this),this.seatData.readyChanged.add(this.readyChanged,this),this.seatData.isInGameChanged.add(this.isInGameChanged,this),this.seatData.isSitChanged.add(this.isSitChanged,this),this.seatData.handCardCountChanged.add(this.handCardCountChanged,this),this.seatData.catchCardNumChanged.add(this.catchCardNumChanged,this),this.seatData.onlineChanged.add(this.onlineChangeHandel,this),e.RoomData.Instance.MainSeatChanged.add(this.clientNoChanged,this),this.seatData.seatStateListChanged.add(this.seatStateListChanged,this),this.seatData.seatStateAdd.add(this.seatStateAdd,this),GX.PokerEvent.Instance.reconnecEvent.add(this.resetState,this)},n.prototype.removeListener=function(){this.seatData.userChanged.remove(this.userChanged),this.seatData.readyChanged.remove(this.readyChanged),this.seatData.isInGameChanged.remove(this.isInGameChanged),this.seatData.isSitChanged.remove(this.isSitChanged),this.seatData.handCardCountChanged.remove(this.handCardCountChanged),e.RoomData.Instance.MainSeatChanged.remove(this.clientNoChanged),this.seatData.onlineChanged.remove(this.onlineChangeHandel),this.seatData.seatStateAdd.remove(this.seatStateAdd,this),this.seatData.catchCardNumChanged.remove(this.catchCardNumChanged,this),this.seatData.seatStateListChanged.remove(this.seatStateListChanged,this),GX.PokerEvent.Instance.reconnecEvent.remove(this.resetState,this)},Object.defineProperty(n.prototype,"clientNo",{get:function(){return this.m_clientNo},enumerable:!0,configurable:!0}),n.prototype.clientNoChanged=function(){if(this.m_clientNo=e.GameConstant.GetClientNoBySeatId(this.seatData.seatId),!(null==this.m_clientNo||this.m_clientNo<0)){e.SeatLayer.Instance.addChild(this);var t=e.GameConstant.seatPosArr[this.m_clientNo];switch(e.GameView.Instance.maxNum){case 6:t=e.GameConstant.seatPosArr[this.m_clientNo];break;case 12:t=e.GameConstant.seatMaxPosArr[this.m_clientNo]}t&&(this.x=t.x,this.y=t.y)}},n.prototype.onlineChangeHandel=function(e){this.m_userSprite&&(e==Cmd.OnlineState.OnlineState_Offline?this.m_userSprite.showOffline():this.m_userSprite.removeOffline())},n.prototype.readyChanged=function(t){if(null==this.readyIcon){this.readyIcon=new egret.Bitmap(RES.getRes("player_ready")),this.readyIcon.anchorOffsetX=this.readyIcon.width/2,this.readyIcon.anchorOffsetY=this.readyIcon.height/2;var n=e.GameConstant.ReadyPos[this.clientNo];switch(e.GameView.Instance.maxNum){case 6:n=e.GameConstant.ReadyPos[this.clientNo];break;case 12:n=e.GameConstant.ReadyMaxPos[this.clientNo]}if(!n)return;this.readyIcon.x=n.x,this.readyIcon.y=n.y}t?(this.seatData.isReady=!0,e.SeatLayer.Instance.addChild(this.readyIcon),this.seatData.user.uid==uniLib.NetMgr.UID&&e.GameView.Instance.setReadyBtnVisible(!1),egret.Tween.get(this.readyIcon).to({scaleX:2,scaleY:2},200).to({scaleX:1,scaleY:1},200),this.userSprite.removeGuanzhan()):(this.seatData.isReady=!1,this.removeReadyIcon()),(this.seatData.user&&this.seatData.user.uid==uniLib.NetMgr.UID||1==e.RoomInfo.getInstance().video&&this.seatData.user.uid==e.RoomInfo.getInstance().videoUid)&&t&&(e.GameView.Instance.restart(),e.GameView.Instance.setReadyBtnVisible(!1)),DDZ.EventManage.startVisableChanged.call()},n.prototype.removeReadyIcon=function(){this.readyIcon&&this.readyIcon.parent&&this.readyIcon.parent.removeChild(this.readyIcon)},Object.defineProperty(n.prototype,"uid",{get:function(){return this.seatData.user?this.seatData.user.uid:null},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"user",{get:function(){return this.seatData.user?this.seatData.user:null},enumerable:!0,configurable:!0}),n.prototype.isInGameChanged=function(t){this.m_isInGame=t,this.seatData.user&&this.seatData.user.uid==uniLib.NetMgr.UID&&(e.DataManager.isInGame=t)},n.prototype.isSitChanged=function(t){this.visible=t;var n=e.GameConstant.GetClientNoBySeatId(this.seatData.seatId);if(e.SeatLayer.Instance.empSeatList)var i=e.SeatLayer.Instance.empSeatList.first(function(e){return e.id==n});if(t&&i&&i.parent){var a=this.y;this.y=this.y-200,egret.Tween.get(this).to({y:a},400).call(function(){uniLib.DisplayUtils.removeFromParent(i),e.SeatLayer.Instance.empSeatList.remove(i)})}this.seatData.user&&this.seatData.user.uid==uniLib.NetMgr.UID&&(e.DataManager.isSitDown=t,t&&2==e.GameView.Instance.maxNum&&!this.seatData.isReady&&e.GameView.Instance.setReadyBtnVisible(!0)),t||0!=this.clientNo||(e.GameView.Instance.SeatDownBtn=!0)},Object.defineProperty(n.prototype,"canSelectState",{get:function(){return this.m_isInGame&&this.userSprite.alpha>.5&&this.uid!=uniLib.NetMgr.UID&&this.m_seatData.seatStateList&&!this.m_seatData.seatStateList.seek(function(e){return e==Cmd.GameState.State_Fold})&&!this.m_seatData.seatStateList.seek(function(e){return e==Cmd.GameState.State_CompareLose})?!0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"userSprite",{get:function(){return this.m_userSprite},enumerable:!0,configurable:!0}),n.prototype.userChanged=function(e){e?this.addUser(e):this.removeUser()},n.prototype.addUser=function(t){if(this.removeUser(),!this.m_userSprite){var n=userType.across;if(e.GameView.Instance.maxNum<=6)switch(this.clientNo){case 1:n=userType.vertical;break;case 5:n=userType.vertical}this.m_userSprite=new e.UserSprite(t,n)}this.addChild(this.m_userSprite)},n.prototype.removeUser=function(){this.m_userSprite&&this.m_userSprite.parent&&(this.removeChild(this.m_userSprite),this.m_userSprite.destroy(),this.m_userSprite=null)},Object.defineProperty(n.prototype,"headPoint",{get:function(){return null!=this.m_userSprite?this.m_userSprite.headPoint:void 0},enumerable:!0,configurable:!0}),n.prototype.resetUserSprite=function(){this.m_userSprite&&this.m_userSprite.resetHeadIcon()},n.prototype.handCardCountChanged=function(t){this.handCardCount=t,t>0&&(e.EffectCreate.Instance.clearOtherCard(this.uid),this.uid==uniLib.NetMgr.UID&&(e.DataManager.isInGame=!0,e.RoomData.Instance.shuffleUid&&1!=e.RoomInfo.getInstance().video&&uniLib.SetUniEventTimeout(e.GameView.Instance,function(){e.EffectCreate.Instance.addShuffleMc(e.RoomData.Instance.shuffleUid)},500,1,this,null)),e.RoomData.Instance.shuffleUid&&1!=e.RoomInfo.getInstance().video?uniLib.SetUniEventTimeout(e.GameView.Instance,function(){e.EffectCreate.Instance.dealPlayerOne(this.seatData)},e.GameConstant.ShuffleEffectTime,1,this,null):e.EffectCreate.Instance.dealPlayerOne(this.seatData))},n.prototype.catchCardNumChanged=function(e){this.m_userSprite&&this.m_userSprite.catchCardCountChanged(e)},n.prototype.destroy=function(){this.clearState(),this.m_userSprite&&this.m_userSprite.removeListener(),this.removeReadyIcon(),this.removeListener()},Object.defineProperty(n.prototype,"handCards",{get:function(){return this.handCardList},enumerable:!0,configurable:!0}),n.prototype.delectHandCard=function(t){var n=this.handCardList.first(function(e){return e.cardId==t});null!=n&&null!=n.parent&&(e.CardLayer.Instance.removeChild(n),this.handCardList.deletefirst(function(e){return e==n}),this.updataHandCardPosition())},n.prototype.updataHandCardPosition=function(){for(var t=this.handCardList.length,n=this.handCardX,i=0;t>i;i++){var a=this.handCardList[i],o=e.GameConstant.GetClientNoBySeatId(this.seatData.seatId);0==o?a.x=n+e.GameConstant.CardGap*i:1==o?(a.y=100,a.x=750+30*i,i>10&&(a.y=150,a.x=750+30*(i-11))):2==o&&(a.y=100,a.x=150+30*i,i>10&&(a.y=150,a.x=150+30*(i-11)))}},Object.defineProperty(n.prototype,"handCardX",{get:function(){var t=e.GameConstant.GetClientNoBySeatId(this.seatData.seatId);return 0==t?(uniLib.Global.screenWidth-e.GameConstant.HeadWidth-this.handCardWidth)/2+e.GameConstant.OperationOffsetRight:1==t?(uniLib.Global.screenWidth-e.GameConstant.HeadWidth-this.handCardWidth)/2+200:2==t?(uniLib.Global.screenWidth-e.GameConstant.HeadWidth-this.handCardWidth)/2:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"handCardWidth",{get:function(){var t=this.handCardList.length;return e.GameConstant.CardWidth+t*e.GameConstant.CardGap},enumerable:!0,configurable:!0}),n.prototype.addState=function(t){this.clearState(),this.stateImage=new eui.Image(t),this.stateImage.name=t;var n=e.GameConstant.GetClientNoBySeatId(this.seatData.seatId),i=e.GameConstant.playCardPos[n];i&&this.seatData.user.uid!=uniLib.NetMgr.UID?(e.CardLayer.Instance.addChild(this.stateImage),this.stateImage.x=i.x+(2*e.GameConstant.PlayCardGap+e.GameConstant.PlayCardWidth-this.stateImage.width)/2,this.stateImage.y=i.y+(e.GameConstant.PlayCardHeight-this.stateImage.height)):(this.seatData.user.uid==uniLib.NetMgr.UID||"guanzhan"==t)&&(this.addChild(this.stateImage),this.stateImage.y=15),this.stateImage.touchEnabled=!1},n.prototype.clearState=function(){this.stateImage&&this.stateImage.parent&&(this.stateImage.parent.removeChild(this.stateImage),this.stateImage=null),null!=this.userSprite&&(this.userSprite.alpha=1)},n.prototype.seatStateAdd=function(t){this.clearState(),t==Cmd.GameState.State_Check?(this.addState("kanpai"),e.SoundHand.Instance.PlayActSound(Cmd.Operation.Check,this.m_seatData.user.gender)):t==Cmd.GameState.State_Fold?(this.addState("qipai"),this.userSprite.alpha=.5,e.SoundHand.Instance.PlayActSound(Cmd.Operation.Fold,this.m_seatData.user.gender),this.uid!=uniLib.NetMgr.UID&&e.EffectCreate.Instance.cardLeave(this.uid)):t==Cmd.GameState.State_ShowCard&&this.uid==uniLib.NetMgr.UID&&(e.GameView.Instance.playBtnVisable=!1)},n.prototype.deleteState=function(){this.seatData.seatStateList.deletefirst(function(e){return e==Cmd.GameState.State_CompareLose}),this.seatData.seatStateList.deletefirst(function(e){return e==Cmd.GameState.State_Fold}),this.seatData.seatStateList.deletefirst(function(e){return e==Cmd.GameState.State_Complete}),this.seatData.seatStateList.deletefirst(function(e){return e==Cmd.GameState.State_CompareWin}),this.seatData.seatStateList.deletefirst(function(e){return e==Cmd.GameState.State_Check}),this.seatData.seatStateList.deletefirst(function(e){return e==Cmd.GameState.State_Host})},n.prototype.seatStateListChanged=function(t){t.seek(function(e){return e==Cmd.GameState.State_InGame})&&(this.m_isInGame=!0),t.seek(function(e){return e==Cmd.GameState.State_SeeCard})?this.uid==uniLib.NetMgr.UID&&(e.GameView.Instance.lookBtnVisable=!0):t.seek(function(e){return e==Cmd.GameState.State_SeeCard})||this.uid==uniLib.NetMgr.UID&&(e.GameView.Instance.lookBtnVisable=!1),t.seek(function(e){return e==Cmd.GameState.State_Host})&&this.userSprite.showGuanZhan()},Object.defineProperty(n.prototype,"isCheckCard",{get:function(){return this.m_seatData.seatStateList.seek(function(e){return e==Cmd.GameState.State_Check})?!0:!1},enumerable:!0,configurable:!0}),n.prototype.resetState=function(){this.m_seatData.seatStateList.seek(function(e){return e==Cmd.GameState.State_Check})&&this.addState("kanpai"),this.m_seatData.seatStateList.seek(function(e){return e==Cmd.GameState.State_CompareLose})&&this.addState("bipaishu"),this.m_seatData.seatStateList.seek(function(e){return e==Cmd.GameState.State_CompareWin})&&this.addState("bipaiying"),this.m_seatData.seatStateList.seek(function(e){return e==Cmd.GameState.State_Fold})&&(this.addState("qipai"),this.userSprite.alpha=.5,this.uid==uniLib.NetMgr.UID&&e.BetSelectPanel.Instance.offPanel(),e.EffectCreate.Instance.cardLeave(this.uid)),this.m_seatData.seatStateList.seek(function(e){return e==Cmd.GameState.State_SeeCard})&&this.uid==uniLib.NetMgr.UID&&(e.GameView.Instance.lookBtnVisable=!0)},n.prototype.addHeadSelectBg=function(){this.removeHeadSelectBg(),this.selectbg=new eui.Image(RES.getRes("compareCard_bg")),this.selectbg.x=2,this.selectbg.y=5,this.selectbg.touchEnabled=!1,this.addChild(this.selectbg)},n.prototype.removeHeadSelectBg=function(){this.selectbg&&this.selectbg.parent&&(this.selectbg.parent.removeChild(this.selectbg),this.selectbg=null)},Object.defineProperty(n.prototype,"cardType",{get:function(){return this.m_cardType},set:function(e){this.m_cardType=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"cardMultiple",{get:function(){return this.m_cardMultiple},set:function(e){this.m_cardMultiple=e},enumerable:!0,configurable:!0}),n}(egret.Sprite);t.HeadCardWidth=[{width:127,height:173},{width:90,height:130},{width:90,height:130}],e.SeatSprite=t,__reflect(t.prototype,"game.SeatSprite")}(game||(game={}));var game;!function(e){var t=function(t){function n(){var n=t.call(this)||this;return n.skinName=new SetOpreate_ZJH_Skin,e.RoomData.Instance.bottomPoint?n.exitButton.skin.typeImage.texture=RES.getRes("tool_exit"):uniLib.NetMgr.UID==e.RoomData.Instance.ownerId?n.exitButton.skin.typeImage.texture=RES.getRes("wrnn_btn_jiesan"):n.exitButton.skin.typeImage.texture=RES.getRes("tool_exit"),n}return __extends(n,t),Object.defineProperty(n,"instance",{get:function(){return null==this.m_instance&&(this.m_instance=new n),this.m_instance},enumerable:!0,configurable:!0}),n.clearInstance=function(){n.instance.removeHelp(),this.m_instance=null},n.prototype.addUIListener=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.OnClick,this)},n.prototype.removeUIListener=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.OnClick,this)},n.prototype.adaptationWidth=function(){t.prototype.adaptationWidth.call(this)},n.prototype.OnClick=function(t){if(e.SoundHand.Instance.playButtonClick(),t.target==this.exitButton){if(this.showMessageBox(),e.PokerData.isStandAlone)return void e.GameView.exitGame();if(e.RoomData.Instance.bottomPoint){var i=new Cmd.LeaveRoomCmd_CS;i.uid=uniLib.NetMgr.UID,e.PokerFunction.tcpSend(i),e.PopupManager.removePopUp(n.instance)}else{if(uniLib.NetMgr.UID!=e.RoomData.Instance.ownerId){var i=new Cmd.LeaveRoomCmd_CS;return i.uid=uniLib.NetMgr.UID,e.PokerFunction.tcpSend(i),void e.PopupManager.removePopUp(n.instance)}this.showMessageBox()}}else t.target==this.playButton?GX.PopUpManager.addPopUp(e.PlayTypePanel.instance,!1,GX.PopUpEffect.CENTER):t.target==this.setButton?GX.PopUpManager.addPopUp(e.SettingPanel.instance,!1,GX.PopUpEffect.CENTER):t.target==this.helpButton&&(this._helpPanel||(this._helpPanel=new e.HelpPanel,this._helpPanel.addEventListener(e.UIEventConsts.CLOSE,this.removeHelp,this),GX.PopUpManager.addPopUp(this._helpPanel,!1,GX.PopUpEffect.CENTER)));this.OnClose()},n.prototype.removeHelp=function(){this._helpPanel&&(this._helpPanel.removeEventListener(e.UIEventConsts.CLOSE,this.removeHelp,this),uniLib.DisplayUtils.removeFromParent(this._helpPanel),this._helpPanel.destory(),GX.PopUpManager.removePopUp(this._helpPanel,GX.PopUpEffect.CENTER),this._helpPanel=null)},n.prototype.OnOpen=function(){this.setGroup.x=1280,e.PopupManager.addPopUp(n.instance,!1),egret.Tween.get(this.setGroup).to({x:1073},100)},n.prototype.OnClose=function(){egret.Tween.get(this.setGroup).to({x:1280},100).call(function(){return e.PopupManager.removePopUp(n.instance)})},n.prototype.showMessageBox=function(){this.msgbox||(this.msgbox=new e.MsgBoxPanel),this.msgbox.setData("不能返回大厅，你要解散游戏么",["确定","取消"],[this.confirmHandel,this.cancelHandel],this),GX.PopUpManager.addPopUp(this.msgbox,!1)},n.prototype.confirmHandel=function(t){var n=new Cmd.DissolveRoomRequestCmd_C;e.PokerFunction.tcpSend(n)},n.prototype.cancelHandel=function(e){this.removeTips()},n.prototype.removeTips=function(){this.msgbox&&(GX.PopUpManager.removePopUp(this.msgbox,GX.PopUpEffect.CENTER),this.msgbox=null)},n}(e.EuiPanel);e.SetOpreatePanel=t,__reflect(t.prototype,"game.SetOpreatePanel")}(game||(game={}));var game;!function(e){var t=function(){function t(){}return Object.defineProperty(t,"isInGame",{get:function(){return this.$isInGame},set:function(e){this.$isInGame=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isSitDown",{get:function(){return this.$isSitDown},set:function(t){this.$isSitDown=t,t?e.GameView.Instance.removeSeatDownBtn():e.GameView.Instance.setReadyBtnVisible(!1)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isDeZhou",{get:function(){return this.$isDeZhou},set:function(e){this.$isDeZhou=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isPlayRandom",{get:function(){return this._isPlayRandom},set:function(e){this._isPlayRandom=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isChose",{get:function(){return this._isChose},set:function(e){this._isChose=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isAuto",{get:function(){return this._isAuto},set:function(e){this._isAuto=e},enumerable:!0,configurable:!0}),t}();t.$isInGame=!1,t._isAuto=!1,e.DataManager=t,__reflect(t.prototype,"game.DataManager")}(game||(game={}));var game;!function(e){var t=function(t){function i(){var e=t.call(this)||this;return e.skinName=new SelectCard_ZJH_Panel,e.init(),e}return __extends(i,t),Object.defineProperty(i,"Instance",{get:function(){return null==this._instance&&(this._instance=new i),this._instance},enumerable:!0,configurable:!0}),i.TestPanel=function(){if(this._instance)throw new Error("Sington已经创建!")},i.prototype.init=function(){this.create(),this.selectId=[]},i.prototype.create=function(){this.touchChildren=!0,this.touchEnabled=!0,uniLib.Global.debugLevel>=1&&this.setGameButton()},i.prototype.addListener=function(){this.buttonList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.buttonClickHandel,this),this._cardList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.cardListClickHandel,this)},i.prototype.removeListener=function(){this._cardList.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.cardListClickHandel,this),this.buttonList.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.buttonClickHandel,this)},i.prototype.cardListClickHandel=function(e){if(!(this.selectId.length>=17)){for(var t=0,n=this.selectId;t<n.length;t++){var i=n[t];if(i==e.item)return}this.selectId.push(e.item),this.refrenshSelected(),this.setItemVisible(e.item,!1)}},i.prototype.setItemVisible=function(e,t){var n=e+"";this._cardList.getChildByName(n).visible=t},i.prototype.refrenshSelected=function(){this.selectedCards.itemRenderer=n,this.selectedCards.dataProvider=new eui.ArrayCollection(this.selectId)},i.prototype.initCardList=function(){this.cardList=[];for(var e=3;15>e;e++)for(var t=100*e,i=1;5>i;i++){var a=t+10*i;a+=1,this.cardList.push(a)}this.cardList.push(1611),this.cardList.push(1621),this.cardList.push(1631),this.cardList.push(1641),this.cardList.push(2051),this.cardList.push(2151),this._cardList.itemRenderer=n,this._cardList.dataProvider=new eui.ArrayCollection(this.cardList)},i.prototype.setCardList=function(e){this.cardList=new Array,this.cardList=e,this.cardList.sort(function(e,t){return e-t}),this._cardList.itemRenderer=n,this._cardList.dataProvider=new eui.ArrayCollection(this.cardList)},i.prototype.setGameButton=function(){this.cardButtonArr=["确定","取消","重选","删除","结束"],this.buttonList.itemRenderer=n,this.buttonList.dataProvider=new eui.ArrayCollection(this.cardButtonArr)},i.prototype.buttonClickHandel=function(t){switch(t.itemIndex){case 0:if(this.selectId.length<1)return;var n=new Cmd.GmSelectCardCmd_C;n.cardList=this.selectId,e.PokerFunction.tcpSend(n),e.GameInfo.topLayer.removeChild(this),this.dispose();break;case 1:e.GameInfo.topLayer.removeChild(this),this.dispose();break;case 2:this.selectId.clear(),this.refrenshSelected();for(var i=0;i<this.cardList.length;i++)this._cardList.getChildByName(this.cardList[i]+"").visible||this.setItemVisible(this.cardList[i],!0);break;case 3:if(this.selectId.length<1)return;var a=this.selectId.pop();this.setItemVisible(a,!0),this.refrenshSelected();break;case 4:var o=new Cmd.GmFinishRoundCmd_C;e.PokerFunction.tcpSend(o),e.GameInfo.topLayer.removeChild(this),this.dispose()}},i.prototype.dispose=function(){this.removeListener(),this.cardList=[],this.selectId=[]},i}(eui.Component);e.TestPanel=t,__reflect(t.prototype,"game.TestPanel");var n=function(e){function t(){var t=e.call(this)||this;return t.skinName=new CardItem_ZJH_Skin,t}return __extends(t,e),t.prototype.dataChanged=function(){var e=this.data;isNaN(e)?(this.cardName.text=e,this.background.fillColor=16776960):this.cardName.text=table.TablePokerCard.cardName(e),this.name=e+""},t}(eui.ItemRenderer);e.CardItem=n,__reflect(n.prototype,"game.CardItem")}(game||(game={}));var game;!function(e){var t=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.initUI=function(){this.kickPersonBtn=new eui.Button,this.kickPersonBtn.skinName=new KickButton_ZJH_Skin,this.kickPersonBtn.label="踢出",this.kickPersonBtn.width=154,this.kickPersonBtn.height=75,this.kickPersonBtn.y=70;var t=new eui.Rect(uniLib.Global.screenWidth,uniLib.Global.screenHeight);t.alpha=.1,t.x=-291,t.y=-185,this.addChildAt(t,0),t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseHandle,this),uniLib.Global.addEventListener(uniLib.ZqEvent.EVENT_L2G,this.diamondChange,this);var i=e.DataCache.langObj.uiTxt.PlayerInfoPanel,a=e.ResUtil.createBitmapByName("zjh_big_bg_png");a.scale9Grid=new egret.Rectangle(17,13,67,68),a.touchEnabled=!0,a.width=697,a.x=-8,a.height=360,this.addChild(a);var o=e.ResUtil.createTextFeild(16777215,egret.HorizontalAlign.LEFT,i.nickLabel,24,182,45,300);this.addChild(o);var s=e.ResUtil.createTextFeild(16777215,egret.HorizontalAlign.LEFT,i.idLabel,24,183,90,90);this.addChild(s);var r=e.ResUtil.createTextFeild(16777215,egret.HorizontalAlign.LEFT,i.levelLabel,24,185,131,90);this.addChild(r);var h=new egret.Bitmap(RES.getRes("userinfo_fangka_DDZ"));h.x=455,h.y=125,this._nickTxt=e.ResUtil.createTextFeild(16777215,egret.HorizontalAlign.LEFT,"",24,260,45,159),this._nickTxt.height=26,this.addChild(this._nickTxt),this._idTxt=e.ResUtil.createTextFeild(16777215,egret.HorizontalAlign.LEFT,"",24,258,90,136),this.addChild(this._idTxt),this._diamondTxt=e.ResUtil.createTextFeild(16777215,egret.HorizontalAlign.LEFT,"",24,535,130,136),this.addChild(this._diamondTxt),this._ipTxt=e.ResUtil.createTextFeild(16777215,egret.HorizontalAlign.LEFT,"",24,258,131,200),this.addChild(this._ipTxt),this._distance=e.ResUtil.createTextFeild(16777215,egret.HorizontalAlign.LEFT,"",24,185,170,400),this.addChild(this._distance),this._scoreTxt=e.ResUtil.createTextFeild(16777215,egret.HorizontalAlign.LEFT,"",24,535,131,136),this._giftItemArr=[];for(var l,d=table.TableGift.instance(),c=0;c<d.length;c++)6!==c&&(l=new n,l.data=d[c],this._giftItemArr[d[c].giftId]=l,l.x=105*c,6===c&&(l.x=525),l.y=200,this.addChild(l),l.touchEnabled=!0,l.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickGift,this));uniLib.NetMgr.UID==e.RoomData.Instance.ownerId&&(this.kickPersonBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.kickPerson,this),this.addChild(this.kickPersonBtn))},i.prototype.kickPerson=function(){e.SoundHand.Instance.playButtonClick();var t=new Cmd.KickLeaveRoomCmd_C;t.uid=this._data.uid,uniLib.NetMgr.tcpSend(t),this.onCloseHandle()},i.prototype.onCloseHandle=function(){this.parent.removeChild(this),this.kickPersonBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.kickPerson,this),this.destory()},i.prototype.table=function(){var e;return e=loadTable("TableGiftND_json")},i.prototype.onClickGift=function(t){if(!e.DataManager.isSitDown)return void e.PublicManage.getInstance().showMildWarnShow("未坐下不能送礼");if(e.SoundHand.Instance.playButtonClick(),this._data.uid==uniLib.NetMgr.UID)return void e.PublicManage.getInstance().showMildWarnShow("不能给自己送礼物");var n=t.currentTarget,i=new Cmd.SendGiftRoomCmd_C,a=new Cmd.GiftsInfo;a.giftsId=n.data.giftId,a.toUid=this._data.uid,a.fromUid=uniLib.NetMgr.UID,a.giftsNum=1,i.gift=a,e.PokerFunction.tcpSend(i),this.onCloseHandle()},i.prototype.reset=function(){this._data=null,this._idTxt.text="",this._nickTxt.text="",this._ipTxt.text="",this._distance.text="",this._diamondTxt.text="",this._scoreTxt.text=""},i.prototype.setData=function(t){this._data=t;var n="public_DDZ6";"男"==t.gender&&(n="public_DDZ7"),this._genderIcon?this._genderIcon.texture=e.ResUtil.createTexture(n):(this._genderIcon=e.ResUtil.createBitmapByName(n,467,65),this.addChild(this._genderIcon)),this._idTxt.text=t.uid.toString(),this._nickTxt.text=t.nickName,void 0!=t.ip&&(this._ipTxt.text=t.ip),null==e.RoomData.Instance.bottomPoint?void 0!=t.points&&(this._diamondTxt.text="分数："+Math.floor(t.points)):void 0!=t.points&&(this._diamondTxt.text="金豆："+Math.floor(t.points)),this._scoreTxt.text=t.points.toString();for(var i=0;6>i;i++)this._giftItemArr[i+1]&&this._giftItemArr[i+1].setFlowerNum(0);if(t.flower instanceof Array)for(var i=0;i<t.flower.length;i++)this._giftItemArr[t.flower[i].id].setFlowerNum(t.flower[i].num)},i.prototype.diamondChange=function(e){},i.prototype.destory=function(){uniLib.Global.removeEventListener(uniLib.ZqEvent.EVENT_L2G,this.diamondChange,this);var e=table.TableGift.instance();if(e)for(var t=0;t<e.length;t++){var i=new n;i.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickGift,this),i.destory()}uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this),this._data=null,this._idTxt=null,this._ipTxt=null,this._nickTxt=null,this._diamondTxt=null,this._genderIcon=null
},i}(e.BaseVc);e.UserInfoPanel=t,__reflect(t.prototype,"game.UserInfoPanel");var n=function(t){function n(){return t.call(this)||this}return __extends(n,t),n.prototype.initUI=function(){this._testBg=new egret.Bitmap(RES.getRes("testBg")),this._testBg.y=110,this._testBg.x=35,this._nameTxt=e.ResUtil.createTextFeild(419190,egret.HorizontalAlign.CENTER,"",20,5,110,100)},Object.defineProperty(n.prototype,"data",{get:function(){return this._data},set:function(t){this._nameTxt.text="0",this._giftIcon||(this._giftIcon=e.ResUtil.createBitmapByName("userInfo_freegift_DDZ"+t.giftId,17,0),this.addChildAt(this._giftIcon,0)),this._data=t,this.name=t.giftId.toString()},enumerable:!0,configurable:!0}),n.prototype.setFlowerNum=function(e){this._nameTxt.text=e.toString(),this._nameTxt.x=this._testBg.x+(this._testBg.width-this._nameTxt.width)/2},n.prototype.destory=function(){uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this),this._data=null,this._nameTxt=null},n}(e.BaseVc);e.GiftItem=n,__reflect(n.prototype,"game.GiftItem")}(game||(game={}));var game;!function(e){var t=function(t){function n(e,n){var i=t.call(this)||this;return i._betSum=0,i._cardImageList=[],i.userType=n,i.m_user=e,i.skinName=new UserSprite_across_ZJH_Skin,i.addListener(),i.touchEnabled=!0,i.touchChildren=!1,i}return __extends(n,t),Object.defineProperty(n.prototype,"user",{get:function(){return this.m_user},enumerable:!0,configurable:!0}),n.prototype.destroy=function(){this._betSum=0,this._betImage&&this._betImage.parent&&(this._betImage.parent.removeChild(this._betImage),this._betImage=null),this.removeListener()},n.prototype.addListener=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.requestUserInfo,this),this.user.headUrlChanged.add(this.changedHead,this),e.RoomData.Instance.ownerIdChanged.add(this.showRoomOwner,this),DDZ.EventManage.stateChanged.add(this.changeState,this),e.RoomData.Instance.startGameOpIdChange.add(this.changeStartVisable,this),this.user.pointChanged.add(this.pointChanged,this),this.user.nameChanged.add(this.nameChanged,this),GX.PokerEvent.Instance.userBetEvent.add(this.addPoint,this)},n.prototype.removeListener=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.requestUserInfo,this),this.user.headUrlChanged.remove(this.changedHead),DDZ.EventManage.stateChanged.remove(this.changeState),e.RoomData.Instance.ownerIdChanged.remove(this.showRoomOwner),e.RoomData.Instance.startGameOpIdChange.remove(this.changeStartVisable,this),GX.PokerEvent.Instance.userBetEvent.remove(this.addPoint,this)},n.prototype.addPoint=function(t){if(t.bet&&t.bet.chips&&t.uid==this.user.uid){var n=e.GameConstant.GetClientNoByUid(t.uid),i=e.GameConstant.robSorcePosArr[n];switch(e.GameView.Instance.maxNum){case 6:i=e.GameConstant.robSorcePosArr[n];break;case 12:i=e.GameConstant.robSorceMaxPosArr[n]}if(i){t.uid==uniLib.NetMgr.UID&&e.OperateBet.instance.onClose(),this._betImage&&this._betImage.parent&&this._betImage.parent.removeChild(this._betImage),this._betImage=new eui.BitmapLabel,e.EffectCreate.Instance.chips.push(this._betImage),this._betSum+=t.bet.chips,this._betImage.font="zhanji_num_fnt",this._betImage.text="+"+this._betSum;var a=e.GameConstant.GetSeatSpriteByUid(t.uid),o="";if(a&&(o=a.seatData.user.gender),e.OperateLayer.Instance.addChild(this._betImage),1==n||2==n||3==n){this._betImage.y=i.y;var s=e.GameConstant.GetSeatSpriteByUid(this.user.uid);s&&(this._betImage.x=s.x-this._betImage.width)}else this._betImage.y=i.y,this._betImage.x=i.x;t.bet&&t.bet.chips&&(e.SoundHand.Instance.PlayBetNum(t.bet.chips,o),e.EffectCreate.Instance.ChipsEffect(t.bet.chips,t.uid,!0))}}},n.prototype.pointChanged=function(){this._chips.text=""+this.user.point},n.prototype.nameChanged=function(){this._name.text=this.user.nickName},n.prototype.changedHead=function(){this._headImage.source=this.user.headUrl},Object.defineProperty(n.prototype,"headPoint",{get:function(){return{x:this.x,y:this.y}},enumerable:!0,configurable:!0}),n.prototype.showRoomOwner=function(){this.roomOwner||(this.roomOwner=new egret.Bitmap(RES.getRes("room_owner")),this.roomOwner.name="roomOwner"),this.user.uid==e.RoomData.Instance.ownerId&&(this.roomOwner.y=35,this.roomOwner.x=20,this.addChild(this.roomOwner))},n.prototype.removeRoomOwner=function(){this.roomOwner&&this.roomOwner.parent&&this.removeChild(this.roomOwner)},n.prototype.showLordLogo=function(){return this.user.uid!=e.RoomData.Instance.landlordUid?void(this.zhuangEffect&&this.zhuangEffect.display.parent&&(this.zhuangEffect.display.parent.removeChild(this.zhuangEffect.display),this.zhuangEffect=null)):(this.zhuangEffect||(this.zhuangEffect=e.EffectCreate.Instance.playzhuangEffect()),this.userType==userType.vertical&&(this.zhuangEffect.display.x=40,this.zhuangEffect.display.y=0),dragonBones.WorldClock.clock.add(this.zhuangEffect),this.zhuangEffect.animation.play("newAnimation",1),this.addChild(this.zhuangEffect.display),void 0)},n.prototype.removeLordLogo=function(){this.zhuangEffect&&this.zhuangEffect.display.parent&&(this.removeChild(this.zhuangEffect.display),this.zhuangEffect=null,e.EffectCreate.Instance.zhuangEffect=null)},n.prototype.changeState=function(e){this.complete||(this.complete=new egret.Bitmap(RES.getRes("wrnn_selfSortCardEnd"))),e==this.user.uid&&this.hancardSprite&&this.hancardSprite.addChild(this.complete)},n.prototype.showOffline=function(){this.offLine||(this.offLine=new egret.Bitmap(RES.getRes("user_dropped_icon"))),this.addChild(this.offLine),this.userType==userType.vertical?(this.offLine.x=(this.width-this.offLine.width)/2,this.offLine.y=10):(this.offLine.x=(this.width-this.offLine.width)/2-70,this.offLine.y=(this.height-this.offLine.height)/2),this.guanzhan&&this.guanzhan.parent.removeChild(this.guanzhan)},n.prototype.removeOffline=function(){this.offLine&&this.offLine.parent&&this.offLine.parent.removeChild(this.offLine),this.offLine=null,this.guanzhan&&!this.guanzhan.parent&&this.addChild(this.guanzhan)},n.prototype.showGuanZhan=function(){this.removeGuanzhan(),this.guanzhan||(this.guanzhan=new egret.Bitmap(RES.getRes("guanzhan"))),this.addChild(this.guanzhan),this.userType==userType.vertical?(this.guanzhan.x=(this.width-this.guanzhan.width)/2,this.guanzhan.y=10):(this.guanzhan.x=-13,this.guanzhan.y=10)},n.prototype.removeGuanzhan=function(){this.guanzhan&&this.guanzhan.parent&&this.guanzhan.parent.removeChild(this.guanzhan),this.guanzhan=null},n.prototype.resetHeadIcon=function(){this.changedHead(),this.removeLordLogo(),this._betSum=0},Object.defineProperty(n.prototype,"cardImageList",{get:function(){return this._cardImageList},enumerable:!0,configurable:!0}),n.prototype.handCardCountChanged=function(t){if(0>=t&&this.hancardSprite&&this.hancardSprite.parent&&(this.hancardSprite.parent.removeChild(this.hancardSprite),this.hancardSprite=null),!(0>=t)){var n=e.GameConstant.GetSeatSpriteByUid(this.user.uid);n&&(n.isInGame=!0),this.clearCardImage(),this.hancardSprite||(this.hancardSprite=new egret.Sprite,e.OperateLayer.Instance.addChild(this.hancardSprite))}},n.prototype.catchCardCountChanged=function(e){},n.prototype.clearCardImage=function(){for(var e=0;e<this._cardImageList.length;e++)this._cardImageList[e]&&this._cardImageList[e].parent&&this._cardImageList[e].parent.removeChild(this._cardImageList[e]),this._cardImageList.clear()},n.prototype.changeStartVisable=function(){this.removeStart(),this.user.uid==e.RoomData.Instance.startGameOpId&&(this.startgameIcon=new egret.Bitmap,this.startgameIcon.texture=RES.getRes("start_Game_icon"),this.userType==userType.vertical?(this.startgameIcon.x=0,this.startgameIcon.y=25):(this.startgameIcon.x=-10,this.startgameIcon.y=50),this.addChild(this.startgameIcon))},n.prototype.removeStart=function(){this.startgameIcon&&this.startgameIcon.parent&&(this.startgameIcon.parent.removeChild(this.startgameIcon),this.startgameIcon=null)},n.prototype.requestUserInfo=function(t){if(e.SoundHand.Instance.playButtonClick(),e.DataManager.isChose){var n=e.GameConstant.GetSeatSpriteByUid(this.user.uid);if(n&&!n.isInGame)return;if(!this.user.uid||this.user.uid==uniLib.NetMgr.UID)return;e.BetSelectPanel.Instance.slectUID=this.user.uid,e.BetSelectPanel.Instance.operateAct(Cmd.Operation.Compare)}else{var i=new Cmd.GetPersonalPanel_C;i.uid=this.user.uid,e.PokerFunction.tcpSend(i)}},n.prototype.showAllcard=function(){for(var e=0;e<this._cardImageList.length;e++)this._cardImageList[e].visible=!0},n.prototype.randomRoundEffect=function(){var t=this,n=this;this.zhuangHeadBg=new eui.Image(RES.getRes("head_around")),this.addChild(this.zhuangHeadBg),e.SoundHand.Instance.randomSound(),uniLib.SetUniEventTimeout(this,function(){n.zhuangHeadBg&&t.zhuangHeadBg.parent&&n.zhuangHeadBg.parent.removeChild(n.zhuangHeadBg)},200,1,this)},n.prototype.addHeadTimer=function(e){function t(t){return n(o),o>0?o-=360/(10*e):0>=o&&(s*=-1,egret.clearInterval(this.timer),a&&a.parent&&a.parent.removeChild(a),this._timerBg&&this._timerBg.parent&&this._timerBg.parent.removeChild(this._timerBg)),!1}function n(e){a.graphics.clear(),a.graphics.beginFill(16777215),a.graphics.lineTo(0,-r),a.graphics.drawArc(0,0,r,0,e*Math.PI/180,-1==s),a.graphics.lineTo(0,0),a.graphics.endFill()}var i=new eui.Image(RES.getRes("head_around"));this._timerBg=new egret.Sprite,this._timerBg.x=0,this._timerBg.y=9;var a=new egret.Shape;a.alpha=1,this._timerBg.mask=a,this._timerBg.addChild(i),a.anchorOffsetX=a.width/2,a.anchorOffsetY=a.height/2,a.x=this._timerBg.x+58+a.anchorOffsetX,a.y=this._timerBg.y+79.5+a.anchorOffsetY,a.rotation=-90;var o=360,s=1;this.timer=egret.setInterval(t,this,100),this.addChild(this._timerBg),this.addChild(a);var r=100},n.prototype.stopHeadTimer=function(){egret.clearInterval(this.timer),this._timerBg&&this._timerBg.parent&&this._timerBg.parent.removeChild(this._timerBg)},Object.defineProperty(n.prototype,"allvisable",{set:function(e){for(var t=0;t<this.numChildren;t++)this.getChildAt(t).visible=e;this._headImage.visible=!0},enumerable:!0,configurable:!0}),n}(eui.Component);e.UserSprite=t,__reflect(t.prototype,"game.UserSprite")}(game||(game={}));var game;!function(e){var t=function(t){function n(){return t.call(this)||this}return __extends(n,t),n.prototype.initUI=function(){this._mask=new egret.Sprite,this._mask.graphics.beginFill(0,.01),this._mask.graphics.drawRect(0,0,e.DataCache.defaultWidth,e.DataCache.defaultHeight),this._mask.graphics.endFill(),this._mask.touchEnabled=!0,this.addChild(this._mask);var t=uniLib.DisplayUtils.createBitmapByName("video_bg");this.addChild(t),t.y=uniLib.Global.screenHeight/2+20,t.x=uniLib.Global.screenWidth/2-t.width/2,this._backBtn=new e.GameButton(["video_back1","video_back2"]),this.addChild(this._backBtn),this._backBtn.name="back",this._stopBtn=new e.GameButton(["video_stop1","video_stop2"]),this.addChild(this._stopBtn),this._stopBtn.name="stop",this._advanceBtn=new e.GameButton(["video_advance1","video_advance2"]),this.addChild(this._advanceBtn),this._advanceBtn.name="advance",this._closeBtn=new e.GameButton(["video_close1","video_close2"]),this.addChild(this._closeBtn),this._closeBtn.name="close",this._backBtn.x=t.x+2,this._stopBtn.x=this._backBtn.x+this._backBtn.width+5,this._advanceBtn.x=this._stopBtn.x+this._stopBtn.width+5,this._closeBtn.x=this._advanceBtn.x+this._advanceBtn.width+3,this._backBtn.y=this._stopBtn.y=this._advanceBtn.y=this._closeBtn.y=t.y+5,this._backBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),this._stopBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),this._advanceBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),this._closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this)},n.prototype.btnClick=function(t){var n=t.currentTarget.name;switch(n){case"back":uniLib.Global.dispatchEvent(uniLib.ZqEvent.EVENT_G2L,"video_back");break;case"stop":uniLib.Global.dispatchEvent(uniLib.ZqEvent.EVENT_G2L,"video_stop");break;case"advance":uniLib.Global.dispatchEvent(uniLib.ZqEvent.EVENT_G2L,"video_advance");break;case"close":e.GameView.Instance.showVideoFinish(1)}},n.prototype.destory=function(){this._backBtn&&(this._backBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),this._backBtn=null),this._stopBtn&&(this._stopBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),this._stopBtn=null),this._advanceBtn&&(this._advanceBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),this._advanceBtn=null),this._closeBtn&&(this._closeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),this._closeBtn=null),uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this)},n}(e.BaseVc);e.VideoPanel=t,__reflect(t.prototype,"game.VideoPanel")}(game||(game={}));var game;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.skinName=new VsCard_ZJH_Skin,e}return __extends(n,t),Object.defineProperty(n,"Instance",{get:function(){return null==this._instance&&(this._instance=new n),this._instance},enumerable:!0,configurable:!0}),n.clearInstance=function(){this._instance=null},n.prototype.addUIListener=function(){},n.prototype.removeUIListener=function(){},n.prototype.adaptationWidth=function(){t.prototype.adaptationWidth.call(this)},n.prototype.loadData=function(t,n){this.clearData();var i=e.GameConstant.GetSeatSpriteByUid(n.uid),a=e.GameConstant.GetSeatSpriteByUid(t.uid);if(i.uid!=uniLib.NetMgr.UID||!i.isCheckCard||n.cardList instanceof Array)if(n.cardList&&n.cardList instanceof Array){for(var o=0,s=n.cardList;o<s.length;o++){var r=s[o],h=this.getCardSprite(r);h.x=50*this.leftCardGroup.numChildren,this.leftCardGroup.addChild(h)}this.setCardType(n.cardListType,n.multiple,!0)}else for(var l=0;3>l;l++){var h=this.getCardSprite(null);h.x=50*this.leftCardGroup.numChildren,this.leftCardGroup.addChild(h)}else if(e.EffectCreate.Instance.cardImage[i.uid]&&e.EffectCreate.Instance.cardImage[i.uid]instanceof Array){for(var d=0,c=e.EffectCreate.Instance.cardImage[i.uid];d<c.length;d++){var u=c[d];console.error(u);var h=this.getCardSprite(u.cardId);h.x=50*this.leftCardGroup.numChildren,this.leftCardGroup.addChild(h)}this.setCardType(i.cardType,i.cardMultiple,!0)}if(a.uid!=uniLib.NetMgr.UID||!a.isCheckCard||t.cardList instanceof Array)if(t.cardList&&t.cardList instanceof Array){for(var m=0,p=t.cardList;m<p.length;m++){var r=p[m],h=this.getCardSprite(r);h.x=50*this.rightCardGroup.numChildren,this.rightCardGroup.addChild(h)}this.setCardType(t.cardListType,t.multiple,!1)}else for(var l=0;3>l;l++){var h=this.getCardSprite(null);h.x=50*this.rightCardGroup.numChildren,this.rightCardGroup.addChild(h)}else if(e.EffectCreate.Instance.cardImage[a.uid]&&e.EffectCreate.Instance.cardImage[a.uid]instanceof Array){for(var g=0,f=e.EffectCreate.Instance.cardImage[a.uid];g<f.length;g++){var u=f[g],h=this.getCardSprite(u.cardId);h.x=50*this.rightCardGroup.numChildren,this.rightCardGroup.addChild(h)}this.setCardType(a.cardType,a.cardMultiple,!1)}this.winImage.visible=!1,this.loseImage.visible=!1;var C=this;uniLib.SetUniEventTimeout(e.GameView.Instance,function(){this.winImage.visible=!0,this.loseImage.visible=!0,egret.Tween.get(C.winImage).to({alpha:1.1},250).to({alpha:1}),egret.Tween.get(C.loseImage).to({alpha:1.1},250).to({alpha:1})},1500,1,this,null)},n.prototype.getCardSprite=function(t){var n=null;return t?n=new e.HandCardSprite(t):(n=new e.HandCardSprite(null),n.setTexture("BackCard")),n.touchEnabled=!1,n.touchChildren=!1,n.y=0,n},n.prototype.setCardType=function(e,t,n){e=e?e:0,n?(this.leftCardTypeImage.source="cow_"+e,this.leftPoint.text=t?"乘"+t:""):(this.rightCardTypeImage.source="cow_"+e,this.rightPoint.text=t?"乘"+t:"")},n.prototype.clearData=function(){this.leftCardGroup.removeChildren(),this.rightCardGroup.removeChildren()},n}(e.EuiPanel);e.VsCardPanel=t,__reflect(t.prototype,"game.VsCardPanel")}(game||(game={}));var DDZ;!function(e){var t=function(){function t(){this.PlayCardArr=[],this.isDeal=!1,this.state=0,this.listener()}return t.prototype.listener=function(){GX.PokerEvent.Instance.tcpSendEvent.add(this.tcpSendEvent,this),GX.PokerEvent.Instance.calllordRobResult.add(this.calllordRobResult,this),GX.PokerEvent.Instance.playCard.add(this.PlayCard,this),GX.PokerEvent.Instance.dissolveRoomUpdate.add(this.dissolveRoom,this),GX.PokerEvent.Instance.systemMessage.add(this.showSystemMessage,this),GX.PokerEvent.Instance.leaveRoom.add(this.leaveRoom,this),GX.PokerEvent.Instance.roundResult.add(this.showLastHandcards,this),GX.PokerEvent.Instance.dealCardEnd.add(this.dealCardEnd,this),GX.PokerEvent.Instance.dealCardAnimation.add(game.EffectCreate.Instance.dealCardAnimation,game.EffectCreate.Instance),GX.PokerEvent.Instance.gameFinalSettle.add(this.gameFianlSettle,this),GX.PokerEvent.Instance.gmAvailableCardUpdate.add(this.gmAvailableCardUpdate,this),GX.PokerEvent.Instance.kickPlay.add(this.kickPlay,this),GX.PokerEvent.Instance.gameStateUpdate.add(this.gameStatusUpdate,this),GX.PokerEvent.Instance.SendGiftEvent.add(this.SendGiftEvent,this),GX.PokerEvent.Instance.ActionUpdate.add(this.ActionUpdate,this),game.RoomData.Instance.landlordChanged.add(this.OnLandlordUpdateCmd_S,this),GX.PokerEvent.Instance.DisplayCardEvent.add(this.lookCard,this),GX.PokerEvent.Instance.compareResultEvent.add(this.compareResult,this),game.RoomData.Instance.bottomPointChange.add(this.bottomUpdate,this)},t.prototype.tcpSendEvent=function(e){!game.PokerData.isStandAlone},t.prototype.SendGiftEvent=function(e){if(e&&e.gift&&e.gift.toUid!=e.gift.fromUid){if(e.gift.toUid==e.gift.fromUid&&e.gift.toUid==uniLib.NetMgr.UID)return void game.PublicManage.getInstance().showMildWarnShow("不能给自己送礼");var n=uniLib.SetUniEventTimeout(game.GameView.Instance,function(){game.EffectCreate.Instance.giftEffect(e.gift.giftsId,e.gift.toUid,e.gift.fromUid)},0,1,this);t.ResultTimer.push(n)}},t.prototype.OnLandlordUpdateCmd_S=function(e){null!=e&&game.OperateLayer.Instance.playRandomRoundEffect()},t.prototype.calllordRobResult=function(e){game.OperateLayer.Instance.addCalllordRobResult(e)},t.prototype.kickPlay=function(e){game.PokerFunction.GetUserInfoByUid(e.uid)},t.prototype.PlayCard=function(e){var t=game.GameConstant.GetSeatSpriteByUid(uniLib.NetMgr.UID);if(t)if(e.list)game.CountPanel.instance.parent&&game.CountPanel.instance.parent.removeChild(game.CountPanel.instance),game.OperateBet.instance.onClose(),t.userSprite.showAllcard(),game.CardLayer.Instance.clearHandCard(),game.CardLayer.Instance.deleteCommonCards(),game.OperateLayer.Instance.removeOperateMain(),game.OperateLayer.Instance.removeRobLandlord(),this.PlayCardArr=e.list,this.playFirstItem();else{if(!e.cardList||!e.cardList.length)return;e.uid==uniLib.NetMgr.UID&&(game.OperateLayer.Instance.removeOperateMain(),game.BetSelectPanel.Instance.offPanel(),game.OperateLayer.Instance.removeRobLandlord(),t.userSprite.showAllcard(),game.OperateBet.instance.onClose(),game.CardLayer.Instance.clearHandCard(),game.CountPanel.instance.parent&&game.CountPanel.instance.parent.removeChild(game.CountPanel.instance)),game.OperateLayer.Instance.playCard(e)}},t.prototype.playFirstItem=function(){var e=this;this.PlayCardArr[0]?(game.OperateLayer.Instance.playCard(this.PlayCardArr[0]),this.PlayCardArr.removeAt(0),egret.Tween.get(this).wait(500).call(function(){return e.playFirstItem()})):(this.isDeal=!1,this&&egret.Tween.removeTweens(this))},t.prototype.dissolveRoom=function(e){this._dismissPanel?this._dismissPanel.setData(e):(this._dismissPanel=new game.DismissPanel,this._dismissPanel.x=uniLib.Global.screenWidth-this._dismissPanel.width>>1,this._dismissPanel.y=uniLib.Global.screenHeight-this._dismissPanel.height>>1,this._dismissPanel.setData(e),game.GameInfo.topLayer.addChild(this._dismissPanel))},t.prototype.removeDissPanel=function(){this._dismissPanel&&this._dismissPanel.parent&&this._dismissPanel.parent.removeChild(this._dismissPanel),this._dismissPanel=null},t.prototype.gameStatusUpdate=function(e){e&&(null!=e&&null!=e.status&&(game.GameView.Instance.setBtnsVisible(!1),game.GameView.Instance.setStartBtnVisible(!1)),e.status==Cmd.GameStatus.GameStatus_Free&&(game.OperateLayer.Instance.stopTimer(),game.OperateLayer.Instance.thisendTime=e.leftSec,game.RoomData.Instance.roomPlayProps.seek(function(e){return 10463==e})||game.OperateLayer.Instance.addTimeButton(),game.OperationPlay.Instance.addListener()),e.status==Cmd.GameStatus.GameStatus_Bet?(game.OperateBet.instance.onOpen(),game.OperateLayer.Instance.stopTimer(),game.OperateLayer.Instance.thisendTime=e.leftSec,game.RoomData.Instance.roomPlayProps.seek(function(e){return 10463==e})||game.OperateLayer.Instance.addTimeButton()):e.status==Cmd.GameStatus.GameStatus_Lottery&&(game.OperateLayer.Instance.stopTimer(),game.GameView.Instance.betTimesLabel=null,game.RoomData.Instance.roomPlayProps.seek(function(e){return 10463==e})&&game.DataManager.isInGame&&(game.GameView.Instance.playBtnVisable=!0)))},t.prototype.showSystemMessage=function(e){switch(this.removeDissPanel(),e.msgType){case Cmd.SysMessageCmd_S.MsgType.Text:game.PublicManage.getInstance().showMildWarnShow(e.msg);break;case Cmd.SysMessageCmd_S.MsgType.DissolveRoom:this.showMessageBox(e);break;case Cmd.SysMessageCmd_S.MsgType.BackToLobby:var t=new MJLobby.MessageItem;t.text=e.msg,t.title="",MJLobby.MessageQueue.Instance.push(t),game.GameView.exitGame();break;case Cmd.SysMessageCmd_S.MsgType.Bounce:var n=new MJLobby.MessageItem;n.text=e.msg,n.title="",MJLobby.MessageQueue.Instance.push(n);break;case Cmd.SysMessageCmd_S.MsgType.NotEnoughMoney:this.showMessageTips(e)}},t.prototype.showMessageBox=function(e){this.msgTips||(this.msgTips=new game.MsgBoxPanel),this.msgTips.x=uniLib.Global.screenWidth-this.msgTips.width>>1,this.msgTips.y=uniLib.Global.screenHeight-this.msgTips.height>>1,this.msgTips.setData(e.msg,["确定"],[this.msgConfirmHandler],this),game.GameInfo.topLayer.addChild(this.msgTips)},t.prototype.removeMessageBox=function(){this.msgTips&&(game.GameInfo.topLayer.removeChild(this.msgTips),this.msgTips=null)},t.prototype.msgConfirmHandler=function(e){this.msgTips&&(game.GameInfo.topLayer.removeChild(this.msgTips),this.msgTips=null,game.GameView.exitGame())},t.prototype.showMessageTips=function(e){var t=new game.MsgBoxPanel;t.x=uniLib.Global.screenWidth-t.width>>1,t.y=uniLib.Global.screenHeight-t.height>>1,game.GameInfo.topLayer.addChild(t);var n=function(){t&&t.parent&&(t.parent.removeChild(t),t=null)};t.setData(e.msg,["确定"],[n],this)},t.prototype.leaveRoom=function(e){game.GameView.exitGame(),this.clearTimer()},t.prototype.showLastHandcards=function(e){if(game.CardLayer.Instance.deleteCommonCards(),game.GameView.Instance.setBtnsVisible(!1),this.roundResultData=e,!(1==game.RoomInfo.getInstance().video||game.PokerFunction.MainSeat&&game.PokerFunction.MainSeat.isReady)){for(var t=function(e){var t=game.RoomData.Instance.seatList[e],i=new Cmd.PlayCardCmd_CS;if(i.uid=t.user.uid,!n.roundResultData.resultList.first(function(e){return e.user.uid==t.user.uid}))return"continue";var a=n.roundResultData.resultList.first(function(e){return e.user.uid==t.user.uid}).cardList;return null==i.cardList?t.handCards:a,i.cardListType=0,null!=i.cardList&&i.cardList.length?void game.OperateLayer.Instance.playCard(i):"continue"},n=this,i=0;i<game.RoomData.Instance.seatList.length;i++)t(i);this.showRoundResult(this.roundResultData)}},t.prototype.clearTimer=function(){this.timer&&(this.timer.stop(),this.timer=null)},t.clearResultTimer=function(){for(var e=0,n=t.ResultTimer;e<n.length;e++){var i=n[e];i.stop()}t.ResultTimer.clear()},t.prototype.dealCardEnd=function(){this.state=0},t.prototype.showRoundResult=function(n){e.EventManage.clearResultTimer(),this.state=1,game.SeatLayer.Instance.resetSeat();for(var i=0,a=game.SeatLayer.Instance.seatSprites;i<a.length;i++){var o=a[i];o.clearState(),o.deleteState()}if(game.GameView.Instance.playBtnVisable=!1,game.GameView.Instance.lookBtnVisable=!1,game.EffectCreate.Instance.clearChips(),game.BetSelectPanel.Instance.offPanel(),game.BetSelectPanel.Instance.changeRoundAnimation(!1,!1),game.OperateLayer.Instance.removeLandlordRobImage(!0),game.GameView.Instance.changeAllSum(!0),!game.PokerFunction.MainSeat||!game.PokerFunction.MainSeat.isReady){game.OperateLayer.Instance.stopTimer();for(var s=n.resultList,r=function(e,n){var i=s[e];i.user.uid==uniLib.NetMgr.UID;if(i&&i.profit>=0){game.EffectCreate.Instance.chipsfly(i.user.uid);var a=uniLib.SetUniEventTimeout(game.GameView.Instance,function(){game.EffectCreate.Instance.goldFlyEffect(game.RoomData.Instance.landlordUid,i.user.uid)},2100,1,h);t.ResultTimer.push(a)}else{var o=uniLib.SetUniEventTimeout(game.GameView.Instance,function(){game.EffectCreate.Instance.goldFlyEffect(i.user.uid,game.RoomData.Instance.landlordUid)},1500,1,h);t.ResultTimer.push(o)}var r=uniLib.SetUniEventTimeout(game.GameView.Instance,function(){game.EffectCreate.Instance.pointNotic(i.user.uid,i.profit)},2100,1,h);t.ResultTimer.push(r),i.user.uid==uniLib.NetMgr.UID&&(i.profit>=0?game.SoundHand.Instance.playDDZWin():game.SoundHand.Instance.playDDZLose())},h=this,l=0,d=s.length;d>l;l++)r(l,d);if(n.haveNextRound&&game.DataManager.isSitDown){game.GameView.Instance.setReadyBtnVisible(!0);var c=game.RoomData.Instance.roomPlayProps.first(function(e){return 88==e});c&&game.GameView.Instance.showShuffleBtn(n.shuffleUid,n.shuffleCost)}}},t.prototype.gameFianlSettle=function(e){game.RoomData.Instance.roomCurrentInnings=e.gameNum,game.OperateLayer.Instance.stopTimer(),game.GameInfo.topLayer.removeChildren();var t=new game.GameOverPanel;game.GameInfo.uiLayer.addChild(t),t.x=uniLib.Global.screenWidth-t.width>>1,t.y=uniLib.Global.screenHeight-t.height>>1,t.setData(e),game.RoomData.Instance.clearSeatList(),GX.MulticastEvent.EventList.removeAll(),game.GameView.Instance.setReadyBtnVisible(!1)},t.prototype.gmAvailableCardUpdate=function(e){var t=e,n=game.TestPanel.Instance;n.x=(uniLib.Global.screenWidth-n.width)/2,n.y=80,n.addListener(),game.GameInfo.topLayer.addChild(n),n.setCardList(t.cardList)},t.prototype.ActionUpdate=function(e){game.BetSelectPanel.Instance.updateChipsNum(e)},t.prototype.lookCard=function(e){for(var t=function(e){game.BetSelectPanel.Instance.updateBtnEnable(e.opList);var t=game.EffectCreate.Instance.cardImage[e.user.uid];if(!t)return"continue";if(t.length!=e.cardList.length)return"continue";for(var n=function(n){var i=table.TablePokerCard.resNormal(e.cardList[n]);t[n].anchorOffsetX=t[n].width/2,t[n].x=t[n].x+t[n].anchorOffsetX,egret.Tween.get(t[n]).to({scaleX:0},200).call(function(){t[n]?(t[n].setTexture(i),t[n].cardId=e.cardList[n]):console.error("不存在",n,"对应的",t)}).to({scaleX:1},200).call(function(){return egret.Tween.removeTweens(t[n])})},i=0;i<t.length;i++)n(i);game.EffectCreate.Instance.addNnLogo(e.cardType,null,e.user.uid)},n=0,i=e.each;n<i.length;n++){var a=i[n];t(a)}},t.prototype.bottomUpdate=function(e){game.GameView.Instance.bottomPointChange()},t.prototype.compareResult=function(e){this.compareFunc(e)},t.prototype.compareFunc=function(e){var t=game.RoomData.Instance.roomCurrentInnings,n=this;uniLib.SetUniEventTimeout(game.GameView.Instance,function(){game.EffectCreate.Instance.isCompared?n.compareFunc(e):1!=n.state&&t==game.RoomData.Instance.roomCurrentInnings&&game.EffectCreate.Instance.compareCard(e.lose,e.win)},200,1,this)},t}();t.stateChanged=new GX.MulticastEvent,t.startVisableChanged=new GX.MulticastEvent,t.ResultTimer=[],e.EventManage=t,__reflect(t.prototype,"DDZ.EventManage")}(DDZ||(DDZ={}));var LocalStorage=function(){function e(){this.$hideSelect="hideSelect"}return Object.defineProperty(e,"Instance",{get:function(){return null==e._self&&(e._self=new e),e._self},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hideSelct",{get:function(){var e=egret.localStorage.getItem(this.$hideSelect);return"1"==e?!0:!1},set:function(e){e?egret.localStorage.setItem(this.$hideSelect,"1"):egret.localStorage.setItem(this.$hideSelect,"0")},enumerable:!0,configurable:!0}),e}();__reflect(LocalStorage.prototype,"LocalStorage");var game;!function(e){var t=function(t){function n(i){var a=t.call(this,n.NAME,i)||this;e.GameInfo.uiLayer.addChild(e.GameView.Instance),a.initGame();var o=new e.DDZVoiceChat;return o.name="voiceVc",o.updateBtnRes(["NDvoice_btn1_ddz","NDvoice_btn2_ddz"]),e.GameInfo.uiLayer.addChild(o),a.facade.registerMediator(new e.DDZVoiceChatMediator(o)),0!=uniLib.Global.is_sandbox&&(o.visible=!1),GX.PokerEvent.Instance.systemMessage.add(a.showSystemMessage,a),a}return __extends(n,t),n.prototype.uiHandle=function(e){},n.prototype.listNotificationInterests=function(){return[e.MahjongFourFacadeConst.NOTIFY_COMMON_CHAT,e.MahjongFourFacadeConst.USERINFO_DATA,e.MahjongFourFacadeConst.SEND_GIFTS_NOTICE,e.MahjongFourFacadeConst.DISS_REQUEST_NOTICE,e.MahjongFourFacadeConst.ReturnIpAndGPS,e.MahjongFourFacadeConst.USER_ENTER_ROOM]},n.prototype.handleNotification=function(t){switch(t.getName()){case e.MahjongFourFacadeConst.NOTIFY_COMMON_CHAT:var n=t.getBody();this.showChatPop(n);break;case e.MahjongFourFacadeConst.USERINFO_DATA:var i=t.getBody();this.showUserInfo(i);break;case e.MahjongFourFacadeConst.SEND_GIFTS_NOTICE:var a=t.getBody();if(!a||!a.gift)return;var o=uniLib.SetUniEventTimeout(e.GameView.Instance,function(){e.EffectCreate.Instance.giftEffect(a.gift.giftsId,a.gift.toUid,a.gift.fromUid)},0,1,this);DDZ.EventManage.ResultTimer.push(o);break;case e.MahjongFourFacadeConst.DISS_REQUEST_NOTICE:var s=e.PokerFunction.GetUserInfoByUid(uniLib.NetMgr.UID);s&&this.dissolveRoom(t.getBody());break;case e.MahjongFourFacadeConst.ReturnIpAndGPS:e.GameView.Instance.setDistanceDate(t.getBody());break;case e.MahjongFourFacadeConst.USER_ENTER_ROOM:}},n.prototype.dissolveRoom=function(t){this._dismissPanel?this._dismissPanel.setData_Mjhong(t):(this._dismissPanel=new e.DismissPanel,this._dismissPanel.x=uniLib.Global.screenWidth-this._dismissPanel.width>>1,this._dismissPanel.y=uniLib.Global.screenHeight-this._dismissPanel.height>>1,this._dismissPanel.setData_Mjhong(t),e.GameInfo.topLayer.addChild(this._dismissPanel))},n.prototype.showSystemMessage=function(){this.removeDissPanel()},n.prototype.removeDissPanel=function(){this._dismissPanel&&this._dismissPanel.parent&&this._dismissPanel.parent.removeChild(this._dismissPanel),this._dismissPanel=null},n.prototype.showChatPop=function(t){var n=new e.ChatPop;e.GameInfo.topLayer.addChild(n),t.voiceId?n.showCommonChat(t.uid,String(t.voiceId)):t.words&&n.showCommonChat(t.uid,t.words)},n.prototype.showUserInfo=function(t){var n=new e.UserInfoPanel;n.x=uniLib.Global.screenWidth-n.width>>1,n.y=uniLib.Global.screenHeight-n.height>>1,n.setData(t),e.GameInfo.topLayer.addChild(n)},n.prototype.initGame=function(){e.PokerData.isStandAlone||this.facade.sendNotification(e.MahjongFourFacadeConst.SEND_DATA,null,e.DataRequestCommand.CONNECT_GAME_SERVER)},n.prototype.onRemove=function(){t.prototype.onRemove.call(this),this.facade.removeMediator(e.DDZVoiceChatMediator.NAME)},n}(puremvc.Mediator);t.NAME="DDZPokerMediator",e.DDZPokerMediator=t,__reflect(t.prototype,"game.DDZPokerMediator")}(game||(game={}));var game;!function(e){var t=function(t){function a(){var e=t.call(this)||this;return e._isCancel=!1,e}return __extends(a,t),a.StartVoicePlaying=function(e){var t=!1;for(var n in a.VoicePlaying){var i=a.VoicePlaying[n];1==i&&(t=!0)}t||(a.soundOpen=uniLib.SoundMgr.instance.soundOpen,uniLib.SoundMgr.instance.soundOpen=!1,uniLib.SoundMgr.instance.pauseBgMusic()),a.VoicePlaying[e]=!0},a.StopVoicePlaying=function(e){a.VoicePlaying[e]=!1;var t=!1;for(var n in a.VoicePlaying){var i=a.VoicePlaying[n];1==i&&(t=!0)}t||(uniLib.SoundMgr.instance.soundOpen=a.soundOpen,uniLib.SoundMgr.instance.resumeBgMusic())},a.prototype.initUI=function(){this._startBtn=new e.GameButton(["NDvoice_btn1_ddz","NDvoice_btn2_ddz"]),this._startBtn.y=490,this._startBtn.x=uniLib.Global.screenWidth-this._startBtn.width-(71-this._startBtn.width),this.addChild(this._startBtn),this._startBtn.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.startRecord,this),this._recording=new i,this.addChild(this._recording),this._recording.x=(e.DataCache.defaultWidth-this._recording.width)/2,this._recording.y=(e.DataCache.defaultHeight-this._recording.height)/2,this._recording.addEventListener(e.UIEventConsts.RECORD_TIME_OUT,this.recordEvent,this),this._voiceArr=[],e.GameInfo.topLayer.addChild(this._recording),e.RoomData.Instance.maxuserNbrChanged.add(this.maxnumchanged,this)
},a.prototype.maxnumchanged=function(t){e.GameView.Instance.maxNum>6?(this._startBtn.y=62,this._startBtn.x=1055):(this._startBtn.y=640,this._startBtn.x=uniLib.Global.screenWidth-this._startBtn.width-10)},a.prototype.updateBtnRes=function(t){this._startBtn.iconTexture(t),e.GameView.Instance.maxNum>6?(this._startBtn.y=62,this._startBtn.x=1055):(this._startBtn.y=640,this._startBtn.x=uniLib.Global.screenWidth-this._startBtn.width-10)},a.prototype.setVoiceVisible=function(e){this._startBtn.visible=e},a.prototype.test=function(){var e=new Cmd.VoiceChat_Brd;e.uid=uniLib.UserInfo.uid,e.time="15",e.url="",this.showVoice(e)},a.prototype.showVoice=function(t){var n=e.GameConstant.GetClientNoByUid(t.uid);if(!(n>2||0>n)){var i=this.getVoiceItem(n);e.GameInfo.topLayer.addChildAt(i,0);var a=new e.VoiceDataVo;a.time=Number(t.time),a.url=t.url,a.uid=t.uid,i.setData(a)}},a.prototype.getVoiceItem=function(t){if(this._voiceArr[t])return this._voiceArr[t];var i=e.GameConstant.seatPosArr[t];switch(e.GameView.Instance.maxNum){case 6:i=e.GameConstant.seatPosArr[t];break;default:i=e.GameConstant.seatMaxPosArr[t]}if(i){if(!this._voiceArr[t]){var a=new n;0==t||2==t?a.x=i.x+e.GameConstant.HeadWidth:1==t&&(a.scaleX=-1,a.flip(),a.x=i.x),a.y=i.y+10,this._voiceArr[t]=a}return this._voiceArr[t]}},a.prototype.recordEvent=function(e){this.stopRecord()},a.prototype.startRecord=function(e){this._isCancel=!1,this._curPosY=e.localY,egret.MainContext.instance.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.stopRecord,this),egret.MainContext.instance.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.checkCancel,this),uniLib.ZQGameSdk.startRecord(),this._recording.startTimer()},a.prototype.checkCancel=function(e){e.localY>this._curPosY+20&&(this._isCancel=!0,egret.MainContext.instance.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.stopRecord,this),egret.MainContext.instance.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.checkCancel,this),uniLib.ZQGameSdk.stopRecord(),this._recording.stopTimer())},a.prototype.stopRecord=function(e){void 0===e&&(e=null),egret.MainContext.instance.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.stopRecord,this),egret.MainContext.instance.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.checkCancel,this);var t=this._recording.stopTimer();1e3>t?uniLib.SetUniEventTimeout(this,function(){uniLib.ZQGameSdk.stopRecord()},1e3,1,this):uniLib.ZQGameSdk.stopRecord(this.onRecordBack,this)},a.prototype.onRecordBack=function(t){var n=t.data,i=e.GameConstant.GetClientNoByUid(uniLib.NetMgr.UID);this.getVoiceItem(i);if(0==t.code){var a=new e.VoiceDataVo;a.url=n.voiceUrl,a.time=Math.round(n.voiceDuration/1e3),a.nickName=uniLib.NetMgr.UID.toString(),a.text=n.text,a.status=0,isNaN(a.time)?e.GameInfo.manage.showMildWarnShow("语音发送失败"):0==this._isCancel&&this.dispatchEventWith(e.UIEventConsts.SEND_RECORD,!1,a)}else e.GameInfo.manage.showMildWarnShow(t.errMsg)},a.prototype.destory=function(){e.RoomData.Instance.maxuserNbrChanged.remove(this.maxnumchanged),this._startBtn&&(this._startBtn.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.startRecord,this),egret.MainContext.instance.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.stopRecord,this),egret.MainContext.instance.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.checkCancel,this),this._startBtn.destory()),this._startBtn=null,this._recording&&(e.ResUtil.removeFromParent(this._recording),this._recording.removeEventListener(e.UIEventConsts.RECORD_TIME_OUT,this.recordEvent,this),this._recording.destory()),this._recording=null;for(var t,n=0;n<this._voiceArr.length;n++)t=this._voiceArr[n],t&&(e.ResUtil.removeFromParent(t),t.destory(),t=null);this._voiceArr=null,uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this)},a}(e.BaseVc);t.VoicePlaying={},e.DDZVoiceChat=t,__reflect(t.prototype,"game.DDZVoiceChat");var n=function(n){function i(){var e=n.call(this)||this;return e._ifFlip=!1,e}return __extends(i,n),i.prototype.initUI=function(){this._bg=e.ResUtil.createBitmapByName("voice_paopao_ddz"),this._bg.scale9Grid=new egret.Rectangle(50,10,30,20),this.addChild(this._bg),this._soundIcon=e.ResUtil.createBitmapByName("voice_icon_ddz",24,11),this.addChild(this._soundIcon),this._timeTxt=e.ResUtil.createTextFeild(16777215,egret.HorizontalAlign.RIGHT,"",18,48,13,50),this.addChild(this._timeTxt)},i.prototype.onTimer=function(){this._soundIcon.visible=!this._soundIcon.visible;var e=new Date,n=e.getTime(),i=Math.floor((n-this._startTime)/1e3);i>=this._soundTime&&(t.StopVoicePlaying(this.uid),this.stopTimer())},i.prototype.stopTimer=function(){this._soundIcon.visible=!0,this.visible=!1,this._timer&&(this._timer.stop(),this._timer=null)},i.prototype.flip=function(){this._ifFlip=!0,this._timeTxt.skewY=180,this._timeTxt.textAlign=egret.HorizontalAlign.LEFT},i.prototype.setData=function(e){this.uid=e.uid,t.StartVoicePlaying(this.uid),e.uid!=uniLib.NetMgr.UID&&uniLib.ZQGameSdk.playRecord(e.url,this.playEndBack,this),e.time?this._timeTxt.text=e.time+"''":this._timeTxt.text="",this._soundTime=e.time?e.time:10,e.time<=3?this._bg.width=100:this._bg.width=100+5*(e.time-3),this._ifFlip?this._timeTxt.x=this._bg.width-12:this._timeTxt.x=this._bg.width-60,this.stopTimer(),this.visible=!0,this._timer=new uniLib.UniTimer(this,this.onTimer,200,!0,this);var n=new Date;this._startTime=n.getTime()},i.prototype.playEndBack=function(e){this.stopTimer()},i.prototype.destory=function(){this.stopTimer(),uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this),this._bg=null,this._soundIcon=null},i}(e.BaseVc);e.DDZVoiceMc=n,__reflect(n.prototype,"game.DDZVoiceMc");var i=function(t){function n(){var e=t.call(this)||this;return e._maxTime=15,e._msTime=0,e}return __extends(n,t),n.prototype.initUI=function(){var t=e.ResUtil.createBitmapByName("voice_recording_ddz");this.addChild(t),this._moving=new egret.DisplayObjectContainer,this._moving.x=104,this._moving.y=102;var n=e.ResUtil.createBitmapByName("voiceloading_ddz");n.x=-n.width/2,n.y=-n.height/2,this._moving.addChild(n),this.addChild(this._moving),this._time=e.ResUtil.createTextFeild(13031390,egret.HorizontalAlign.CENTER,"8''",22,74,136,75),this.addChild(this._time),this.visible=!1},n.prototype.startTimer=function(){this.stopTimer(),this.visible=!0,this._startTimer=new uniLib.UniTimer(this,this.onTimer,50,!0,this);var e=new Date;this._startTime=e.getTime()},n.prototype.stopTimer=function(){return this.visible=!1,this._startTimer&&(this._startTimer.stop(),this._startTimer=null),this._msTime},n.prototype.onTimer=function(){var t=new Date,n=t.getTime(),i=Math.floor((n-this._startTime)/1e3);this._time.text=i+1+"''",this._moving.rotation+=15,i>=this._maxTime&&this.dispatchEventWith(e.UIEventConsts.RECORD_TIME_OUT),this._msTime=n-this._startTime},n.prototype.dispose=function(){this.stopTimer(),this._moving&&(uniLib.DisplayUtils.removeAllChildren(this._moving),uniLib.DisplayUtils.removeFromParent(this._moving)),uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this),this._moving=null,this._time=null},n}(e.BaseVc);e.DDZRecordingMc=i,__reflect(i.prototype,"game.DDZRecordingMc")}(game||(game={}));var game;!function(e){var t=function(t){function n(n){var i=t.call(this,e.VoiceChatMediator.NAME,n)||this;return i._voiceVc=n,i._voiceVc.addEventListener(e.UIEventConsts.SEND_RECORD,i.uiEventHandle,i),i}return __extends(n,t),n.prototype.uiEventHandle=function(t){var n=t.type;switch(n){case e.UIEventConsts.SEND_RECORD:var i=t.data,a=new Cmd.VoiceChat_C;a.url=i.url,a.time=i.time.toString(),a.words=i.text,this.sendNotification(e.MahjongFourFacadeConst.SEND_DATA,a,e.DataRequestCommand.GAME_DATA)}},n.prototype.listNotificationInterests=function(){return[e.MahjongFourFacadeConst.USER_ENTER_ROOM,e.MahjongFourFacadeConst.VOICE_NOTICE]},n.prototype.handleNotification=function(t){switch(t.getName()){case e.MahjongFourFacadeConst.VOICE_NOTICE:this._voiceVc.showVoice(t.getBody());break;case e.MahjongFourFacadeConst.USER_ENTER_ROOM:}},n.prototype.onRemove=function(){e.DDZVoiceChat.VoicePlaying={},this._voiceVc&&(this._voiceVc.removeEventListener(e.UIEventConsts.SEND_RECORD,this.uiEventHandle,this),this._voiceVc.destory(),this._voiceVc=null),t.prototype.onRemove.call(this)},n}(puremvc.Mediator);t.NAME="DDZVoiceChatMediator",e.DDZVoiceChatMediator=t,__reflect(t.prototype,"game.DDZVoiceChatMediator")}(game||(game={}));var DDZtable;!function(e){var t=function(){function e(){}return e.prototype.GetType=function(){return"table.gameList"},e}();e.gameList=t,__reflect(t.prototype,"DDZtable.gameList")}(DDZtable||(DDZtable={}));var DDZtable;!function(e){var t=function(){function e(){}return e.prototype.GetType=function(){return"table.PokerTableCard"},e}();e.PokerTableCard=t,__reflect(t.prototype,"DDZtable.PokerTableCard")}(DDZtable||(DDZtable={}));var DDZtable;!function(e){var t=function(){function e(){}return e.prototype.GetType=function(){return"DDZtable.TableCard"},e}();e.TableCard=t,__reflect(t.prototype,"DDZtable.TableCard")}(DDZtable||(DDZtable={}));var DDZtable;!function(e){var t=function(){function e(){}return e.prototype.GetType=function(){return"table.TableGift"},e}();e.TableGift=t,__reflect(t.prototype,"DDZtable.TableGift")}(DDZtable||(DDZtable={})),table.TableGift.instance=function(){return null==table.TableGift.$instance&&(table.TableGift.$instance=loadTable("TableGift_json")),table.TableGift.$instance};var DDZtable;!function(e){var t=function(){function e(){}return e.prototype.GetType=function(){return"table.TableGoodsConfig"},e}();e.TableGoodsConfig=t,__reflect(t.prototype,"DDZtable.TableGoodsConfig"),function(e){var t=function(){function e(){}return e}();e.GiftGoodsItem=t,__reflect(t.prototype,"DDZtable.TableGoodsConfig.GiftGoodsItem")}(t=e.TableGoodsConfig||(e.TableGoodsConfig={}))}(DDZtable||(DDZtable={}));var DDZtable;!function(e){var t=function(){function e(){}return e.prototype.GetType=function(){return"table.TableMahjongMulti"},e}();e.TableMahjongMulti=t,__reflect(t.prototype,"DDZtable.TableMahjongMulti")}(DDZtable||(DDZtable={}));var table;!function(e){var t=function(){function e(){}return e.prototype.GetType=function(){return"table.TableNYSCard"},e}();e.TableNYSCard=t,__reflect(t.prototype,"table.TableNYSCard")}(table||(table={})),table.TableNYSCard.instance=function(){return null==table.TableNYSCard.$instance&&(table.TableNYSCard.$instance=loadTable("TableNYSCard_json")),table.TableNYSCard.$instance};var DDZtable;!function(e){var t=function(){function e(){}return e.prototype.GetType=function(){return"table.TablePlayTypeList"},e}();e.TablePlayTypeList=t,__reflect(t.prototype,"DDZtable.TablePlayTypeList")}(DDZtable||(DDZtable={}));var DDZtable;!function(e){var t=function(){function e(){}return e.prototype.GetType=function(){return"table.TableRoomCostConfig"},e}();e.TableRoomCostConfig=t,__reflect(t.prototype,"DDZtable.TableRoomCostConfig")}(DDZtable||(DDZtable={}));var DDZtable;!function(e){var t=function(){function e(){}return e.prototype.GetType=function(){return"table.TableServerReturnCode"},e}();e.TableServerReturnCode=t,__reflect(t.prototype,"DDZtable.TableServerReturnCode")}(DDZtable||(DDZtable={}));var DDZtable;!function(e){var t=function(){function e(){}return e.prototype.GetType=function(){return"table.TableShopConfig"},e}();e.TableShopConfig=t,__reflect(t.prototype,"DDZtable.TableShopConfig"),function(e){var t=function(){function e(){}return e}();e.ShopGoodsItem=t,__reflect(t.prototype,"DDZtable.TableShopConfig.ShopGoodsItem")}(t=e.TableShopConfig||(e.TableShopConfig={})),function(e){var t=function(){function e(){}return e}();e.FirstShopGoodsItem=t,__reflect(t.prototype,"DDZtable.TableShopConfig.FirstShopGoodsItem")}(t=e.TableShopConfig||(e.TableShopConfig={}))}(DDZtable||(DDZtable={}));var DDZtable;!function(e){var t=function(){function e(){}return e.prototype.GetType=function(){return"table.TableVoice"},e}();e.TableVoice=t,__reflect(t.prototype,"DDZtable.TableVoice")}(DDZtable||(DDZtable={}));var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,n,i){function a(e){t.call(i,e)}function o(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),n.call(i))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),RES.getResByUrl(e,a,this,RES.ResourceItem.TYPE_TEXT)},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var ZJHMain=function(e){function t(t){var n=e.call(this,t)||this;return n.isThemeLoadEnd=!1,game.GameViewConfig.mainMediatorName=uniLib.getQualifiedClassName(game.DDZPokerMediator),game.DataCache.platParam={},"false"==uniLib.BrowersUtils.GetRequest("cacheres")&&(RES.web.Html5VersionController.prototype.getVirtualUrl=function(e){return e+="?v="+Math.random()}),n._gameInfo&&(game.DataCache.gameInfo=n._gameInfo),t&&t.destroyResOnExit&&(game.DataCache.destroyResOnExit=t.destroyResOnExit),n._gameInfo&&n._gameInfo.extData&&(game.DataCache.platParam=n._gameInfo.extData),n._gameInfo&&n._gameInfo.extData&&n._gameInfo.extData.video?(game.RoomInfo.getInstance().video=n._gameInfo.extData.video,game.RoomInfo.getInstance().videoUid=n._gameInfo.extData.videoUid):(game.RoomInfo.getInstance().video=0,game.RoomInfo.getInstance().videoUid=0),MJLobby.MJLobbyData.ShowGameLoading&&(uniLib.UIMgr.instance.showLoadingTimeout(DDZLoadingView),uniLib.UIMgr.instance.commonLoadUI=DDZLoadingView),console.error("是否是新的房间数据:"+game.RoomData.Instance.seatList.length),game.RoomData.Instance.clearSeatList(),GX.MulticastEvent.EventList.removeAll(),game.GameData.iskPoker=!0,game.PokerFunction.handCardSort=function(e){return e.sort(function(e,t){return t-e})},n.initDoor(),n}return __extends(t,e),t.prototype.start=function(e){void 0===e&&(e=null);var t={};t.designWidth=1280,t.designHeight=720,t.debug=!0,uniLib.init(t),MJLobby.ScreenFixedUtils.instance.init(egret.StageScaleMode.FIXED_HEIGHT),RES.setMaxLoadingThread(6);var n=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",n),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},t.prototype.initDoor=function(){for(var e=new Array,t=1;6>=t;t++){var n=new game.DoorData(t);e.push(n)}game.RoomData.Instance.initDoorDatas(e)},t.prototype.onConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var t=new eui.Theme("resource/default.thm.json",this.stage);t.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this)},t.prototype.onThemeLoadComplete=function(){this.preLoadEnd()},t.prototype.preLoadEnd=function(){uniLib.UIMgr.instance.showProcessBar(null,2,100,"正在加载游戏资源..."),uniLib.Global.lobbyMode?uniLib.ResLoadMgr.instance.load(game.GameConstant.ResGroup_DDZ,this.startCreateScene,this.onItemLoadError,this,null):(uniLib.ResLoadMgr.instance.load(game.GameConstant.ResGroup_DDZ,this.startCreateScene,this.onItemLoadError,this,null),uniLib.ResLoadMgr.instance.load("common",this.startCreateScene,this.onItemLoadError,this,null))},t.prototype.onItemLoadError=function(e){console.warn("Url:"+e.groupName+"..."+e.itemsLoaded+"..."+e.itemsTotal+" has failed to load")},t.prototype.startCreateScene=function(){game.GameConstant.loadResMp3(),this._gameInfo&&(game.DataCache.gameInfo=this._gameInfo),this._gameInfo&&this._gameInfo.extData&&(game.DataCache.platParam=this._gameInfo.extData),game.GameData.iskPoker=!0,game.DataCache.langObj=JSON.parse(RES.getRes("ddz_GameTxt_cn_txt")),game.GameInfo.manage=game.PublicManage.getInstance(),game.DataCache.stageWidth=uniLib.Global.screenWidth,game.DataCache.stageHight=uniLib.Global.screenHeight;var e=new Array;e=["快点下注吧，一会就没机会了","我是庄家谁敢挑战我！","看我通杀全场，这些钱都是我的！","不出炸弹我们还是好牌友！","牌运来了，挡都挡不住！","牌好，就是任性！","一手烂牌，哪年才能翻身！","风水轮流转，底裤都输光了！","不要走，决战到天亮！","又断线了，网络怎么这么差啊！","各位真不好意思，我要离开一会","下次咱们再玩吧！"];for(var t=0;t<e.length;t++)game.GameData.getInstance().ShortTalkArr[t]=e[t];uniLib.UIMgr.instance.hideLoading(),uniLib.SceneMgr.instance.changeScene(game.PokerGameScene),new DDZ.EventManage,game.SoundHand.Instance.playDDZBg()},t}(uniLib.GameDoc);__reflect(ZJHMain.prototype,"ZJHMain");